{"version":3,"file":"main.js","mappings":"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","sources":["webpack:///./src/CurvyWallsToolBar.ts","webpack:///./src/CurvyWallToolManager.ts","webpack:///./src/tools/BezierTool.ts","webpack:///../common/Settings.ts","webpack:///./src/tools/CircleTool.ts","webpack:///./src/tools/ToolInputHandler.ts","webpack:///./src/tools/RectangleTool.ts","webpack:///./src/tools/CubicTool.ts","webpack:///./libs/bezier.js","webpack:///./src/tools/QuadTool.ts","webpack:///./src/tools/PointMapper.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./src/df-curvy-walls.ts"],"sourcesContent":["\nimport { CurvyWallToolManager, Mode } from './CurvyWallToolManager';\nimport SETTINGS from \"../../common/Settings\";\nimport { ToolMode } from './tools/BezierTool';\n\nexport interface CurvyWallControl {\n\ttitle: string;\n\ticon: string;\n\ttoggleable?: boolean;\n\tclass?: string;\n\tisActive?: () => boolean;\n\tonClick: (enabled?: boolean) => void;\n}\ninterface CurvyWallControlUI {\n\tname: string;\n\ttitle: string;\n\ticon: string;\n\ttoggleable?: boolean;\n\tclass?: string;\n\tisActive?: boolean;\n}\ninterface CurvyWallsToolsOptions {\n\ttools: CurvyWallControlUI[];\n\tgeneral: CurvyWallControlUI[];\n\tcontrols: CurvyWallControlUI[];\n}\n\nexport class CurvyWallsToolBar extends Application {\n\tstatic init() {\n\t\tHooks.on('getModuleToolGroups', (controlManager: ControlManager, groups: ToolGroup[]) => {\n\t\t\tgroups.push(\n\t\t\t\t{\n\t\t\t\t\tname: SETTINGS.MOD_NAME,\n\t\t\t\t\ticon: '<i class=\"fas fa-bezier-curve\"></i>',\n\t\t\t\t\ttitle: 'Curvy Walls Tools',\n\t\t\t\t\tvisible: () => {\n\t\t\t\t\t\treturn ui.controls.activeControl === 'walls';\n\t\t\t\t\t},\n\t\t\t\t\ttools: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'cubic',\n\t\t\t\t\t\t\ttitle: \"df-curvy-walls.cubic\",\n\t\t\t\t\t\t\ticon: '<i class=\"fas fa-bezier-curve\"></i>',\n\t\t\t\t\t\t\ttoggle: true,\n\t\t\t\t\t\t\tisActive: () => CurvyWallToolManager.instance.mode === Mode.Cube,\n\t\t\t\t\t\t\tonClick: active => { CurvyWallToolManager.instance.mode = active ? Mode.Cube : Mode.None; }\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'quadratic',\n\t\t\t\t\t\t\ttitle: \"df-curvy-walls.quadratic\",\n\t\t\t\t\t\t\ticon: '<i class=\"fas fa-project-diagram\"></i>',\n\t\t\t\t\t\t\ttoggle: true,\n\t\t\t\t\t\t\tisActive: () => CurvyWallToolManager.instance.mode === Mode.Quad,\n\t\t\t\t\t\t\tonClick: active => { CurvyWallToolManager.instance.mode = active ? Mode.Quad : Mode.None; }\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'circle',\n\t\t\t\t\t\t\ttitle: \"df-curvy-walls.circle\",\n\t\t\t\t\t\t\ticon: '<i class=\"fas fa-circle\"></i>',\n\t\t\t\t\t\t\ttoggle: true,\n\t\t\t\t\t\t\tisActive: () => CurvyWallToolManager.instance.mode === Mode.Circ,\n\t\t\t\t\t\t\tonClick: active => { CurvyWallToolManager.instance.mode = active ? Mode.Circ : Mode.None; }\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'rectangle',\n\t\t\t\t\t\t\ttitle: \"df-curvy-walls.rectangle\",\n\t\t\t\t\t\t\ticon: '<i class=\"fas fa-vector-square\"></i>',\n\t\t\t\t\t\t\ttoggle: true,\n\t\t\t\t\t\t\tisActive: () => CurvyWallToolManager.instance.mode === Mode.Rect,\n\t\t\t\t\t\t\tonClick: active => { CurvyWallToolManager.instance.mode = active ? Mode.Rect : Mode.None; }\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic readonly PREF_PRESERVE = 'preserve-tool';\n\n\tstatic get defaultOptions(): Application.Options {\n\t\treturn mergeObject(super.defaultOptions, {\n\t\t\tpopOut: false,\n\t\t\ttemplate: 'modules/df-curvy-walls/templates/curvy-walls-controls.hbs'\n\t\t});\n\t}\n\n\tprivate _closing = false;\n\n\tprivate _tools: Record<string, CurvyWallControl> = {\n\t\tbeziercube: {\n\t\t\ttitle: \"df-curvy-walls.cubic\",\n\t\t\ticon: \"fas fa-bezier-curve\",\n\t\t\tisActive: function () { return CurvyWallToolManager.instance.mode == Mode.Cube; },\n\t\t\tonClick: function () { return CurvyWallToolManager.instance.mode = this.isActive() ? Mode.None : Mode.Cube; }\n\t\t},\n\t\tbezierquad: {\n\t\t\ttitle: \"df-curvy-walls.quadratic\",\n\t\t\ticon: \"fas fa-project-diagram\",\n\t\t\tisActive: function () { return CurvyWallToolManager.instance.mode == Mode.Quad; },\n\t\t\tonClick: function () { return CurvyWallToolManager.instance.mode = this.isActive() ? Mode.None : Mode.Quad; }\n\t\t},\n\t\tbeziercirc: {\n\t\t\ttitle: \"df-curvy-walls.circle\",\n\t\t\ticon: \"fas fa-circle\",\n\t\t\tisActive: function () { return CurvyWallToolManager.instance.mode == Mode.Circ; },\n\t\t\tonClick: function () { return CurvyWallToolManager.instance.mode = this.isActive() ? Mode.None : Mode.Circ; }\n\t\t},\n\t\tbezierrect: {\n\t\t\ttitle: \"df-curvy-walls.rectangle\",\n\t\t\ticon: \"fas fa-vector-square\",\n\t\t\tisActive: function () { return CurvyWallToolManager.instance.mode == Mode.Rect; },\n\t\t\tonClick: function () { return CurvyWallToolManager.instance.mode = this.isActive() ? Mode.None : Mode.Rect; }\n\t\t}\n\t};\n\tprivate _generalControls: Record<string, CurvyWallControl> = {\n\t\tincrement: {\n\t\t\ttitle: 'df-curvy-walls.increment',\n\t\t\ticon: 'fas fa-plus',\n\t\t\tonClick: () => CurvyWallToolManager.instance.segments++\n\t\t},\n\t\tdecrement: {\n\t\t\ttitle: 'df-curvy-walls.decrement',\n\t\t\ticon: 'fas fa-minus',\n\t\t\tonClick: () => CurvyWallToolManager.instance.segments--\n\t\t},\n\t\tapply: {\n\t\t\ttitle: 'df-curvy-walls.apply',\n\t\t\ticon: 'fas fa-check',\n\t\t\tclass: 'apply',\n\t\t\tonClick: CurvyWallToolManager.instance.apply.bind(CurvyWallToolManager.instance)\n\t\t},\n\t\tcancel: {\n\t\t\ttitle: 'df-curvy-walls.cancel',\n\t\t\ticon: 'fas fa-times',\n\t\t\tclass: 'cancel',\n\t\t\tonClick: CurvyWallToolManager.instance.clearTool.bind(CurvyWallToolManager.instance)\n\t\t}\n\t};\n\tprivate _placementControls: Record<string, CurvyWallControl> = {\n\t\tpointconstruct: {\n\t\t\ttitle: 'df-curvy-walls.trace_curve_with_points',\n\t\t\ticon: 'fas fa-route',\n\t\t\ttoggleable: true,\n\t\t\tisActive: () => CurvyWallToolManager.instance.currentlyMappingPoints,\n\t\t\tonClick: () => {\n\t\t\t\tCurvyWallToolManager.instance.togglePointMapping();\n\t\t\t\tthis.render(false);\n\t\t\t}\n\t\t},\n\t\tapplyplacement: {\n\t\t\ttitle: 'df-curvy-walls.pointmapapply',\n\t\t\ticon: 'fas fa-check',\n\t\t\tclass: 'apply',\n\t\t\tonClick: () => { CurvyWallToolManager.instance.applyPointMapping(); }\n\t\t}\n\t};\n\n\tconstructor(options?: Application.Options) {\n\t\tsuper(options);\n\t\tCurvyWallToolManager.instance.setModeListener(() => {\n\t\t\tif (this._closing) {\n\t\t\t\tthis._closing = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.render(false);\n\t\t});\n\t}\n\n\tgetData(): CurvyWallsToolsOptions {\n\t\tconst toolIsPlaced = CurvyWallToolManager.instance.mode != Mode.None && CurvyWallToolManager.instance.activeTool.mode != ToolMode.NotPlaced;\n\t\tconst toolControls = CurvyWallToolManager.instance.activeTool?.getTools();\n\t\tconst placementControls: CurvyWallControlUI[] = [{\n\t\t\tname: 'pointconstruct',\n\t\t\ttitle: this._placementControls.pointconstruct.title,\n\t\t\ticon: this._placementControls.pointconstruct.icon,\n\t\t\tclass: this._placementControls.pointconstruct.class,\n\t\t\ttoggleable: true,\n\t\t\tisActive: this._placementControls.pointconstruct.isActive()\n\t\t}];\n\t\tif (CurvyWallToolManager.instance.currentlyMappingPoints && CurvyWallToolManager.instance.canApplyPointMapping)\n\t\t\tplacementControls.push({\n\t\t\t\tname: 'applyplacement',\n\t\t\t\ttitle: this._placementControls.applyplacement.title,\n\t\t\t\ticon: this._placementControls.applyplacement.icon,\n\t\t\t\tclass: this._placementControls.applyplacement.class\n\t\t\t});\n\n\t\tconst data: CurvyWallsToolsOptions = {\n\t\t\ttools: Object.keys(this._tools).map(it => {\n\t\t\t\treturn {\n\t\t\t\t\tname: it,\n\t\t\t\t\ttitle: this._tools[it].title,\n\t\t\t\t\ticon: this._tools[it].icon,\n\t\t\t\t\ttoggleable: true,\n\t\t\t\t\tisActive: this._tools[it].isActive()\n\t\t\t\t};\n\t\t\t}),\n\t\t\tgeneral: toolIsPlaced ? Object.keys(this._generalControls).map(it => {\n\t\t\t\treturn {\n\t\t\t\t\tname: it,\n\t\t\t\t\ttitle: this._generalControls[it].title,\n\t\t\t\t\ticon: this._generalControls[it].icon,\n\t\t\t\t\tclass: this._generalControls[it].class\n\t\t\t\t};\n\t\t\t}) : [Mode.Quad, Mode.Circ, Mode.Rect].includes(CurvyWallToolManager.instance.mode) ? placementControls : [],\n\t\t\tcontrols: toolIsPlaced && !!toolControls ? Object.keys(toolControls).map(it => {\n\t\t\t\treturn {\n\t\t\t\t\tname: it,\n\t\t\t\t\ttitle: toolControls[it].title,\n\t\t\t\t\ticon: toolControls[it].icon,\n\t\t\t\t\tclass: toolControls[it].class,\n\t\t\t\t\ttoggleable: toolControls[it].toggleable,\n\t\t\t\t\tisActive: toolControls[it].toggleable ? toolControls[it].isActive() : undefined\n\t\t\t\t};\n\t\t\t}) : []\n\t\t};\n\n\t\treturn data;\n\t}\n\n\tactivateListeners(html: JQuery<HTMLElement>) {\n\t\tconst toolbarPosition = game.settings.get('lib-df-buttons', 'position');\n\t\tswitch (toolbarPosition) {\n\t\t\tcase 'top':\n\t\t\t\thtml.remove();\n\t\t\t\t$(document.querySelector('#moduleControls')).append(html);\n\t\t\t\thtml.css('position', 'unset');\n\t\t\t\tbreak;\n\t\t\tcase 'left':\n\t\t\t\thtml.remove();\n\t\t\t\t$(document.querySelector('#moduleControls')).append(html);\n\t\t\t\thtml.css('top', '0');\n\t\t\t\thtml.css('left', '46px');\n\t\t\t\tbreak;\n\t\t\tcase 'right':\n\t\t\tcase 'bottom':\n\t\t\t\thtml.css('left', (ui as any).moduleControls.getLeftWidth() + 'px');\n\t\t\t\thtml.css('top', (ui as any).moduleControls.getTopHeight(true) + 'px');\n\t\t\t\tbreak;\n\t\t}\n\t\thtml.find('li').on(\"click\", (event: JQuery.ClickEvent) => {\n\t\t\tconst element = $(event.currentTarget);\n\t\t\tconst name = element.attr('data-tool');\n\n\t\t\tconst tool = this._tools[name];\n\t\t\tif (tool !== undefined) {\n\t\t\t\ttool.onClick();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst generalControl = this._generalControls[name];\n\t\t\tif (generalControl !== undefined) generalControl.onClick();\n\n\t\t\tconst placementControl = this._placementControls[name];\n\t\t\tif (placementControl !== undefined) placementControl.onClick();\n\n\t\t\tconst toolControl = CurvyWallToolManager.instance.activeTool?.getTools()[name];\n\t\t\tif (toolControl !== undefined) {\n\t\t\t\tif (!toolControl.toggleable) toolControl.onClick();\n\t\t\t\telse toolControl.onClick(!toolControl.isActive());\n\t\t\t}\n\n\t\t\tthis.render(false);\n\t\t});\n\t}\n\n\tclose(options?: Application.CloseOptions): Promise<void> {\n\t\tif (!SETTINGS.get(CurvyWallsToolBar.PREF_PRESERVE)) {\n\t\t\tthis._closing = true;\n\t\t\tCurvyWallToolManager.instance.mode = Mode.None;\n\t\t}\n\t\treturn super.close(options);\n\t}\n}","import { BezierTool, ToolMode } from './tools/BezierTool';\nimport CircleTool from './tools/CircleTool';\nimport RectangleTool from './tools/RectangleTool';\nimport CubicTool from './tools/CubicTool';\nimport QuadTool from './tools/QuadTool';\nimport { InputHandler } from './tools/ToolInputHandler';\nimport PointMapper from './tools/PointMapper';\nimport SETTINGS from \"../../common/Settings\";\nimport { WallData } from '@league-of-foundry-developers/foundry-vtt-types/src/foundry/common/data/data.mjs';\n\ndeclare global {\n\tnamespace PIXI {\n\t\tinterface InteractionData {\n\t\t\torigin: PIXI.Point;\n\t\t\tdestination: PIXI.Point;\n\t\t}\n\t}\n}\n\nexport enum Mode {\n\tNone,\n\tCube,\n\tQuad,\n\tCirc,\n\tRect\n}\n\nconst MODE_NAMES: { [key: number]: string } = {};\nMODE_NAMES[Mode.None] = 'undefined';\nMODE_NAMES[Mode.Cube] = 'beziercube';\nMODE_NAMES[Mode.Quad] = 'bezierquad';\nMODE_NAMES[Mode.Circ] = 'beziercirc';\nMODE_NAMES[Mode.Rect] = 'bezierrect';\nclass WallPool {\n\tstatic readonly walls: Wall[] = [];\n\tstatic acquire(wallData: WallData): Wall {\n\t\tconst result = this.walls.pop() ?? new Wall(new WallDocument(wallData, { parent: canvas.scene }));\n\t\tresult.data = wallData;\n\t\treturn result;\n\t}\n\tstatic release(wall: Wall) { this.walls.push(wall); }\n}\n\nexport class CurvyWallToolManager {\n\tstatic readonly PREF_DROP_KEY = 'drop-key';\n\tprivate static _instance: CurvyWallToolManager;\n\tprivate _mode = Mode.None;\n\tprivate wallsLayer: WallsLayer;\n\tprivate walls: Wall[] = [];\n\tprivate currentHandler?: InputHandler = null;\n\tprivate _activeTool?: BezierTool = null;\n\tprivate _modeListener: (mode: Mode, toolMode: ToolMode | null) => void = null;\n\tprivate _ignoreNextToolModeChange = false;\n\tprivate _previousToolData = new Map<Mode, object>([\n\t\t[Mode.Cube, { l1: [-100, 0], l2: [100, 0], c1: [-100, -132], c2: [100, -132] }],\n\t\t[Mode.Quad, { l1: [-100, 0], l2: [100, 0], c: [0, -132] }],\n\t\t[Mode.Circ, { l1: [-100, -100], l2: [100, 100], a1: 0, a2: 0 }],\n\t\t[Mode.Rect, { l1: [-100, -100], l2: [100, 100], t: 1, r: 1, b: 1, l: 1 }],\n\t]);\n\tprivate _pointMapper = new PointMapper();\n\n\tget segments(): number { return this._activeTool.segments; }\n\tset segments(value: number) {\n\t\tthis._activeTool.segments = Math.clamped(value, 1, 64);\n\t\tif (this.mode != Mode.None)\n\t\t\tthis.render();\n\t}\n\tget activeTool(): BezierTool | null { return this._activeTool; }\n\n\tprivate _inPointMapMode = false;\n\tget currentlyMappingPoints(): boolean { return this._inPointMapMode; }\n\n\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\tprivate constructor() { }\n\tpublic static get instance(): CurvyWallToolManager {\n\t\treturn this._instance || (this._instance = new this());\n\t}\n\n\tget mode(): Mode { return this._mode; }\n\tset mode(value: Mode) {\n\t\tif (this._mode === value) return;\n\t\tthis._ignoreNextToolModeChange = this.activeTool?.mode !== ToolMode.NotPlaced;\n\t\tthis.clearTool();\n\t\tif (this._inPointMapMode)\n\t\t\tthis.togglePointMapping();\n\t\tthis._mode = value;\n\t\tif (this._inPointMapMode)\n\t\t\tthis._pointMapper.points = [];\n\t\tswitch (value) {\n\t\t\tcase Mode.None:\n\t\t\t\tthis._activeTool = null;\n\t\t\t\tbreak;\n\t\t\tcase Mode.Cube:\n\t\t\t\tthis._activeTool = new CubicTool();\n\t\t\t\tbreak;\n\t\t\tcase Mode.Quad:\n\t\t\t\tthis._activeTool = new QuadTool();\n\t\t\t\tbreak;\n\t\t\tcase Mode.Circ:\n\t\t\t\tthis._activeTool = new CircleTool();\n\t\t\t\tbreak;\n\t\t\tcase Mode.Rect:\n\t\t\t\tthis._activeTool = new RectangleTool();\n\t\t\t\tbreak;\n\t\t}\n\t\tthis._activeTool?.setModeListener((toolMode: ToolMode) => {\n\t\t\tif (this._ignoreNextToolModeChange) {\n\t\t\t\tthis._ignoreNextToolModeChange = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._modeListener !== null)\n\t\t\t\tthis._modeListener(this._mode, toolMode);\n\t\t});\n\t\tif (this._modeListener !== null)\n\t\t\tthis._modeListener(value, this.activeTool?.mode);\n\t}\n\tsetModeListener(listener: (mode: Mode, toolMode: ToolMode | null) => void) {\n\t\tthis._modeListener = listener;\n\t}\n\n\tasync apply() {\n\t\tif (!this.activeTool || this.activeTool.mode != ToolMode.Placed) return;\n\t\tawait game.scenes.viewed.createEmbeddedDocuments(\"Wall\", <any>this.walls.map(e => e.data));\n\t\tthis.clearTool();\n\t}\n\n\tclearTool() {\n\t\tif (!this._activeTool) {\n\t\t\tthis._ignoreNextToolModeChange = false;\n\t\t\treturn;\n\t\t}\n\t\tthis._activeTool.clearTool();\n\t\tthis.walls = [];\n\t\tthis.wallsLayer.preview.removeChildren();\n\t\tthis.render();\n\t}\n\n\ttogglePointMapping() {\n\t\tthis._inPointMapMode = !this._inPointMapMode;\n\t\tif (this._inPointMapMode) {\n\t\t\tthis._pointMapper.points = [];\n\t\t\tui.notifications.info(game.i18n.localize(this._pointMapper.getTooltipMessage()), { permanent: true });\n\t\t} else {\n\t\t\tui.notifications.active.forEach(x => x.remove());\n\t\t\tui.notifications.active = [];\n\t\t}\n\t\tthis.render();\n\t}\n\tget canApplyPointMapping(): boolean {\n\t\treturn this._pointMapper.hasEnoughData();\n\t}\n\tapplyPointMapping() {\n\t\tif (!this._inPointMapMode) return;\n\t\tthis._inPointMapMode = false;\n\t\tthis._pointMapper.bindData(this._activeTool);\n\t\t(<any>this._activeTool).setMode(ToolMode.Placed);\n\t\tui.notifications.active.forEach(x => x.remove());\n\t\tui.notifications.active = [];\n\t\tthis.render();\n\t}\n\n\tstatic _onClickLeft(wrapped: AnyFunction, event: PIXI.InteractionEvent) {\n\t\tconst self = CurvyWallToolManager.instance;\n\t\tif (self._inPointMapMode) {\n\t\t\tif (!self._pointMapper.checkPointForClick(event.data.origin, event))\n\t\t\t\treturn;\n\t\t\tif (self._pointMapper.hasEnoughData())\n\t\t\t\tself._modeListener(self.mode, ToolMode.NotPlaced);\n\t\t\tself.render();\n\t\t\treturn;\n\t\t}\n\n\t\tif (self.mode == Mode.None || self.activeTool == null) return wrapped(event);\n\t\tif (self.activeTool.checkPointForClick(event.data.origin, event)) {\n\t\t\tself.render();\n\t\t\treturn;\n\t\t}\n\t\tif (event.data.originalEvent.ctrlKey) {\n\t\t\tself.activeTool.startedWithCtrlHeld = true;\n\t\t}\n\t\tif (SETTINGS.get(CurvyWallToolManager.PREF_DROP_KEY) === 'ctrl' && !event.data.originalEvent.ctrlKey) return;\n\t\tif (SETTINGS.get(CurvyWallToolManager.PREF_DROP_KEY) === 'alt' && !event.data.originalEvent.altKey) return;\n\t\tself.activeTool.placeTool(event.data.origin, self._previousToolData.get(self._mode));\n\t\tself.render();\n\t}\n\tstatic _onDragLeftStart(wrapped: AnyFunction, event: PIXI.InteractionEvent) {\n\t\tconst self = CurvyWallToolManager.instance;\n\t\tif (self._inPointMapMode) {\n\t\t\tself.currentHandler = self._pointMapper.checkPointForDrag(event.data.origin);\n\t\t\tif (self.currentHandler == null) return;\n\t\t\tself.currentHandler.start(event.data.origin, event.data.destination, event);\n\t\t\tself.render();\n\t\t\treturn;\n\t\t}\n\t\tif (self.mode == Mode.None || self.activeTool == null) return wrapped(event);\n\t\tself.currentHandler = self.activeTool.checkPointForDrag(event.data.origin);\n\t\tif (self.currentHandler == null) return;\n\t\tself.currentHandler.start(event.data.origin, event.data.destination, event);\n\t\tself.render();\n\t}\n\tstatic _onDragLeftMove(wrapped: AnyFunction, event: PIXI.InteractionEvent) {\n\t\tconst self = CurvyWallToolManager.instance;\n\t\tif (self.mode == Mode.None || !self.currentHandler) return wrapped(event);\n\t\tif (self.activeTool.startedWithCtrlHeld && !event.data.originalEvent.ctrlKey) {\n\t\t\tself.activeTool.startedWithCtrlHeld = false;\n\t\t}\n\t\tself.currentHandler.move(event.data.origin, event.data.destination, event);\n\t\tself.render();\n\t}\n\tstatic _onDragLeftDrop(wrapped: AnyFunction, event: PIXI.InteractionEvent) {\n\t\tconst self = CurvyWallToolManager.instance;\n\t\tif (self.mode == Mode.None || !self.currentHandler) return wrapped(event);\n\t\tself.activeTool.startedWithCtrlHeld = false;\n\t\tself.currentHandler.stop(event.data.origin, event.data.destination, event);\n\t\tself.currentHandler = null;\n\t\tself.render();\n\t}\n\tstatic _onDragLeftCancel(wrapped: AnyFunction, event: PIXI.InteractionEvent) {\n\t\tconst self = CurvyWallToolManager.instance;\n\t\tif (self.mode == Mode.None) return wrapped(event);\n\t\telse if (!self.currentHandler) return;\n\t\tself.currentHandler.cancel();\n\t\tself.currentHandler = null;\n\t\tself.render();\n\t}\n\tstatic _onClickRight(wrapped: AnyFunction, event: PIXI.InteractionEvent) {\n\t\tconst self = CurvyWallToolManager.instance;\n\t\tif (!event.data.originalEvent.ctrlKey || self.mode == Mode.None) return wrapped(event);\n\t\tself.mode = Mode.None;\n\t\tself.render();\n\t}\n\n\tprivate graphicsContext = new PIXI.Graphics(null);\n\trender() {\n\t\tthis.wallsLayer.preview.removeChildren();\n\t\tif (this.currentlyMappingPoints) {\n\t\t\tthis._pointMapper.clearContext(this.graphicsContext);\n\t\t\tthis.graphicsContext.clear();\n\t\t\tthis.graphicsContext.removeChildren();\n\t\t\tthis.wallsLayer.preview.addChild(this.graphicsContext);\n\t\t\tthis._pointMapper.drawHandles(this.graphicsContext);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.activeTool == null) return;\n\t\tconst pointData = this.activeTool?.getSegments(this.segments);\n\t\tif (pointData.length == 0) return;\n\t\tthis.walls.length;\n\t\tconst wallData = (<any>this.wallsLayer)._getWallDataFromActiveTool(game.activeTool) as WallData;\n\n\t\twhile (this.walls.length > pointData.length - 1) {\n\t\t\tconst wall = this.walls.pop();\n\t\t\tWallPool.release(wall);\n\t\t\tthis.wallsLayer.preview.removeChild(wall);\n\t\t}\n\t\tif ((<PIXI.Point>pointData[0]).x !== undefined) {\n\t\t\tconst points = pointData as PIXI.Point[];\n\t\t\tfor (let c = 0; c < points.length - 1; c++) {\n\t\t\t\tconst data = duplicate(wallData) as WallData;\n\t\t\t\tdata.c = [points[c].x, points[c].y, points[c + 1].x, points[c + 1].y];\n\t\t\t\tif (c == this.walls.length) {\n\t\t\t\t\tthis.walls.push(WallPool.acquire(data));\n\t\t\t\t\tthis.wallsLayer.preview.addChild(this.walls[c]);\n\t\t\t\t\tthis.walls[c].draw();\n\t\t\t\t} else {\n\t\t\t\t\tthis.walls[c].data = data;\n\t\t\t\t\tthis.wallsLayer.preview.addChild(this.walls[c]);\n\t\t\t\t\tthis.walls[c].refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if ((<PIXI.Point>(<PIXI.Point[]>pointData[0])[0]).x !== undefined) {\n\t\t\tconst points = pointData as PIXI.Point[][];\n\t\t\tif (this.walls.length > points.length) {\n\t\t\t\tconst wall = this.walls.pop();\n\t\t\t\tWallPool.release(wall);\n\t\t\t\tthis.wallsLayer.preview.removeChild(wall);\n\t\t\t}\n\t\t\tfor (let c = 0; c < points.length; c++) {\n\t\t\t\tconst data = duplicate(wallData) as WallData;\n\t\t\t\tdata.c = [points[c][0].x, points[c][0].y, points[c][1].x, points[c][1].y];\n\t\t\t\tif (c == this.walls.length) {\n\t\t\t\t\tthis.walls.push(WallPool.acquire(data));\n\t\t\t\t\tthis.wallsLayer.preview.addChild(this.walls[c]);\n\t\t\t\t\tthis.walls[c].draw();\n\t\t\t\t} else {\n\t\t\t\t\tthis.walls[c].data = data;\n\t\t\t\t\tthis.wallsLayer.preview.addChild(this.walls[c]);\n\t\t\t\t\tthis.walls[c].refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.activeTool.clearContext(this.graphicsContext);\n\t\tthis.graphicsContext.removeChildren().forEach(x => x.destroy());\n\t\tthis.graphicsContext.clear();\n\t\tthis.graphicsContext.visible = true;\n\t\tthis.wallsLayer.preview.addChild(this.graphicsContext);\n\t\tthis.activeTool.drawHandles(this.graphicsContext);\n\t\tthis._previousToolData.set(this._mode, this.activeTool.getData());\n\t}\n\n\tinit() {\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'Wall.prototype._onDragLeftStart', (wrapper: any, ...args: any) => {\n\t\t\tthis.clearTool();\n\t\t\twrapper(...args);\n\t\t}, 'WRAPPER');\n\t}\n\n\tpatchWallsLayer() {\n\t\tthis.wallsLayer = canvas.walls;\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'WallsLayer.prototype._onClickLeft', CurvyWallToolManager._onClickLeft, 'MIXED');\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'WallsLayer.prototype._onDragLeftStart', CurvyWallToolManager._onDragLeftStart, 'MIXED');\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'WallsLayer.prototype._onDragLeftMove', CurvyWallToolManager._onDragLeftMove, 'MIXED');\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'WallsLayer.prototype._onDragLeftDrop', CurvyWallToolManager._onDragLeftDrop, 'MIXED');\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'WallsLayer.prototype._onDragLeftCancel', CurvyWallToolManager._onDragLeftCancel, 'MIXED');\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'WallsLayer.prototype._onClickRight', CurvyWallToolManager._onClickRight, 'MIXED');\n\t\tHooks.on('requestCurvyWallsRedraw', () => this.render());\n\t}\n}\n","import { InputHandler } from \"./ToolInputHandler\";\nimport { CurvyWallControl } from '../CurvyWallsToolBar';\nimport SETTINGS from \"../../../common/Settings\";\n\nexport enum ToolMode {\n\tNotPlaced,\n\tPlacing,\n\tPlaced\n}\n\nexport abstract class BezierTool {\n\tpublic static readonly PREF_SMALL_HANDLES = \"BezierTool.SmallHandles\";\n\tpublic static get HANDLE_RADIUS(): number {\n\t\treturn SETTINGS.get(this.PREF_SMALL_HANDLES) ? 5 : 10;\n\t}\n\tpublic static readonly LINE_SIZE: number = 2;\n\tprivate static readonly TEXT_STYLE_BASE = new PIXI.TextStyle({\n\t\tfontFamily: CONFIG.defaultFontFamily,\n\t\tfontSize: 24,\n\t\tfill: \"#BBBBBB\",\n\t\tstroke: \"#111111\",\n\t\tstrokeThickness: 4,\n\t\tdropShadow: false,\n\t\tdropShadowColor: \"#000000\",\n\t\tdropShadowBlur: Math.max(Math.round(24 / 16), 2),\n\t\tdropShadowAngle: 0,\n\t\tdropShadowDistance: 0,\n\t\tpadding: 1\n\t});\n\t// Define the text style\n\tpublic static get TEXT_STYLE(): PIXI.TextStyle {\n\t\tthis.TEXT_STYLE_BASE.fontSize = SETTINGS.get(this.PREF_SMALL_HANDLES) ? 18 : 24;\n\t\treturn this.TEXT_STYLE_BASE;\n\t}\n\n\tprivate _mode: ToolMode = ToolMode.NotPlaced;\n\tprotected lastSegmentFetch: PIXI.Point[] | PIXI.Point[][] = [];\n\tabstract get handles(): PIXI.Point[]\n\tabstract get bounds(): PIXI.Bounds;\n\tabstract lineA: PIXI.Point;\n\tabstract lineB: PIXI.Point;\n\n\tpublic segments: number = 8;\n\n\tget lineCenter(): PIXI.Point {\n\t\treturn new PIXI.Point(\n\t\t\tthis.lineA.x + ((this.lineB.x - this.lineA.x) / 2),\n\t\t\tthis.lineA.y + ((this.lineB.y - this.lineA.y) / 2));\n\t}\n\n\tprivate _modeListener: (mode: ToolMode) => void = null;\n\tget mode(): ToolMode { return this._mode; }\n\tprotected setMode(value: ToolMode) {\n\t\tif (this._mode === value) return;\n\t\tthis._mode = value;\n\t\tif (this._modeListener !== null)\n\t\t\tthis._modeListener(value);\n\t}\n\n\tstartedWithCtrlHeld: boolean = false;\n\n\tconstructor(segments: number = 10) {\n\t\tthis.segments = segments;\n\t}\n\n\tabstract drawHandles(context: PIXI.Graphics): void;\n\tabstract checkPointForDrag(point: PIXI.Point): InputHandler | null;\n\tabstract getSegments(count: number): PIXI.Point[] | PIXI.Point[][];\n\tabstract placeTool(point: PIXI.Point, data: object): void;\n\tabstract getData(): object;\n\tabstract getTools(): Record<string, CurvyWallControl>\n\n\tcheckPointForClick(_point: PIXI.Point, _event: PIXI.InteractionEvent): boolean { return false; }\n\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\tclearContext(_context: PIXI.Graphics): void { }\n\tclearTool() {\n\t\tthis.setMode(ToolMode.NotPlaced);\n\t}\n\tsetModeListener(listener: (toolMode: ToolMode) => void) {\n\t\tthis._modeListener = listener;\n\t}\n\n\tprotected static createText(text: string): PreciseText {\n\t\tconst result = new PreciseText(text, BezierTool.TEXT_STYLE);\n\t\tresult.anchor.set(0.5, 0.5);\n\t\treturn result;\n\t}\n\tprotected drawSegmentLabel(context: PIXI.Graphics) {\n\t\tconst text = BezierTool.createText(`${this.lastSegmentFetch.length - 1}`);\n\t\ttext.position = this.lineCenter;\n\t\tcontext.addChild(text);\n\t}\n\tprotected drawBoundingBox(context: PIXI.Graphics) {\n\t\tconst bounds = this.bounds.getRectangle(PIXI.Rectangle.EMPTY);\n\t\tcontext.beginFill(0, 0)\n\t\t\t.lineStyle(BezierTool.LINE_SIZE, 0xE88D2D, 1, 0.5)\n\t\t\t.drawRoundedRect(bounds.left - 20, bounds.top - 20, bounds.width + 40, bounds.height + 40, 20)\n\t\t\t.endFill();\n\t}\n\tprotected drawHandle(context: PIXI.Graphics, fill: number, point: PIXI.Point): PIXI.Graphics {\n\t\treturn context.beginFill(fill, 1)\n\t\t\t.lineStyle(BezierTool.LINE_SIZE, 0x0, 1, 0.5)\n\t\t\t.drawCircle(point.x, point.y, BezierTool.HANDLE_RADIUS)\n\t\t\t.endFill();\n\t}\n\n\tstatic pointNearPoint(a: { x: number, y: number }, b: { x: number, y: number }, threshold: number): boolean {\n\t\tconst x = a.x - b.x;\n\t\tconst y = a.y - b.y;\n\t\treturn ((x * x) + (y * y)) <= (threshold * threshold); // super simple and efficient Squared Length circle collision\n\t}\n}","\ndeclare global {\n\tinterface LenientGlobalVariableTypes {\n\t\tgame: never;\n\t\tcanvas: never;\n\t}\n\tinterface String {\n\t\t/** Localizes the string via the global `game.i18n.localize()` function. */\n\t\tlocalize(): string\n\t}\n\ttype AnyFunction = (...args: any) => any;\n}\n\nexport default class SETTINGS {\n\tstatic MOD_NAME: string;\n\tstatic init(moduleName: string) {\n\t\tthis.MOD_NAME = moduleName;\n\t\tif (!String.prototype.localize) {\n\t\t\tString.prototype.localize = function () {\n\t\t\t\treturn game.i18n.localize(this.valueOf());\n\t\t\t};\n\t\t}\n\t}\n\tstatic register<T>(key: string, config: ClientSettings.PartialSetting<T>) { game.settings.register(SETTINGS.MOD_NAME, key, config); }\n\tstatic registerMenu(key: string, config: ClientSettings.PartialMenuSetting) { game.settings.registerMenu(SETTINGS.MOD_NAME, key, config); }\n\tstatic get<T>(key: string): T { return <T>game.settings.get(SETTINGS.MOD_NAME, key); }\n\tstatic async set<T>(key: string, value: T): Promise<T> { return await game.settings.set(SETTINGS.MOD_NAME, key, value); }\n\tstatic default<T>(key: string): T { return <T>game.settings.settings.get(SETTINGS.MOD_NAME + '.' + key).default; }\n\t/** helper for referencing a Typed constructor for the `type` field of a setting { type: SETTINGS.typeOf<MyClass>() } */\n\tstatic typeOf<T>(): ConstructorOf<T> { return Object as any; }\n}\n","import { BezierTool, ToolMode } from './BezierTool';\nimport { PointArrayInputHandler, InputHandler, PointInputHandler, InitializerInputHandler } from \"./ToolInputHandler\";\nimport { CurvyWallControl } from '../CurvyWallsToolBar';\n\nconst pointNearPoint = BezierTool.pointNearPoint;\nconst PI2 = Math.PI * 2;\ndeclare type Point = PIXI.Point;\n\n// Helper function log outputs\n// function degrees(radians: number) { return (radians / Math.PI) * 180.0; }\n\nclass InitializerIH extends InitializerInputHandler {\n\tconstructor(tool: CircleTool, success: () => void, fail: () => void) {\n\t\tsuper(tool, true, tool.lineA, tool.lineB, success, fail);\n\t}\n}\n\nexport default class CircleTool extends BezierTool {\n\tstatic readonly ANGLE_SNAP_STEPS = [Math.PI / 4, Math.PI / 6, Math.PI / 12, Math.PI / 24, Math.PI / 48];\n\tstatic snapSetIndex = 2;\n\tstatic finishSliceIfShort = true;\n\tstatic closeLoopIfSliced = false;\n\tlineA = new PIXI.Point();\n\tlineB = new PIXI.Point();\n\tarcHandle = new RotatorHandle(100);\n\tsliceHandle = new RotatorHandle(75, this.arcHandle);\n\n\tget handles(): Point[] { return [this.lineA, this.lineB]; }\n\tget bounds(): PIXI.Bounds {\n\t\tconst b = new PIXI.Bounds();\n\t\tb.addPoint(this.lineA);\n\t\tb.addPoint(this.lineB);\n\t\treturn b;\n\t}\n\tget polygon(): PIXI.Polygon {\n\t\tconst bounds = this.bounds;\n\t\treturn new PIXI.Polygon([\n\t\t\tbounds.minX, bounds.minY,\n\t\t\tbounds.maxX, bounds.minY,\n\t\t\tbounds.minX, bounds.maxY,\n\t\t\tbounds.maxX, bounds.maxY]);\n\t}\n\n\tprivate _tools: Record<string, CurvyWallControl> = {\n\t\tellipseclose: {\n\t\t\ticon: 'fas fa-adjust',\n\t\t\ttitle: 'df-curvy-walls.ellipse_close',\n\t\t\ttoggleable: true,\n\t\t\tisActive: () => CircleTool.closeLoopIfSliced,\n\t\t\tonClick: enabled => {\n\t\t\t\tCircleTool.closeLoopIfSliced = enabled;\n\t\t\t\tHooks.call('requestCurvyWallsRedraw');\n\t\t\t}\n\t\t},\n\t\tellipsefinish: {\n\t\t\ticon: 'fas fa-compress-alt',\n\t\t\ttitle: 'df-curvy-walls.ellipse_finish_slice',\n\t\t\ttoggleable: true,\n\t\t\tisActive: () => CircleTool.finishSliceIfShort,\n\t\t\tonClick: enabled => {\n\t\t\t\tCircleTool.finishSliceIfShort = enabled;\n\t\t\t\tHooks.call('requestCurvyWallsRedraw');\n\t\t\t}\n\t\t},\n\t\tellipseinc: {\n\t\t\ticon: 'dfcw ellipseinc',\n\t\t\ttitle: 'df-curvy-walls.ellipse_increment',\n\t\t\tonClick: () => {\n\t\t\t\tCircleTool.snapSetIndex = Math.clamped(CircleTool.snapSetIndex + 1, 0, CircleTool.ANGLE_SNAP_STEPS.length - 1);\n\t\t\t\tHooks.call('requestCurvyWallsRedraw');\n\t\t\t}\n\t\t},\n\t\tellipsedec: {\n\t\t\ticon: 'dfcw ellipsedec',\n\t\t\ttitle: 'df-curvy-walls.ellipse_decrement',\n\t\t\tonClick: () => {\n\t\t\t\tCircleTool.snapSetIndex = Math.clamped(CircleTool.snapSetIndex - 1, 0, CircleTool.ANGLE_SNAP_STEPS.length - 1);\n\t\t\t\tHooks.call('requestCurvyWallsRedraw');\n\t\t\t}\n\t\t}\n\t};\n\tgetTools(): Record<string, CurvyWallControl> { return this._tools; }\n\tplaceTool(point: PIXI.Point, data: { l1: number[], l2: number[], a1: number, a2: number }) {\n\t\tthis.lineA.set(data.l1[0] + point.x, data.l1[1] + point.y);\n\t\tthis.lineB.set(data.l2[0] + point.x, data.l2[1] + point.y);\n\t\tthis.arcHandle.angle = data.a1;\n\t\tthis.sliceHandle.angle = data.a2;\n\t\tthis.setMode(ToolMode.Placed);\n\t}\n\tgetData() {\n\t\tconst center = this.lineCenter;\n\t\treturn {\n\t\t\tl1: [this.lineA.x - center.x, this.lineA.y - center.y],\n\t\t\tl2: [this.lineB.x - center.x, this.lineB.y - center.y],\n\t\t\ta1: this.arcHandle.angle, a2: this.sliceHandle.angle\n\t\t};\n\t}\n\n\tgetCenter(): PIXI.Point {\n\t\tconst bounds = this.bounds;\n\t\tconst rect = bounds.getRectangle(PIXI.Rectangle.EMPTY);\n\t\tconst halfWidth = rect.width / 2;\n\t\tconst halfHeight = rect.height / 2;\n\t\treturn new PIXI.Point(bounds.minX + halfWidth, bounds.minY + halfHeight);\n\t}\n\n\tprivate createVector(theta: number, magnitude: Point, origin: Point): Point {\n\t\treturn new PIXI.Point(\n\t\t\torigin.x + (Math.cos(theta) * magnitude.x),\n\t\t\torigin.y + (Math.sin(theta) * magnitude.y)\n\t\t);\n\t}\n\n\tgetSegments(count: number): PIXI.Point[] {\n\t\tif (this.mode == ToolMode.NotPlaced) return [];\n\t\tconst bounds = this.bounds;\n\t\tconst rect = bounds.getRectangle(PIXI.Rectangle.EMPTY);\n\t\tconst deltaTheta = Math.PI / count;\n\t\t// Calculate the magnitude per axis based on the scalar of the circle's x,y radius\n\t\tconst magnitude = new PIXI.Point(rect.width / 2, rect.height / 2);\n\t\t// Find the exact middle point of the circle\n\t\tconst origin = new PIXI.Point(bounds.minX + magnitude.x, bounds.minY + magnitude.y);\n\t\t// initialize with the first point\n\t\tconst points: PIXI.Point[] = [];\n\t\t// Start at full rotation and work our way back CCW\n\t\tlet angle = PI2;\n\t\tconst sliceAngle = this.sliceHandle.rawAngle != PI2 ? this.sliceHandle.rawAngle : 0.0;\n\t\t// console.log(`Slice: ${degrees(sliceAngle)}, Arc: ${degrees(this.arcHandle.rawAngle)}`);\n\t\twhile (angle >= sliceAngle) {\n\t\t\tpoints.push(this.createVector(this.arcHandle.rawAngle + angle, magnitude, origin));\n\t\t\tangle -= deltaTheta;\n\t\t\tif (angle < 1e-10 && angle > -1e-10)\n\t\t\t\tangle = 0;\n\t\t}\n\t\t// If we stopped short of the slice handle, add a small step to go the rest of the way\n\t\tif (CircleTool.finishSliceIfShort && angle != sliceAngle && sliceAngle != 0) {\n\t\t\tpoints.push(this.createVector(this.arcHandle.rawAngle + sliceAngle, magnitude, origin));\n\t\t}\n\t\t// Close loop if there is no slice, or if the user has locked loop closing\n\t\tif (CircleTool.closeLoopIfSliced && sliceAngle != 0)\n\t\t\tpoints.push(points[0]);\n\t\treturn (this.lastSegmentFetch = points);\n\t}\n\n\tinitialPoints(): number[] { return [0, 0, 0, 0, 0, 0]; }\n\tdrawHandles(context: PIXI.Graphics): void {\n\t\tif (this.mode == ToolMode.NotPlaced) return;\n\t\tthis.drawBoundingBox(context);\n\t\tconst middle = this.getCenter();\n\t\tconst arc = this.arcHandle.getHandlePoint(middle);\n\t\tconst slice = this.sliceHandle.getHandlePoint(middle);\n\t\tcontext.beginFill(0xffaacc)\n\t\t\t.lineStyle(BezierTool.LINE_SIZE, 0xffaacc, 1, 0.5)\n\t\t\t.moveTo(this.lineA.x, this.lineA.y)\n\t\t\t.lineTo(this.lineB.x, this.lineB.y)\n\t\t\t.moveTo(middle.x, middle.y)\n\t\t\t.lineTo(arc.x, arc.y)\n\t\t\t.moveTo(middle.x, middle.y)\n\t\t\t.lineTo(slice.x, slice.y)\n\t\t\t.endFill();\n\t\tthis.drawSegmentLabel(context);\n\t\tconst snapAngle = Math.toDegrees(CircleTool.ANGLE_SNAP_STEPS[CircleTool.snapSetIndex]).toFixed(2);\n\t\tconst arcLabel = BezierTool.createText(`${snapAngle}   ${180 / parseFloat(snapAngle)}`);\n\t\tarcLabel.position.copyFrom(this.lineCenter);\n\t\tarcLabel.position.y += BezierTool.TEXT_STYLE.fontSize as number + 4;\n\t\tcontext.addChild(arcLabel);\n\t\tthis.drawHandle(context, 0xff4444, this.lineA);\n\t\tthis.drawHandle(context, 0xff4444, this.lineB);\n\t\tthis.drawHandle(context, 0x44ff44, this.arcHandle.getHandlePoint(this.getCenter()));\n\t\tthis.drawHandle(context, 0x4444ff, this.sliceHandle.getHandlePoint(this.getCenter()));\n\t}\n\tprotected drawSegmentLabel(context: PIXI.Graphics) {\n\t\tconst text = BezierTool.createText(`${this.lastSegmentFetch.length - 1}`);\n\t\ttext.position = this.lineCenter;\n\t\tcontext.addChild(text);\n\t}\n\tcheckPointForDrag(point: Point): InputHandler | null {\n\t\tif (this.mode == ToolMode.NotPlaced) {\n\t\t\tthis.setMode(ToolMode.Placing);\n\t\t\treturn new InitializerIH(this, () => this.setMode(ToolMode.Placed), () => this.setMode(ToolMode.NotPlaced));\n\t\t}\n\t\tif (pointNearPoint(point, this.lineA, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.lineA, null, this.lineB);\n\t\telse if (pointNearPoint(point, this.lineB, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.lineB, null, this.lineA);\n\t\telse if (pointNearPoint(point, this.arcHandle.getHandlePoint(this.getCenter()), BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointRotationHandler(this, this.arcHandle, this.getCenter());\n\t\telse if (pointNearPoint(point, this.sliceHandle.getHandlePoint(this.getCenter()), BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointRotationHandler(this, this.sliceHandle, this.getCenter());\n\t\telse if (this.polygon.contains(point.x, point.y))\n\t\t\treturn new PointArrayInputHandler(this, point, this.handles);\n\t\treturn null;\n\t}\n}\n\nclass RotatorHandle {\n\tprivate _angle: number = 0.0;\n\tget rawAngle(): number { return this._angle; }\n\tset rawAngle(value: number) { this._angle = value; }\n\tget angle(): number {\n\t\treturn this.magnet ? this._angle + this.magnet._angle : this._angle;\n\t}\n\tset angle(value: number) {\n\t\tthis._angle = this.magnet ? value - this.magnet._angle : this._angle = value;\n\t}\n\tprivate length: number = 0.0;\n\tmagnet: RotatorHandle;\n\tconstructor(length: number, magnet?: RotatorHandle) {\n\t\tthis.length = length;\n\t\tthis.magnet = magnet;\n\t}\n\tgetHandlePoint(center: PIXI.Point): PIXI.Point {\n\t\tconst magnet = this.magnet ? this.magnet._angle : 0;\n\t\tconst ax = Math.cos(magnet + this._angle) * this.length;\n\t\tconst ay = Math.sin(magnet + this._angle) * this.length;\n\t\treturn new PIXI.Point(center.x + ax, center.y + ay);\n\t}\n}\n\nclass PointRotationHandler extends InputHandler {\n\tprivate original: number;\n\tprivate arcHandle: RotatorHandle;\n\tprivate center: PIXI.Point;\n\tconstructor(tool: BezierTool, arcHandle: RotatorHandle, center: PIXI.Point) {\n\t\tsuper(tool);\n\t\tthis.arcHandle = arcHandle;\n\t\tthis.original = this.arcHandle.angle;\n\t\tthis.center = center;\n\t}\n\n\tsetAngle(to: PIXI.Point, event: PIXI.InteractionEvent) {\n\t\tconst vecX = to.x - this.center.x;\n\t\tconst vecY = to.y - this.center.y;\n\t\t// calculate the reference angle theta bar ()\n\t\tlet angle = Math.atan(vecY / vecX);\n\t\t// If on the -X axis (2nd and 3rd quadrants)\n\t\tif (vecX < 0) angle += Math.PI;\n\t\t// Specifically the +X,-Y quadrant (4th quadrant)\n\t\telse if (vecY < 0) angle += PI2;\n\t\t// Perform snapping if enabled\n\t\tif (this.shouldSnap(event)) {\n\t\t\tconst snapAngle = CircleTool.ANGLE_SNAP_STEPS[CircleTool.snapSetIndex];\n\t\t\t// Whole number of angle snaps\n\t\t\tconst whole = Math.trunc(angle / snapAngle);\n\t\t\t// Round to the nearest whole angle snap\n\t\t\tangle = (angle - (whole * snapAngle)) < (snapAngle / 2)\n\t\t\t\t? whole * snapAngle\n\t\t\t\t: (whole + 1) * snapAngle;\n\t\t}\n\t\tconst magnet = this.arcHandle.magnet ? (PI2 - this.arcHandle.magnet.rawAngle) : 0;\n\t\tthis.arcHandle.rawAngle = (magnet + angle) % PI2;\n\t}\n\n\tstart(_origin: PIXI.Point, destination: PIXI.Point, event: PIXI.InteractionEvent): void {\n\t\tthis.setAngle(destination, event);\n\t}\n\tmove(_origin: PIXI.Point, destination: PIXI.Point, event: PIXI.InteractionEvent): void {\n\t\tthis.setAngle(destination, event);\n\t}\n\tstop(_origin: PIXI.Point, destination: PIXI.Point, event: PIXI.InteractionEvent): void {\n\t\tthis.setAngle(destination, event);\n\t}\n\tcancel(): void {\n\t\tthis.arcHandle.angle = this.original;\n\t}\n}","import { BezierTool } from \"./BezierTool\";\n\ndeclare type Point = PIXI.Point;\nexport abstract class InputHandler {\n\tprivate _tool: BezierTool;\n\tget tool(): BezierTool { return this._tool; }\n\tconstructor(tool: BezierTool) {\n\t\tthis._tool = tool;\n\t}\n\n\tabstract start(origin: Point, destination: Point, event: PIXI.InteractionEvent): void;\n\tabstract move(origin: Point, destination: Point, event: PIXI.InteractionEvent): void;\n\tabstract stop(origin: Point, destination: Point, event: PIXI.InteractionEvent): void;\n\tabstract cancel(): void;\n\tstatic finalPoint(point: Point, snap: boolean = true) {\n\t\treturn (<any>(<Canvas>canvas).walls)._getWallEndpointCoordinates(point, { snap: snap });\n\t}\n\n\tprotected get walls(): WallsLayer { return (canvas as any).walls as WallsLayer; }\n\n\tshouldSnap(event: PIXI.InteractionEvent) {\n\t\tconst { originalEvent } = event.data;\n\t\treturn (<any>this.walls)._forceSnap || !originalEvent.shiftKey;\n\t}\n\n\tgetWallEndPoint(origin: PIXI.Point, snap: boolean): PIXI.Point {\n\t\t// Determine the starting coordinates\n\t\treturn new PIXI.Point(...(<any>this.walls)._getWallEndpointCoordinates(origin, { snap }));\n\t}\n\n\tstatic squarePoint(origin: Point, destination: Point): PIXI.Point {\n\t\t/*\t\n\t\t\t 4  1 \n\t\t\t\n\t\t\t 3  2 \n\t\t\t\t*/\n\t\tconst min = Math.max(Math.abs(destination.x - origin.x), Math.abs(destination.y - origin.y));\n\t\tif (destination.x > origin.x) {\n\t\t\t// Quadrant 1\n\t\t\tif (destination.y < origin.y)\n\t\t\t\treturn new PIXI.Point(origin.x + min, origin.y - min);\n\t\t\t// Quadrant 2\n\t\t\telse return new PIXI.Point(origin.x + min, origin.y + min);\n\t\t}\n\t\t// Quadrant 3\n\t\telse if (destination.y > origin.y)\n\t\t\treturn new PIXI.Point(origin.x - min, origin.y + min);\n\t\t// Quadrant 4\n\t\telse return new PIXI.Point(origin.x - min, origin.y - min);\n\t}\n}\n\nexport abstract class InitializerInputHandler extends InputHandler {\n\tlineA: Point;\n\tlineB: Point;\n\tprotected squaring: boolean;\n\tprotected success: () => void;\n\tprotected fail: () => void;\n\tconstructor(tool: BezierTool, squaring: boolean, lineA: Point, lineB: Point, success: () => void, fail: () => void) {\n\t\tsuper(tool);\n\t\tthis.lineA = lineA;\n\t\tthis.lineB = lineB;\n\t\tthis.squaring = squaring;\n\t\tthis.success = success;\n\t\tthis.fail = fail;\n\t}\n\tstart(origin: Point, destination: Point, event: PIXI.InteractionEvent) {\n\t\tconst snap = this.shouldSnap(event);\n\t\tthis.lineA.copyFrom(this.getWallEndPoint(origin, snap) as PIXI.Point);\n\t\tthis.lineB.copyFrom(this.getWallEndPoint(destination, snap) as PIXI.Point);\n\t}\n\tmove(origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tconst snap = this.shouldSnap(event);\n\t\tconst destPoint = this.squaring && event.data.originalEvent.altKey ? InputHandler.squarePoint(origin, destination) : destination;\n\t\tconst origPoint = !this.tool.startedWithCtrlHeld && event.data.originalEvent.ctrlKey ? new PIXI.Point(origin.x - (destPoint.x - origin.x), origin.y - (destPoint.y - origin.y)) : origin;\n\t\tthis.lineA.copyFrom(this.getWallEndPoint(origPoint, snap) as PIXI.Point);\n\t\tthis.lineB.copyFrom(this.getWallEndPoint(destPoint, snap) as PIXI.Point);\n\t}\n\tstop(origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tconst snap = this.shouldSnap(event);\n\t\tif (this.squaring && event.data.originalEvent.altKey)\n\t\t\tthis.lineB.copyFrom(this.getWallEndPoint(InputHandler.squarePoint(origin, destination), snap) as PIXI.Point);\n\t\telse\n\t\t\tthis.lineB.copyFrom(this.getWallEndPoint(destination, snap) as PIXI.Point);\n\t\tthis.success();\n\t}\n\tcancel() {\n\t\tthis.fail();\n\t}\n}\n\nexport class PointInputHandler extends InputHandler {\n\tprivate _origin: Point;\n\tprivate _originalPoint = new PIXI.Point(0, 0);\n\tpoint: Point;\n\tcompletion?: (sender: PointInputHandler) => void = null;\n\tconstructor(tool: BezierTool, destination: Point, completion: (sender: PointInputHandler) => void = null, origin?: Point) {\n\t\tsuper(tool);\n\t\tthis._originalPoint.copyFrom(destination);\n\t\tthis._origin = origin;\n\t\tthis.point = destination;\n\t\tthis.completion = completion;\n\t}\n\tstart(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tthis.move(null, destination, event);\n\t}\n\tmove(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tif (!!this._origin && event.data.originalEvent.altKey)\n\t\t\tthis.point.copyFrom(this.getWallEndPoint(InputHandler.squarePoint(this._origin, destination), this.shouldSnap(event)) as PIXI.Point);\n\t\telse\n\t\t\tthis.point.copyFrom(this.getWallEndPoint(destination, this.shouldSnap(event)) as PIXI.Point);\n\t}\n\tstop(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tif (!!this._origin && event.data.originalEvent.altKey)\n\t\t\tthis.point.copyFrom(this.getWallEndPoint(InputHandler.squarePoint(this._origin, destination), this.shouldSnap(event)) as PIXI.Point);\n\t\telse\n\t\t\tthis.point.copyFrom(this.getWallEndPoint(destination, this.shouldSnap(event)) as PIXI.Point);\n\t\tif (this.completion != null)\n\t\t\tthis.completion(this);\n\t}\n\tcancel() {\n\t\tthis.point.copyFrom(this._originalPoint);\n\t\tif (this.completion != null)\n\t\t\tthis.completion(this);\n\t}\n}\n\nexport class PointArrayInputHandler extends InputHandler {\n\tprivate originalPoints: Point[] = [];\n\tpoints: PIXI.Point[];\n\tprivate _start: Point;\n\tcompletion: (sender: PointArrayInputHandler) => void;\n\tconstructor(tool: BezierTool, start: Point, points: Point[], completion: (sender: PointArrayInputHandler) => void = null) {\n\t\tsuper(tool);\n\t\tpoints.forEach(e => this.originalPoints.push(e.clone()));\n\t\tthis.points = points;\n\t\tthis._start = start;\n\t\tthis.completion = completion;\n\t}\n\tprivate moveAll(to: Point, event: PIXI.InteractionEvent) {\n\t\tconst delta = new PIXI.Point(to.x - this._start.x, to.y - this._start.y);\n\t\tconst snap = this.shouldSnap(event);\n\t\tlet o: PIXI.Point;\n\t\tthis.points.forEach((e, i) => {\n\t\t\to = this.originalPoints[i];\n\t\t\te.copyFrom(this.getWallEndPoint(new PIXI.Point(o.x + delta.x, o.y + delta.y), snap));\n\t\t});\n\t}\n\tstart(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tthis.moveAll(destination, event);\n\t}\n\tmove(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tthis.moveAll(destination, event);\n\t}\n\tstop(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tthis.moveAll(destination, event);\n\t\tif (this.completion != null)\n\t\t\tthis.completion(this);\n\t}\n\tcancel() {\n\t\tthis.originalPoints.forEach((e, i) => e.copyTo(this.points[i]));\n\t\tif (this.completion != null)\n\t\t\tthis.completion(this);\n\t}\n}\n\nexport class MagnetPointInputHandler extends InputHandler {\n\tprivate originalPoint = new PIXI.Point(0, 0);\n\tprotected masterPoint: Point;\n\tprotected slavePoint: Point;\n\tprotected offsetX: number;\n\tprotected offsetY: number;\n\tcompletion?: (sender: MagnetPointInputHandler) => void = null;\n\tconstructor(tool: BezierTool, masterPoint: Point, slavePoint: Point, completion: (sender: MagnetPointInputHandler) => void = null) {\n\t\tsuper(tool);\n\t\tthis.originalPoint.copyFrom(masterPoint);\n\t\tthis.masterPoint = masterPoint;\n\t\tthis.slavePoint = slavePoint;\n\t\tthis.offsetX = slavePoint.x - masterPoint.x;\n\t\tthis.offsetY = slavePoint.y - masterPoint.y;\n\t\tthis.completion = completion;\n\t}\n\tstart(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tthis.move(null, destination, event);\n\t}\n\tmove(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tthis.masterPoint.copyFrom(this.getWallEndPoint(destination, this.shouldSnap(event)) as PIXI.Point);\n\t\tthis.slavePoint.set(this.masterPoint.x + this.offsetX, this.masterPoint.y + this.offsetY);\n\t}\n\tstop(_origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tthis.masterPoint.copyFrom(this.getWallEndPoint(destination, this.shouldSnap(event)) as PIXI.Point);\n\t\tthis.slavePoint.set(this.masterPoint.x + this.offsetX, this.masterPoint.y + this.offsetY);\n\t\tif (this.completion != null)\n\t\t\tthis.completion(this);\n\t}\n\tcancel() {\n\t\tthis.masterPoint.copyFrom(this.originalPoint);\n\t\tthis.slavePoint.set(this.masterPoint.x + this.offsetX, this.masterPoint.y + this.offsetY);\n\t\tif (this.completion != null)\n\t\t\tthis.completion(this);\n\t}\n}","import { CurvyWallControl } from \"../CurvyWallsToolBar\";\nimport { BezierTool, ToolMode } from \"./BezierTool\";\nimport { InitializerInputHandler, InputHandler, PointArrayInputHandler, PointInputHandler } from \"./ToolInputHandler\";\n\nconst pointNearPoint = BezierTool.pointNearPoint;\n\nclass InitializerIH extends InitializerInputHandler {\n\tconstructor(tool: RectangleTool, success: () => void, fail: () => void) {\n\t\tsuper(tool, true, tool.lineA, tool.lineB, success, fail);\n\t}\n}\n\nexport default class RectangleTool extends BezierTool {\n\tlineA = new PIXI.Point();\n\tlineB = new PIXI.Point();\n\tprivate lastCount = 0;\n\tprivate topCount = 0;\n\tprivate rightCount = 0;\n\tprivate bottomCount = 0;\n\tprivate leftCount = 0;\n\tprivate buttonRadius = 50;\n\tprivate buttonOffset = 15;\n\tprivate incTop: PreciseText;\n\tprivate decTop: PreciseText;\n\tprivate incRight: PreciseText;\n\tprivate decRight: PreciseText;\n\tprivate incBottom: PreciseText;\n\tprivate decBottom: PreciseText;\n\tprivate incLeft: PreciseText;\n\tprivate decLeft: PreciseText;\n\tprivate textTop: PreciseText;\n\tprivate textRight: PreciseText;\n\tprivate textBottom: PreciseText;\n\tprivate textLeft: PreciseText;\n\n\tprivate static readonly STYLE = new PIXI.TextStyle({\n\t\tfontFamily: CONFIG.defaultFontFamily,\n\t\tfontSize: 48,\n\t\tfill: \"#BBBBBB\",\n\t\tstroke: \"#111111\",\n\t\tstrokeThickness: 4,\n\t\tdropShadow: true,\n\t\tdropShadowColor: \"#000000\",\n\t\tdropShadowBlur: Math.max(Math.round(24 / 16), 2),\n\t\tdropShadowAngle: 0,\n\t\tdropShadowDistance: 0,\n\t\tpadding: 1\n\t});\n\n\tget handles(): PIXI.Point[] { return [this.lineA, this.lineB]; }\n\tget bounds(): PIXI.Bounds {\n\t\tconst b = new PIXI.Bounds();\n\t\tb.addPoint(this.lineA);\n\t\tb.addPoint(this.lineB);\n\t\treturn b;\n\t}\n\tget rect(): PIXI.Rectangle { return new PIXI.Rectangle(this.lineA.x, this.lineA.y, this.lineB.x, this.lineB.y); }\n\n\tconstructor() {\n\t\tsuper(1);\n\t\tthis.incTop = RectangleTool.createLineLabel('+');\n\t\tthis.decTop = RectangleTool.createLineLabel('-');\n\t\tthis.incRight = RectangleTool.createLineLabel('+');\n\t\tthis.decRight = RectangleTool.createLineLabel('-');\n\t\tthis.incBottom = RectangleTool.createLineLabel('+');\n\t\tthis.decBottom = RectangleTool.createLineLabel('-');\n\t\tthis.incLeft = RectangleTool.createLineLabel('+');\n\t\tthis.decLeft = RectangleTool.createLineLabel('-');\n\t\tthis.textTop = BezierTool.createText('');\n\t\tthis.textRight = BezierTool.createText('');\n\t\tthis.textBottom = BezierTool.createText('');\n\t\tthis.textLeft = BezierTool.createText('');\n\t\tthis.incTop.tint = 0xaaff44;\n\t\tthis.incBottom.tint = 0xaaff44;\n\t\tthis.incRight.tint = 0xaaff44;\n\t\tthis.incLeft.tint = 0xaaff44;\n\t\tthis.decTop.tint = 0xff4444;\n\t\tthis.decBottom.tint = 0xff4444;\n\t\tthis.decRight.tint = 0xff4444;\n\t\tthis.decLeft.tint = 0xff4444;\n\t\tthis.textRight.rotation = Math.PI / 2;\n\t\tthis.textLeft.rotation = -Math.PI / 2;\n\t}\n\n\tprivate static createLineLabel(text: string): PreciseText {\n\t\tconst result = new PreciseText(text, RectangleTool.STYLE);\n\t\tresult.anchor.set(0.5, 0.5);\n\t\treturn result;\n\t}\n\n\tclearContext(context: PIXI.Graphics) {\n\t\tsuper.clearContext(context);\n\t\tcontext.removeChild(this.incTop);\n\t\tcontext.removeChild(this.decTop);\n\t\tcontext.removeChild(this.incRight);\n\t\tcontext.removeChild(this.decRight);\n\t\tcontext.removeChild(this.incBottom);\n\t\tcontext.removeChild(this.decBottom);\n\t\tcontext.removeChild(this.incLeft);\n\t\tcontext.removeChild(this.decLeft);\n\t\tcontext.removeChild(this.textTop);\n\t\tcontext.removeChild(this.textRight);\n\t\tcontext.removeChild(this.textBottom);\n\t\tcontext.removeChild(this.textLeft);\n\t}\n\tdrawHandles(context: PIXI.Graphics) {\n\t\tif (this.mode == ToolMode.NotPlaced) return;\n\t\tthis.drawBoundingBox(context);\n\t\tcontext.beginFill(0xffaacc)\n\t\t\t.lineStyle(BezierTool.LINE_SIZE, 0xffaacc, 1, 0.5)\n\t\t\t.moveTo(this.lineA.x, this.lineA.y)\n\t\t\t.lineTo(this.lineB.x, this.lineB.y)\n\t\t\t.endFill();\n\t\tthis.drawSegmentLabels(context);\n\t\tthis.drawButtons(context);\n\t\tthis.drawHandle(context, 0xff4444, this.lineA);\n\t\tthis.drawHandle(context, 0xaaff44, this.lineB);\n\t}\n\tprotected drawSegmentLabels(context: PIXI.Graphics) {\n\t\tthis.textTop.text = `${Math.trunc(this.topCount + this.lastCount)}`;\n\t\tthis.textRight.text = `${Math.trunc(this.rightCount + this.lastCount)}`;\n\t\tthis.textBottom.text = `${Math.trunc(this.bottomCount + this.lastCount)}`;\n\t\tthis.textLeft.text = `${Math.trunc(this.leftCount + this.lastCount)}`;\n\t\tconst offset = 25;\n\t\tconst bounds = this.bounds;\n\t\tthis.textTop.position = new PIXI.Point(this.lineCenter.x, bounds.minY - offset);\n\t\tthis.textBottom.position = new PIXI.Point(this.lineCenter.x, bounds.maxY + offset);\n\t\tthis.textLeft.position = new PIXI.Point(bounds.minX - offset, this.lineCenter.y);\n\t\tthis.textRight.position = new PIXI.Point(bounds.maxX + offset, this.lineCenter.y);\n\t\tcontext.addChild(this.textTop, this.textRight, this.textBottom, this.textLeft);\n\t}\n\tprotected drawButtons(context: PIXI.Graphics) {\n\t\t// Add buttons to each side for inc/dec segment count on that side.\n\t\tconst center = this.lineCenter;\n\n\t\tthis.incTop.position = new PIXI.Point(center.x + this.buttonOffset, center.y - this.buttonRadius);\n\t\tthis.decTop.position = new PIXI.Point(center.x - this.buttonOffset, center.y - this.buttonRadius);\n\t\tthis.incBottom.position = new PIXI.Point(center.x + this.buttonOffset, center.y + this.buttonRadius);\n\t\tthis.decBottom.position = new PIXI.Point(center.x - this.buttonOffset, center.y + this.buttonRadius);\n\t\tthis.incLeft.position = new PIXI.Point(center.x - this.buttonRadius, center.y - this.buttonOffset);\n\t\tthis.decLeft.position = new PIXI.Point(center.x - this.buttonRadius, center.y + this.buttonOffset);\n\t\tthis.incRight.position = new PIXI.Point(center.x + this.buttonRadius, center.y - this.buttonOffset);\n\t\tthis.decRight.position = new PIXI.Point(center.x + this.buttonRadius, center.y + this.buttonOffset);\n\n\t\tcontext.addChild(this.incTop, this.decTop, this.incRight, this.decRight,\n\t\t\tthis.incBottom, this.decBottom, this.incLeft, this.decLeft);\n\t}\n\tgetSegments(count: number): PIXI.Point[] | PIXI.Point[][] {\n\t\tif (this.mode == ToolMode.NotPlaced) return [];\n\t\tthis.lastCount = count;\n\t\tconst bounds = this.bounds;\n\n\t\tconst width = bounds.maxX - bounds.minX;\n\t\tconst height = bounds.maxY - bounds.minY;\n\t\tconst points: PIXI.Point[][] = [];\n\t\t// top\n\t\tlet size = width / (count + this.topCount);\n\t\tfor (let c = 0; c < count + this.topCount; c++) {\n\t\t\tpoints.push([\n\t\t\t\tnew PIXI.Point(bounds.minX + (c * size), bounds.minY),\n\t\t\t\tnew PIXI.Point(bounds.minX + ((c + 1) * size), bounds.minY)\n\t\t\t]);\n\t\t}\n\t\t// right\n\t\tsize = height / (count + this.rightCount);\n\t\tfor (let c = 0; c < count + this.rightCount; c++) {\n\t\t\tpoints.push([\n\t\t\t\tnew PIXI.Point(bounds.maxX, bounds.minY + (c * size)),\n\t\t\t\tnew PIXI.Point(bounds.maxX, bounds.minY + ((c + 1) * size))\n\t\t\t]);\n\t\t}\n\t\t// bottom\n\t\tsize = width / (count + this.bottomCount);\n\t\tfor (let c = 0; c < count + this.bottomCount; c++) {\n\t\t\tpoints.push([\n\t\t\t\tnew PIXI.Point(bounds.maxX - (c * size), bounds.maxY),\n\t\t\t\tnew PIXI.Point(bounds.maxX - ((c + 1) * size), bounds.maxY)\n\t\t\t]);\n\t\t}\n\t\t// left\n\t\tsize = height / (count + this.leftCount);\n\t\tfor (let c = 0; c < count + this.leftCount; c++) {\n\t\t\tpoints.push([\n\t\t\t\tnew PIXI.Point(bounds.minX, bounds.maxY - (c * size)),\n\t\t\t\tnew PIXI.Point(bounds.minX, bounds.maxY - ((c + 1) * size))\n\t\t\t]);\n\t\t}\n\t\treturn (this.lastSegmentFetch = points);\n\t}\n\tcheckPointForDrag(point: PIXI.Point): InputHandler | null {\n\t\tif (this.mode == ToolMode.NotPlaced) {\n\t\t\tthis.setMode(ToolMode.Placing);\n\t\t\treturn new InitializerIH(this, () => this.setMode(ToolMode.Placed), () => this.setMode(ToolMode.NotPlaced));\n\t\t}\n\t\tif (pointNearPoint(point, this.lineA, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.lineA, null, this.lineB);\n\t\telse if (pointNearPoint(point, this.lineB, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.lineB, null, this.lineA);\n\t\telse if (this.rect.contains(point.x, point.y))\n\t\t\treturn new PointArrayInputHandler(this, point, this.handles);\n\t\treturn null;\n\t}\n\n\tcheckPointForClick(point: PIXI.Point): boolean {\n\t\tif (pointNearPoint(point, this.incTop.position, BezierTool.HANDLE_RADIUS * 2)) {\n\t\t\tthis.topCount = Math.clamped(this.topCount + 1, -64, 64);\n\t\t\treturn true;\n\t\t}\n\t\tif (pointNearPoint(point, this.decTop.position, BezierTool.HANDLE_RADIUS * 2)) {\n\t\t\tthis.topCount = Math.clamped(this.topCount - 1, -64, 64);\n\t\t\treturn true;\n\t\t}\n\t\tif (pointNearPoint(point, this.incRight.position, BezierTool.HANDLE_RADIUS * 2)) {\n\t\t\tthis.rightCount = Math.clamped(this.rightCount + 1, -64, 64);\n\t\t\treturn true;\n\t\t}\n\t\tif (pointNearPoint(point, this.decRight.position, BezierTool.HANDLE_RADIUS * 2)) {\n\t\t\tthis.rightCount = Math.clamped(this.rightCount - 1, -64, 64);\n\t\t\treturn true;\n\t\t}\n\t\tif (pointNearPoint(point, this.incBottom.position, BezierTool.HANDLE_RADIUS * 2)) {\n\t\t\tthis.bottomCount = Math.clamped(this.bottomCount + 1, -64, 64);\n\t\t\treturn true;\n\t\t}\n\t\tif (pointNearPoint(point, this.decBottom.position, BezierTool.HANDLE_RADIUS * 2)) {\n\t\t\tthis.bottomCount = Math.clamped(this.bottomCount - 1, -64, 64);\n\t\t\treturn true;\n\t\t}\n\t\tif (pointNearPoint(point, this.incLeft.position, BezierTool.HANDLE_RADIUS * 2)) {\n\t\t\tthis.leftCount = Math.clamped(this.leftCount + 1, -64, 64);\n\t\t\treturn true;\n\t\t}\n\t\tif (pointNearPoint(point, this.decLeft.position, BezierTool.HANDLE_RADIUS * 2)) {\n\t\t\tthis.leftCount = Math.clamped(this.leftCount - 1, -64, 64);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetTools(): Record<string, CurvyWallControl> { return {}; }\n\tplaceTool(point: PIXI.Point, data: { l1: number[], l2: number[], t: number, r: number, b: number, l: number }) {\n\t\tthis.lineA.set(data.l1[0] + point.x, data.l1[1] + point.y);\n\t\tthis.lineB.set(data.l2[0] + point.x, data.l2[1] + point.y);\n\t\tthis.topCount = data.t;\n\t\tthis.rightCount = data.r;\n\t\tthis.bottomCount = data.b;\n\t\tthis.leftCount = data.l;\n\t\tthis.setMode(ToolMode.Placed);\n\t}\n\tgetData() {\n\t\tconst center = this.lineCenter;\n\t\treturn {\n\t\t\tl1: [this.lineA.x - center.x, this.lineA.y - center.y],\n\t\t\tl2: [this.lineB.x - center.x, this.lineB.y - center.y],\n\t\t\tt: this.topCount,\n\t\t\tr: this.rightCount,\n\t\t\tb: this.bottomCount,\n\t\t\tl: this.leftCount\n\t\t};\n\t}\n\tinitialPoints(): number[] { return [0, 0, 0, 0, 0, 0]; }\n}","import { CurvyWallControl } from '../CurvyWallsToolBar';\nimport { Bezier } from '../../libs/bezier';\nimport { BezierTool, ToolMode } from './BezierTool';\nimport { PointArrayInputHandler, InputHandler, PointInputHandler, InitializerInputHandler, MagnetPointInputHandler } from \"./ToolInputHandler\";\n\nconst pointNearPoint = BezierTool.pointNearPoint;\ndeclare type Point = PIXI.Point;\n\nclass InitializerIH extends InitializerInputHandler {\n\tprivate get cubicTool(): CubicTool { return this.tool as CubicTool; }\n\tconstructor(tool: CubicTool, success: () => void, fail: () => void) {\n\t\tsuper(tool, false, tool.lineA, tool.lineB, success, fail);\n\t}\n\tmove(origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tsuper.move(origin, destination, event);\n\t\tlet dx = this.tool.lineB.x - this.tool.lineA.x;\n\t\tlet dy = this.tool.lineB.y - this.tool.lineA.y;\n\t\tconst length = Math.sqrt((dx * dx) + (dy * dy));\n\t\tdx /= length;\n\t\tdy /= length;\n\t\tconst barLength = length * (2 / 3);\n\t\tthis.cubicTool.controlA.set(this.tool.lineA.x + (dy * barLength), this.tool.lineA.y + (-dx * barLength));\n\t\tthis.cubicTool.controlB.set(this.tool.lineB.x + (dy * barLength), this.tool.lineB.y + (-dx * barLength));\n\t}\n}\n\nexport default class CubicTool extends BezierTool {\n\tstatic lockHandles = true;\n\tprivate bezier: Bezier;\n\tlineA = new PIXI.Point();\n\tlineB = new PIXI.Point();\n\tcontrolA = new PIXI.Point();\n\tcontrolB = new PIXI.Point();\n\n\tget handles(): Point[] { return [this.lineA, this.controlA, this.controlB, this.lineB]; }\n\tget bounds(): PIXI.Bounds {\n\t\tconst b = new PIXI.Bounds();\n\t\tb.addPoint(this.lineA);\n\t\tb.addPoint(this.lineB);\n\t\tb.addPoint(this.controlA);\n\t\tb.addPoint(this.controlB);\n\t\treturn b;\n\t}\n\tget polygon(): PIXI.Polygon { return new PIXI.Polygon([this.lineA, this.lineB, this.controlA, this.controlB]); }\n\n\tconstructor(segments: number = 10) {\n\t\tsuper(segments);\n\t\tthis.bezier = new Bezier([0, 0, 0, 0, 0, 0, 0, 0]);\n\t}\n\tgetSegments(count: number): PIXI.Point[] | PIXI.Point[][] {\n\t\tif (this.mode == ToolMode.NotPlaced) return [];\n\t\tthis.bezier.points = this.handles;\n\t\tthis.bezier.update();\n\t\treturn (this.lastSegmentFetch = this.bezier.getLUT(count + 2).map((e: { x: number, y: number }) => new PIXI.Point(e.x, e.y)));\n\t}\n\tdrawHandles(context: PIXI.Graphics): void {\n\t\tif (this.mode == ToolMode.NotPlaced) return;\n\t\tthis.drawBoundingBox(context);\n\t\tcontext.beginFill(0xffaacc)\n\t\t\t.lineStyle(BezierTool.LINE_SIZE, 0xffaacc, 1, 0.5)\n\t\t\t.moveTo(this.lineA.x, this.lineA.y)\n\t\t\t.lineTo(this.controlA.x, this.controlA.y)\n\t\t\t.moveTo(this.lineB.x, this.lineB.y)\n\t\t\t.lineTo(this.controlB.x, this.controlB.y)\n\t\t\t.endFill();\n\t\tsuper.drawSegmentLabel(context);\n\t\tthis.drawHandle(context, 0xff4444, this.lineA);\n\t\tthis.drawHandle(context, 0xff4444, this.lineB);\n\t\tthis.drawHandle(context, 0xaaff44, this.controlA);\n\t\tthis.drawHandle(context, 0xaaff44, this.controlB);\n\t}\n\tcheckPointForDrag(point: Point): InputHandler | null {\n\t\tif (this.mode == ToolMode.NotPlaced) {\n\t\t\tthis.setMode(ToolMode.Placing);\n\t\t\treturn new InitializerIH(this, () => this.setMode(ToolMode.Placed), () => this.setMode(ToolMode.NotPlaced));\n\t\t}\n\t\tif (pointNearPoint(point, this.lineA, BezierTool.HANDLE_RADIUS))\n\t\t\treturn CubicTool.lockHandles\n\t\t\t\t? new MagnetPointInputHandler(this, this.lineA, this.controlA)\n\t\t\t\t: new PointInputHandler(this, this.lineA);\n\t\telse if (pointNearPoint(point, this.lineB, BezierTool.HANDLE_RADIUS))\n\t\t\treturn CubicTool.lockHandles\n\t\t\t\t? new MagnetPointInputHandler(this, this.lineB, this.controlB)\n\t\t\t\t: new PointInputHandler(this, this.lineB);\n\t\telse if (pointNearPoint(point, this.controlA, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.controlA);\n\t\telse if (pointNearPoint(point, this.controlB, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.controlB);\n\t\telse if (this.polygon.contains(point.x, point.y))\n\t\t\treturn new PointArrayInputHandler(this, point, this.handles);\n\t\treturn null;\n\t}\n\n\tgetTools(): Record<string, CurvyWallControl> {\n\t\treturn {\n\t\t\tcubiclock: {\n\t\t\t\ticon: 'fas fa-lock',\n\t\t\t\ttitle: 'df-curvy-walls.cubic_lock_handles',\n\t\t\t\ttoggleable: true,\n\t\t\t\tisActive: () => CubicTool.lockHandles,\n\t\t\t\tonClick: enabled => CubicTool.lockHandles = enabled\n\t\t\t}\n\t\t};\n\t}\n\tplaceTool(point: PIXI.Point, data: { l1: number[], l2: number[], c1: number[], c2: number[] }) {\n\t\tthis.lineA.set(data.l1[0] + point.x, data.l1[1] + point.y);\n\t\tthis.lineB.set(data.l2[0] + point.x, data.l2[1] + point.y);\n\t\tthis.controlA.set(data.c1[0] + point.x, data.c1[1] + point.y);\n\t\tthis.controlB.set(data.c2[0] + point.x, data.c2[1] + point.y);\n\t\tthis.setMode(ToolMode.Placed);\n\t}\n\tgetData() {\n\t\tconst center = this.lineCenter;\n\t\treturn {\n\t\t\tl1: [this.lineA.x - center.x, this.lineA.y - center.y],\n\t\t\tl2: [this.lineB.x - center.x, this.lineB.y - center.y],\n\t\t\tc1: [this.controlA.x - center.x, this.controlA.y - center.y],\n\t\t\tc2: [this.controlB.x - center.x, this.controlB.y - center.y]\n\t\t};\n\t}\n}","// math-inlining.\nconst { abs, cos, sin, acos, atan2, sqrt, pow } = Math;\n\n// cube root function yielding real roots\nfunction crt(v) {\n\treturn v < 0 ? -pow(-v, 1 / 3) : pow(v, 1 / 3);\n}\n\n// trig constants\nconst pi = Math.PI,\n\ttau = 2 * pi,\n\tquart = pi / 2,\n\t// float precision significant decimal\n\tepsilon = 0.000001,\n\t// extremas used in bbox calculation and similar algorithms\n\tnMax = Number.MAX_SAFE_INTEGER || 9007199254740991,\n\tnMin = Number.MIN_SAFE_INTEGER || -9007199254740991,\n\t// a zero coordinate, which is surprisingly useful\n\tZERO = { x: 0, y: 0, z: 0 };\n\n// Bezier utility functions\nconst utils = {\n\t// Legendre-Gauss abscissae with n=24 (x_i values, defined at i=n as the roots of the nth order Legendre polynomial Pn(x))\n\tTvalues: [\n\t\t-0.0640568928626056260850430826247450385909,\n\t\t0.0640568928626056260850430826247450385909,\n\t\t-0.1911188674736163091586398207570696318404,\n\t\t0.1911188674736163091586398207570696318404,\n\t\t-0.3150426796961633743867932913198102407864,\n\t\t0.3150426796961633743867932913198102407864,\n\t\t-0.4337935076260451384870842319133497124524,\n\t\t0.4337935076260451384870842319133497124524,\n\t\t-0.5454214713888395356583756172183723700107,\n\t\t0.5454214713888395356583756172183723700107,\n\t\t-0.6480936519369755692524957869107476266696,\n\t\t0.6480936519369755692524957869107476266696,\n\t\t-0.7401241915785543642438281030999784255232,\n\t\t0.7401241915785543642438281030999784255232,\n\t\t-0.8200019859739029219539498726697452080761,\n\t\t0.8200019859739029219539498726697452080761,\n\t\t-0.8864155270044010342131543419821967550873,\n\t\t0.8864155270044010342131543419821967550873,\n\t\t-0.9382745520027327585236490017087214496548,\n\t\t0.9382745520027327585236490017087214496548,\n\t\t-0.9747285559713094981983919930081690617411,\n\t\t0.9747285559713094981983919930081690617411,\n\t\t-0.9951872199970213601799974097007368118745,\n\t\t0.9951872199970213601799974097007368118745,\n\t],\n\n\t// Legendre-Gauss weights with n=24 (w_i values, defined by a function linked to in the Bezier primer article)\n\tCvalues: [\n\t\t0.1279381953467521569740561652246953718517,\n\t\t0.1279381953467521569740561652246953718517,\n\t\t0.1258374563468282961213753825111836887264,\n\t\t0.1258374563468282961213753825111836887264,\n\t\t0.121670472927803391204463153476262425607,\n\t\t0.121670472927803391204463153476262425607,\n\t\t0.1155056680537256013533444839067835598622,\n\t\t0.1155056680537256013533444839067835598622,\n\t\t0.1074442701159656347825773424466062227946,\n\t\t0.1074442701159656347825773424466062227946,\n\t\t0.0976186521041138882698806644642471544279,\n\t\t0.0976186521041138882698806644642471544279,\n\t\t0.086190161531953275917185202983742667185,\n\t\t0.086190161531953275917185202983742667185,\n\t\t0.0733464814110803057340336152531165181193,\n\t\t0.0733464814110803057340336152531165181193,\n\t\t0.0592985849154367807463677585001085845412,\n\t\t0.0592985849154367807463677585001085845412,\n\t\t0.0442774388174198061686027482113382288593,\n\t\t0.0442774388174198061686027482113382288593,\n\t\t0.0285313886289336631813078159518782864491,\n\t\t0.0285313886289336631813078159518782864491,\n\t\t0.0123412297999871995468056670700372915759,\n\t\t0.0123412297999871995468056670700372915759,\n\t],\n\n\tarcfn: function (t, derivativeFn) {\n\t\tconst d = derivativeFn(t);\n\t\tlet l = d.x * d.x + d.y * d.y;\n\t\tif (typeof d.z !== \"undefined\") {\n\t\t\tl += d.z * d.z;\n\t\t}\n\t\treturn sqrt(l);\n\t},\n\n\tcompute: function (t, points, _3d) {\n\t\t// shortcuts\n\t\tif (t === 0) {\n\t\t\tpoints[0].t = 0;\n\t\t\treturn points[0];\n\t\t}\n\n\t\tconst order = points.length - 1;\n\n\t\tif (t === 1) {\n\t\t\tpoints[order].t = 1;\n\t\t\treturn points[order];\n\t\t}\n\n\t\tconst mt = 1 - t;\n\t\tlet p = points;\n\n\t\t// constant?\n\t\tif (order === 0) {\n\t\t\tpoints[0].t = t;\n\t\t\treturn points[0];\n\t\t}\n\n\t\t// linear?\n\t\tif (order === 1) {\n\t\t\tconst ret = {\n\t\t\t\tx: mt * p[0].x + t * p[1].x,\n\t\t\t\ty: mt * p[0].y + t * p[1].y,\n\t\t\t\tt: t,\n\t\t\t};\n\t\t\tif (_3d) {\n\t\t\t\tret.z = mt * p[0].z + t * p[1].z;\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\n\t\t// quadratic/cubic curve?\n\t\tif (order < 4) {\n\t\t\tlet mt2 = mt * mt,\n\t\t\t\tt2 = t * t,\n\t\t\t\ta,\n\t\t\t\tb,\n\t\t\t\tc,\n\t\t\t\td = 0;\n\t\t\tif (order === 2) {\n\t\t\t\tp = [p[0], p[1], p[2], ZERO];\n\t\t\t\ta = mt2;\n\t\t\t\tb = mt * t * 2;\n\t\t\t\tc = t2;\n\t\t\t} else if (order === 3) {\n\t\t\t\ta = mt2 * mt;\n\t\t\t\tb = mt2 * t * 3;\n\t\t\t\tc = mt * t2 * 3;\n\t\t\t\td = t * t2;\n\t\t\t}\n\t\t\tconst ret = {\n\t\t\t\tx: a * p[0].x + b * p[1].x + c * p[2].x + d * p[3].x,\n\t\t\t\ty: a * p[0].y + b * p[1].y + c * p[2].y + d * p[3].y,\n\t\t\t\tt: t,\n\t\t\t};\n\t\t\tif (_3d) {\n\t\t\t\tret.z = a * p[0].z + b * p[1].z + c * p[2].z + d * p[3].z;\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\n\t\t// higher order curves: use de Casteljau's computation\n\t\tconst dCpts = JSON.parse(JSON.stringify(points));\n\t\twhile (dCpts.length > 1) {\n\t\t\tfor (let i = 0; i < dCpts.length - 1; i++) {\n\t\t\t\tdCpts[i] = {\n\t\t\t\t\tx: dCpts[i].x + (dCpts[i + 1].x - dCpts[i].x) * t,\n\t\t\t\t\ty: dCpts[i].y + (dCpts[i + 1].y - dCpts[i].y) * t,\n\t\t\t\t};\n\t\t\t\tif (typeof dCpts[i].z !== \"undefined\") {\n\t\t\t\t\tdCpts[i] = dCpts[i].z + (dCpts[i + 1].z - dCpts[i].z) * t;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdCpts.splice(dCpts.length - 1, 1);\n\t\t}\n\t\tdCpts[0].t = t;\n\t\treturn dCpts[0];\n\t},\n\n\tcomputeWithRatios: function (t, points, ratios, _3d) {\n\t\tconst mt = 1 - t,\n\t\t\tr = ratios,\n\t\t\tp = points;\n\n\t\tlet f1 = r[0],\n\t\t\tf2 = r[1],\n\t\t\tf3 = r[2],\n\t\t\tf4 = r[3],\n\t\t\td;\n\n\t\t// spec for linear\n\t\tf1 *= mt;\n\t\tf2 *= t;\n\n\t\tif (p.length === 2) {\n\t\t\td = f1 + f2;\n\t\t\treturn {\n\t\t\t\tx: (f1 * p[0].x + f2 * p[1].x) / d,\n\t\t\t\ty: (f1 * p[0].y + f2 * p[1].y) / d,\n\t\t\t\tz: !_3d ? false : (f1 * p[0].z + f2 * p[1].z) / d,\n\t\t\t\tt: t,\n\t\t\t};\n\t\t}\n\n\t\t// upgrade to quadratic\n\t\tf1 *= mt;\n\t\tf2 *= 2 * mt;\n\t\tf3 *= t * t;\n\n\t\tif (p.length === 3) {\n\t\t\td = f1 + f2 + f3;\n\t\t\treturn {\n\t\t\t\tx: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x) / d,\n\t\t\t\ty: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y) / d,\n\t\t\t\tz: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z) / d,\n\t\t\t\tt: t,\n\t\t\t};\n\t\t}\n\n\t\t// upgrade to cubic\n\t\tf1 *= mt;\n\t\tf2 *= 1.5 * mt;\n\t\tf3 *= 3 * mt;\n\t\tf4 *= t * t * t;\n\n\t\tif (p.length === 4) {\n\t\t\td = f1 + f2 + f3 + f4;\n\t\t\treturn {\n\t\t\t\tx: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x + f4 * p[3].x) / d,\n\t\t\t\ty: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y + f4 * p[3].y) / d,\n\t\t\t\tz: !_3d\n\t\t\t\t\t? false\n\t\t\t\t\t: (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z + f4 * p[3].z) / d,\n\t\t\t\tt: t,\n\t\t\t};\n\t\t}\n\t},\n\n\tderive: function (points, _3d) {\n\t\tconst dpoints = [];\n\t\tfor (let p = points, d = p.length, c = d - 1; d > 1; d--, c--) {\n\t\t\tconst list = [];\n\t\t\tfor (let j = 0, dpt; j < c; j++) {\n\t\t\t\tdpt = {\n\t\t\t\t\tx: c * (p[j + 1].x - p[j].x),\n\t\t\t\t\ty: c * (p[j + 1].y - p[j].y),\n\t\t\t\t};\n\t\t\t\tif (_3d) {\n\t\t\t\t\tdpt.z = c * (p[j + 1].z - p[j].z);\n\t\t\t\t}\n\t\t\t\tlist.push(dpt);\n\t\t\t}\n\t\t\tdpoints.push(list);\n\t\t\tp = list;\n\t\t}\n\t\treturn dpoints;\n\t},\n\n\tbetween: function (v, m, M) {\n\t\treturn (\n\t\t\t(m <= v && v <= M) ||\n\t\t\tutils.approximately(v, m) ||\n\t\t\tutils.approximately(v, M)\n\t\t);\n\t},\n\n\tapproximately: function (a, b, precision) {\n\t\treturn abs(a - b) <= (precision || epsilon);\n\t},\n\n\tlength: function (derivativeFn) {\n\t\tconst z = 0.5,\n\t\t\tlen = utils.Tvalues.length;\n\n\t\tlet sum = 0;\n\n\t\tfor (let i = 0, t; i < len; i++) {\n\t\t\tt = z * utils.Tvalues[i] + z;\n\t\t\tsum += utils.Cvalues[i] * utils.arcfn(t, derivativeFn);\n\t\t}\n\t\treturn z * sum;\n\t},\n\n\tmap: function (v, ds, de, ts, te) {\n\t\tconst d1 = de - ds,\n\t\t\td2 = te - ts,\n\t\t\tv2 = v - ds,\n\t\t\tr = v2 / d1;\n\t\treturn ts + d2 * r;\n\t},\n\n\tlerp: function (r, v1, v2) {\n\t\tconst ret = {\n\t\t\tx: v1.x + r * (v2.x - v1.x),\n\t\t\ty: v1.y + r * (v2.y - v1.y),\n\t\t};\n\t\tif (!!v1.z && !!v2.z) {\n\t\t\tret.z = v1.z + r * (v2.z - v1.z);\n\t\t}\n\t\treturn ret;\n\t},\n\n\tpointToString: function (p) {\n\t\tlet s = p.x + \"/\" + p.y;\n\t\tif (typeof p.z !== \"undefined\") {\n\t\t\ts += \"/\" + p.z;\n\t\t}\n\t\treturn s;\n\t},\n\n\tpointsToString: function (points) {\n\t\treturn \"[\" + points.map(utils.pointToString).join(\", \") + \"]\";\n\t},\n\n\tcopy: function (obj) {\n\t\treturn JSON.parse(JSON.stringify(obj));\n\t},\n\n\tangle: function (o, v1, v2) {\n\t\tconst dx1 = v1.x - o.x,\n\t\t\tdy1 = v1.y - o.y,\n\t\t\tdx2 = v2.x - o.x,\n\t\t\tdy2 = v2.y - o.y,\n\t\t\tcross = dx1 * dy2 - dy1 * dx2,\n\t\t\tdot = dx1 * dx2 + dy1 * dy2;\n\t\treturn atan2(cross, dot);\n\t},\n\n\t// round as string, to avoid rounding errors\n\tround: function (v, d) {\n\t\tconst s = \"\" + v;\n\t\tconst pos = s.indexOf(\".\");\n\t\treturn parseFloat(s.substring(0, pos + 1 + d));\n\t},\n\n\tdist: function (p1, p2) {\n\t\tconst dx = p1.x - p2.x,\n\t\t\tdy = p1.y - p2.y;\n\t\treturn sqrt(dx * dx + dy * dy);\n\t},\n\n\tclosest: function (LUT, point) {\n\t\tlet mdist = pow(2, 63),\n\t\t\tmpos,\n\t\t\td;\n\t\tLUT.forEach(function (p, idx) {\n\t\t\td = utils.dist(point, p);\n\t\t\tif (d < mdist) {\n\t\t\t\tmdist = d;\n\t\t\t\tmpos = idx;\n\t\t\t}\n\t\t});\n\t\treturn { mdist: mdist, mpos: mpos };\n\t},\n\n\tabcratio: function (t, n) {\n\t\t// see ratio(t) note on http://pomax.github.io/bezierinfo/#abc\n\t\tif (n !== 2 && n !== 3) {\n\t\t\treturn false;\n\t\t}\n\t\tif (typeof t === \"undefined\") {\n\t\t\tt = 0.5;\n\t\t} else if (t === 0 || t === 1) {\n\t\t\treturn t;\n\t\t}\n\t\tconst bottom = pow(t, n) + pow(1 - t, n),\n\t\t\ttop = bottom - 1;\n\t\treturn abs(top / bottom);\n\t},\n\n\tprojectionratio: function (t, n) {\n\t\t// see u(t) note on http://pomax.github.io/bezierinfo/#abc\n\t\tif (n !== 2 && n !== 3) {\n\t\t\treturn false;\n\t\t}\n\t\tif (typeof t === \"undefined\") {\n\t\t\tt = 0.5;\n\t\t} else if (t === 0 || t === 1) {\n\t\t\treturn t;\n\t\t}\n\t\tconst top = pow(1 - t, n),\n\t\t\tbottom = pow(t, n) + top;\n\t\treturn top / bottom;\n\t},\n\n\tlli8: function (x1, y1, x2, y2, x3, y3, x4, y4) {\n\t\tconst nx =\n\t\t\t(x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n\t\t\tny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n\t\t\td = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n\t\tif (d == 0) {\n\t\t\treturn false;\n\t\t}\n\t\treturn { x: nx / d, y: ny / d };\n\t},\n\n\tlli4: function (p1, p2, p3, p4) {\n\t\tconst x1 = p1.x,\n\t\t\ty1 = p1.y,\n\t\t\tx2 = p2.x,\n\t\t\ty2 = p2.y,\n\t\t\tx3 = p3.x,\n\t\t\ty3 = p3.y,\n\t\t\tx4 = p4.x,\n\t\t\ty4 = p4.y;\n\t\treturn utils.lli8(x1, y1, x2, y2, x3, y3, x4, y4);\n\t},\n\n\tlli: function (v1, v2) {\n\t\treturn utils.lli4(v1, v1.c, v2, v2.c);\n\t},\n\n\tmakeline: function (p1, p2) {\n\t\tconst x1 = p1.x,\n\t\t\ty1 = p1.y,\n\t\t\tx2 = p2.x,\n\t\t\ty2 = p2.y,\n\t\t\tdx = (x2 - x1) / 3,\n\t\t\tdy = (y2 - y1) / 3;\n\t\treturn new Bezier(\n\t\t\tx1,\n\t\t\ty1,\n\t\t\tx1 + dx,\n\t\t\ty1 + dy,\n\t\t\tx1 + 2 * dx,\n\t\t\ty1 + 2 * dy,\n\t\t\tx2,\n\t\t\ty2\n\t\t);\n\t},\n\n\tfindbbox: function (sections) {\n\t\tlet mx = nMax,\n\t\t\tmy = nMax,\n\t\t\tMX = nMin,\n\t\t\tMY = nMin;\n\t\tsections.forEach(function (s) {\n\t\t\tconst bbox = s.bbox();\n\t\t\tif (mx > bbox.x.min) mx = bbox.x.min;\n\t\t\tif (my > bbox.y.min) my = bbox.y.min;\n\t\t\tif (MX < bbox.x.max) MX = bbox.x.max;\n\t\t\tif (MY < bbox.y.max) MY = bbox.y.max;\n\t\t});\n\t\treturn {\n\t\t\tx: { min: mx, mid: (mx + MX) / 2, max: MX, size: MX - mx },\n\t\t\ty: { min: my, mid: (my + MY) / 2, max: MY, size: MY - my },\n\t\t};\n\t},\n\n\tshapeintersections: function (\n\t\ts1,\n\t\tbbox1,\n\t\ts2,\n\t\tbbox2,\n\t\tcurveIntersectionThreshold\n\t) {\n\t\tif (!utils.bboxoverlap(bbox1, bbox2)) return [];\n\t\tconst intersections = [];\n\t\tconst a1 = [s1.startcap, s1.forward, s1.back, s1.endcap];\n\t\tconst a2 = [s2.startcap, s2.forward, s2.back, s2.endcap];\n\t\ta1.forEach(function (l1) {\n\t\t\tif (l1.virtual) return;\n\t\t\ta2.forEach(function (l2) {\n\t\t\t\tif (l2.virtual) return;\n\t\t\t\tconst iss = l1.intersects(l2, curveIntersectionThreshold);\n\t\t\t\tif (iss.length > 0) {\n\t\t\t\t\tiss.c1 = l1;\n\t\t\t\t\tiss.c2 = l2;\n\t\t\t\t\tiss.s1 = s1;\n\t\t\t\t\tiss.s2 = s2;\n\t\t\t\t\tintersections.push(iss);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn intersections;\n\t},\n\n\tmakeshape: function (forward, back, curveIntersectionThreshold) {\n\t\tconst bpl = back.points.length;\n\t\tconst fpl = forward.points.length;\n\t\tconst start = utils.makeline(back.points[bpl - 1], forward.points[0]);\n\t\tconst end = utils.makeline(forward.points[fpl - 1], back.points[0]);\n\t\tconst shape = {\n\t\t\tstartcap: start,\n\t\t\tforward: forward,\n\t\t\tback: back,\n\t\t\tendcap: end,\n\t\t\tbbox: utils.findbbox([start, forward, back, end]),\n\t\t};\n\t\tshape.intersections = function (s2) {\n\t\t\treturn utils.shapeintersections(\n\t\t\t\tshape,\n\t\t\t\tshape.bbox,\n\t\t\t\ts2,\n\t\t\t\ts2.bbox,\n\t\t\t\tcurveIntersectionThreshold\n\t\t\t);\n\t\t};\n\t\treturn shape;\n\t},\n\n\tgetminmax: function (curve, d, list) {\n\t\tif (!list) return { min: 0, max: 0 };\n\t\tlet min = nMax,\n\t\t\tmax = nMin,\n\t\t\tt,\n\t\t\tc;\n\t\tif (list.indexOf(0) === -1) {\n\t\t\tlist = [0].concat(list);\n\t\t}\n\t\tif (list.indexOf(1) === -1) {\n\t\t\tlist.push(1);\n\t\t}\n\t\tfor (let i = 0, len = list.length; i < len; i++) {\n\t\t\tt = list[i];\n\t\t\tc = curve.get(t);\n\t\t\tif (c[d] < min) {\n\t\t\t\tmin = c[d];\n\t\t\t}\n\t\t\tif (c[d] > max) {\n\t\t\t\tmax = c[d];\n\t\t\t}\n\t\t}\n\t\treturn { min: min, mid: (min + max) / 2, max: max, size: max - min };\n\t},\n\n\talign: function (points, line) {\n\t\tconst tx = line.p1.x,\n\t\t\tty = line.p1.y,\n\t\t\ta = -atan2(line.p2.y - ty, line.p2.x - tx),\n\t\t\td = function (v) {\n\t\t\t\treturn {\n\t\t\t\t\tx: (v.x - tx) * cos(a) - (v.y - ty) * sin(a),\n\t\t\t\t\ty: (v.x - tx) * sin(a) + (v.y - ty) * cos(a),\n\t\t\t\t};\n\t\t\t};\n\t\treturn points.map(d);\n\t},\n\n\troots: function (points, line) {\n\t\tline = line || { p1: { x: 0, y: 0 }, p2: { x: 1, y: 0 } };\n\n\t\tconst order = points.length - 1;\n\t\tconst aligned = utils.align(points, line);\n\t\tconst reduce = function (t) {\n\t\t\treturn 0 <= t && t <= 1;\n\t\t};\n\n\t\tif (order === 2) {\n\t\t\tconst a = aligned[0].y,\n\t\t\t\tb = aligned[1].y,\n\t\t\t\tc = aligned[2].y,\n\t\t\t\td = a - 2 * b + c;\n\t\t\tif (d !== 0) {\n\t\t\t\tconst m1 = -sqrt(b * b - a * c),\n\t\t\t\t\tm2 = -a + b,\n\t\t\t\t\tv1 = -(m1 + m2) / d,\n\t\t\t\t\tv2 = -(-m1 + m2) / d;\n\t\t\t\treturn [v1, v2].filter(reduce);\n\t\t\t} else if (b !== c && d === 0) {\n\t\t\t\treturn [(2 * b - c) / (2 * b - 2 * c)].filter(reduce);\n\t\t\t}\n\t\t\treturn [];\n\t\t}\n\n\t\t// see http://www.trans4mind.com/personal_development/mathematics/polynomials/cubicAlgebra.htm\n\t\tconst pa = aligned[0].y,\n\t\t\tpb = aligned[1].y,\n\t\t\tpc = aligned[2].y,\n\t\t\tpd = aligned[3].y;\n\n\t\tlet d = -pa + 3 * pb - 3 * pc + pd,\n\t\t\ta = 3 * pa - 6 * pb + 3 * pc,\n\t\t\tb = -3 * pa + 3 * pb,\n\t\t\tc = pa;\n\n\t\tif (utils.approximately(d, 0)) {\n\t\t\t// this is not a cubic curve.\n\t\t\tif (utils.approximately(a, 0)) {\n\t\t\t\t// in fact, this is not a quadratic curve either.\n\t\t\t\tif (utils.approximately(b, 0)) {\n\t\t\t\t\t// in fact in fact, there are no solutions.\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t\t// linear solution:\n\t\t\t\treturn [-c / b].filter(reduce);\n\t\t\t}\n\t\t\t// quadratic solution:\n\t\t\tconst q = sqrt(b * b - 4 * a * c),\n\t\t\t\ta2 = 2 * a;\n\t\t\treturn [(q - b) / a2, (-b - q) / a2].filter(reduce);\n\t\t}\n\n\t\t// at this point, we know we need a cubic solution:\n\n\t\ta /= d;\n\t\tb /= d;\n\t\tc /= d;\n\n\t\tconst p = (3 * b - a * a) / 3,\n\t\t\tp3 = p / 3,\n\t\t\tq = (2 * a * a * a - 9 * a * b + 27 * c) / 27,\n\t\t\tq2 = q / 2,\n\t\t\tdiscriminant = q2 * q2 + p3 * p3 * p3;\n\n\t\tlet u1, v1, x1, x2, x3;\n\t\tif (discriminant < 0) {\n\t\t\tconst mp3 = -p / 3,\n\t\t\t\tmp33 = mp3 * mp3 * mp3,\n\t\t\t\tr = sqrt(mp33),\n\t\t\t\tt = -q / (2 * r),\n\t\t\t\tcosphi = t < -1 ? -1 : t > 1 ? 1 : t,\n\t\t\t\tphi = acos(cosphi),\n\t\t\t\tcrtr = crt(r),\n\t\t\t\tt1 = 2 * crtr;\n\t\t\tx1 = t1 * cos(phi / 3) - a / 3;\n\t\t\tx2 = t1 * cos((phi + tau) / 3) - a / 3;\n\t\t\tx3 = t1 * cos((phi + 2 * tau) / 3) - a / 3;\n\t\t\treturn [x1, x2, x3].filter(reduce);\n\t\t} else if (discriminant === 0) {\n\t\t\tu1 = q2 < 0 ? crt(-q2) : -crt(q2);\n\t\t\tx1 = 2 * u1 - a / 3;\n\t\t\tx2 = -u1 - a / 3;\n\t\t\treturn [x1, x2].filter(reduce);\n\t\t} else {\n\t\t\tconst sd = sqrt(discriminant);\n\t\t\tu1 = crt(-q2 + sd);\n\t\t\tv1 = crt(q2 + sd);\n\t\t\treturn [u1 - v1 - a / 3].filter(reduce);\n\t\t}\n\t},\n\n\tdroots: function (p) {\n\t\t// quadratic roots are easy\n\t\tif (p.length === 3) {\n\t\t\tconst a = p[0],\n\t\t\t\tb = p[1],\n\t\t\t\tc = p[2],\n\t\t\t\td = a - 2 * b + c;\n\t\t\tif (d !== 0) {\n\t\t\t\tconst m1 = -sqrt(b * b - a * c),\n\t\t\t\t\tm2 = -a + b,\n\t\t\t\t\tv1 = -(m1 + m2) / d,\n\t\t\t\t\tv2 = -(-m1 + m2) / d;\n\t\t\t\treturn [v1, v2];\n\t\t\t} else if (b !== c && d === 0) {\n\t\t\t\treturn [(2 * b - c) / (2 * (b - c))];\n\t\t\t}\n\t\t\treturn [];\n\t\t}\n\n\t\t// linear roots are even easier\n\t\tif (p.length === 2) {\n\t\t\tconst a = p[0],\n\t\t\t\tb = p[1];\n\t\t\tif (a !== b) {\n\t\t\t\treturn [a / (a - b)];\n\t\t\t}\n\t\t\treturn [];\n\t\t}\n\n\t\treturn [];\n\t},\n\n\tcurvature: function (t, d1, d2, _3d, kOnly) {\n\t\tlet num,\n\t\t\tdnm,\n\t\t\tadk,\n\t\t\tdk,\n\t\t\tk = 0,\n\t\t\tr = 0;\n\n\t\t//\n\t\t// We're using the following formula for curvature:\n\t\t//\n\t\t//              x'y\" - y'x\"\n\t\t//   k(t) = ------------------\n\t\t//           (x' + y')^(3/2)\n\t\t//\n\t\t// from https://en.wikipedia.org/wiki/Radius_of_curvature#Definition\n\t\t//\n\t\t// With it corresponding 3D counterpart:\n\t\t//\n\t\t//          sqrt( (y'z\" - y\"z') + (z'x\" - z\"x') + (x'y\" - x\"y'))\n\t\t//   k(t) = -------------------------------------------------------\n\t\t//                     (x' + y' + z')^(3/2)\n\t\t//\n\n\t\tconst d = utils.compute(t, d1);\n\t\tconst dd = utils.compute(t, d2);\n\t\tconst qdsum = d.x * d.x + d.y * d.y;\n\n\t\tif (_3d) {\n\t\t\tnum = sqrt(\n\t\t\t\tpow(d.y * dd.z - dd.y * d.z, 2) +\n\t\t\t\tpow(d.z * dd.x - dd.z * d.x, 2) +\n\t\t\t\tpow(d.x * dd.y - dd.x * d.y, 2)\n\t\t\t);\n\t\t\tdnm = pow(qdsum + d.z * d.z, 3 / 2);\n\t\t} else {\n\t\t\tnum = d.x * dd.y - d.y * dd.x;\n\t\t\tdnm = pow(qdsum, 3 / 2);\n\t\t}\n\n\t\tif (num === 0 || dnm === 0) {\n\t\t\treturn { k: 0, r: 0 };\n\t\t}\n\n\t\tk = num / dnm;\n\t\tr = dnm / num;\n\n\t\t// We're also computing the derivative of kappa, because\n\t\t// there is value in knowing the rate of change for the\n\t\t// curvature along the curve. And we're just going to\n\t\t// ballpark it based on an epsilon.\n\t\tif (!kOnly) {\n\t\t\t// compute k'(t) based on the interval before, and after it,\n\t\t\t// to at least try to not introduce forward/backward pass bias.\n\t\t\tconst pk = utils.curvature(t - 0.001, d1, d2, _3d, true).k;\n\t\t\tconst nk = utils.curvature(t + 0.001, d1, d2, _3d, true).k;\n\t\t\tdk = (nk - k + (k - pk)) / 2;\n\t\t\tadk = (abs(nk - k) + abs(k - pk)) / 2;\n\t\t}\n\n\t\treturn { k: k, r: r, dk: dk, adk: adk };\n\t},\n\n\tinflections: function (points) {\n\t\tif (points.length < 4) return [];\n\n\t\t// FIXME: TODO: add in inflection abstraction for quartic+ curves?\n\n\t\tconst p = utils.align(points, { p1: points[0], p2: points.slice(-1)[0] }),\n\t\t\ta = p[2].x * p[1].y,\n\t\t\tb = p[3].x * p[1].y,\n\t\t\tc = p[1].x * p[2].y,\n\t\t\td = p[3].x * p[2].y,\n\t\t\tv1 = 18 * (-3 * a + 2 * b + 3 * c - d),\n\t\t\tv2 = 18 * (3 * a - b - 3 * c),\n\t\t\tv3 = 18 * (c - a);\n\n\t\tif (utils.approximately(v1, 0)) {\n\t\t\tif (!utils.approximately(v2, 0)) {\n\t\t\t\tlet t = -v3 / v2;\n\t\t\t\tif (0 <= t && t <= 1) return [t];\n\t\t\t}\n\t\t\treturn [];\n\t\t}\n\n\t\tconst trm = v2 * v2 - 4 * v1 * v3,\n\t\t\tsq = Math.sqrt(trm),\n\t\t\td2 = 2 * v1;\n\n\t\tif (utils.approximately(d2, 0)) return [];\n\n\t\treturn [(sq - v2) / d2, -(v2 + sq) / d2].filter(function (r) {\n\t\t\treturn 0 <= r && r <= 1;\n\t\t});\n\t},\n\n\tbboxoverlap: function (b1, b2) {\n\t\tconst dims = [\"x\", \"y\"],\n\t\t\tlen = dims.length;\n\n\t\tfor (let i = 0, dim, l, t, d; i < len; i++) {\n\t\t\tdim = dims[i];\n\t\t\tl = b1[dim].mid;\n\t\t\tt = b2[dim].mid;\n\t\t\td = (b1[dim].size + b2[dim].size) / 2;\n\t\t\tif (abs(l - t) >= d) return false;\n\t\t}\n\t\treturn true;\n\t},\n\n\texpandbox: function (bbox, _bbox) {\n\t\tif (_bbox.x.min < bbox.x.min) {\n\t\t\tbbox.x.min = _bbox.x.min;\n\t\t}\n\t\tif (_bbox.y.min < bbox.y.min) {\n\t\t\tbbox.y.min = _bbox.y.min;\n\t\t}\n\t\tif (_bbox.z && _bbox.z.min < bbox.z.min) {\n\t\t\tbbox.z.min = _bbox.z.min;\n\t\t}\n\t\tif (_bbox.x.max > bbox.x.max) {\n\t\t\tbbox.x.max = _bbox.x.max;\n\t\t}\n\t\tif (_bbox.y.max > bbox.y.max) {\n\t\t\tbbox.y.max = _bbox.y.max;\n\t\t}\n\t\tif (_bbox.z && _bbox.z.max > bbox.z.max) {\n\t\t\tbbox.z.max = _bbox.z.max;\n\t\t}\n\t\tbbox.x.mid = (bbox.x.min + bbox.x.max) / 2;\n\t\tbbox.y.mid = (bbox.y.min + bbox.y.max) / 2;\n\t\tif (bbox.z) {\n\t\t\tbbox.z.mid = (bbox.z.min + bbox.z.max) / 2;\n\t\t}\n\t\tbbox.x.size = bbox.x.max - bbox.x.min;\n\t\tbbox.y.size = bbox.y.max - bbox.y.min;\n\t\tif (bbox.z) {\n\t\t\tbbox.z.size = bbox.z.max - bbox.z.min;\n\t\t}\n\t},\n\n\tpairiteration: function (c1, c2, curveIntersectionThreshold) {\n\t\tconst c1b = c1.bbox(),\n\t\t\tc2b = c2.bbox(),\n\t\t\tr = 100000,\n\t\t\tthreshold = curveIntersectionThreshold || 0.5;\n\n\t\tif (\n\t\t\tc1b.x.size + c1b.y.size < threshold &&\n\t\t\tc2b.x.size + c2b.y.size < threshold\n\t\t) {\n\t\t\treturn [\n\t\t\t\t(((r * (c1._t1 + c1._t2)) / 2) | 0) / r +\n\t\t\t\t\"/\" +\n\t\t\t\t(((r * (c2._t1 + c2._t2)) / 2) | 0) / r,\n\t\t\t];\n\t\t}\n\n\t\tlet cc1 = c1.split(0.5),\n\t\t\tcc2 = c2.split(0.5),\n\t\t\tpairs = [\n\t\t\t\t{ left: cc1.left, right: cc2.left },\n\t\t\t\t{ left: cc1.left, right: cc2.right },\n\t\t\t\t{ left: cc1.right, right: cc2.right },\n\t\t\t\t{ left: cc1.right, right: cc2.left },\n\t\t\t];\n\n\t\tpairs = pairs.filter(function (pair) {\n\t\t\treturn utils.bboxoverlap(pair.left.bbox(), pair.right.bbox());\n\t\t});\n\n\t\tlet results = [];\n\n\t\tif (pairs.length === 0) return results;\n\n\t\tpairs.forEach(function (pair) {\n\t\t\tresults = results.concat(\n\t\t\t\tutils.pairiteration(pair.left, pair.right, threshold)\n\t\t\t);\n\t\t});\n\n\t\tresults = results.filter(function (v, i) {\n\t\t\treturn results.indexOf(v) === i;\n\t\t});\n\n\t\treturn results;\n\t},\n\n\tgetccenter: function (p1, p2, p3) {\n\t\tconst dx1 = p2.x - p1.x,\n\t\t\tdy1 = p2.y - p1.y,\n\t\t\tdx2 = p3.x - p2.x,\n\t\t\tdy2 = p3.y - p2.y,\n\t\t\tdx1p = dx1 * cos(quart) - dy1 * sin(quart),\n\t\t\tdy1p = dx1 * sin(quart) + dy1 * cos(quart),\n\t\t\tdx2p = dx2 * cos(quart) - dy2 * sin(quart),\n\t\t\tdy2p = dx2 * sin(quart) + dy2 * cos(quart),\n\t\t\t// chord midpoints\n\t\t\tmx1 = (p1.x + p2.x) / 2,\n\t\t\tmy1 = (p1.y + p2.y) / 2,\n\t\t\tmx2 = (p2.x + p3.x) / 2,\n\t\t\tmy2 = (p2.y + p3.y) / 2,\n\t\t\t// midpoint offsets\n\t\t\tmx1n = mx1 + dx1p,\n\t\t\tmy1n = my1 + dy1p,\n\t\t\tmx2n = mx2 + dx2p,\n\t\t\tmy2n = my2 + dy2p,\n\t\t\t// intersection of these lines:\n\t\t\tarc = utils.lli8(mx1, my1, mx1n, my1n, mx2, my2, mx2n, my2n),\n\t\t\tr = utils.dist(arc, p1);\n\n\t\t// arc start/end values, over mid point:\n\t\tlet s = atan2(p1.y - arc.y, p1.x - arc.x),\n\t\t\tm = atan2(p2.y - arc.y, p2.x - arc.x),\n\t\t\te = atan2(p3.y - arc.y, p3.x - arc.x),\n\t\t\t_;\n\n\t\t// determine arc direction (cw/ccw correction)\n\t\tif (s < e) {\n\t\t\t// if s<m<e, arc(s, e)\n\t\t\t// if m<s<e, arc(e, s + tau)\n\t\t\t// if s<e<m, arc(e, s + tau)\n\t\t\tif (s > m || m > e) {\n\t\t\t\ts += tau;\n\t\t\t}\n\t\t\tif (s > e) {\n\t\t\t\t_ = e;\n\t\t\t\te = s;\n\t\t\t\ts = _;\n\t\t\t}\n\t\t} else {\n\t\t\t// if e<m<s, arc(e, s)\n\t\t\t// if m<e<s, arc(s, e + tau)\n\t\t\t// if e<s<m, arc(s, e + tau)\n\t\t\tif (e < m && m < s) {\n\t\t\t\t_ = e;\n\t\t\t\te = s;\n\t\t\t\ts = _;\n\t\t\t} else {\n\t\t\t\te += tau;\n\t\t\t}\n\t\t}\n\t\t// assign and done.\n\t\tarc.s = s;\n\t\tarc.e = e;\n\t\tarc.r = r;\n\t\treturn arc;\n\t},\n\n\tnumberSort: function (a, b) {\n\t\treturn a - b;\n\t},\n};\n\n/**\n * Poly Bezier\n * @param {[type]} curves [description]\n */\nclass PolyBezier {\n\tconstructor(curves) {\n\t\tthis.curves = [];\n\t\tthis._3d = false;\n\t\tif (!!curves) {\n\t\t\tthis.curves = curves;\n\t\t\tthis._3d = this.curves[0]._3d;\n\t\t}\n\t}\n\n\tvalueOf() {\n\t\treturn this.toString();\n\t}\n\n\ttoString() {\n\t\treturn (\n\t\t\t\"[\" +\n\t\t\tthis.curves\n\t\t\t\t.map(function (curve) {\n\t\t\t\t\treturn utils.pointsToString(curve.points);\n\t\t\t\t})\n\t\t\t\t.join(\", \") +\n\t\t\t\"]\"\n\t\t);\n\t}\n\n\taddCurve(curve) {\n\t\tthis.curves.push(curve);\n\t\tthis._3d = this._3d || curve._3d;\n\t}\n\n\tlength() {\n\t\treturn this.curves\n\t\t\t.map(function (v) {\n\t\t\t\treturn v.length();\n\t\t\t})\n\t\t\t.reduce(function (a, b) {\n\t\t\t\treturn a + b;\n\t\t\t});\n\t}\n\n\tcurve(idx) {\n\t\treturn this.curves[idx];\n\t}\n\n\tbbox() {\n\t\tconst c = this.curves;\n\t\tvar bbox = c[0].bbox();\n\t\tfor (var i = 1; i < c.length; i++) {\n\t\t\tutils.expandbox(bbox, c[i].bbox());\n\t\t}\n\t\treturn bbox;\n\t}\n\n\toffset(d) {\n\t\tconst offset = [];\n\t\tthis.curves.forEach(function (v) {\n\t\t\toffset.push(...v.offset(d));\n\t\t});\n\t\treturn new PolyBezier(offset);\n\t}\n}\n\n/**\n  A javascript Bezier curve library by Pomax.\n\n  Based on http://pomax.github.io/bezierinfo\n\n  This code is MIT licensed.\n**/\n\n// math-inlining.\nconst { abs: abs$1, min, max, cos: cos$1, sin: sin$1, acos: acos$1, sqrt: sqrt$1 } = Math;\nconst pi$1 = Math.PI;\n\n/**\n * Bezier curve constructor.\n *\n * ...docs pending...\n */\nclass Bezier {\n\tconstructor(coords) {\n\t\tlet args =\n\t\t\tcoords && coords.forEach ? coords : Array.from(arguments).slice();\n\t\tlet coordlen = false;\n\n\t\tif (typeof args[0] === \"object\") {\n\t\t\tcoordlen = args.length;\n\t\t\tconst newargs = [];\n\t\t\targs.forEach(function (point) {\n\t\t\t\t[\"x\", \"y\", \"z\"].forEach(function (d) {\n\t\t\t\t\tif (typeof point[d] !== \"undefined\") {\n\t\t\t\t\t\tnewargs.push(point[d]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\targs = newargs;\n\t\t}\n\n\t\tlet higher = false;\n\t\tconst len = args.length;\n\n\t\tif (coordlen) {\n\t\t\tif (coordlen > 4) {\n\t\t\t\tif (arguments.length !== 1) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\"Only new Bezier(point[]) is accepted for 4th and higher order curves\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\thigher = true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (len !== 6 && len !== 8 && len !== 9 && len !== 12) {\n\t\t\t\tif (arguments.length !== 1) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\"Only new Bezier(point[]) is accepted for 4th and higher order curves\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst _3d = (this._3d =\n\t\t\t(!higher && (len === 9 || len === 12)) ||\n\t\t\t(coords && coords[0] && typeof coords[0].z !== \"undefined\"));\n\n\t\tconst points = (this.points = []);\n\t\tfor (let idx = 0, step = _3d ? 3 : 2; idx < len; idx += step) {\n\t\t\tvar point = {\n\t\t\t\tx: args[idx],\n\t\t\t\ty: args[idx + 1],\n\t\t\t};\n\t\t\tif (_3d) {\n\t\t\t\tpoint.z = args[idx + 2];\n\t\t\t}\n\t\t\tpoints.push(point);\n\t\t}\n\t\tconst order = (this.order = points.length - 1);\n\n\t\tconst dims = (this.dims = [\"x\", \"y\"]);\n\t\tif (_3d) dims.push(\"z\");\n\t\tthis.dimlen = dims.length;\n\n\t\tconst aligned = utils.align(points, { p1: points[0], p2: points[order] });\n\t\tthis._linear = !aligned.some((p) => abs$1(p.y) > 0.0001);\n\n\t\tthis._lut = [];\n\n\t\tthis._t1 = 0;\n\t\tthis._t2 = 1;\n\t\tthis.update();\n\t}\n\n\tstatic quadraticFromPoints(p1, p2, p3, t) {\n\t\tif (typeof t === \"undefined\") {\n\t\t\tt = 0.5;\n\t\t}\n\t\t// shortcuts, although they're really dumb\n\t\tif (t === 0) {\n\t\t\treturn new Bezier(p2, p2, p3);\n\t\t}\n\t\tif (t === 1) {\n\t\t\treturn new Bezier(p1, p2, p2);\n\t\t}\n\t\t// real fitting.\n\t\tconst abc = Bezier.getABC(2, p1, p2, p3, t);\n\t\treturn new Bezier(p1, abc.A, p3);\n\t}\n\n\tstatic cubicFromPoints(S, B, E, t, d1) {\n\t\tif (typeof t === \"undefined\") {\n\t\t\tt = 0.5;\n\t\t}\n\t\tconst abc = Bezier.getABC(3, S, B, E, t);\n\t\tif (typeof d1 === \"undefined\") {\n\t\t\td1 = utils.dist(B, abc.C);\n\t\t}\n\t\tconst d2 = (d1 * (1 - t)) / t;\n\n\t\tconst selen = utils.dist(S, E),\n\t\t\tlx = (E.x - S.x) / selen,\n\t\t\tly = (E.y - S.y) / selen,\n\t\t\tbx1 = d1 * lx,\n\t\t\tby1 = d1 * ly,\n\t\t\tbx2 = d2 * lx,\n\t\t\tby2 = d2 * ly;\n\t\t// derivation of new hull coordinates\n\t\tconst e1 = { x: B.x - bx1, y: B.y - by1 },\n\t\t\te2 = { x: B.x + bx2, y: B.y + by2 },\n\t\t\tA = abc.A,\n\t\t\tv1 = { x: A.x + (e1.x - A.x) / (1 - t), y: A.y + (e1.y - A.y) / (1 - t) },\n\t\t\tv2 = { x: A.x + (e2.x - A.x) / t, y: A.y + (e2.y - A.y) / t },\n\t\t\tnc1 = { x: S.x + (v1.x - S.x) / t, y: S.y + (v1.y - S.y) / t },\n\t\t\tnc2 = {\n\t\t\t\tx: E.x + (v2.x - E.x) / (1 - t),\n\t\t\t\ty: E.y + (v2.y - E.y) / (1 - t),\n\t\t\t};\n\t\t// ...done\n\t\treturn new Bezier(S, nc1, nc2, E);\n\t}\n\n\tstatic getUtils() {\n\t\treturn utils;\n\t}\n\n\tgetUtils() {\n\t\treturn Bezier.getUtils();\n\t}\n\n\tstatic get PolyBezier() {\n\t\treturn PolyBezier;\n\t}\n\n\tvalueOf() {\n\t\treturn this.toString();\n\t}\n\n\ttoString() {\n\t\treturn utils.pointsToString(this.points);\n\t}\n\n\ttoSVG() {\n\t\tif (this._3d) return false;\n\t\tconst p = this.points,\n\t\t\tx = p[0].x,\n\t\t\ty = p[0].y,\n\t\t\ts = [\"M\", x, y, this.order === 2 ? \"Q\" : \"C\"];\n\t\tfor (let i = 1, last = p.length; i < last; i++) {\n\t\t\ts.push(p[i].x);\n\t\t\ts.push(p[i].y);\n\t\t}\n\t\treturn s.join(\" \");\n\t}\n\n\tsetRatios(ratios) {\n\t\tif (ratios.length !== this.points.length) {\n\t\t\tthrow new Error(\"incorrect number of ratio values\");\n\t\t}\n\t\tthis.ratios = ratios;\n\t\tthis._lut = []; //  invalidate any precomputed LUT\n\t}\n\n\tverify() {\n\t\tconst print = this.coordDigest();\n\t\tif (print !== this._print) {\n\t\t\tthis._print = print;\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\tcoordDigest() {\n\t\treturn this.points\n\t\t\t.map(function (c, pos) {\n\t\t\t\treturn \"\" + pos + c.x + c.y + (c.z ? c.z : 0);\n\t\t\t})\n\t\t\t.join(\"\");\n\t}\n\n\tupdate() {\n\t\t// invalidate any precomputed LUT\n\t\tthis._lut = [];\n\t\tthis.dpoints = utils.derive(this.points, this._3d);\n\t\tthis.computedirection();\n\t}\n\n\tcomputedirection() {\n\t\tconst points = this.points;\n\t\tconst angle = utils.angle(points[0], points[this.order], points[1]);\n\t\tthis.clockwise = angle > 0;\n\t}\n\n\tlength() {\n\t\treturn utils.length(this.derivative.bind(this));\n\t}\n\n\tstatic getABC(order = 2, S, B, E, t = 0.5) {\n\t\tconst u = utils.projectionratio(t, order),\n\t\t\tum = 1 - u,\n\t\t\tC = {\n\t\t\t\tx: u * S.x + um * E.x,\n\t\t\t\ty: u * S.y + um * E.y,\n\t\t\t},\n\t\t\ts = utils.abcratio(t, order),\n\t\t\tA = {\n\t\t\t\tx: B.x + (B.x - C.x) / s,\n\t\t\t\ty: B.y + (B.y - C.y) / s,\n\t\t\t};\n\t\treturn { A, B, C, S, E };\n\t}\n\n\tgetABC(t, B) {\n\t\tB = B || this.get(t);\n\t\tlet S = this.points[0];\n\t\tlet E = this.points[this.order];\n\t\treturn Bezier.getABC(this.order, S, B, E, t);\n\t}\n\n\tgetLUT(steps) {\n\t\tthis.verify();\n\t\tsteps = steps || 100;\n\t\tif (this._lut.length === steps) {\n\t\t\treturn this._lut;\n\t\t}\n\t\tthis._lut = [];\n\t\t// We want a range from 0 to 1 inclusive, so\n\t\t// we decrement and then use <= rather than <:\n\t\tsteps--;\n\t\tfor (let i = 0, p, t; i < steps; i++) {\n\t\t\tt = i / (steps - 1);\n\t\t\tp = this.compute(t);\n\t\t\tp.t = t;\n\t\t\tthis._lut.push(p);\n\t\t}\n\t\treturn this._lut;\n\t}\n\n\ton(point, error) {\n\t\terror = error || 5;\n\t\tconst lut = this.getLUT(),\n\t\t\thits = [];\n\t\tfor (let i = 0, c, t = 0; i < lut.length; i++) {\n\t\t\tc = lut[i];\n\t\t\tif (utils.dist(c, point) < error) {\n\t\t\t\thits.push(c);\n\t\t\t\tt += i / lut.length;\n\t\t\t}\n\t\t}\n\t\tif (!hits.length) return false;\n\t\treturn (t /= hits.length);\n\t}\n\n\tproject(point) {\n\t\t// step 1: coarse check\n\t\tconst LUT = this.getLUT(),\n\t\t\tl = LUT.length - 1,\n\t\t\tclosest = utils.closest(LUT, point),\n\t\t\tmpos = closest.mpos,\n\t\t\tt1 = (mpos - 1) / l,\n\t\t\tt2 = (mpos + 1) / l,\n\t\t\tstep = 0.1 / l;\n\n\t\t// step 2: fine check\n\t\tlet mdist = closest.mdist,\n\t\t\tt = t1,\n\t\t\tft = t,\n\t\t\tp;\n\t\tmdist += 1;\n\t\tfor (let d; t < t2 + step; t += step) {\n\t\t\tp = this.compute(t);\n\t\t\td = utils.dist(point, p);\n\t\t\tif (d < mdist) {\n\t\t\t\tmdist = d;\n\t\t\t\tft = t;\n\t\t\t}\n\t\t}\n\t\tft = ft < 0 ? 0 : ft > 1 ? 1 : ft;\n\t\tp = this.compute(ft);\n\t\tp.t = ft;\n\t\tp.d = mdist;\n\t\treturn p;\n\t}\n\n\tget(t) {\n\t\treturn this.compute(t);\n\t}\n\n\tpoint(idx) {\n\t\treturn this.points[idx];\n\t}\n\n\tcompute(t) {\n\t\tif (this.ratios) {\n\t\t\treturn utils.computeWithRatios(t, this.points, this.ratios, this._3d);\n\t\t}\n\t\treturn utils.compute(t, this.points, this._3d, this.ratios);\n\t}\n\n\traise() {\n\t\tconst p = this.points,\n\t\t\tnp = [p[0]],\n\t\t\tk = p.length;\n\t\tfor (let i = 1, pi, pim; i < k; i++) {\n\t\t\tpi = p[i];\n\t\t\tpim = p[i - 1];\n\t\t\tnp[i] = {\n\t\t\t\tx: ((k - i) / k) * pi.x + (i / k) * pim.x,\n\t\t\t\ty: ((k - i) / k) * pi.y + (i / k) * pim.y,\n\t\t\t};\n\t\t}\n\t\tnp[k] = p[k - 1];\n\t\treturn new Bezier(np);\n\t}\n\n\tderivative(t) {\n\t\treturn utils.compute(t, this.dpoints[0]);\n\t}\n\n\tdderivative(t) {\n\t\treturn utils.compute(t, this.dpoints[1]);\n\t}\n\n\talign() {\n\t\tlet p = this.points;\n\t\treturn new Bezier(utils.align(p, { p1: p[0], p2: p[p.length - 1] }));\n\t}\n\n\tcurvature(t) {\n\t\treturn utils.curvature(t, this.dpoints[0], this.dpoints[1], this._3d);\n\t}\n\n\tinflections() {\n\t\treturn utils.inflections(this.points);\n\t}\n\n\tnormal(t) {\n\t\treturn this._3d ? this.__normal3(t) : this.__normal2(t);\n\t}\n\n\t__normal2(t) {\n\t\tconst d = this.derivative(t);\n\t\tconst q = sqrt$1(d.x * d.x + d.y * d.y);\n\t\treturn { x: -d.y / q, y: d.x / q };\n\t}\n\n\t__normal3(t) {\n\t\t// see http://stackoverflow.com/questions/25453159\n\t\tconst r1 = this.derivative(t),\n\t\t\tr2 = this.derivative(t + 0.01),\n\t\t\tq1 = sqrt$1(r1.x * r1.x + r1.y * r1.y + r1.z * r1.z),\n\t\t\tq2 = sqrt$1(r2.x * r2.x + r2.y * r2.y + r2.z * r2.z);\n\t\tr1.x /= q1;\n\t\tr1.y /= q1;\n\t\tr1.z /= q1;\n\t\tr2.x /= q2;\n\t\tr2.y /= q2;\n\t\tr2.z /= q2;\n\t\t// cross product\n\t\tconst c = {\n\t\t\tx: r2.y * r1.z - r2.z * r1.y,\n\t\t\ty: r2.z * r1.x - r2.x * r1.z,\n\t\t\tz: r2.x * r1.y - r2.y * r1.x,\n\t\t};\n\t\tconst m = sqrt$1(c.x * c.x + c.y * c.y + c.z * c.z);\n\t\tc.x /= m;\n\t\tc.y /= m;\n\t\tc.z /= m;\n\t\t// rotation matrix\n\t\tconst R = [\n\t\t\tc.x * c.x,\n\t\t\tc.x * c.y - c.z,\n\t\t\tc.x * c.z + c.y,\n\t\t\tc.x * c.y + c.z,\n\t\t\tc.y * c.y,\n\t\t\tc.y * c.z - c.x,\n\t\t\tc.x * c.z - c.y,\n\t\t\tc.y * c.z + c.x,\n\t\t\tc.z * c.z,\n\t\t];\n\t\t// normal vector:\n\t\tconst n = {\n\t\t\tx: R[0] * r1.x + R[1] * r1.y + R[2] * r1.z,\n\t\t\ty: R[3] * r1.x + R[4] * r1.y + R[5] * r1.z,\n\t\t\tz: R[6] * r1.x + R[7] * r1.y + R[8] * r1.z,\n\t\t};\n\t\treturn n;\n\t}\n\n\thull(t) {\n\t\tlet p = this.points,\n\t\t\t_p = [],\n\t\t\tq = [],\n\t\t\tidx = 0;\n\t\tq[idx++] = p[0];\n\t\tq[idx++] = p[1];\n\t\tq[idx++] = p[2];\n\t\tif (this.order === 3) {\n\t\t\tq[idx++] = p[3];\n\t\t}\n\t\t// we lerp between all points at each iteration, until we have 1 point left.\n\t\twhile (p.length > 1) {\n\t\t\t_p = [];\n\t\t\tfor (let i = 0, pt, l = p.length - 1; i < l; i++) {\n\t\t\t\tpt = utils.lerp(t, p[i], p[i + 1]);\n\t\t\t\tq[idx++] = pt;\n\t\t\t\t_p.push(pt);\n\t\t\t}\n\t\t\tp = _p;\n\t\t}\n\t\treturn q;\n\t}\n\n\tsplit(t1, t2) {\n\t\t// shortcuts\n\t\tif (t1 === 0 && !!t2) {\n\t\t\treturn this.split(t2).left;\n\t\t}\n\t\tif (t2 === 1) {\n\t\t\treturn this.split(t1).right;\n\t\t}\n\n\t\t// no shortcut: use \"de Casteljau\" iteration.\n\t\tconst q = this.hull(t1);\n\t\tconst result = {\n\t\t\tleft:\n\t\t\t\tthis.order === 2\n\t\t\t\t\t? new Bezier([q[0], q[3], q[5]])\n\t\t\t\t\t: new Bezier([q[0], q[4], q[7], q[9]]),\n\t\t\tright:\n\t\t\t\tthis.order === 2\n\t\t\t\t\t? new Bezier([q[5], q[4], q[2]])\n\t\t\t\t\t: new Bezier([q[9], q[8], q[6], q[3]]),\n\t\t\tspan: q,\n\t\t};\n\n\t\t// make sure we bind _t1/_t2 information!\n\t\tresult.left._t1 = utils.map(0, 0, 1, this._t1, this._t2);\n\t\tresult.left._t2 = utils.map(t1, 0, 1, this._t1, this._t2);\n\t\tresult.right._t1 = utils.map(t1, 0, 1, this._t1, this._t2);\n\t\tresult.right._t2 = utils.map(1, 0, 1, this._t1, this._t2);\n\n\t\t// if we have no t2, we're done\n\t\tif (!t2) {\n\t\t\treturn result;\n\t\t}\n\n\t\t// if we have a t2, split again:\n\t\tt2 = utils.map(t2, t1, 1, 0, 1);\n\t\treturn result.right.split(t2).left;\n\t}\n\n\textrema() {\n\t\tconst result = {};\n\t\tlet roots = [];\n\n\t\tthis.dims.forEach(\n\t\t\tfunction (dim) {\n\t\t\t\tlet mfn = function (v) {\n\t\t\t\t\treturn v[dim];\n\t\t\t\t};\n\t\t\t\tlet p = this.dpoints[0].map(mfn);\n\t\t\t\tresult[dim] = utils.droots(p);\n\t\t\t\tif (this.order === 3) {\n\t\t\t\t\tp = this.dpoints[1].map(mfn);\n\t\t\t\t\tresult[dim] = result[dim].concat(utils.droots(p));\n\t\t\t\t}\n\t\t\t\tresult[dim] = result[dim].filter(function (t) {\n\t\t\t\t\treturn t >= 0 && t <= 1;\n\t\t\t\t});\n\t\t\t\troots = roots.concat(result[dim].sort(utils.numberSort));\n\t\t\t}.bind(this)\n\t\t);\n\n\t\tresult.values = roots.sort(utils.numberSort).filter(function (v, idx) {\n\t\t\treturn roots.indexOf(v) === idx;\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tbbox() {\n\t\tconst extrema = this.extrema(),\n\t\t\tresult = {};\n\t\tthis.dims.forEach(\n\t\t\tfunction (d) {\n\t\t\t\tresult[d] = utils.getminmax(this, d, extrema[d]);\n\t\t\t}.bind(this)\n\t\t);\n\t\treturn result;\n\t}\n\n\toverlaps(curve) {\n\t\tconst lbbox = this.bbox(),\n\t\t\ttbbox = curve.bbox();\n\t\treturn utils.bboxoverlap(lbbox, tbbox);\n\t}\n\n\toffset(t, d) {\n\t\tif (typeof d !== \"undefined\") {\n\t\t\tconst c = this.get(t),\n\t\t\t\tn = this.normal(t);\n\t\t\tconst ret = {\n\t\t\t\tc: c,\n\t\t\t\tn: n,\n\t\t\t\tx: c.x + n.x * d,\n\t\t\t\ty: c.y + n.y * d,\n\t\t\t};\n\t\t\tif (this._3d) {\n\t\t\t\tret.z = c.z + n.z * d;\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\tif (this._linear) {\n\t\t\tconst nv = this.normal(0),\n\t\t\t\tcoords = this.points.map(function (p) {\n\t\t\t\t\tconst ret = {\n\t\t\t\t\t\tx: p.x + t * nv.x,\n\t\t\t\t\t\ty: p.y + t * nv.y,\n\t\t\t\t\t};\n\t\t\t\t\tif (p.z && nv.z) {\n\t\t\t\t\t\tret.z = p.z + t * nv.z;\n\t\t\t\t\t}\n\t\t\t\t\treturn ret;\n\t\t\t\t});\n\t\t\treturn [new Bezier(coords)];\n\t\t}\n\t\treturn this.reduce().map(function (s) {\n\t\t\tif (s._linear) {\n\t\t\t\treturn s.offset(t)[0];\n\t\t\t}\n\t\t\treturn s.scale(t);\n\t\t});\n\t}\n\n\tsimple() {\n\t\tif (this.order === 3) {\n\t\t\tconst a1 = utils.angle(this.points[0], this.points[3], this.points[1]);\n\t\t\tconst a2 = utils.angle(this.points[0], this.points[3], this.points[2]);\n\t\t\tif ((a1 > 0 && a2 < 0) || (a1 < 0 && a2 > 0)) return false;\n\t\t}\n\t\tconst n1 = this.normal(0);\n\t\tconst n2 = this.normal(1);\n\t\tlet s = n1.x * n2.x + n1.y * n2.y;\n\t\tif (this._3d) {\n\t\t\ts += n1.z * n2.z;\n\t\t}\n\t\treturn abs$1(acos$1(s)) < pi$1 / 3;\n\t}\n\n\treduce() {\n\t\t// TODO: examine these var types in more detail...\n\t\tlet i,\n\t\t\tt1 = 0,\n\t\t\tt2 = 0,\n\t\t\tstep = 0.01,\n\t\t\tsegment,\n\t\t\tpass1 = [],\n\t\t\tpass2 = [];\n\t\t// first pass: split on extrema\n\t\tlet extrema = this.extrema().values;\n\t\tif (extrema.indexOf(0) === -1) {\n\t\t\textrema = [0].concat(extrema);\n\t\t}\n\t\tif (extrema.indexOf(1) === -1) {\n\t\t\textrema.push(1);\n\t\t}\n\n\t\tfor (t1 = extrema[0], i = 1; i < extrema.length; i++) {\n\t\t\tt2 = extrema[i];\n\t\t\tsegment = this.split(t1, t2);\n\t\t\tsegment._t1 = t1;\n\t\t\tsegment._t2 = t2;\n\t\t\tpass1.push(segment);\n\t\t\tt1 = t2;\n\t\t}\n\n\t\t// second pass: further reduce these segments to simple segments\n\t\tpass1.forEach(function (p1) {\n\t\t\tt1 = 0;\n\t\t\tt2 = 0;\n\t\t\twhile (t2 <= 1) {\n\t\t\t\tfor (t2 = t1 + step; t2 <= 1 + step; t2 += step) {\n\t\t\t\t\tsegment = p1.split(t1, t2);\n\t\t\t\t\tif (!segment.simple()) {\n\t\t\t\t\t\tt2 -= step;\n\t\t\t\t\t\tif (abs$1(t1 - t2) < step) {\n\t\t\t\t\t\t\t// we can never form a reduction\n\t\t\t\t\t\t\treturn [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsegment = p1.split(t1, t2);\n\t\t\t\t\t\tsegment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n\t\t\t\t\t\tsegment._t2 = utils.map(t2, 0, 1, p1._t1, p1._t2);\n\t\t\t\t\t\tpass2.push(segment);\n\t\t\t\t\t\tt1 = t2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (t1 < 1) {\n\t\t\t\tsegment = p1.split(t1, 1);\n\t\t\t\tsegment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n\t\t\t\tsegment._t2 = p1._t2;\n\t\t\t\tpass2.push(segment);\n\t\t\t}\n\t\t});\n\t\treturn pass2;\n\t}\n\n\tscale(d) {\n\t\tconst order = this.order;\n\t\tlet distanceFn = false;\n\t\tif (typeof d === \"function\") {\n\t\t\tdistanceFn = d;\n\t\t}\n\t\tif (distanceFn && order === 2) {\n\t\t\treturn this.raise().scale(distanceFn);\n\t\t}\n\n\t\t// TODO: add special handling for degenerate (=linear) curves.\n\t\tconst clockwise = this.clockwise;\n\t\tconst r1 = distanceFn ? distanceFn(0) : d;\n\t\tconst r2 = distanceFn ? distanceFn(1) : d;\n\t\tconst v = [this.offset(0, 10), this.offset(1, 10)];\n\t\tconst points = this.points;\n\t\tconst np = [];\n\t\tconst o = utils.lli4(v[0], v[0].c, v[1], v[1].c);\n\n\t\tif (!o) {\n\t\t\tthrow new Error(\"cannot scale this curve. Try reducing it first.\");\n\t\t}\n\t\t// move all points by distance 'd' wrt the origin 'o'\n\n\t\t// move end points by fixed distance along normal.\n\t\t[0, 1].forEach(function (t) {\n\t\t\tconst p = (np[t * order] = utils.copy(points[t * order]));\n\t\t\tp.x += (t ? r2 : r1) * v[t].n.x;\n\t\t\tp.y += (t ? r2 : r1) * v[t].n.y;\n\t\t});\n\n\t\tif (!distanceFn) {\n\t\t\t// move control points to lie on the intersection of the offset\n\t\t\t// derivative vector, and the origin-through-control vector\n\t\t\t[0, 1].forEach((t) => {\n\t\t\t\tif (order === 2 && !!t) return;\n\t\t\t\tconst p = np[t * order];\n\t\t\t\tconst d = this.derivative(t);\n\t\t\t\tconst p2 = { x: p.x + d.x, y: p.y + d.y };\n\t\t\t\tnp[t + 1] = utils.lli4(p, p2, o, points[t + 1]);\n\t\t\t});\n\t\t\treturn new Bezier(np);\n\t\t}\n\n\t\t// move control points by \"however much necessary to\n\t\t// ensure the correct tangent to endpoint\".\n\t\t[0, 1].forEach(function (t) {\n\t\t\tif (order === 2 && !!t) return;\n\t\t\tvar p = points[t + 1];\n\t\t\tvar ov = {\n\t\t\t\tx: p.x - o.x,\n\t\t\t\ty: p.y - o.y,\n\t\t\t};\n\t\t\tvar rc = distanceFn ? distanceFn((t + 1) / order) : d;\n\t\t\tif (distanceFn && !clockwise) rc = -rc;\n\t\t\tvar m = sqrt$1(ov.x * ov.x + ov.y * ov.y);\n\t\t\tov.x /= m;\n\t\t\tov.y /= m;\n\t\t\tnp[t + 1] = {\n\t\t\t\tx: p.x + rc * ov.x,\n\t\t\t\ty: p.y + rc * ov.y,\n\t\t\t};\n\t\t});\n\t\treturn new Bezier(np);\n\t}\n\n\toutline(d1, d2, d3, d4) {\n\t\td2 = typeof d2 === \"undefined\" ? d1 : d2;\n\t\tconst reduced = this.reduce(),\n\t\t\tlen = reduced.length,\n\t\t\tfcurves = [];\n\n\t\tlet bcurves = [],\n\t\t\tp,\n\t\t\talen = 0,\n\t\t\ttlen = this.length();\n\n\t\tconst graduated = typeof d3 !== \"undefined\" && typeof d4 !== \"undefined\";\n\n\t\tfunction linearDistanceFunction(s, e, tlen, alen, slen) {\n\t\t\treturn function (v) {\n\t\t\t\tconst f1 = alen / tlen,\n\t\t\t\t\tf2 = (alen + slen) / tlen,\n\t\t\t\t\td = e - s;\n\t\t\t\treturn utils.map(v, 0, 1, s + f1 * d, s + f2 * d);\n\t\t\t};\n\t\t}\n\n\t\t// form curve oulines\n\t\treduced.forEach(function (segment) {\n\t\t\tconst slen = segment.length();\n\t\t\tif (graduated) {\n\t\t\t\tfcurves.push(\n\t\t\t\t\tsegment.scale(linearDistanceFunction(d1, d3, tlen, alen, slen))\n\t\t\t\t);\n\t\t\t\tbcurves.push(\n\t\t\t\t\tsegment.scale(linearDistanceFunction(-d2, -d4, tlen, alen, slen))\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfcurves.push(segment.scale(d1));\n\t\t\t\tbcurves.push(segment.scale(-d2));\n\t\t\t}\n\t\t\talen += slen;\n\t\t});\n\n\t\t// reverse the \"return\" outline\n\t\tbcurves = bcurves\n\t\t\t.map(function (s) {\n\t\t\t\tp = s.points;\n\t\t\t\tif (p[3]) {\n\t\t\t\t\ts.points = [p[3], p[2], p[1], p[0]];\n\t\t\t\t} else {\n\t\t\t\t\ts.points = [p[2], p[1], p[0]];\n\t\t\t\t}\n\t\t\t\treturn s;\n\t\t\t})\n\t\t\t.reverse();\n\n\t\t// form the endcaps as lines\n\t\tconst fs = fcurves[0].points[0],\n\t\t\tfe = fcurves[len - 1].points[fcurves[len - 1].points.length - 1],\n\t\t\tbs = bcurves[len - 1].points[bcurves[len - 1].points.length - 1],\n\t\t\tbe = bcurves[0].points[0],\n\t\t\tls = utils.makeline(bs, fs),\n\t\t\tle = utils.makeline(fe, be),\n\t\t\tsegments = [ls].concat(fcurves).concat([le]).concat(bcurves);\n\n\t\treturn new PolyBezier(segments);\n\t}\n\n\toutlineshapes(d1, d2, curveIntersectionThreshold) {\n\t\td2 = d2 || d1;\n\t\tconst outline = this.outline(d1, d2).curves;\n\t\tconst shapes = [];\n\t\tfor (let i = 1, len = outline.length; i < len / 2; i++) {\n\t\t\tconst shape = utils.makeshape(\n\t\t\t\toutline[i],\n\t\t\t\toutline[len - i],\n\t\t\t\tcurveIntersectionThreshold\n\t\t\t);\n\t\t\tshape.startcap.virtual = i > 1;\n\t\t\tshape.endcap.virtual = i < len / 2 - 1;\n\t\t\tshapes.push(shape);\n\t\t}\n\t\treturn shapes;\n\t}\n\n\tintersects(curve, curveIntersectionThreshold) {\n\t\tif (!curve) return this.selfintersects(curveIntersectionThreshold);\n\t\tif (curve.p1 && curve.p2) {\n\t\t\treturn this.lineIntersects(curve);\n\t\t}\n\t\tif (curve instanceof Bezier) {\n\t\t\tcurve = curve.reduce();\n\t\t}\n\t\treturn this.curveintersects(\n\t\t\tthis.reduce(),\n\t\t\tcurve,\n\t\t\tcurveIntersectionThreshold\n\t\t);\n\t}\n\n\tlineIntersects(line) {\n\t\tconst mx = min(line.p1.x, line.p2.x),\n\t\t\tmy = min(line.p1.y, line.p2.y),\n\t\t\tMX = max(line.p1.x, line.p2.x),\n\t\t\tMY = max(line.p1.y, line.p2.y);\n\t\treturn utils.roots(this.points, line).filter((t) => {\n\t\t\tvar p = this.get(t);\n\t\t\treturn utils.between(p.x, mx, MX) && utils.between(p.y, my, MY);\n\t\t});\n\t}\n\n\tselfintersects(curveIntersectionThreshold) {\n\t\t// \"simple\" curves cannot intersect with their direct\n\t\t// neighbour, so for each segment X we check whether\n\t\t// it intersects [0:x-2][x+2:last].\n\n\t\tconst reduced = this.reduce(),\n\t\t\tlen = reduced.length - 2,\n\t\t\tresults = [];\n\n\t\tfor (let i = 0, result, left, right; i < len; i++) {\n\t\t\tleft = reduced.slice(i, i + 1);\n\t\t\tright = reduced.slice(i + 2);\n\t\t\tresult = this.curveintersects(left, right, curveIntersectionThreshold);\n\t\t\tresults.push(...result);\n\t\t}\n\t\treturn results;\n\t}\n\n\tcurveintersects(c1, c2, curveIntersectionThreshold) {\n\t\tconst pairs = [];\n\t\t// step 1: pair off any overlapping segments\n\t\tc1.forEach(function (l) {\n\t\t\tc2.forEach(function (r) {\n\t\t\t\tif (l.overlaps(r)) {\n\t\t\t\t\tpairs.push({ left: l, right: r });\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t// step 2: for each pairing, run through the convergence algorithm.\n\t\tlet intersections = [];\n\t\tpairs.forEach(function (pair) {\n\t\t\tconst result = utils.pairiteration(\n\t\t\t\tpair.left,\n\t\t\t\tpair.right,\n\t\t\t\tcurveIntersectionThreshold\n\t\t\t);\n\t\t\tif (result.length > 0) {\n\t\t\t\tintersections = intersections.concat(result);\n\t\t\t}\n\t\t});\n\t\treturn intersections;\n\t}\n\n\tarcs(errorThreshold) {\n\t\terrorThreshold = errorThreshold || 0.5;\n\t\treturn this._iterate(errorThreshold, []);\n\t}\n\n\t_error(pc, np1, s, e) {\n\t\tconst q = (e - s) / 4,\n\t\t\tc1 = this.get(s + q),\n\t\t\tc2 = this.get(e - q),\n\t\t\tref = utils.dist(pc, np1),\n\t\t\td1 = utils.dist(pc, c1),\n\t\t\td2 = utils.dist(pc, c2);\n\t\treturn abs$1(d1 - ref) + abs$1(d2 - ref);\n\t}\n\n\t_iterate(errorThreshold, circles) {\n\t\tlet t_s = 0,\n\t\t\tt_e = 1,\n\t\t\tsafety;\n\t\t// we do a binary search to find the \"good `t` closest to no-longer-good\"\n\t\tdo {\n\t\t\tsafety = 0;\n\n\t\t\t// step 1: start with the maximum possible arc\n\t\t\tt_e = 1;\n\n\t\t\t// points:\n\t\t\tlet np1 = this.get(t_s),\n\t\t\t\tnp2,\n\t\t\t\tnp3,\n\t\t\t\tarc,\n\t\t\t\tprev_arc;\n\n\t\t\t// booleans:\n\t\t\tlet curr_good = false,\n\t\t\t\tprev_good = false,\n\t\t\t\tdone;\n\n\t\t\t// numbers:\n\t\t\tlet t_m = t_e,\n\t\t\t\tprev_e = 1;\n\n\t\t\t// step 2: find the best possible arc\n\t\t\tdo {\n\t\t\t\tprev_good = curr_good;\n\t\t\t\tprev_arc = arc;\n\t\t\t\tt_m = (t_s + t_e) / 2;\n\n\t\t\t\tnp2 = this.get(t_m);\n\t\t\t\tnp3 = this.get(t_e);\n\n\t\t\t\tarc = utils.getccenter(np1, np2, np3);\n\n\t\t\t\t//also save the t values\n\t\t\t\tarc.interval = {\n\t\t\t\t\tstart: t_s,\n\t\t\t\t\tend: t_e,\n\t\t\t\t};\n\n\t\t\t\tlet error = this._error(arc, np1, t_s, t_e);\n\t\t\t\tcurr_good = error <= errorThreshold;\n\n\t\t\t\tdone = prev_good && !curr_good;\n\t\t\t\tif (!done) prev_e = t_e;\n\n\t\t\t\t// this arc is fine: we can move 'e' up to see if we can find a wider arc\n\t\t\t\tif (curr_good) {\n\t\t\t\t\t// if e is already at max, then we're done for this arc.\n\t\t\t\t\tif (t_e >= 1) {\n\t\t\t\t\t\t// make sure we cap at t=1\n\t\t\t\t\t\tarc.interval.end = prev_e = 1;\n\t\t\t\t\t\tprev_arc = arc;\n\t\t\t\t\t\t// if we capped the arc segment to t=1 we also need to make sure that\n\t\t\t\t\t\t// the arc's end angle is correct with respect to the bezier end point.\n\t\t\t\t\t\tif (t_e > 1) {\n\t\t\t\t\t\t\tlet d = {\n\t\t\t\t\t\t\t\tx: arc.x + arc.r * cos$1(arc.e),\n\t\t\t\t\t\t\t\ty: arc.y + arc.r * sin$1(arc.e),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tarc.e += utils.angle({ x: arc.x, y: arc.y }, d, this.get(1));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t// if not, move it up by half the iteration distance\n\t\t\t\t\tt_e = t_e + (t_e - t_s) / 2;\n\t\t\t\t} else {\n\t\t\t\t\t// this is a bad arc: we need to move 'e' down to find a good arc\n\t\t\t\t\tt_e = t_m;\n\t\t\t\t}\n\t\t\t} while (!done && safety++ < 100);\n\n\t\t\tif (safety >= 100) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// console.log(\"L835: [F] arc found\", t_s, prev_e, prev_arc.x, prev_arc.y, prev_arc.s, prev_arc.e);\n\n\t\t\tprev_arc = prev_arc ? prev_arc : arc;\n\t\t\tcircles.push(prev_arc);\n\t\t\tt_s = prev_e;\n\t\t} while (t_e < 1);\n\t\treturn circles;\n\t}\n}\n\nexport { Bezier };","\nimport { BezierTool, ToolMode } from './BezierTool';\nimport { PointArrayInputHandler, InputHandler, PointInputHandler, InitializerInputHandler } from \"./ToolInputHandler\";\nimport { CurvyWallControl } from '../CurvyWallsToolBar';\nimport { Bezier } from '../../libs/bezier';\n\nconst pointNearPoint = BezierTool.pointNearPoint;\ndeclare type Point = PIXI.Point;\n\nclass InitializerIH extends InitializerInputHandler {\n\tprivate get quadTool(): QuadTool { return this.tool as QuadTool; }\n\tconstructor(tool: QuadTool, success: () => void, fail: () => void) {\n\t\tsuper(tool, false, tool.lineA, tool.lineB, success, fail);\n\t}\n\tmove(origin: Point, destination: Point, event: PIXI.InteractionEvent): void {\n\t\tsuper.move(origin, destination, event);\n\t\tconst cX = (this.tool.lineB.x + this.tool.lineA.x) / 2;\n\t\tconst cY = (this.tool.lineB.y + this.tool.lineA.y) / 2;\n\t\tlet nY = -(this.tool.lineB.x - this.tool.lineA.x);\n\t\tlet nX = this.tool.lineB.y - this.tool.lineA.y;\n\t\t// const length = Math.sqrt((nX * nX) + (nY * nY));\n\t\tnX *= 0.25;\n\t\tnY *= 0.25;\n\t\tthis.quadTool.control.set(cX + nX, cY + nY);\n\t}\n}\n\nexport default class QuadTool extends BezierTool {\n\tprivate bezier: Bezier;\n\tlineA = new PIXI.Point();\n\tlineB = new PIXI.Point();\n\tcontrol = new PIXI.Point();\n\n\tget handles(): Point[] { return [this.lineA, this.control, this.lineB]; }\n\tget bounds(): PIXI.Bounds {\n\t\tconst b = new PIXI.Bounds();\n\t\tb.addPoint(this.lineA);\n\t\tb.addPoint(this.lineB);\n\t\tb.addPoint(this.control);\n\t\treturn b;\n\t}\n\tget polygon(): PIXI.Polygon { return new PIXI.Polygon([this.lineA, this.lineB, this.control]); }\n\n\tconstructor(segments: number = 10) {\n\t\tsuper(segments);\n\t\t// this.bezier = new Bezier([0, 0, 0, 0, 0, 0]);\n\t}\n\n\tgetSegments(count: number): PIXI.Point[] | PIXI.Point[][] {\n\t\tif (this.mode == ToolMode.NotPlaced) return [];\n\t\tthis.bezier = Bezier.quadraticFromPoints(this.lineA, this.control, this.lineB);\n\t\t// this.bezier.points = this.handles;\n\t\t// this.bezier.update();\n\t\treturn (this.lastSegmentFetch = this.bezier.getLUT(count + 2).map((e: { x: number, y: number }) => new PIXI.Point(e.x, e.y)));\n\t}\n\tdrawHandles(context: PIXI.Graphics): void {\n\t\tif (this.mode == ToolMode.NotPlaced) return;\n\t\tthis.drawBoundingBox(context);\n\t\t// context.beginFill(0xffaacc)\n\t\t// \t.lineStyle(BezierTool.LINE_SIZE, 0xffaacc, 1, 0.5)\n\t\t// \t.moveTo(this.lineA.x, this.lineA.y)\n\t\t// \t.lineTo(this.control.x, this.control.y)\n\t\t// \t.moveTo(this.lineB.x, this.lineB.y)\n\t\t// \t.lineTo(this.control.x, this.control.y)\n\t\t// \t.endFill();\n\t\tsuper.drawSegmentLabel(context);\n\t\tthis.drawHandle(context, 0xff4444, this.lineA);\n\t\tthis.drawHandle(context, 0xff4444, this.lineB);\n\t\tthis.drawHandle(context, 0xaaff44, this.control);\n\t}\n\tcheckPointForDrag(point: Point): InputHandler | null {\n\t\tif (this.mode == ToolMode.NotPlaced) {\n\t\t\tthis.setMode(ToolMode.Placing);\n\t\t\treturn new InitializerIH(this, () => this.setMode(ToolMode.Placed), () => this.setMode(ToolMode.NotPlaced));\n\t\t}\n\t\tif (pointNearPoint(point, this.lineA, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.lineA);\n\t\telse if (pointNearPoint(point, this.lineB, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.lineB);\n\t\telse if (pointNearPoint(point, this.control, BezierTool.HANDLE_RADIUS))\n\t\t\treturn new PointInputHandler(this, this.control);\n\t\telse if (this.polygon.contains(point.x, point.y))\n\t\t\treturn new PointArrayInputHandler(this, point, this.handles);\n\t\treturn null;\n\t}\n\n\tgetTools(): Record<string, CurvyWallControl> { return {}; }\n\tplaceTool(point: PIXI.Point, data: { l1: number[], l2: number[], c: number[] }) {\n\t\tthis.lineA.set(data.l1[0] + point.x, data.l1[1] + point.y);\n\t\tthis.lineB.set(data.l2[0] + point.x, data.l2[1] + point.y);\n\t\tthis.control.set(data.c[0] + point.x, data.c[1] + point.y);\n\t\tthis.setMode(ToolMode.Placed);\n\t}\n\tgetData() {\n\t\tconst center = this.lineCenter;\n\t\treturn {\n\t\t\tl1: [this.lineA.x - center.x, this.lineA.y - center.y],\n\t\t\tl2: [this.lineB.x - center.x, this.lineB.y - center.y],\n\t\t\tc: [this.control.x - center.x, this.control.y - center.y]\n\t\t};\n\t}\n}","import { CurvyWallControl } from \"../CurvyWallsToolBar\";\nimport { CurvyWallToolManager, Mode } from \"../CurvyWallToolManager\";\nimport { Bezier } from \"../../libs/bezier\";\nimport { BezierTool } from \"./BezierTool\";\nimport { InputHandler, PointInputHandler } from \"./ToolInputHandler\";\n\nconst pointNearPoint = BezierTool.pointNearPoint;\n\nexport default class PointMapper extends BezierTool {\n\tget handles(): PIXI.Point[] {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\tget bounds(): PIXI.Bounds {\n\t\tconst b = new PIXI.Bounds();\n\t\tthis.points.forEach(x => b.addPoint(x));\n\t\treturn b;\n\t}\n\tlineA = new PIXI.Point();\n\tlineB = new PIXI.Point();\n\tpoints: PIXI.Point[] = [];\n\n\tdrawHandles(context: PIXI.Graphics): void {\n\t\tthis.drawBoundingBox(context);\n\t\tswitch (CurvyWallToolManager.instance.mode) {\n\t\t\t// case Mode.Cube:\n\t\t\t// \tif (this.points.length < 3) break;\n\t\t\t// \tlet lines = Bezier.cubicFromPoints(this.points[0], this.points[1], this.points[2])\n\t\t\t// \t\t.getLUT().map((p: { x: number, y: number }) => new PIXI.Point(p.x, p.y));\n\t\t\t// \tcontext.beginFill(0, 0).lineStyle(6, 0xffaacc, 1, 0.5)\n\t\t\t// \tcontext.moveTo(lines[0].x, lines[0].y)\n\t\t\t// \tfor (let c = 1; c < lines.length; c++)\n\t\t\t// \t\tcontext.lineTo(lines[c].x, lines[c].y)\n\t\t\t// \tcontext.endFill();\n\t\t\t// \tbreak;\n\t\t\tcase Mode.Quad:\n\t\t\t\tif (this.points.length < 3) break;\n\t\t\t\tconst lines = Bezier.quadraticFromPoints(this.points[0], this.points[1], this.points[2])\n\t\t\t\t\t.getLUT().map((p: { x: number, y: number }) => new PIXI.Point(p.x, p.y));\n\t\t\t\tcontext.beginFill(0, 0).lineStyle(6, 0xffaacc, 1, 0.5);\n\t\t\t\tcontext.moveTo(lines[0].x, lines[0].y);\n\t\t\t\tfor (let c = 1; c < lines.length; c++)\n\t\t\t\t\tcontext.lineTo(lines[c].x, lines[c].y);\n\t\t\t\tcontext.endFill();\n\t\t\t\tbreak;\n\t\t\tcase Mode.Circ:\n\t\t\t\tif (this.points.length < 2) break;\n\t\t\t\tconst dimensions = this._calculateCircle();\n\t\t\t\tcontext.beginFill(0, 0)\n\t\t\t\t\t.lineStyle(6, 0xffaacc, 1, 0.5)\n\t\t\t\t\t.drawEllipse(dimensions.x, dimensions.y, dimensions.w, dimensions.h)\n\t\t\t\t\t.endFill();\n\t\t\t\tbreak;\n\t\t\tcase Mode.Rect:\n\t\t\t\tif (this.points.length == 0) break;\n\t\t\t\tconst bounds = this.bounds;\n\t\t\t\tcontext.beginFill(0, 0)\n\t\t\t\t\t.lineStyle(6, 0xffaacc, 1, 0.5)\n\t\t\t\t\t.drawRect(bounds.minX, bounds.minY, bounds.maxX - bounds.minX, bounds.maxY - bounds.minY)\n\t\t\t\t\t.endFill();\n\t\t\t\tbreak;\n\t\t}\n\t\tconst fill = [0x44ffaa, 0xff4444, 0x4444ff, 0xdd44dd, 0xdddd44];\n\t\tthis.points.forEach((x, idx) => this.drawHandle(context, fill[idx], x));\n\t}\n\tcheckPointForClick(point: PIXI.Point, event: PIXI.InteractionEvent): boolean {\n\t\tconst utility = new PointInputHandler(this, point);\n\t\tconst snap = utility.shouldSnap(event);\n\n\t\tif (event.data.originalEvent.ctrlKey) {\n\t\t\tconst handle = this.points.findIndex(e => pointNearPoint(point, e, BezierTool.HANDLE_RADIUS));\n\t\t\tif (handle < 0) return false;\n\t\t\tthis.points.splice(handle, 1);\n\t\t\treturn true;\n\t\t}\n\t\t// If we are clicking on an already existing point, or we have max points\n\t\tif (this.points.find(e => pointNearPoint(point, e, BezierTool.HANDLE_RADIUS))) return false;\n\n\t\tswitch (CurvyWallToolManager.instance.mode) {\n\t\t\t// case Mode.Cube:\n\t\t\tcase Mode.Quad:\n\t\t\t\tif (this.points.length == 3) return false;\n\t\t\t\tthis.points.push(utility.getWallEndPoint(point, snap));\n\t\t\t\treturn true;\n\t\t\tcase Mode.Circ:\n\t\t\t// if (this.points.length == 4) return false;\n\t\t\t// this.points.push(utility.getWallEndPoint(point, snap));\n\t\t\t// return true;\n\t\t\t\t// fallthrough\n\t\t\tcase Mode.Rect:\n\t\t\t\tif (this.points.length == 4) return false;\n\t\t\t\tthis.points.push(utility.getWallEndPoint(point, snap));\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\tcheckPointForDrag(point: PIXI.Point): InputHandler | null {\n\t\tconst target = this.points.find(x => pointNearPoint(point, x, BezierTool.HANDLE_RADIUS));\n\t\tif (!target) return null;\n\t\treturn new PointInputHandler(this, target);\n\t}\n\n\tgetTooltipMessage(): string {\n\t\tswitch (CurvyWallToolManager.instance.mode) {\n\t\t\t// case Mode.Cube:\n\t\t\t// \treturn \"You need to place 3 points to generate a Bezier Cubic Curve.\";\n\t\t\tcase Mode.Quad: return \"df-curvy-walls.pointmap_quad\";\n\t\t\tcase Mode.Circ: return \"df-curvy-walls.pointmap_circ\";\n\t\t\tcase Mode.Rect: return \"df-curvy-walls.pointmap_rect\";\n\t\t}\n\t\treturn \"\";\n\t}\n\thasEnoughData(): boolean {\n\t\tswitch (CurvyWallToolManager.instance.mode) {\n\t\t\t// case Mode.Cube:\n\t\t\tcase Mode.Quad:\n\t\t\t\treturn this.points.length == 3;\n\t\t\tcase Mode.Circ:\n\t\t\tcase Mode.Rect:\n\t\t\t\treturn this.points.length >= 2;\n\t\t}\n\t\treturn false;\n\t}\n\n\tbindData(tool: BezierTool) {\n\t\tswitch (CurvyWallToolManager.instance.mode) {\n\t\t\t// case Mode.Cube:\n\t\t\t// \tcurve = Bezier.cubicFromPoints(this.points[0], this.points[1], this.points[2]);\n\t\t\t// \ttool.lineA.copyFrom(curve.points[0]);\n\t\t\t// \ttool.lineB.copyFrom(curve.points[3]);\n\t\t\t// \t(<PIXI.Point>(<any>tool).controlA).copyFrom(curve.points[1]);\n\t\t\t// \t(<PIXI.Point>(<any>tool).controlB).copyFrom(curve.points[2]);\n\t\t\t// \tbreak;\n\t\t\tcase Mode.Quad:\n\t\t\t\ttool.lineA.copyFrom(this.points[0]);\n\t\t\t\ttool.lineB.copyFrom(this.points[2]);\n\t\t\t\t(<PIXI.Point>(<any>tool).control).copyFrom(this.points[1]);\n\t\t\t\tbreak;\n\t\t\tcase Mode.Circ:\n\t\t\t\tconst dimens = this._calculateCircle();\n\t\t\t\ttool.lineA.set(dimens.x - dimens.w, dimens.y - dimens.h);\n\t\t\t\ttool.lineB.set(dimens.x + dimens.w, dimens.y + dimens.h);\n\t\t\t\tbreak;\n\t\t\tcase Mode.Rect:\n\t\t\t\tconst bounds = this.bounds;\n\t\t\t\ttool.lineA.set(bounds.minX, bounds.minY);\n\t\t\t\ttool.lineB.set(bounds.maxX, bounds.maxY);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate _calculateCircle(): { x: number, y: number, w: number, h: number } {\n\t\tconst result: { x: number, y: number, w: number, h: number } = { x: 0, y: 0, w: 0, h: 0 };\n\t\tif (this.points.length == 2) {\n\t\t\tresult.x = this.points[0].x;\n\t\t\tresult.y = this.points[0].y;\n\t\t\tconst size = Math.sqrt(Math.pow(this.points[1].x - result.x, 2) + Math.pow(this.points[1].y - result.y, 2));\n\t\t\tresult.w = size;\n\t\t\tresult.h = size;\n\t\t} else if (this.points.length == 3) {\n\t\t\tconst p1 = this.points[0];\n\t\t\tconst p2 = this.points[1];\n\t\t\tconst p3 = this.points[2];\n\t\t\tconst circle = generateCircle(p1, p2, p3);\n\t\t\tresult.x = circle.center.x;\n\t\t\tresult.y = circle.center.y;\n\t\t\tresult.w = circle.radius;\n\t\t\tresult.h = circle.radius;\n\t\t} else if (this.points.length == 4) {\n\t\t\tconst bounds = this.bounds;\n\t\t\tresult.x = (bounds.minX + bounds.maxX) / 2;\n\t\t\tresult.y = (bounds.minY + bounds.maxY) / 2;\n\t\t\tresult.w = (bounds.maxX - bounds.minX) / 2;\n\t\t\tresult.h = (bounds.maxY - bounds.minY) / 2;\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSegments(_count: number): PIXI.Point[] | PIXI.Point[][] { throw new Error(\"Method not implemented.\"); }\n\tplaceTool(_point: PIXI.Point, _data: object): void { throw new Error(\"Method not implemented.\"); }\n\tgetData(): object { throw new Error(\"Method not implemented.\"); }\n\tgetTools(): Record<string, CurvyWallControl> { throw new Error(\"Method not implemented.\"); }\n}\n\nfunction isPerpendicular(p1: Point, p2: Point, p3: Point): boolean {\n\tconst yDelta_a: number = p2.y - p1.y;\n\tconst xDelta_a: number = p2.x - p1.x;\n\tconst yDelta_b: number = p3.y - p2.y;\n\tconst xDelta_b: number = p3.x - p2.x;\n\t// checking whether the line of the two pts are vertical\n\tif (Math.abs(xDelta_a) <= 0.000000001 && Math.abs(yDelta_b) <= 0.000000001) {\n\t\treturn false;\n\t}\n\tif (Math.abs(yDelta_a) <= 0.0000001) return true;\n\telse if (Math.abs(yDelta_b) <= 0.0000001) return true;\n\telse if (Math.abs(xDelta_a) <= 0.000000001) return true;\n\telse if (Math.abs(xDelta_b) <= 0.000000001) return true;\n\telse return false;\n}\nfunction calcCircle(pt1: Point, pt2: Point, pt3: Point): { center: Point, radius: number } {\n\tconst yDelta_a = pt2.y - pt1.y;\n\tconst xDelta_a = pt2.x - pt1.x;\n\tconst yDelta_b = pt3.y - pt2.y;\n\tconst xDelta_b = pt3.x - pt2.x;\n\tconst center = new PIXI.Point();\n\tlet radius = 0;\n\n\tif (Math.abs(xDelta_a) <= 0.000000001 && Math.abs(yDelta_b) <= 0.000000001) {\n\t\tcenter.x = 0.5 * (pt2.x + pt3.x);\n\t\tcenter.y = 0.5 * (pt1.y + pt2.y);\n\t\tradius = Math.sqrt(Math.pow(pt1.x - center.x, 2) + Math.pow(pt1.y - center.y, 2));\n\t\treturn { center, radius };\n\t}\n\n\t// IsPerpendicular() assure that xDelta(s) are not zero\n\tconst aSlope = yDelta_a / xDelta_a;\n\tconst bSlope = yDelta_b / xDelta_b;\n\tif (Math.abs(aSlope - bSlope) <= 0.000000001) {// checking whether the given points are colinear. \t\n\t\treturn { center, radius: -1 };\n\t}\n\n\t// calc center\n\tcenter.x = (aSlope * bSlope * (pt1.y - pt3.y) + bSlope * (pt1.x + pt2.x) - aSlope * (pt2.x + pt3.x)) / (2 * (bSlope - aSlope));\n\tcenter.y = -1 * (center.x - (pt1.x + pt2.x) / 2) / aSlope + (pt1.y + pt2.y) / 2;\n\n\tradius = Math.sqrt(Math.pow(pt1.x - center.x, 2) + Math.pow(pt1.y - center.y, 2));\n\treturn { center, radius };\n}\n\nfunction generateCircle(pt1: Point, pt2: Point, pt3: Point): { center: Point, radius: number } {\n\tif (!isPerpendicular(pt1, pt2, pt3)) return calcCircle(pt1, pt2, pt3);\n\telse if (!isPerpendicular(pt1, pt3, pt2)) return calcCircle(pt1, pt3, pt2);\n\telse if (!isPerpendicular(pt2, pt1, pt3)) return calcCircle(pt2, pt1, pt3);\n\telse if (!isPerpendicular(pt2, pt3, pt1)) return calcCircle(pt2, pt3, pt1);\n\telse if (!isPerpendicular(pt3, pt2, pt1)) return calcCircle(pt3, pt2, pt1);\n\telse if (!isPerpendicular(pt3, pt1, pt2)) return calcCircle(pt3, pt1, pt2);\n\telse return { center: null, radius: -1 };\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { CurvyWallsToolBar } from './CurvyWallsToolBar';\nimport { CurvyWallToolManager, Mode } from './CurvyWallToolManager';\nimport SETTINGS from \"../../common/Settings\";\nimport { BezierTool } from './tools/BezierTool';\n\nconst curvyWallApp = new CurvyWallsToolBar();\nSETTINGS.init('df-curvy-walls');\n\nHooks.once('init', function () {\n\tSETTINGS.register(CurvyWallsToolBar.PREF_PRESERVE, {\n\t\tscope: 'world',\n\t\ttype: Boolean,\n\t\tconfig: true,\n\t\tdefault: true,\n\t\tname: 'df-curvy-walls.SettingPreserve_Name',\n\t\thint: 'df-curvy-walls.SettingPreserve_Hint',\n\t});\n\tSETTINGS.register(CurvyWallToolManager.PREF_DROP_KEY, {\n\t\tname: 'df-curvy-walls.SettingDropKey_Name',\n\t\thint: 'df-curvy-walls.SettingDropKey_Hint',\n\t\tconfig: true,\n\t\tscope: 'world',\n\t\tchoices: {\n\t\t\talt: 'df-curvy-walls.SettingDropKey_OptionAlt',\n\t\t\tctrl: 'df-curvy-walls.SettingDropKey_OptionCtrl'\n\t\t},\n\t\tdefault: 'alt',\n\t\ttype: String\n\t});\n\tSETTINGS.register(BezierTool.PREF_SMALL_HANDLES, {\n\t\tname: 'df-curvy-walls.SettingSmallHandlesName',\n\t\thint: 'df-curvy-walls.SettingSmallHandlesHint',\n\t\tconfig: true,\n\t\tscope: 'world',\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t});\n\n\tgame.keybindings.register(SETTINGS.MOD_NAME, 'applyTool', {\n\t\tname: 'df-curvy-walls.apply',\n\t\teditable: [{ key: \"Enter\" }],\n\t\tonDown: () => { CurvyWallToolManager.instance.apply(); }\n\t});\n\tgame.keybindings.register(SETTINGS.MOD_NAME, 'cancelTool', {\n\t\tname: 'df-curvy-walls.cancel',\n\t\teditable: [{ key: 'Delete' }],\n\t\tonDown: () => CurvyWallToolManager.instance.clearTool()\n\t});\n\tgame.keybindings.register(SETTINGS.MOD_NAME, 'incrementSegments', {\n\t\tname: 'df-curvy-walls.increment',\n\t\teditable: [{ key: 'Equal' }],\n\t\trepeat: true,\n\t\tonDown: () => { CurvyWallToolManager.instance.segments++; }\n\t});\n\tgame.keybindings.register(SETTINGS.MOD_NAME, 'decrementSegments', {\n\t\tname: 'df-curvy-walls.decrement',\n\t\teditable: [{ key: 'Minus' }],\n\t\trepeat: true,\n\t\tonDown: () => { CurvyWallToolManager.instance.segments--; }\n\t});\n\n\tCurvyWallsToolBar.init();\n\tCurvyWallToolManager.instance.init();\n});\n\nHooks.once(\"ready\", function () {\n\t// Exit if we do not have a canvas\n\tif (game.settings.get('core', 'noCanvas')) return;\n\tif (!game.modules.get('lib-wrapper')?.active) {\n\t\tconsole.error('Missing libWrapper module dependency');\n\t\tif (game.user.isGM)\n\t\t\tui.notifications.error(game.i18n.localize('df-curvy-walls.errorLibWrapperMissing'));\n\t\treturn;\n\t}\n\t// @ts-ignore\n\tcanvas.walls.bezier = CurvyWallToolManager.instance;\n\tCurvyWallToolManager.instance.patchWallsLayer();\n});\n\nlet moduleControls: ControlManager;\n\nHooks.on('renderSceneControls', async (controls: SceneControls) => {\n\t// Exit if we do not have a canvas\n\tif (game.settings.get('core', 'noCanvas')) return;\n\tif (!game.modules.get('lib-wrapper')?.active) return;\n\tif (!game.user.isGM) return;\n\tif (controls.activeControl !== 'walls') {\n\t\tawait curvyWallApp.close();\n\t\tif ((moduleControls as any)._state === 2)\n\t\t\tmoduleControls.refresh();\n\t\treturn;\n\t}\n\telse if ((moduleControls as any)._state === 2)\n\t\tmoduleControls.activateGroupByName(SETTINGS.MOD_NAME);\n\tcurvyWallApp.render(true);\n\tif (CurvyWallToolManager.instance.mode != Mode.None)\n\t\tCurvyWallToolManager.instance.render();\n});\n// Refresh the curvy wall controls when the button bar re-renders\nHooks.on('renderControlManager', () => curvyWallApp.render());\nHooks.on('getModuleToolGroupsPre', (app: ControlManager) => { moduleControls = app; });"],"names":["CurvyWallsToolBar","Application","constructor","options","super","_closing","_tools","beziercube","title","icon","isActive","CurvyWallToolManager","Mode","onClick","this","bezierquad","beziercirc","bezierrect","_generalControls","increment","decrement","apply","class","cancel","_placementControls","pointconstruct","toggleable","render","applyplacement","static","Hooks","on","controlManager","groups","push","name","visible","ui","controls","activeControl","tools","toggle","active","defaultOptions","mergeObject","popOut","template","getData","toolIsPlaced","ToolMode","toolControls","getTools","placementControls","Object","keys","map","it","general","includes","undefined","activateListeners","html","game","settings","get","remove","$","document","querySelector","append","css","moduleControls","getLeftWidth","getTopHeight","find","event","currentTarget","attr","tool","generalControl","placementControl","toolControl","close","PREF_PRESERVE","MODE_NAMES","None","Cube","Quad","Circ","Rect","WallPool","wallData","result","walls","pop","Wall","WallDocument","parent","canvas","scene","data","wall","_mode","currentHandler","_activeTool","_modeListener","_ignoreNextToolModeChange","_previousToolData","Map","l1","l2","c1","c2","c","a1","a2","t","r","b","l","_pointMapper","_inPointMapMode","graphicsContext","PIXI","Graphics","segments","value","Math","clamped","mode","activeTool","currentlyMappingPoints","instance","_instance","clearTool","togglePointMapping","points","setModeListener","toolMode","listener","async","scenes","viewed","createEmbeddedDocuments","e","wallsLayer","preview","removeChildren","notifications","info","i18n","localize","getTooltipMessage","permanent","forEach","x","canApplyPointMapping","hasEnoughData","applyPointMapping","bindData","setMode","wrapped","self","checkPointForClick","origin","originalEvent","ctrlKey","startedWithCtrlHeld","PREF_DROP_KEY","altKey","placeTool","checkPointForDrag","start","destination","move","stop","clearContext","clear","addChild","drawHandles","pointData","getSegments","length","_getWallDataFromActiveTool","release","removeChild","duplicate","y","acquire","draw","refresh","destroy","set","init","libWrapper","register","wrapper","args","patchWallsLayer","_onClickLeft","_onDragLeftStart","_onDragLeftMove","_onDragLeftDrop","_onDragLeftCancel","_onClickRight","BezierTool","NotPlaced","lastSegmentFetch","HANDLE_RADIUS","PREF_SMALL_HANDLES","TEXT_STYLE","TEXT_STYLE_BASE","fontSize","lineCenter","Point","lineA","lineB","_point","_event","_context","text","PreciseText","anchor","drawSegmentLabel","context","createText","position","drawBoundingBox","bounds","getRectangle","Rectangle","EMPTY","beginFill","lineStyle","LINE_SIZE","drawRoundedRect","left","top","width","height","endFill","drawHandle","fill","point","drawCircle","a","threshold","TextStyle","fontFamily","CONFIG","defaultFontFamily","stroke","strokeThickness","dropShadow","dropShadowColor","dropShadowBlur","max","round","dropShadowAngle","dropShadowDistance","padding","SETTINGS","moduleName","MOD_NAME","String","prototype","valueOf","key","config","registerMenu","default","pointNearPoint","PI2","PI","InitializerIH","InitializerInputHandler","success","fail","CircleTool","arcHandle","RotatorHandle","sliceHandle","ellipseclose","closeLoopIfSliced","enabled","call","ellipsefinish","finishSliceIfShort","ellipseinc","snapSetIndex","ANGLE_SNAP_STEPS","ellipsedec","handles","Bounds","addPoint","polygon","Polygon","minX","minY","maxX","maxY","angle","center","getCenter","rect","halfWidth","halfHeight","createVector","theta","magnitude","cos","sin","count","deltaTheta","sliceAngle","rawAngle","initialPoints","middle","arc","getHandlePoint","slice","moveTo","lineTo","snapAngle","toDegrees","toFixed","arcLabel","parseFloat","copyFrom","PointInputHandler","PointRotationHandler","contains","PointArrayInputHandler","magnet","_angle","ax","ay","InputHandler","original","setAngle","to","vecX","vecY","atan","shouldSnap","whole","trunc","_origin","_tool","snap","_getWallEndpointCoordinates","_forceSnap","shiftKey","getWallEndPoint","min","abs","squaring","destPoint","squarePoint","origPoint","completion","_originalPoint","originalPoints","clone","_start","moveAll","delta","o","i","copyTo","MagnetPointInputHandler","masterPoint","slavePoint","originalPoint","offsetX","offsetY","RectangleTool","lastCount","topCount","rightCount","bottomCount","leftCount","buttonRadius","buttonOffset","incTop","createLineLabel","decTop","incRight","decRight","incBottom","decBottom","incLeft","decLeft","textTop","textRight","textBottom","textLeft","tint","rotation","STYLE","drawSegmentLabels","drawButtons","size","cubicTool","dx","dy","sqrt","barLength","controlA","controlB","CubicTool","bezier","Bezier","update","getLUT","lockHandles","cubiclock","acos","atan2","pow","crt","v","pi","tau","quart","nMax","Number","MAX_SAFE_INTEGER","nMin","MIN_SAFE_INTEGER","ZERO","z","utils","Tvalues","Cvalues","arcfn","derivativeFn","d","compute","_3d","order","mt","p","ret","mt2","t2","dCpts","JSON","parse","stringify","splice","computeWithRatios","ratios","f1","f2","f3","f4","derive","dpoints","list","dpt","j","between","m","M","approximately","precision","len","sum","ds","de","ts","te","lerp","v1","v2","pointToString","s","pointsToString","join","copy","obj","dx1","dy1","dx2","dy2","pos","indexOf","substring","dist","p1","p2","closest","LUT","mpos","mdist","idx","abcratio","n","bottom","projectionratio","lli8","x1","y1","x2","y2","x3","y3","x4","y4","lli4","p3","p4","lli","makeline","findbbox","sections","mx","my","MX","MY","bbox","mid","shapeintersections","s1","bbox1","s2","bbox2","curveIntersectionThreshold","bboxoverlap","intersections","startcap","forward","back","endcap","virtual","iss","intersects","makeshape","bpl","fpl","end","shape","getminmax","curve","concat","align","line","tx","ty","roots","aligned","reduce","m1","m2","filter","pa","pb","pc","q","q2","discriminant","u1","mp3","phi","t1","sd","droots","curvature","d1","d2","kOnly","num","dnm","adk","dk","k","dd","qdsum","pk","nk","inflections","v3","trm","sq","b1","b2","dims","dim","expandbox","_bbox","pairiteration","c1b","c2b","_t1","_t2","cc1","split","cc2","pairs","right","pair","results","getccenter","dx1p","dy1p","dx2p","dy2p","mx1","my1","mx2","my2","mx1n","my1n","mx2n","my2n","_","numberSort","PolyBezier","curves","toString","addCurve","offset","abs$1","cos$1","sin$1","acos$1","sqrt$1","pi$1","coords","Array","from","arguments","coordlen","newargs","higher","Error","step","dimlen","_linear","some","_lut","abc","getABC","A","S","B","E","C","selen","lx","ly","bx1","by1","bx2","by2","e1","e2","nc1","nc2","getUtils","toSVG","last","setRatios","verify","print","coordDigest","_print","computedirection","clockwise","derivative","bind","u","um","steps","error","lut","hits","project","ft","raise","np","pim","dderivative","normal","__normal3","__normal2","r1","r2","q1","R","hull","_p","pt","span","extrema","mfn","sort","values","overlaps","lbbox","tbbox","nv","scale","simple","n1","n2","segment","pass1","pass2","distanceFn","ov","rc","outline","d3","d4","reduced","fcurves","bcurves","alen","tlen","graduated","linearDistanceFunction","slen","reverse","fs","fe","bs","be","ls","le","outlineshapes","shapes","lineIntersects","curveintersects","selfintersects","arcs","errorThreshold","_iterate","_error","np1","ref","circles","safety","t_s","t_e","np2","np3","prev_arc","done","curr_good","prev_good","t_m","prev_e","interval","quadTool","cX","cY","nY","nX","control","QuadTool","PointMapper","lines","dimensions","_calculateCircle","drawEllipse","w","h","drawRect","utility","handle","findIndex","target","dimens","circle","generateCircle","pt1","pt2","pt3","isPerpendicular","radius","calcCircle","_count","_data","yDelta_a","xDelta_a","yDelta_b","xDelta_b","aSlope","bSlope","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","definition","defineProperty","enumerable","prop","hasOwnProperty","Symbol","toStringTag","curvyWallApp","once","scope","type","Boolean","hint","choices","alt","ctrl","keybindings","editable","onDown","repeat","modules","console","user","isGM","_state","activateGroupByName","app"],"sourceRoot":""}