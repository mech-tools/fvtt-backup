{"version":3,"file":"token-action-hud-core.min.js","sources":["../scripts/constants.js","../scripts/utils.js","../scripts/data-handler.js","../scripts/action-handlers/generic-action-handler.js","../scripts/action-handlers/compendium-action-handler.js","../scripts/action-handlers/macro-action-handler.js","../scripts/action-handlers/action-handler.js","../scripts/action-handlers/action-handler-extender.js","../scripts/migration-manager.js","../scripts/roll-handlers/roll-handler.js","../scripts/roll-handlers/pre-roll-handler.js","../scripts/forms/custom-style-form.js","../scripts/forms/settings-form.js","../scripts/settings.js","../scripts/action-handlers/item-macro-extender.js","../scripts/roll-handlers/compendium-macro-pre-handler.js","../scripts/roll-handlers/pre-item-macro.js","../scripts/system-manager.js","../node_modules/@yaireo/dragsort/dist/dragsort.js","../node_modules/@yaireo/tagify/dist/tagify.min.js","../scripts/dialogs/tag-dialog.js","../scripts/dialogs/tag-dialog-helper.js","../scripts/group-resizer.js","../scripts/token-action-hud.js","../scripts/init.js"],"sourcesContent":["/**\n * Module-based constants\n */\nexport const MODULE = {\n    ID: 'token-action-hud-core',\n    NAME: 'Token Action HUD'\n}\n\n/**\n * Template directory\n */\nconst TEMPLATE_DIR = `modules/${MODULE.ID}/templates`\n\n/**\n * Templates\n */\nexport const TEMPLATE = {\n    action: `${TEMPLATE_DIR}/action.hbs`,\n    customStyleForm: `${TEMPLATE_DIR}/custom-style-form.hbs`,\n    group: `${TEMPLATE_DIR}/group.hbs`,\n    hud: `${TEMPLATE_DIR}/hud.hbs`,\n    listGroup: `${TEMPLATE_DIR}/list-group.hbs`,\n    settings: `${TEMPLATE_DIR}/settings.hbs`,\n    tabGroup: `${TEMPLATE_DIR}/tab-group.hbs`,\n    tagDialogGroup: `${TEMPLATE_DIR}/tag-dialog-group.hbs`,\n    tagDialogHud: `${TEMPLATE_DIR}/tag-dialog-hud.hbs`,\n    tagDialogTopLevelGroup: `${TEMPLATE_DIR}/tag-dialog-top-level-group.hbs`\n}\n\n/**\n * Delimiter character\n */\nexport const DELIMITER = '|'\n\n/**\n * Action types\n */\nexport const ACTION_TYPE = {\n    compendiumEntry: 'tokenActionHud.compendiumEntry',\n    compendiumMacro: 'tokenActionHud.compendiumMacro',\n    compendiumPlaylist: 'tokenActionHud.compendiumPlaylist',\n    macro: 'tokenActionHud.macro'\n}\n\n/**\n * Compendium action types\n */\nexport const COMPENDIUM_ACTION_TYPES = ['compendiumEntry', 'compendiumMacro', 'compendiumPlaylist', 'macro']\n\n/**\n * Compendium pack types\n */\nexport const COMPENDIUM_PACK_TYPES = ['JournalEntry', 'Macro', 'RollTable']\n\n/**\n * CSS styles\n */\nexport const CSS_STYLE = {\n    foundryVTT: {\n        class: 'tah-style-foundry-vtt-dark',\n        file: 'tah-foundry-vtt-dark',\n        moduleId: MODULE.ID,\n        name: 'Foundry VTT Dark',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    foundryVttLight: {\n        class: 'tah-style-foundry-vtt-light',\n        file: 'tah-foundry-vtt-light',\n        moduleId: MODULE.ID,\n        name: 'Foundry VTT Light',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    compact: {\n        class: 'tah-style-foundry-vtt',\n        file: 'tah-compact',\n        moduleId: MODULE.ID,\n        name: 'Foundry VTT Compact',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    dorakoUI: {\n        class: 'tah-style-dorako-ui',\n        file: 'tah-dorako',\n        moduleId: MODULE.ID,\n        name: 'Dorako UI'\n    },\n    pathfinder: {\n        class: 'tah-style-pathfinder',\n        file: 'tah-pathfinder',\n        moduleId: MODULE.ID,\n        name: 'Pathfinder'\n    },\n    highContrast: {\n        class: 'tah-style-high-contrast',\n        file: 'tah-high-contrast',\n        moduleId: MODULE.ID,\n        name: 'High Contrast',\n        primaryColor: '#ffff00',\n        secondaryColor: '#ffff00',\n        tertiaryColor: '#0C7BDC'\n    },\n    custom: {\n        class: 'tah-style-custom',\n        file: 'tah-custom',\n        moduleId: MODULE.ID,\n        name: 'Custom'\n    },\n}\n\n/**\n * Custom styles\n */\nexport const CUSTOM_STYLE = {\n    backgroundColor: { cssProperty: '--tah-background-color', type: String, default: '#00000000' },\n    buttonHeight: { cssProperty: '--tah-button-height-editable', type: Number, default: 32 },\n    buttonBackgroundColor: { cssProperty: '--tah-button-background-color-editable', type: String, default: '#000000b3' },\n    buttonBorderPrimaryColor: { cssProperty: '--tah-button-border-primary-color-editable', type: String, default: '#0C0C0CFF' },\n    buttonBorderSecondaryColor: { cssProperty: '--tah-button-border-secondary-color-editable', type: String, default: '#060606FF' },\n    buttonTextColor: { cssProperty: '--tah-button-text-color-editable', type: String, default: '#DDDDDDFF' },\n    buttonHoverBorderPrimaryColor: { cssProperty: '--tah-button-hover-border-primary-color-editable', type: String, default: '#FF6400FF' },\n    buttonHoverBorderSecondaryColor: { cssProperty: '--tah-button-hover-border-secondary-color-editable', type: String, default: '#FF0000FF' },\n    buttonHoverBackgroundColor: { cssProperty: '--tah-button-hover-background-color-editable', type: String, default: '#000000B3' },\n    buttonHoverTextColor: { cssProperty: '--tah-button-hover-text-color-editable', type: String, default: '#FFFFFFFF' },\n    buttonToggleActiveBackgroundColor: { cssProperty: '--tah-button-toggle-active-background-color-editable', type: String, default: '#3C0078BF' },\n    buttonToggleActiveBorderPrimaryColor: { cssProperty: '--tah-button-toggle-active-border-primary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleActiveBorderSecondaryColor: { cssProperty: '--tah-button-toggle-active-border-secondary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleActiveTextColor: { cssProperty: '--tah-button-toggle-active-text-color-editable', type: String, default: '#FFFFFFFF' },\n    buttonToggleHoverBackgroundColor: { cssProperty: '--tah-button-toggle-hover-background-color-editable', type: String, default: '#3C0078BF' },\n    buttonToggleHoverBorderPrimaryColor: { cssProperty: '--tah-button-toggle-hover-border-primary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleHoverBorderSecondaryColor: { cssProperty: '--tah-button-toggle-hover-secondary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleHoverTextColor: { cssProperty: '--tah-button-toggle-hover-text-color-editable', type: String, default: '#FFFFFFFF' },\n    textPrimaryColor: { cssProperty: '--tah-text-primary-color-editable', type: String, default: '#DDDDDDFF' },\n    textSecondaryColor: { cssProperty: '--tah-text-secondary-color-editable', type: String, default: '#DDDDDD80' },\n    textTertiaryColor: { cssProperty: '--tah-text-tertiary-color-editable', type: String, default: '#FF6400FF' },\n    textHoverPrimaryColor: { cssProperty: '--tah-text-hover-primary-color-editable', type: String, default: '#DDDDDDFF' },\n    textHoverSecondaryColor: { cssProperty: '--tah-text-hover-secondary-color-editable', type: String, default: '#DDDDDD80' },\n    textHoverTertiaryColor: { cssProperty: '--tah-text-tertiary-color-editable', type: String, default: '#FF6400FF' }\n}\n\n/**\n * Group types\n */\nexport const GROUP_TYPE = {\n    COMPENDIUM: 'compendium',\n    CUSTOM: 'custom',\n    SYSTEM: 'system',\n    SYSTEM_DERIVED: 'system-derived'\n}\n\n/**\n * Item Macro icon\n */\nexport const ITEM_MACRO_ICON = {\n    ICON: 'fas fa-sd-card',\n    TOOLTIP: 'Item Macro'\n}\n\n/**\n * Layout settings\n */\nexport const LAYOUT_SETTING = {\n    customLayout: {\n        hint: 'tokenActionHud.settings.customLayout.hint',\n        name: 'tokenActionHud.settings.customLayout.name',\n        inputType: 'filePicker',\n        filePickerType: 'json',\n        dtype: 'String',\n        scope: 'world'\n    },\n    userCustomLayout: {\n        hint: 'tokenActionHud.settings.userCustomLayout.hint',\n        name: 'tokenActionHud.settings.userCustomLayout.name',\n        inputType: 'filePicker',\n        filePickerType: 'json',\n        dtype: 'String',\n        scope: 'user'\n    },\n    exportLayout: {\n        hint: 'tokenActionHud.settings.exportLayout.hint',\n        label: 'tokenActionHud.settings.exportLayout.label',\n        name: 'tokenActionHud.settings.exportLayout.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-file-export',\n        onClick: 'game?.tokenActionHud?.actionHandler?.exportLayout()'\n    },\n    resetLayout: {\n        hint: 'tokenActionHud.settings.resetLayout.hint',\n        label: 'tokenActionHud.settings.resetLayout.label',\n        name: 'tokenActionHud.settings.resetLayout.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-arrow-rotate-left',\n        onClick: 'game?.tokenActionHud?.resetDialog()',\n        scope: 'client'\n    },\n    resetAllLayouts: {\n        hint: 'tokenActionHud.settings.resetAllLayouts.hint',\n        label: 'tokenActionHud.settings.resetAllLayouts.label',\n        name: 'tokenActionHud.settings.resetAllLayouts.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-bomb',\n        onClick: 'game?.tokenActionHud?.resetAllDialog()',\n        scope: 'world'\n    }\n}\n\n/**\n * Settings\n */\nexport const SETTING = {\n    activeCssAsText: { classes: ['TokenActionHud'], variable: 'activeCssAsTextSetting' },\n    allow: { classes: ['TokenActionHud'], variable: 'allowSetting' },\n    alwaysShowHud: { classes: ['TokenActionHud'], variable: 'alwaysShowHudSetting' },\n    backgroundColor: {},\n    buttonBackgroundColor: {},\n    buttonBorderPrimaryColor: {},\n    buttonBorderSecondaryColor: {},\n    buttonHeight: {},\n    buttonHoverBorderPrimaryColor: {},\n    buttonHoverBorderSecondaryColor: {},\n    buttonHoverBackgroundColor: {},\n    buttonHoverTextColor: {},\n    buttonTextColor: {},\n    buttonToggleActiveBackgroundColor: {},\n    buttonToggleActiveBorderPrimaryColor: {},\n    buttonToggleActiveBorderSecondaryColor: {},\n    buttonToggleActiveTextColor: {},\n    buttonToggleHoverBackgroundColor: {},\n    buttonToggleHoverBorderPrimaryColor: {},\n    buttonToggleHoverBorderSecondaryColor: {},\n    buttonToggleHoverTextColor: {},\n    clickOpenCategory: { classes: ['TokenActionHud'], variable: 'clickOpenCategorySetting' },\n    customLayout: { classes: ['ActionHandler'], variable: 'customLayoutSetting' },\n    customStyle: {},\n    debug: { classes: ['TokenActionHud'], variable: 'debugSetting' },\n    direction: { classes: ['TokenActionHud'], variable: 'directionSetting' },\n    displayCharacterName: { classes: ['TokenActionHud'], variable: 'displayCharacterName' },\n    displayIcons: { classes: ['TokenActionHud'], variable: 'displayIconsSetting' },\n    drag: { classes: ['TokenActionHud'], variable: 'dragSetting' },\n    enable: { classes: ['TokenActionHud'], variable: 'enableSetting' },\n    enableCustomization: { classes: ['ActionHandler', 'TokenActionHud'], variable: 'enableCustomizationSetting' },\n    grid: { classes: ['TokenActionHud'], variable: 'gridSetting' },\n    itemMacro: {},\n    migrationVersion: {},\n    reset: {},\n    renderItemOnRightClick: {},\n    rollHandler: { default: 'core' },\n    scale: { classes: ['TokenActionHud'], variable: 'scaleSetting' },\n    sortActions: { classes: ['ActionHandler'], variable: 'sortActionsSetting' },\n    startup: {},\n    style: {},\n    tooltips: { classes: ['ActionHandler'], variable: 'tooltipsSetting' },\n    textPrimaryColor: {},\n    textSecondaryColor: {},\n    textTertiaryColor: {},\n    textHoverPrimaryColor: {},\n    textHoverSecondaryColor: {},\n    textHoverTertiaryColor: {},\n    userCustomLayout: { classes: ['ActionHandler'], variable: 'userCustomLayoutFlag' }\n}\n","import { CSS_STYLE, CUSTOM_STYLE, MODULE } from './constants.js'\n\n/**\n * Console logger\n */\nexport class Logger {\n    static info (message, notify = false) {\n        if (notify) ui.notifications.info(`Token Action HUD | ${message}`)\n        else console.log(`Token Action HUD Info | ${message}`)\n    }\n\n    static error (message, notify = false) {\n        if (notify) ui.notifications.error(`Token Action HUD | ${message}`)\n        else console.error(`Token Action HUD Error | ${message}`)\n    }\n\n    static debug (message, data) {\n        const isDebug = (game.tokenActionHud) ? game.tokenActionHud.debugSetting : Utils.getSetting('debug')\n        if (isDebug) {\n            if (!data) {\n                console.log(`Token Action HUD Debug | ${message}`)\n                return\n            }\n            const dataClone = Utils.deepClone(data)\n            console.log(`Token Action HUD Debug | ${message}`, dataClone)\n        }\n    }\n}\n\n/**\n * Timer for setting and aborting timeouts\n */\nexport class Timer {\n    constructor (milliseconds) {\n        this.milliseconds = milliseconds\n        this.timer = null\n    }\n\n    async start () {\n        if (this.timer) this.abort()\n        return new Promise(resolve => {\n            this.timer = setTimeout(() => { resolve() }, this.milliseconds ?? 100)\n        })\n    }\n\n    async abort () {\n        clearTimeout(this.timer)\n        this.timer = null\n    }\n}\n\nexport class Utils {\n    /**\n    * Whether the user is allowed to use the HUD\n    * @public\n    * @param {number} userRole The user's role\n    * @returns {boolean}\n    */\n    static checkAllow (userRole, allowSetting) {\n        if (userRole >= allowSetting) return true\n        return false\n    }\n\n    /**\n     * Foundry VTT's deepClone function wrapped here to avoid code error highlighting due to missing definition.\n     * @public\n     * @param {*} original\n     * @param {*} options\n     */\n    static deepClone (original, options) {\n        // eslint-disable-next-line no-undef\n        return foundry.utils.deepClone(original, options)\n    }\n\n    /**\n     * Get actor from the token or actor object\n     * @public\n     * @param {string} actorId The actor id\n     * @param {string} tokenId The token id\n     * @returns {object}       The actor\n     */\n    static getActor (actorId, tokenId) {\n        let token = null\n        if (tokenId) token = canvas.tokens.placeables.find((token) => token.id === tokenId)\n        if (token) return token.actor\n        return game.actors.get(actorId)\n    }\n\n    /**\n     * Get status effect from actor based on the status id\n     * @param {object} actor    The actor\n     * @param {string} statusId The status id\n     * @returns {object}        The status effect\n     */\n    static getStatusEffect (actor, statusId) {\n        if (foundry.utils.isNewerVersion(game.version, '10')) {\n            return actor.effects.find((effect) => effect.statuses.every((status) => status === statusId))\n        } else {\n            // V10\n            return actor.effects.find((effect) => effect.flags?.core?.statusId === statusId)\n        }\n    }\n\n    /**\n     * Get image from entity\n     * @public\n     * @param {object} entity       The entity, e.g., actor, item\n     * @param {array} defaultImages Any default images to exclude\n     * @returns {string}            The image URL\n     */\n    static getImage (entity, defaultImages = []) {\n        defaultImages.push('icons/svg/mystery-man.svg')\n        let result = ''\n        if (game.tokenActionHud.displayIconsSetting) result = (typeof entity === 'string') ? entity : entity?.img ?? entity?.icon ?? ''\n        return !defaultImages.includes(result) ? result : ''\n    }\n\n    /**\n     * Get item from the actor object\n     * @public\n     * @param {object} actor  The actor\n     * @param {string} itemId The item id\n     * @returns {object}      The item\n     */\n    static getItem (actor, itemId) {\n        return actor.items.get(itemId)\n    }\n\n    /**\n     * Get token\n     * @public\n     * @param {string} tokenId The token id\n     * @returns {object}       The token\n     */\n    static getToken (tokenId) {\n        return canvas.tokens.placeables.find((token) => token.id === tokenId)\n    }\n\n    /**\n     * Get controlled tokens\n     * @public\n     * @returns {array} The controlled tokens\n     */\n    static getControlledTokens () {\n        return game.canvas.tokens?.controlled ?? []\n    }\n\n    /**\n     * Get first controlled tokens\n     * @public\n     * @returns {object} The first controlled token\n     */\n    static getFirstControlledToken () {\n        const controlledToken = game.canvas.tokens.controlled[0]\n        if (controlledToken) {\n            return controlledToken\n        }\n        const character = game.user?.character\n        if (character) {\n            return canvas.tokens.placeables.find(token => token.actor?.id === character.id)\n        }\n    }\n\n    /**\n     * Get setting value\n     * @public\n     * @param {string} key               The setting key\n     * @param {string=null} defaultValue The setting default value\n     * @returns {*}                      The setting value\n     */\n    static getSetting (key, defaultValue = null) {\n        let value = defaultValue ?? null\n        try {\n            value = game.settings.get(MODULE.ID, key)\n        } catch {\n            Logger.debug(`Setting '${key}' not found`)\n        }\n        return value\n    }\n\n    /**\n     * Set setting value\n     * @public\n     * @param {string} key   The setting key\n     * @param {string} value The setting value\n     */\n    static async setSetting (key, value) {\n        if (game.settings.settings.get(`${MODULE.ID}.${key}`)) {\n            await game.settings.set(MODULE.ID, key, value)\n            Logger.debug(`Setting '${key}' set to '${value}'`)\n        } else {\n            if (key !== 'debug') {\n                Logger.debug(`Setting '${key}' not found`)\n            }\n        }\n    }\n\n    /**\n     * Get module actor flag\n     * @public\n     * @param {string} key The flag key\n     * @returns {*}        The flag value\n     */\n    static getActorFlag (key) {\n        return game.tokenActionHud.actor.getFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Set module actor flag\n     * @public\n     * @param {string} key The flag key\n     * @param {*} value    The flag value\n     */\n    static async setActorFlag (key, value) {\n        await game.tokenActionHud.actor.setFlag(MODULE.ID, key, value)\n    }\n\n    /**\n     * Unset module actor flag\n     * @public\n     * @param {string} key The flag key\n     */\n    static async unsetActorFlag (key) {\n        await game.tokenActionHud.actor.unsetFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Get module user flag\n     * @public\n     * @param {string} key The flag key\n     * @returns {*}        The flag value\n     */\n    static getUserFlag (key) {\n        return game.user.getFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Set module user flag\n     * @public\n     * @param {string} key The flag key\n     * @param {*} value    The flag value\n     */\n    static async setUserFlag (key, value) {\n        await game.user.setFlag(MODULE.ID, key, value)\n    }\n\n    /**\n     * Unset module user flag\n     * @public\n     * @param {string} key The flag key\n     */\n    static async unsetUserFlag (key) {\n        await game.user.unsetFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Language translation\n     * @public\n     * @param {string} toTranslate The value to translate\n     * @returns {string}           The translated value\n     */\n    static i18n (toTranslate) {\n        return game.i18n.localize(toTranslate)\n    }\n\n    /**\n     * Whether a GM is active\n     * @public\n     * @returns {boolean} Whether a GM is active\n     */\n    static isGmActive () {\n        return game.users.some(user => user.isGM && user.active)\n    }\n\n    /**\n     * Whether the given module is active\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {boolean}       Whether the given module is active\n     */\n    static isModuleActive (moduleId) {\n        const module = game.modules.get(moduleId)\n        return module && module.active\n    }\n\n    /**\n     * Get the given module's title\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {string}        The module title\n     */\n    static getModuleTitle (moduleId) {\n        return game.modules.get(moduleId)?.title ?? ''\n    }\n\n    /**\n     * Get the given module's version\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {string}        The module version\n     */\n    static getModuleVersion (moduleId) {\n        return game.modules.get(moduleId)?.version ?? ''\n    }\n\n    /**\n     * Humanize keybinding\n     * @param {object} key The keybinding key\n     * @returns {string}   The humanized keybinding\n     */\n    static humanizeBinding (key) {\n        const binding = game.keybindings.get(MODULE.ID, key)\n        if (!binding) return ''\n        const stringParts = binding[0].modifiers.reduce((parts, part) => {\n            if (KeyboardManager.MODIFIER_CODES[part]?.includes(binding[0].key)) return parts\n            parts.unshift(KeyboardManager.getKeycodeDisplayString(part))\n            return parts\n        }, [KeyboardManager.getKeycodeDisplayString(binding[0].key)])\n        return stringParts.join(' + ')\n    }\n\n    /**\n     * Get the median\n     * @public\n     * @param {array} numbers The array of numbers\n     * @returns {number}      The median\n     */\n    static median (numbers) {\n        const mid = Math.floor(numbers.length / 2)\n        const nums = [...numbers].sort((a, b) => a - b)\n        return numbers.length % 2 !== 0 ? nums[mid] : (nums[mid - 1] + nums[mid]) / 2\n    }\n\n    /**\n     * Get upper quartile average\n     * @param {array} numbers The numbers\n     * @returns {number}      The upper quartile average\n     */\n    static getUpperQuartileAverage (numbers) {\n        const sortedNumbers = numbers.slice().sort((a, b) => a - b)\n        const length = sortedNumbers.length\n        const startIndex = Math.ceil(length * 0.75)\n        const endIndex = length - 1\n\n        let sum = 0\n        let count = 0\n\n        for (let i = startIndex; i <= endIndex; i++) {\n            sum += sortedNumbers[i]\n            count++\n        }\n\n        const upperQuartileAverage = sum / count\n\n        return upperQuartileAverage\n    }\n\n    /**\n     * Get modifier\n     * @param {number} value The value\n     * @returns {string}     The modifier\n     */\n    static getModifier (value) {\n        if (!value && value !== 0) return ''\n        const sign = (value >= 0) ? '+' : ''\n        return `${sign}${value}`\n    }\n\n    /**\n     * Sort items\n     * @public\n     * @param {object} items The items\n     * @returns {object}     The sorted items\n     */\n    static sortItems (items) {\n        return new Map([...items.entries()].sort((a, b) => a[1].sort.localeCompare(b[1].sort)))\n    }\n\n    /**\n     * Sort items by name\n     * @public\n     * @param {object} items The items\n     * @returns {object}     The sorted items\n     */\n    static sortItemsByName (items) {\n        return new Map([...items.entries()].sort((a, b) => a[1].name.localeCompare(b[1].name)))\n    }\n\n    /**\n     * Enable stylesheet based on setting and disable all other stylesheets\n     * @public\n     * @param {string} style The 'style' setting value\n     */\n    static switchCSS (style) {\n        for (const [key, value] of Object.entries(CSS_STYLE)) {\n            const href = [`modules/${value.moduleId}/`, `${value.file}`]\n            if (key === style) {\n                Object.values(document.styleSheets).find(\n                    (ss) => ss.href?.includes(href[0]) && ss.href?.includes(href[1])\n                ).disabled = false\n            } else {\n                Object.values(document.styleSheets).find(\n                    (ss) => ss.href?.includes(href[0]) && ss.href?.includes(href[1])\n                ).disabled = true\n            }\n        }\n\n        if (style === 'custom') {\n            for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n                const setting = Utils.getSetting(key)\n                if (setting) {\n                    document.querySelector(':root').style.setProperty(value.cssProperty, setting)\n                }\n            }\n        }\n\n        const tahElement = document.querySelector('#token-action-hud')\n        if (tahElement) {\n            tahElement.classList.remove(...tahElement.classList)\n            tahElement.classList.add(CSS_STYLE[style].class)\n        }\n    }\n\n    /**\n     * Register Handlebar helpers\n     * @public\n     */\n    static registerHandlebars () {\n        // Capitalise first character\n        Handlebars.registerHelper('tokenActionHudCoreCap', function (string) {\n            if (!string || string.length < 1) return ''\n            return string[0].toUpperCase() + string.slice(1)\n        })\n        const reduceOp = function (args, reducer) {\n            args = Array.from(args)\n            args.pop() // => options\n            const first = args.shift()\n            return args.reduce(reducer, first)\n        }\n\n        // Support operators\n        Handlebars.registerHelper({\n            tokenActionHudCoreTrue: function () { return reduceOp(arguments, (a) => a) }\n        })\n\n        // Add asterisk to toggleable actions\n        Handlebars.registerHelper('tokenActionHudCoreActiveText', function (block) {\n            if (game.tokenActionHud.activeCssAsTextSetting) {\n                return block.fn(this)\n            }\n            return block.inverse(this)\n        })\n    }\n\n    /**\n     * Get the major, minor and patch parts of the module version\n     * @public\n     * @param {string} moduleVersion The module version\n     * @returns {object}             The module version parts\n     */\n    static getModuleVersionParts (moduleVersion) {\n        if (!moduleVersion) {\n            Logger.debug('Module version not retrieved', { trigger: 'getModuleVersionParts' })\n            return\n        }\n        const moduleVersionParts = moduleVersion.split('.')\n        return {\n            major: moduleVersionParts[0],\n            minor: moduleVersionParts[1],\n            patch: moduleVersionParts[2]\n        }\n    }\n\n    /**\n     * Whether the system module is compatible with the core module version\n     * @public\n     * @param {object} systemModuleCoreModuleVersion The system module's required core module version\n     * @returns {boolean}\n     */\n    static checkModuleCompatibility (requiredCoreModuleVersion) {\n        // Get core module version in parts\n        const requiredCoreModuleVersionParts = this.getModuleVersionParts(requiredCoreModuleVersion)\n        const coreModuleVersionParts = this.getModuleVersionParts(game.modules.get(MODULE.ID).version)\n\n        if (coreModuleVersionParts.major !== requiredCoreModuleVersionParts.major ||\n            coreModuleVersionParts.minor !== requiredCoreModuleVersionParts.minor ||\n            (requiredCoreModuleVersionParts.patch && coreModuleVersionParts.patch !== requiredCoreModuleVersionParts.patch)\n        ) {\n            ui.notifications.error(\n                `The installed Token Action HUD system module requires Token Action HUD Core module version ${requiredCoreModuleVersion}. Install the required version to continue using Token Action HUD.`\n            )\n            return false\n        }\n        return true\n    }\n\n    /**\n     * Get subcategories by criteria\n     * @public\n     * @param {object} subcategories  The subcategories\n     * @param {object} data           The search data\n     * @returns {object}\n     */\n    static getSubcategories (subcategories, data = {}) {\n        let order = 0\n        if (!subcategories) return\n        const subcategoryId = data?.id\n        const subcategoryType = data?.type\n        subcategories = (Array.isArray(subcategories)) ? subcategories : Object.values(subcategories)\n        const foundSubcategories = {}\n        for (const subcategory of subcategories) {\n            if ((!subcategoryId || subcategory.id === subcategoryId) && (!subcategoryType || subcategory.type === subcategoryType)) {\n                order++\n                const level = subcategory.nestId.split('_').length\n                foundSubcategories[subcategory.nestId] = { ...subcategory, order, level }\n            }\n            if (subcategory.subcategories?.length > 0) {\n                const subcategories = this.getSubcategories(subcategory.subcategories, data)\n                if (subcategories) Object.assign(foundSubcategories, subcategories)\n            }\n        }\n        return (Object.keys(foundSubcategories).length > 0) ? foundSubcategories : null\n    }\n\n    /**\n     * Get nested groups by criteria\n     * @public\n     * @param {object} groups  The groups\n     * @param {object} data    The search data\n     * @returns {object}\n     */\n    static getNestedGroups (groups, data = {}) {\n        let order = 0\n        if (!groups) return\n        const groupId = data?.id\n        const groupType = data?.type\n        groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n        const foundGroups = {}\n        for (const group of groups) {\n            if ((!groupId || group.id === groupId) && (!groupType || group.type === groupType)) {\n                order++\n                const level = group.nestId.split('_').length\n                foundGroups[group.nestId] = { ...group, order, level }\n            }\n            if (group.groups?.length > 0) {\n                const groups = this.getNestedGroups(group.groups, data)\n                if (groups) Object.assign(foundGroups, groups)\n            }\n        }\n        return (Object.keys(foundGroups).length > 0) ? foundGroups : null\n    }\n\n    /**\n     * Get group by nest id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     * @returns {object}\n     */\n    static async getGroupByNestId (groups, data = {}) {\n        const nestId = (typeof data === 'string' ? data : data?.nestId)\n        const groupType = data?.type\n        if (!nestId) return\n\n        const parts = nestId.split('_')\n        return await findGroup(groups, parts)\n\n        async function findGroup (groups, parts) {\n            groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n            for (const group of groups) {\n                if (group.id === parts[0]) {\n                    if (parts.length === 1) {\n                        if (!group.type || !groupType || group.type === groupType) return group\n                        return\n                    }\n                    parts.shift()\n                    for (const groupStyle of Object.values(group.groups)) {\n                        if (groupStyle.length === 0) continue\n                        const foundGroup = await findGroup(groupStyle, parts)\n                        if (foundGroup) return foundGroup\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete group by nest id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     */\n    static async deleteGroupByNestId (groups, data = {}) {\n        const nestId = (typeof data === 'string' ? data : data?.nestId)\n        if (!nestId) return\n\n        const parts = nestId.split('_')\n        return await findGroup(groups, parts)\n\n        async function findGroup (groups, parts) {\n            groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n            for (const [index, group] of groups.entries()) {\n                if (group.id === parts[0]) {\n                    if (parts.length === 1) {\n                        groups.splice(index, 1)\n                        return\n                    }\n                    if (group.groups.length === 0) return\n                    parts.shift()\n                    const foundGroup = await findGroup(group.groups, parts)\n                    if (foundGroup) return\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete groups by id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     */\n    static async deleteGroupsById (groups, data = {}) {\n        const id = (typeof data === 'string' ? data : data?.id)\n        if (!id) return\n\n        for (let i = groups.length - 1; i >= 0; i--) {\n            if (groups[i].id === id) {\n                groups.splice(i, 1)\n            } else if (groups[i].groups?.length > 0) {\n                this.deleteGroupsById(groups[i].groups, data)\n            }\n        }\n    }\n}\n","import { MODULE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\n/**\n * Get file parts\n * @param {string} file The file\n * @returns {object}    The file parts\n */\nfunction getFileParts (file) {\n    const parts = file.split('/')\n    const filename = parts.pop()\n    const folder = parts.join('/')\n    const id = filename.split('.')[0]\n    return { folder, filename, id }\n}\n\nexport function isPersistentStorage () {\n    return (game.version >= '11.305' && typeof ForgeVTT === 'undefined')\n}\n\nexport class DataHandler {\n    async init () {\n        this.path = DataHandler.getPath()\n        this.private = await DataHandler.isPrivate()\n        this.fileMap = await DataHandler.getFilePathsAsGm()\n    }\n\n    /**\n     * Create directories\n     */\n    static async createDirectories () {\n        const DATA_FOLDER = 'data'\n        const moduleDirectory = (isPersistentStorage())\n            ? `modules/${MODULE.ID}/storage`\n            : MODULE.ID\n\n        const directoriesToCreate = [\n            moduleDirectory,\n            `${moduleDirectory}/${game.world.id}`,\n            `${moduleDirectory}/${game.world.id}/actor`,\n            `${moduleDirectory}/${game.world.id}/user`\n        ]\n\n        for (const directory of directoriesToCreate) {\n            await FilePicker.browse(DATA_FOLDER, directory).catch(async (_) => {\n                if (!(await FilePicker.createDirectory(DATA_FOLDER, directory, {}))) {\n                    Logger.debug('Failed to create directory: ' + directory)\n                }\n            })\n        }\n    }\n\n    /**\n     * Get base path to the layout files\n     * @returns {string} The path\n     */\n    static getPath () {\n        return (isPersistentStorage())\n            ? `modules/${MODULE.ID}/storage/${game.world.id}/`\n            : `${MODULE.ID}/${game.world.id}/`\n    }\n\n    /**\n     * Whether the module directory is set to private\n     * @returns {boolean} Whether the module directory is set to private\n     */\n    static async isPrivate () {\n        if (game.user.isGM) return false\n\n        const dataHandler = game?.tokenActionHud?.dataHandler\n\n        if (game.user.hasPermission('FILES_BROWSE')) {\n            try {\n                await FilePicker.browse('data', dataHandler.path)\n                return false\n            } catch {\n                return true\n            }\n        }\n    }\n\n    /**\n     * Get file paths as GM\n     * @returns {object} The file paths\n     */\n    static async getFilePathsAsGm () {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        if ((!game.user.hasPermission('FILES_BROWSE') || dataHandler.private) && !Utils.isGmActive()) {\n            Logger.info('Cannot get file paths without a GM present', true)\n            return new Map() // Return an empty map if no permissions and no GM\n        }\n\n        const files = game.user.hasPermission('FILES_BROWSE') && !dataHandler.private\n            ? await DataHandler.getFilePaths()\n            : await game.tokenActionHud.socket.executeAsGM('getFilePaths')\n\n        return new Map(files.map(file => {\n            const { id } = getFileParts(file)\n            return [id, file]\n        }))\n    }\n\n    /**\n     * Get file paths\n     */\n    static async getFilePaths () {\n        const dataHandler = game?.tokenActionHud?.dataHandler\n        const [actorFiles, userFiles] = await Promise.all([\n            FilePicker.browse('data', `${dataHandler.path}actor/`),\n            FilePicker.browse('data', `${dataHandler.path}user/`)\n        ])\n\n        return [...(actorFiles?.files ?? []), ...(userFiles?.files ?? [])]\n    }\n\n    /**\n     * Whether the user can save data\n     * @returns {boolean} Whether the user can save data\n     */\n    static canSaveData () {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        return ((game.user.hasPermission('FILES_UPLOAD') && !dataHandler.private) || Utils.isGmActive())\n    }\n\n    /**\n     * Save data the GM\n     * @public\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveDataAsGm (type, id, data) {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        if (game.user.hasPermission('FILES_UPLOAD') && !dataHandler.private) {\n            return await DataHandler.saveData(type, id, data)\n        }\n\n        if (!Utils.isGmActive()) {\n            Logger.info('Cannot save data without a GM present', true)\n            return\n        }\n\n        await game.tokenActionHud.socket.executeAsGM('saveData', type, id, data)\n    }\n\n    /**\n     * Save data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveData (type, id, data) {\n        const dataHandler = game?.tokenActionHud?.dataHandler\n\n        try {\n            // Get the folder path\n            const folder = `${dataHandler.path}${type}`\n\n            // Generate the system-safe filename\n            const fileName = encodeURI(`${id}.json`)\n\n            // Create the file and contents\n            const file = new File([JSON.stringify(data, null, '')], fileName, { type: 'application/json' })\n\n            // Upload the file\n            const response = await FilePicker.upload('data', folder, file, {}, { notify: false })\n\n            if (response.path) {\n                if (!dataHandler.fileMap.has(id)) {\n                    dataHandler.fileMap.set(id, response.path)\n                }\n            } else {\n                Logger.debug(`Failed to save data to: ${fileName}\\nReason: ${response.error || 'Unknown error'}`)\n            }\n        } catch (error) {\n            Logger.error(`An error occurred while saving data for ${id}.json: ${error.message}`)\n        }\n    }\n\n    /**\n     * Whether the user can get data\n     * @returns {boolean} Whether the user can get data\n     */\n    static canGetData () {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        return ((game.user.hasPermission('FILES_BROWSE') && !dataHandler.private) || Utils.isGmActive())\n    }\n\n    /**\n     * Get data as GM\n     * @public\n     * @param {object} options The options: file, type, id\n     * @returns {object}       The data\n     */\n    static async getDataAsGm (options) {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        try {\n            if ((!game.user.hasPermission('FILES_BROWSE') || dataHandler.private) && !Utils.isGmActive()) {\n                Logger.info('Cannot get data without a GM present', true)\n                return\n            }\n\n            return (game.user.hasPermission('FILES_BROWSE'))\n                ? await DataHandler.getData(options)\n                : await game.tokenActionHud.socket.executeAsGM('getData', options)\n        } catch (error) {\n            Logger.error(`An error occurred while getting data: ${error.message}`)\n            return null\n        }\n    }\n\n    /**\n     * Get data\n     * @param {string} options The options: file, type, id\n     * @returns {object}       The data\n     */\n    static async getData (options) {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        const { id, file } = options\n\n        // Check if the file is available in the fileMap\n        let foundFile = dataHandler.fileMap.get(id) ?? null\n\n        // If not found, try to browse, otherwise return null\n        if (!foundFile) {\n            if (!file) return null\n            const { folder, filename } = getFileParts(file)\n            const foundFolder = await FilePicker.browse('data', folder)\n            foundFile = foundFolder.files.find(file => file.endsWith(filename))\n            if (!foundFile) return null\n        }\n\n        try {\n            const ms = Date.now()\n            const response = await fetch(`${foundFile}?ms=${ms}`)\n\n            // Check if the fetch was successful\n            if (response.ok) {\n                return await response.json()\n            } else {\n                return null\n            }\n        } catch (error) {\n            console.error(error)\n            return null\n        }\n    }\n\n    /**\n     * Save data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveDataMigrate (type, id, data) {\n        // Get the folder path\n        const folderPath = `${MODULE.ID}/${game.world.id}/${type}`\n        // Generate the system safe filename\n        const fileName = encodeURI(`${id}.json`)\n        // Create the File and contents\n        const file = new File([JSON.stringify(data, null, '')], fileName, { type: 'application/json' })\n        const response = await FilePicker.upload('data', folderPath, file, {}, { notify: false })\n        if (!response.path) {\n            Logger.debug(`Failed to save data to: ${fileName}\\nReason: ${response}`)\n        }\n    }\n\n    /**\n     * Get data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @returns {object}    The data\n     */\n    static async getDataMigrate (type, id) {\n        const folderPath = `${MODULE.ID}/${game.world.id}/${type}`\n        const fileName = encodeURI(`${id}.json`)\n        try {\n            const foundFolderPath = await FilePicker.browse('data', folderPath)\n            const foundFilePath = foundFolderPath.files.find(file => file.endsWith(fileName))\n            if (foundFilePath) {\n                const ms = Date.now()\n                return await fetch(`${foundFilePath}?ms=${ms}`)\n                    .then(response => {\n                        if (response.ok) {\n                            return response.json()\n                        } else {\n                            return null\n                        }\n                    })\n                    .catch(error => {\n                        console.error(error)\n                    })\n            } else {\n                return null\n            }\n        } catch {\n            return null\n        }\n    }\n}\n","import { DELIMITER, GROUP_TYPE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's generic actions.\n */\nexport class GenericActionHandler {\n    actionHandler\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n    }\n\n    /**\n     * Build generic actions\n     * @public\n     * @param {object} character The actor and/or token\n     */\n    buildGenericActions () {\n        this.#buildUtilities()\n    }\n\n    /**\n     * Build utilities\n     * @private\n     */\n    #buildUtilities () {\n        if (this.actor) return this.#buildSingleTokenUtilities()\n        this.#buildMultipleTokenUtilities()\n    }\n\n    /**\n     * Build utilities for a single token\n     * @private\n     */\n    #buildSingleTokenUtilities () {\n        if (!this.token) return\n        const actionsData = []\n\n        const actionType = 'utility'\n\n        // Build Toggle Combat action\n        const toggleCombatId = 'toggleCombat'\n        const toggleCombatName = this.token?.inCombat\n            ? Utils.i18n('tokenActionHud.removeFromCombat')\n            : Utils.i18n('tokenActionHud.addToCombat')\n        const toggleCombatEncodedValue = [\n            actionType,\n            toggleCombatId\n        ].join(DELIMITER)\n        const toggleCombatAction = {\n            id: toggleCombatId,\n            name: toggleCombatName,\n            encodedValue: toggleCombatEncodedValue\n        }\n        actionsData.push(toggleCombatAction)\n\n        // Build Toggle Visibility action\n        if (game.user.isGM) {\n            const toggleVisibilityId = 'toggleVisibility'\n            const toggleVisibilityName = this.token?.document?.hidden\n                ? Utils.i18n('tokenActionHud.makeVisible')\n                : Utils.i18n('tokenActionHud.makeInvisible')\n            const toggleVisbilityEncodedValue = [\n                actionType,\n                toggleVisibilityId\n            ].join(DELIMITER)\n            const toggleVisibilityAction = {\n                id: toggleVisibilityId,\n                name: toggleVisibilityName,\n                encodedValue: toggleVisbilityEncodedValue\n            }\n            actionsData.push(toggleVisibilityAction)\n        }\n\n        const groupData = { id: 'token', type: GROUP_TYPE.SYSTEM }\n\n        // Add actions to HUD\n        this.actionHandler.addActions(actionsData, groupData)\n    }\n\n    /**\n     * Build utilities for multiple tokens\n     * @private\n     */\n    #buildMultipleTokenUtilities () {\n        const tokens = Utils.getControlledTokens()\n        const actionsData = []\n\n        const actionType = 'utility'\n\n        // Toggle Combat\n        const toggleCombatId = 'toggleCombat'\n        const toggleCombatName = tokens.every((token) => token.inCombat)\n            ? Utils.i18n('tokenActionHud.removeFromCombat')\n            : Utils.i18n('tokenActionHud.addToCombat')\n        const toggleCombatEncodedValue = [actionType, toggleCombatId].join(DELIMITER)\n        const toggleCombatAction = {\n            id: toggleCombatId,\n            name: toggleCombatName,\n            encodedValue: toggleCombatEncodedValue\n        }\n        actionsData.push(toggleCombatAction)\n\n        // Toggle Visibility\n        if (game.user.isGM) {\n            const toggleVisibilityId = 'toggleVisibility'\n            const toggleVisibilityname = tokens.every((token) => token.document?.hidden)\n                ? Utils.i18n('tokenActionHud.makeVisible')\n                : Utils.i18n('tokenActionHud.makeInvisible')\n            const toggleVisbilityEncodedValue = [actionType, toggleVisibilityId].join(DELIMITER)\n            const toggleVisibilityAction = {\n                id: toggleVisibilityId,\n                name: toggleVisibilityname,\n                encodedValue: toggleVisbilityEncodedValue\n            }\n            actionsData.push(toggleVisibilityAction)\n        }\n\n        const groupData = { id: 'token', type: GROUP_TYPE.SYSTEM }\n\n        // Add actions to HUD\n        this.actionHandler.addActions(actionsData, groupData)\n    }\n}\n","import { ACTION_TYPE, COMPENDIUM_PACK_TYPES, DELIMITER } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's compendium actions.\n */\nexport class CompendiumActionHandler {\n    actionHandler\n    compendiumActions\n    packIds\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.compendiumActions = new Map()\n        this.packIds = []\n    }\n\n    /**\n     * Build compendium actions\n     */\n    async buildCompendiumActions () {\n        if (this.compendiumActions.size === 0) {\n            this.packIds = game.packs\n                .filter(\n                    (pack) =>\n                        COMPENDIUM_PACK_TYPES.includes(pack.documentName) &&\n              (foundry.utils.isNewerVersion(game.version, '10') ? pack.visible : !pack.private || game.user.isGM)\n                )\n                .map((pack) => pack.metadata.id)\n\n            if (this.packIds.length === 0) return\n\n            await Promise.all(this.packIds.map(packId => this.#setCompendiumActions(packId)))\n        }\n\n        for (const pack of this.compendiumActions.values()) {\n            this.actionHandler.addActions(pack.actionsData, pack.groupData)\n        }\n    }\n\n    /**\n     * Set compendium actions into the compendiumActions map\n     * @param {string} packId The pack id\n     */\n    async #setCompendiumActions (packId) {\n        const pack = game.packs.get(packId)\n        const entries = pack ? pack.index.size > 0 ? pack.index : await pack.getIndex() : null\n        if (!entries) return\n        const actionType = this.#getCompendiumActionType(pack?.documentName)\n        const actionsData = entries.map((entry) => ({\n            id: entry._id,\n            name: entry.name,\n            encodedValue: [actionType, packId, entry._id].join(DELIMITER),\n            img: Utils.getImage(entry),\n            listName: `${Utils.i18n(ACTION_TYPE[actionType])}: ${entry.name}`\n        }))\n        const groupData = { id: this.#getGroupId(packId), type: 'core' }\n        this.compendiumActions.set(packId, { actionsData, groupData })\n    }\n\n    /**\n     * Get compendium action type based on documentName\n     * @param {string} documentName The pack document name\n     * @returns {string}            The compendium action type\n     */\n    #getCompendiumActionType (documentName) {\n        switch (documentName) {\n        case 'Macro':\n            return 'compendiumMacro'\n        case 'Playlist':\n            return 'compendiumPlaylist'\n        default:\n            return 'compendiumEntry'\n        }\n    }\n\n    /**\n     * @param {string} packId The pack id\n     * @returns {string}      The group id\n     */\n    #getGroupId (packId) {\n        return packId.replace('.', '-')\n    }\n\n    /**\n     * Whether the compendium is linked\n     * @public\n     * @param {string} packId The pack id\n     * @returns {boolean}     Whether the compendium is linked\n     */\n    isLinkedCompendium (packId) {\n        return (this.packIds.length)\n            ? this.packIds?.includes(packId)\n            : false\n    }\n}\n","import { DELIMITER, ACTION_TYPE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's macro actions.\n */\nexport class MacroActionHandler {\n    actionHandler\n    macroActions\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.macroActions = null\n    }\n\n    /**\n     * Build macro actions\n     * @override\n     */\n    async buildMacroActions () {\n        if (!this.macroActions) {\n            const groupData = { id: 'macros', type: 'core' }\n            const actionsData = await this.#getActions()\n            this.macroActions = { actionsData, groupData }\n        }\n\n        this.actionHandler.addActions(this.macroActions.actionsData, this.macroActions.groupData)\n    }\n\n    /**\n     * Get actions\n     * @private\n     * @returns {object} The actions\n     */\n    async #getActions () {\n        const actionType = 'macro'\n        const macros = game.macros.filter((macro) => {\n            const permissions = macro.ownership\n            if (permissions[game.userId]) return permissions[game.userId] > 0\n            return permissions.default > 0\n        })\n        return macros.map((macro) => {\n            const id = macro.id\n            const name = macro.name\n            const actionTypeName = `${Utils.i18n(ACTION_TYPE[actionType])}: ` ?? ''\n            const listName = `${actionTypeName}${name}`\n            const encodedValue = [actionType, macro.id].join(DELIMITER)\n            const img = Utils.getImage(macro)\n            return {\n                id,\n                name,\n                listName,\n                encodedValue,\n                img\n            }\n        })\n    }\n}\n","import { DataHandler } from '../data-handler.js'\nimport { GenericActionHandler } from './generic-action-handler.js'\nimport { CompendiumActionHandler } from './compendium-action-handler.js'\nimport { MacroActionHandler } from './macro-action-handler.js'\nimport { COMPENDIUM_PACK_TYPES, DELIMITER, GROUP_TYPE } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD.\n */\nexport class ActionHandler {\n    characterName = null\n    actor = null\n    token = null\n    actionHandlerExtenders = []\n    delimiter = DELIMITER\n\n    constructor () {\n        this.genericActionHandler = new GenericActionHandler(this)\n        this.compendiumActionHandler = new CompendiumActionHandler(this)\n        this.macroActionHandler = new MacroActionHandler(this)\n        this.hud = []\n        this.defaultGroups = {}\n        this.defaultLayout = {}\n        this.groups = {}\n        this.actorGroups = {}\n        this.userGroups = {}\n        this.actions = []\n        this.availableActionsMap = new Map()\n        this.customLayoutSetting = Utils.getSetting('customLayout')\n        this.userCustomLayoutFlag = Utils.getUserFlag('userCustomLayout')\n        this.enableCustomizationSetting = Utils.getSetting('enableCustomization')\n        this.displayCharacterNameSetting = Utils.getSetting('displayCharacterName')\n        this.sortActionsSetting = Utils.getSetting('sortActions')\n        this.tooltipsSetting = Utils.getSetting('tooltips')\n    }\n\n    /**\n     * Reset action handler variables except actorGroups and userGroups\n     * @public\n     */\n    softResetActionHandler () {\n        this.genericActionHandler = new GenericActionHandler(this)\n        this.hud = []\n        this.defaultGroups = {}\n        this.defaultLayout = {}\n        this.groups = {}\n        this.actions = []\n        this.availableActionsMap = new Map()\n    }\n\n    /**\n     * Reset all action handler variables\n     * @public\n     */\n    hardResetActionHandler () {\n        this.softResetActionHandler()\n        this.customLayoutSetting = Utils.getSetting('customLayout')\n        this.userCustomLayoutFlag = Utils.getUserFlag('userCustomLayout')\n        this.customLayout = null\n        this.actorGroups = {}\n        this.userGroups = {}\n    }\n\n    /**\n     * Register default categories from the Token Action Hud system module\n     * @public\n     */\n    async registerDefaultCategories () {}\n\n    /**\n     * Build the HUD\n     * @public\n     * @returns {object} The HUD\n     */\n    async buildHud (options) {\n        Logger.debug('Building HUD...', { actor: this.actor, token: this.token })\n        if (this.previousActor?.id === this.actor?.id) {\n            this.isSameActor = true\n        } else {\n            this.previousActor = this.actor\n            this.isSameActor = false\n        }\n        this.softResetActionHandler()\n        await Promise.all([\n            this.#getDefaultGroups(),\n            this.#getDefaultLayout(),\n            this.#getCustomLayout()\n        ])\n        if (!DataHandler.canGetData() && !this.isGmInactiveUserNotified) {\n            Logger.info('Cannot retrieve HUD layout without GM present', true)\n            this.isGmInactiveUserNotified = true\n        }\n        await Promise.all([\n            this.#getSavedUserGroups(),\n            this.#getSavedActorGroups()\n        ])\n        this.hud = await this.#prepareHud()\n        await Promise.all([\n            this.#buildSystemActions(),\n            this.#buildGenericActions(),\n            this.#buildCompendiumActions(),\n            this.#buildMacroActions()\n        ])\n        await this.#buildExtendedActions()\n        this.#updateNonPresetActions()\n        this.#setHasActions()\n        this.#setCharacterLimit()\n        await this.saveGroups(options)\n        Logger.debug('HUD built', { hud: this.hud, actor: this.actor, token: this.token })\n        return this.hud\n    }\n\n    /**\n     * Prepare the HUD\n     * @private\n     * @returns {object} The HUD\n     */\n    async #prepareHud () {\n        Logger.debug('Preparing HUD...', { actor: this.actor, token: this.token })\n\n        const title = (this.displayCharacterNameSetting)\n            ? this.characterName ?? 'Multiple'\n            : ''\n        const actorId = this.actor?.id ?? 'multi'\n        const tokenId = this.token?.id ?? 'multi'\n        const hud = {\n            title,\n            tokenId,\n            actorId,\n            groups: []\n        }\n\n        if (Object.keys(this.userGroups).length) {\n            const userGroups = this.#getUserGroups()\n            for (const userGroup of userGroups) {\n                if (userGroup.level === 1) {\n                    const group = this.#createGroup(userGroup)\n                    hud.groups.push(group)\n                    this.groups[group.nestId] = group\n                } else {\n                    const parentNestId = userGroup.nestId.split('_', userGroup.level - 1).join('_')\n                    const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId })\n                    if (parentGroup) {\n                        const group = this.#createGroup(userGroup)\n                        if (group.settings.style === 'tab') {\n                            parentGroup.groups.tabs.push(group)\n                        } else {\n                            parentGroup.groups.lists.push(group)\n                        }\n                        this.groups[group.nestId] = group\n                    }\n                }\n            }\n        }\n\n        if (Object.keys(this.actorGroups).length) {\n            const actorGroups = this.#getActorGroups()\n            for (const actorGroup of actorGroups) {\n                const parentNestId = actorGroup.nestId.split('_', actorGroup.level - 1).join('_')\n                const existingGroup = await Utils.getGroupByNestId(hud.groups, { nestId: actorGroup.nestId })\n                if (existingGroup) {\n                    if (actorGroup.actions?.length) {\n                        existingGroup.actions = actorGroup.actions\n                        this.actions.push(...existingGroup.actions)\n                        for (const action of existingGroup.actions) {\n                            action.selected = false\n                        }\n                    }\n                } else {\n                    const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId })\n                    if (parentGroup && actorGroup.type === 'system-derived') {\n                        const group = this.#createGroup(actorGroup)\n                        if (actorGroup.actions?.length) {\n                            group.actions = actorGroup.actions\n                            this.actions.push(...group.actions)\n                            for (const action of group.actions) {\n                                action.selected = false\n                            }\n                        }\n                        if (group.settings.style === 'tab') {\n                            parentGroup.groups.tabs.push(group)\n                        } else {\n                            parentGroup.groups.lists.push(group)\n                        }\n                        this.groups[group.nestId] = group\n                    }\n                }\n            }\n        }\n\n        Logger.debug('HUD prepared', { hud, actor: this.actor, token: this.token })\n        return hud\n    }\n\n    /**\n     * Placeholder function for the system module\n     * @public\n     */\n    async buildSystemActions (groupIds) {}\n\n    /**\n     * Build system-specific actions\n     * @private\n     */\n    async #buildSystemActions () {\n        Logger.debug('Building system actions...', { actor: this.actor, token: this.token })\n        const groupIds = Object.values(this.groups).map(group => group.id)\n        await this.buildSystemActions(groupIds)\n        Logger.debug('System actions built', { hud: this.hud, actor: this.actor, token: this.token })\n    }\n\n    /**\n     * Build compendium-specific actions\n     * @private\n     */\n    async #buildCompendiumActions () {\n        Logger.debug('Building compendium actions...')\n        await this.compendiumActionHandler.buildCompendiumActions()\n        Logger.debug('Compendium actions built', { hud: this.hud })\n    }\n\n    /**\n     * Build generic actions\n     * @private\n     */\n    #buildGenericActions () {\n        Logger.debug('Building generic actions...', { actor: this.actor, token: this.token })\n        this.genericActionHandler.buildGenericActions()\n        Logger.debug('Generic actions built', { hud: this.hud, actor: this.actor, token: this.token })\n    }\n\n    /**\n     * Build macro-specific actions\n     * @private\n     */\n    async #buildMacroActions () {\n        Logger.debug('Building macro actions...')\n        await this.macroActionHandler.buildMacroActions()\n        Logger.debug('Macro actions built', { hud: this.hud })\n    }\n\n    /**\n     * Build extended actions\n     * @private\n     */\n    async #buildExtendedActions () {\n        await Promise.all(this.actionHandlerExtenders.map(\n            async extender => await extender.extendActionHandler()\n        ))\n    }\n\n    /**\n     * Update non-preset actions\n     * @private\n     */\n    #updateNonPresetActions () {\n        const nonPresetActions = this.actions.filter(action => !action?.isPreset)\n\n        for (const nonPresetAction of nonPresetActions) {\n            const availableAction = this.availableActionsMap.get(nonPresetAction.id)\n\n            if (availableAction) {\n                const systemSelected = availableAction.systemSelected ?? nonPresetAction.systemSelected\n                const userSelected = nonPresetAction.userSelected ?? availableAction.userSelected\n                Object.assign(nonPresetAction, this.#createAction({ ...availableAction, systemSelected, userSelected }))\n            }\n        }\n    }\n\n    /**\n     * Set property to indicate whether a group has actions within it\n     * @private\n     */\n    #setHasActions () {\n        for (const group of Object.values(this.groups)) {\n            if (group.actions.some(action => action.selected)) {\n                group.hasActions = true\n            } else {\n                group.hasActions = false\n            }\n        }\n    }\n\n    /**\n     * Get the default groups\n     * @private\n     */\n    #getDefaultGroups () {\n        const defaultGroups = game.tokenActionHud.defaults?.groups\n        if (!defaultGroups) return {}\n        for (const defaultGroup of defaultGroups) {\n            this.defaultGroups[defaultGroup.id] = defaultGroup\n        }\n    }\n\n    /**\n     * Get the default layout\n     * @private\n     */\n    async #getDefaultLayout () {\n        if (Object.keys(this.defaultLayout).length) return\n        const defaultLayout = game.tokenActionHud.defaults?.layout\n        if (!defaultLayout) return {}\n        this.defaultLayout = await Utils.getNestedGroups(defaultLayout)\n    }\n\n    /**\n     * Get custom layout\n     * @private\n     */\n    async #getCustomLayout () {\n        if (this.customLayout) return\n        const file = this.userCustomLayoutFlag || this.customLayoutSetting || null\n        this.customLayout = (file) ? await DataHandler.getDataAsGm({ file }) : null\n    }\n\n    /**\n     * Export layout to file\n     */\n    async exportLayout () {\n        const data = await DataHandler.getDataAsGm({ type: 'user', id: game.userId }) ?? this.customLayout ?? this.defaultLayout\n        if (data) {\n            saveDataToFile(JSON.stringify(data, null, 2), 'text/json', 'token-action-hud-layout.json')\n        }\n    }\n\n    /**\n     * Get the saved groups from the actor flag\n     * @private\n     */\n    async #getSavedActorGroups () {\n        if (!this.actor) return\n\n        if (!this.enableCustomizationSetting) {\n            this.actorGroups = {}\n            return\n        }\n\n        if (this.isSameActor && Object.entries(this.actorGroups).length) return\n\n        if (!DataHandler.canGetData()) {\n            this.actorGroups = {}\n            return\n        }\n\n        Logger.debug('Retrieving groups from actor...', { actor: this.actor })\n        this.actorGroups = {}\n        const actorGroups = await DataHandler.getDataAsGm({ type: 'actor', id: this.actor.id }) ?? null\n        if (!actorGroups) return\n        for (const group of Object.entries(actorGroups)) {\n            group[1].nestId = group[0]\n        }\n        this.actorGroups = actorGroups\n        Logger.debug('Groups from actor retrieved', { actorGroups: this.actorGroups, actor: this.actor })\n    }\n\n    /**\n     * Get the saved groups from the user flag\n     * @private\n     */\n    async #getSavedUserGroups () {\n        const user = game.user\n        const layout = this.customLayout ?? this.defaultLayout\n\n        const getUserGroups = (data) => {\n            const userGroups = Object.keys(data).length ? data : layout\n            for (const group of Object.entries(userGroups)) {\n                group[1].nestId = group[0]\n            }\n            return userGroups\n        }\n\n        if (!this.enableCustomizationSetting) {\n            this.userGroups = getUserGroups(layout)\n            return\n        }\n\n        if (Object.entries(this.userGroups).length) return\n\n        if (!DataHandler.canGetData()) {\n            this.userGroups = getUserGroups(layout)\n            return\n        }\n\n        Logger.debug('Retrieving groups from user...', { user })\n        this.userGroups = {}\n        const savedUserData = await DataHandler.getDataAsGm({ type: 'user', id: user.id }) ?? {}\n        this.userGroups = getUserGroups(savedUserData)\n        Logger.debug('Groups retrieved from user', { userGroups: this.userGroups, user })\n    }\n\n    /**\n     * Get first matching action group based on criteria\n     * @public\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    getGroup (data = {}) {\n        if (data?.nestId) {\n            return this.groups[data.nestId]\n        } else {\n            return Object.values(this.groups).find(\n                group =>\n                    (!data.id || group.id === data.id) &&\n                    (!data.type || group.type === data.type) &&\n                    (!data.level || group.level === data.level)\n            )\n        }\n    }\n\n    /**\n     * Get groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getGroups (data = {}) {\n        return Object.values(this.groups).filter(\n            group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level) &&\n                (!data.selected || group.selected === data.selected)\n        )\n    }\n\n    /**\n     * Get actor-related groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getActorGroups (data = {}) {\n        return Object.values(this.actorGroups)\n            .filter(group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level)\n            )\n            .sort((a, b) => (a.level - b.level || a.order - b.order))\n    }\n\n    /**\n     * Get user-related groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getUserGroups (data = {}) {\n        return Object.values(this.userGroups)\n            .filter(group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level)\n            )\n            .sort((a, b) => {\n                if (a.level === b.level) {\n                    return a.order - b.order\n                } else {\n                    return a.level - b.level\n                }\n            })\n    }\n\n    /**\n     * Get advanced options\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The group settings\n     */\n    getGroupSettings (groupData) {\n        const group = this.getGroup(groupData)\n        return group?.settings ?? null\n    }\n\n    /**\n     * Save group settings\n     * @param {object} groupData The group data\n     */\n    saveGroupSettings (groupData) {\n        const group = this.getGroup(groupData)\n        group.settings = { ...group.settings, ...groupData.settings }\n        this.saveGroups({ saveActor: true, saveUser: true })\n    }\n\n    /**\n     * Create group\n     * @private\n     * @param {object} groupData The group data\n     * @returns {object}         The group\n     */\n    #createGroup (groupData, keepData = false) {\n        const groupDataClone = Utils.deepClone(groupData)\n        const nestIdParts = groupData.nestId.split('_')\n        const level = nestIdParts.length ?? 1\n\n        const tooltip = this.#getTooltip(groupData?.tooltip, groupDataClone?.name)\n\n        if (!keepData) {\n            groupDataClone.actions = []\n            groupDataClone.groups = { lists: [], tabs: [] }\n        }\n\n        const defaultSettings = {\n            showTitle: true,\n            style: (level === 1) ? 'tab' : 'list'\n        }\n\n        const groupSettings = groupDataClone.settings || {}\n        groupSettings.showTitle ??= defaultSettings.showTitle\n        groupSettings.style ??= defaultSettings.style\n\n        groupDataClone.subtitleClass = (groupSettings.showTitle) ? '' : 'tah-hidden'\n\n        const groupSystem = groupDataClone.system || {}\n\n        const commonProps = {\n            actions: groupDataClone.actions,\n            class: groupDataClone.class || groupDataClone.cssClass || '',\n            groups: groupDataClone.groups,\n            id: groupDataClone.id,\n            info1: groupDataClone.info1 || '',\n            info2: groupDataClone.info2 || '',\n            info3: groupDataClone.info3 || '',\n            level: groupDataClone.level || level || 1,\n            listName: groupDataClone.listName || groupDataClone.name,\n            name: groupDataClone.name,\n            nestId: groupDataClone.nestId || groupDataClone.id,\n            order: groupDataClone.order,\n            selected: groupDataClone.selected ?? groupDataClone.isSelected ?? groupDataClone.defaultSelected ?? true,\n            settings: groupSettings,\n            system: groupSystem,\n            tooltip,\n            type: groupDataClone.type || GROUP_TYPE.CUSTOM\n        }\n\n        if (level > 1) {\n            commonProps.subtitleClass = groupDataClone.subtitleClass || ''\n        }\n\n        return commonProps\n    }\n\n    /**\n     * Update groups\n     * @public\n     * @param {array|object} groupsData         The groups data\n     * @param {object} [parentGroupData = null] The parent group data\n     */\n    updateGroups (groupsData, parentGroupData) {\n        if (!Array.isArray(groupsData)) groupsData = [groupsData]\n\n        const level = (parentGroupData?.level ?? 0) + 1\n        const childGroupData = { level }\n        if (parentGroupData?.nestId) childGroupData.nestId = parentGroupData.nestId\n\n        const existingGroups = this.#getGroups(childGroupData)\n\n        // Remove any groups that are no longer present\n        for (const existingGroup of existingGroups) {\n            if (existingGroup.type === 'system-derived') {\n                existingGroup.selected = false\n                existingGroup.order = 999\n            } else {\n                if (!groupsData.find(groupData => groupData.id === existingGroup.id)) {\n                    delete this.groups[existingGroup.nestId]\n                }\n            }\n        }\n\n        // Add or update groups\n        let order = 0\n        for (const groupData of groupsData) {\n            groupData.nestId = (parentGroupData?.nestId)\n                ? `${parentGroupData.nestId}_${groupData.id}`\n                : groupData.id\n            groupData.selected = groupData.selected ?? true\n            groupData.order = order\n\n            const existingGroup = this.getGroup(groupData)\n\n            if (existingGroup) {\n                Object.assign(existingGroup, groupData)\n            } else {\n                const group = this.#createGroup(groupData)\n                this.groups[groupData.nestId] = group\n            }\n            order++\n        }\n\n        // Update parent group settings\n        if (parentGroupData?.settings) {\n            const existingParentGroup = this.getGroup(parentGroupData)\n            if (existingParentGroup) {\n                existingParentGroup.settings = parentGroupData.settings\n            }\n        }\n    }\n\n    /**\n     * Save groups\n     * @public\n     */\n    async saveGroups (options = { saveActor: false, saveUser: false }) {\n        if (!this.enableCustomizationSetting) return\n        Logger.debug('Saving groups...')\n        if (options?.saveActor) await this.#saveActorGroups()\n        if (options?.saveUser) await this.#saveUserGroups()\n        Logger.debug('Groups saved', { groups: this.groups })\n    }\n\n    /**\n     * Save actor groups to file\n     * @private\n     */\n    async #saveActorGroups () {\n        if (!this.actor) return\n        if (!Object.keys(this.groups).length) return\n        Logger.debug('Saving actor groups...')\n        const actorGroups = {}\n        this.actorGroups = {}\n        for (const group of Object.values(this.groups)) {\n            this.actorGroups[group.nestId] = group\n            actorGroups[group.nestId] = this.#getReducedGroupData(group, true)\n        }\n        if (DataHandler.canSaveData()) {\n            await DataHandler.saveDataAsGm('actor', this.actor.id, actorGroups)\n\n            Logger.debug('Actor groups saved', { actorGroups })\n        } else {\n            Logger.debug('Actor groups not saved as no GM present')\n        }\n    }\n\n    /**\n     * Save user groups to file\n     * @private\n     */\n    async #saveUserGroups () {\n        if (!Object.keys(this.groups).length) return\n        Logger.debug('Saving user groups...')\n        const userGroups = {}\n        this.userGroups = {}\n        for (const group of Object.values(this.groups)) {\n            if (group.type !== 'system-derived') {\n                this.userGroups[group.nestId] = group\n                userGroups[group.nestId] = this.#getReducedGroupData(group, false)\n            }\n        }\n        if (DataHandler.canSaveData()) {\n            await DataHandler.saveDataAsGm('user', game.userId, userGroups)\n            Logger.debug('User groups saved', { userGroups })\n        } else {\n            Logger.debug('User groups not saved as no GM present')\n        }\n    }\n\n    /**\n     * Get reduced groups data for saving to flags\n     * @param {object} groupData    The group data\n     * @param {boolean} keepActions Whether to keep action data\n     * @returns                     The reduced group data\n     */\n    #getReducedGroupData (groupData, keepActions = false) {\n        const data = {\n            id: groupData.id,\n            name: groupData.name,\n            listName: groupData.listName,\n            selected: groupData.selected,\n            level: groupData.level,\n            order: groupData.order,\n            settings: groupData.settings,\n            type: groupData.type\n        }\n        if (keepActions) {\n            data.actions = groupData.actions.map(action => {\n                return {\n                    id: action.id,\n                    isPreset: action.isPreset,\n                    userSelected: action.userSelected\n                }\n            })\n        }\n        return data\n    }\n\n    /**\n     * Get actions by id\n     * @private\n     * @param {object} actionData The action data\n     * @returns {array}           The actions\n     */\n    #getActions (actionData) {\n        return this.actions.filter(action => action.id === actionData.id)\n    }\n\n    /**\n     * Get tooltip based on module setting\n     * @param {string} tooltip The tooltip\n     * @param {string} name    The name\n     * @returns {string}       The tooltip\n     */\n    #getTooltip (tooltip, name) {\n        if (this.tooltipsSetting === 'none') return null\n        if (this.tooltipsSetting === 'nameOnly') return name\n        if (this.tooltipsSetting === 'full' && tooltip) {\n            return (tooltip.includes('tah-tooltip-wrapper'))\n                ? tooltip\n                : `<div class=\"tah-tooltip-wrapper\">${tooltip}</div>`\n        }\n        return name\n    }\n\n    /**\n     * Create action\n     * @private\n     * @param {object} actionData The action data\n     * @returns {object}          The action\n     */\n    #createAction(actionData) {\n        const fullName = actionData.fullName ?? actionData.name\n        const tooltip = this.#getTooltip(actionData?.tooltip, fullName)\n\n        const infoProps = (info) => {\n            return {\n                class: info?.class || '',\n                icon: info?.icon || '',\n                text: info?.text || '',\n                title: info?.title || ''\n            }\n        }\n\n        return {\n            encodedValue: actionData.encodedValue,\n            id: actionData.id,\n            name: actionData.name,\n            fullName,\n            listName: actionData.listName || actionData.name,\n            cssClass: actionData.cssClass || '',\n            icons: actionData.icon || {},\n            icon1: actionData.icon1 || '',\n            icon2: actionData.icon2 || '',\n            icon3: actionData.icon3 || '',\n            img: actionData.img || '',\n            info1: infoProps(actionData.info1),\n            info2: infoProps(actionData.info2),\n            info3: infoProps(actionData.info3),\n            isAction: true,\n            isItem: actionData.isitem || null,\n            isPreset: actionData.isPreset || false,\n            userSelected: actionData.userSelected ?? true,\n            systemSelected: actionData.systemSelected ?? true,\n            system: actionData.system || {},\n            selected: actionData.systemSelected\n                ? actionData.userSelected ?? actionData.systemSelected ?? true\n                : false,\n            tooltip,\n            useRawHtmlName: actionData.useRawHtmlName || false\n        }\n    }\n\n    /**\n     * Update actions\n     * @public\n     * @param {array} actionsData The actions data\n     * @param {object} groupData  The group data\n     */\n    updateActions (actionsData, groupData) {\n        const group = this.getGroup(groupData)\n        const actions = group.actions\n\n        const reorderedActions = []\n\n        // Set 'selected' to true for selected actions\n        // Reorder actions based on order in dialog\n        for (const actionData of actionsData) {\n            if (actionData.id.includes('itemMacro')) continue\n            const existingAction = group.actions.find(action => action.id === actionData.id)\n            if (existingAction) {\n                const actionClone = { ...existingAction, userSelected: true }\n                reorderedActions.push(actionClone)\n            } else {\n                const availableAction = this.availableActionsMap.get(actionData.id)\n                if (availableAction) {\n                    const actionClone = { ...availableAction, userSelected: true }\n                    reorderedActions.push(actionClone)\n                }\n            }\n        }\n        // Set 'selected' to false for unselected actions\n        for (const action of actions) {\n            if (!action.id || action?.id.includes('itemMacro')) continue\n\n            const actionData = actionsData.find(actionData => actionData.id === action.id)\n            if (!actionData && action.isPreset) {\n                const actionClone = { ...action, userSelected: false }\n                reorderedActions.push(actionClone)\n            }\n        }\n\n        // Sort actions alphabetically\n        if (groupData?.settings?.sort || (typeof groupData?.settings?.sort === 'undefined' && this.sortActionsSetting)) {\n            reorderedActions.sort((a, b) => a.name.localeCompare(b.name))\n        }\n\n        // Replace group actions\n        group.actions = reorderedActions\n    }\n\n    /**\n     * Add to available actions\n     * @private\n     * @param {array} actionsMap The actions\n     */\n    #addToAvailableActions (actionsMap) {\n        actionsMap.forEach((action, actionId) => {\n            if (!this.availableActionsMap.has(actionId)) this.availableActionsMap.set(actionId, action)\n        })\n    }\n\n    /**\n     * Get available actions as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {array}          The available actions\n     */\n    getAvailableActions () {\n        return [...this.availableActionsMap.values()].map(action => this.#toActionTagifyEntry(action)).sort((a, b) => a.value.localeCompare(b.value))\n    }\n\n    /**\n     * Get selected actions as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {array}          The selected actions\n     */\n    getSelectedActions (groupData) {\n        const group = this.getGroup(groupData)\n        if (!group) return\n        return group.actions\n            .filter(action => action.selected === true)\n            .map(action => this.#toActionTagifyEntry(action))\n    }\n\n    /**\n     * Get selected groups as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The selected groups\n     */\n    getSelectedGroups (groupData = {}) {\n        groupData.selected = true\n        groupData.level = (groupData.level || 0) + 1\n        const groups = this.#getGroups(groupData)\n        return groups?.map(group => this.#toGroupTagifyEntry(group)) ?? []\n    }\n\n    /**\n     * Get available groups as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The groups\n     */\n    async getAvailableGroups (groupData) {\n        const derivedGroups = await this.#getDerivedGroups(groupData)\n        const systemGroups = await this.#getSystemGroups()\n        const compendiumGroups = await this.#getCompendiumGroups()\n        const macroGroups = await this.#getMacroGroups()\n        return [...derivedGroups, ...systemGroups, ...compendiumGroups, ...macroGroups]\n    }\n\n    /**\n     * Get compendium groups as Tagify entries\n     * @private\n     * @returns {object} The compendium groups\n     */\n    #getCompendiumGroups () {\n        const packs = game.packs.filter(pack =>\n            COMPENDIUM_PACK_TYPES.includes(pack.documentName) &&\n            (foundry.utils.isNewerVersion(game.version, '10') ? pack.visible : (!pack.private || game.user.isGM))\n        )\n        const groups = packs.map(pack => {\n            return {\n                id: pack.metadata.id.replace('.', '-'),\n                listName: `Group: ${pack.metadata.label}`,\n                name: pack.metadata.label,\n                type: 'core'\n            }\n        })\n        return groups.map(group => this.#toGroupTagifyEntry(group))\n    }\n\n    /**\n     * Get derived groups as Tagify entries\n     * @private\n     * @param {object} groupData The group data\n     * @returns {object}         The derived groups\n     */\n    #getDerivedGroups (groupData) {\n        const derivedGroups = this.#getGroups({\n            nestId: groupData?.nestId,\n            type: GROUP_TYPE.SYSTEM_DERIVED\n        })\n        return derivedGroups?.map(group => this.#toGroupTagifyEntry(group)) ?? []\n    }\n\n    /**\n     * Get macro groups as Tagify entries\n     * @private\n     * @returns {object} The macro groups\n     */\n    #getMacroGroups () {\n        return [this.#toGroupTagifyEntry({\n            id: 'macros',\n            listName: `Group: ${Utils.i18n('tokenActionHud.macros')}`,\n            name: Utils.i18n('tokenActionHud.macros'),\n            type: 'core'\n        })]\n    }\n\n    /**\n     * Get system groups as Tagify entries\n     * @private\n     * @returns {object} The system groups\n     */\n    #getSystemGroups () {\n        return Object.values(this.defaultGroups).map(group => this.#toGroupTagifyEntry(group))\n    }\n\n    /**\n     * Add group to the HUD\n     * @public\n     * @param {object} groupData         The group data\n     * @param {object} parentGroupData   The parent group data\n     * @param {boolean} [update = false] Whether to update an existing group\n     */\n    addGroup (groupData, parentGroupData, update = false) {\n        groupData.type = groupData?.type ?? 'system-derived'\n        groupData.style = groupData?.style ?? 'list'\n\n        if (!parentGroupData?.id && !parentGroupData?.nestId) return\n\n        const parentGroups = this.#getGroups(parentGroupData)\n        if (!parentGroups?.length) return\n\n        for (const parentGroup of parentGroups) {\n            const nestId = `${parentGroup.nestId}_${groupData.id}`\n            const existingGroups = this.#getGroups({ ...groupData, nestId })\n\n            if (existingGroups.length) {\n                if (update) {\n                    for (const existingGroup of existingGroups) {\n                        // Temporary fix until info1-3 properties are grouped into info object\n                        if (groupData.info) {\n                            Object.assign(groupData, { ...groupData.info })\n                            delete groupData.info\n                        }\n\n                        Object.assign(existingGroup, this.#createGroup({ ...existingGroup, ...groupData }, true))\n                    }\n                } else {\n                    for (const existingGroup of existingGroups) {\n                        const tooltip = this.#getTooltip(groupData.tooltip, existingGroup.name)\n                        Object.assign(existingGroup, { tooltip })\n                    }\n                }\n            } else {\n                const group = this.#createGroup({ ...groupData, nestId })\n                if (group.settings.style === 'tab') {\n                    parentGroup.groups.tabs.push(group)\n                } else {\n                    parentGroup.groups.lists.push(group)\n                }\n                this.groups[group.nestId] = group\n            }\n        }\n    }\n\n    /**\n     * Update group in the HUD\n     * @public\n     * @param {object} groupData                The group data\n     * @param {object} [parentGroupData = null] The parent group data\n     */\n    updateGroup (groupData, parentGroupData = null) {\n        groupData.type = groupData?.type ?? 'system-derived'\n\n        const updateExistingGroups = (existingGroups) => {\n            for (const existingGroup of existingGroups) {\n                // Temporary fix until info1-3 properties are grouped into info object\n                if (groupData.info) {\n                    Object.assign(groupData, { ...groupData.info })\n                    delete groupData.info\n                }\n\n                Object.assign(existingGroup, this.#createGroup({ ...existingGroup, ...groupData }, true))\n            }\n        }\n\n        if (parentGroupData) {\n            const parentGroups = this.#getGroups(parentGroupData)\n            for (const parentGroup of parentGroups) {\n                const nestId = `${parentGroup.nestId}_${groupData.id}`\n                const existingGroups = this.#getGroups({ ...groupData, nestId })\n\n                updateExistingGroups(existingGroups)\n            }\n        } else {\n            const existingGroups = this.#getGroups(groupData)\n\n            updateExistingGroups(existingGroups)\n        }\n    }\n\n    /**\n     * Remove group from HUD\n     * @public\n     * @param {object} groupData The group data\n     */\n    removeGroup (groupData) {\n        if (!groupData?.nestId && groupData?.id) {\n            Utils.deleteGroupsById(this.hud.groups, groupData.id)\n        }\n\n        const groups = this.#getGroups(groupData)\n        if (!groups?.length) return\n\n        for (const group of groups) {\n            delete this.groups[group.nestId]\n            if (groupData?.nestId) {\n                Utils.deleteGroupByNestId(this.hud.groups, group.nestId)\n            }\n        }\n    }\n\n    /**\n     * Add info to group in the HUD\n     * @public\n     * @param {string} groupData The group data\n     */\n    addGroupInfo (groupData) {\n        const groupId = groupData?.id\n        const groupInfo = groupData?.info\n\n        if (!groupId || !groupInfo) return\n\n        const groups = this.#getGroups(groupData)\n\n        groups.forEach(group => {\n            group.info1 = groupInfo.info1\n            group.info2 = groupInfo.info2\n            group.info3 = groupInfo.info3\n        })\n    }\n\n    /**\n     * Add actions to the HUD\n     * @public\n     * @param {object} actionsData The actions data\n     * @param {object} groupData   The group data\n     */\n    addActions (actionsData, groupData) {\n        if (!actionsData.length) return\n\n        // Create actions\n        const actions = new Map(actionsData.map(actionData => [actionData.id, this.#createAction(actionData)]))\n        this.#addToAvailableActions(actions)\n\n        if (!groupData?.id) return\n\n        const groups = this.#getGroups(groupData)\n\n        if (!groups) return\n\n        for (const group of groups) {\n            // Get existing actions\n            const existingActions = new Map(group.actions.map(action => [action.id, action]))\n\n            const reorderedActions = []\n\n            // Loop the previously saved actions in the group\n            existingActions.forEach((existingAction, existingActionId) => {\n                const action = actions.get(existingActionId)\n                if (action) {\n                    const systemSelected = action.systemSelected ?? existingAction.systemSelected\n                    const userSelected = existingAction.userSelected ?? action.userSelected\n                    const selected = (!systemSelected)\n                        ? false\n                        : userSelected ?? systemSelected ?? true\n                    Object.assign(existingAction, { ...action, isPreset: true, selected, systemSelected, userSelected })\n                } else if (!existingAction.selected && existingAction.isPreset) {\n                    const systemSelected = false\n                    Object.assign(existingAction, this.#createAction({ ...existingAction, systemSelected }))\n                }\n            })\n\n            // Loop the generated actions and add any not previously saved\n            actions.forEach((action, actionId) => {\n                const existingAction = existingActions.get(actionId)\n                if (!existingAction) reorderedActions.push(this.#createAction({ ...action, isPreset: true }))\n            })\n\n            // Sort actions alphabetically\n            if (groupData?.settings?.sort || (typeof groupData?.settings?.sort === 'undefined' && this.sortActionsSetting)) {\n                reorderedActions.sort((a, b) => a.name.localeCompare(b.name))\n            }\n\n            // Add actions to group\n            group.actions.push(...reorderedActions)\n        }\n    }\n\n    /**\n     * Set character limit for action names based on the 'Character per Word' setting\n     * @private\n     */\n    #setCharacterLimit () {\n        const topLevelGroups = this.#getGroups({ level: 1 })\n\n        for (const topLevelGroup of topLevelGroups) {\n            const topLevelGroupCharacterCount = topLevelGroup?.settings?.characterCount\n\n            const groups = this.#getGroups({ nestId: topLevelGroup.nestId })\n\n            for (const group of groups) {\n                const actions = group.actions\n\n                if (!actions || actions?.length === 0) continue\n\n                const groupCharacterCount = group?.settings?.characterCount\n                const characterCount = (groupCharacterCount >= 0)\n                    ? topLevelGroupCharacterCount\n                    : groupCharacterCount\n\n                // Exit if character limit is not defined\n                if ((!characterCount && characterCount !== 0) || characterCount < 0) continue\n\n                for (const action of actions) {\n                    if (action.name.length <= characterCount) continue\n                    if (characterCount === 0) {\n                        action.name = ''\n                        continue\n                    }\n                    // Set each word to the character limit\n                    action.name = action.name\n                        .split(' ')\n                        .map(word => word.slice(0, characterCount))\n                        .join(' ')\n                }\n            }\n        }\n    }\n\n    /**\n     * Add action handler extender\n     * @public\n     * @param {object} actioHandlerExtender The action handler extender\n     */\n    addActionHandlerExtender (actionHandlerExtender) {\n        Logger.debug('Adding action handler extender...', { actionHandlerExtender })\n        this.actionHandlerExtenders.push(actionHandlerExtender)\n    }\n\n    /**\n     * Convert group into Tagify entry\n     * @private\n     * @param {object} data\n     * @returns {object}\n     */\n    #toGroupTagifyEntry (data) {\n        return {\n            id: data.id,\n            name: data.name,\n            type: data.type,\n            value: data.listName ?? data.name\n        }\n    }\n\n    /**\n     * Convert action into Tagify entry\n     * @private\n     * @param {object} data The data\n     * @returns {object}    Tagify entry\n     */\n    #toActionTagifyEntry (data) {\n        return {\n            id: data.id,\n            name: data.name,\n            type: 'action',\n            value: data.listName ?? data.name\n        }\n    }\n\n    /** DEPRECATED */\n\n    /**\n     * Add further action handler\n     * @public\n     * @param {object} handler The handler\n     */\n    addFurtherActionHandler (handler) {\n        globalThis.logger.warn('Token Action HUD | ActionHandler.addFurtherActionHandler is deprecated. Use ActionHandler.addActionHandlerExtender')\n        this.addActionHandlerExtender(handler)\n    }\n}\n","import { ActionHandler } from './action-handler.js'\n\n/**\n * An extension of the base ActionHandler which extends the HUD via core or system modules.\n */\nexport class ActionHandlerExtender extends ActionHandler {\n    extendActionList () {}\n\n    /**\n     * @override\n     */\n    extendActionHandler () {\n        globalThis.logger.warn('Token Action HUD | ActionListExtender.extendActionList is deprecated. Use ActionHandlerExtender.extendActionHandler')\n        this.extendActionList()\n    }\n}\n","import { MODULE } from './constants.js'\nimport { isPersistentStorage, DataHandler } from './data-handler.js'\nimport { Logger, Utils } from './utils.js'\n\n/**\n * Manages migrations between module versions\n */\nexport class MigrationManager {\n    constructor (socket) {\n        this.socket = socket\n    }\n\n    /**\n     * Initialise migrations\n     * @public\n     */\n    async init () {\n        if (!game.user.isGM) return\n\n        const moduleVersion = game.modules.get('token-action-hud-core').version\n        const migrationVersion = Utils.getSetting('migrationVersion')\n        if (moduleVersion === migrationVersion) return\n\n        let isSuccess = true\n        isSuccess = (!migrationVersion || migrationVersion < '1.4.10') ? await this.#unsetOldFlags() : true\n        isSuccess = (isPersistentStorage() && (!migrationVersion || migrationVersion < '1.4.11')) ? await this.#migrateFiles() : true\n\n        if (isSuccess) {\n            Utils.setSetting('migrationVersion', moduleVersion)\n        }\n    }\n\n    /**\n     * Unset old flags\n     * @private\n     */\n    async #unsetOldFlags () {\n        try {\n            const users = game.users.filter(user => user.getFlag(MODULE.ID, 'categories'))\n            for (const user of users) {\n                user.unsetFlag(MODULE.ID, 'categories')\n                user.unsetFlag(MODULE.ID, 'defaults')\n            }\n\n            const actors = game.actors.filter(actor => actor.getFlag(MODULE.ID, 'categories'))\n            for (const actor of actors) {\n                actor.unsetFlag(MODULE.ID, 'categories')\n            }\n\n            const tokens = game.canvas.tokens.objects.children.filter(token => token.actor?.getFlag(MODULE.ID, 'categories'))\n            for (const token of tokens) {\n                token.actor?.unsetFlag(MODULE.ID, 'categories')\n            }\n\n            for (const scene of game.scenes) {\n                const tokens = scene.tokens.filter(token => token.actor?.getFlag(MODULE.ID, 'categories'))\n                for (const token of tokens) {\n                    token.actor?.unsetFlag(MODULE.ID, 'categories')\n                }\n            }\n\n            return true\n        } catch (err) {\n            Logger.debug(err.message, err)\n\n            return false\n        }\n    }\n\n    async #migrateFiles () {\n        try {\n            Logger.info('Migrating files to persistent storage...', true)\n            for (const user of game.users) {\n                const data = await DataHandler.getDataMigrate('user', user.id)\n                if (data) {\n                    await DataHandler.saveData('user', user.id, data)\n                }\n            }\n\n            for (const actor of game.actors) {\n                const data = await DataHandler.getDataMigrate('actor', actor.id)\n                if (data) {\n                    await DataHandler.saveData('actor', actor.id, data)\n                }\n            }\n            Logger.info('Successfully migrated files to persistent storage', true)\n            return true\n        } catch {\n            Logger.info('Failed to migrate files to persistent storage', true)\n            return false\n        }\n    }\n}\n","import { DELIMITER } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\n/**\n * Resolves core actions triggered from the HUD\n */\nexport class RollHandler {\n    actor = null\n    token = null\n    delimiter = DELIMITER\n    preRollHandlers = []\n\n    /**\n     * Throw error\n     * @public\n     * @param {*} err The error\n     */\n    throwInvalidValueErr (err) {\n        throw new Error(\n            `Error handling button click: ${err}`\n        )\n    }\n\n    /**\n     * Handle action events\n     * @public\n     * @param {object} event         The event\n     * @param {string} encodedValue  The encoded value\n     * @param {class}  actionHandler The ActionHandler class\n     */\n    async handleActionClickCore (event, encodedValue, actionHandler) {\n        Logger.debug(`Handling click event for action [${encodedValue}]`, { event })\n\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n\n        this.registerKeyPresses(event)\n\n        let handled = false\n        this.preRollHandlers.forEach((handler) => {\n            if (handled) return\n\n            handled = handler.prehandleActionEvent(event, encodedValue, actionHandler)\n        })\n\n        if (handled) return\n\n        if (this.#isGenericAction(encodedValue)) {\n            await this.#handleGenericActionClick(encodedValue)\n        } else {\n            if (this.handleActionClick.toString().slice(-2) !== '{}') {\n                this.handleActionClick(event, encodedValue)\n            } else {\n                globalThis.logger.warn('Token Action HUD | RollHandler.doHandleActionEvent is deprecated. Use RollHandler.handleActionClick')\n                this.doHandleActionEvent(event, encodedValue)\n            }\n        }\n    }\n\n    /**\n     * Overide for the TAH system module\n     * @override\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     */\n    handleActionClick (event, encodedValue) {}\n\n    /**\n     * Handle action hover events\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     * @param {class} actionHandler The ActionHandler class\n     */\n    async handleActionHoverCore (event, encodedValue, actionHandler) {\n        Logger.debug(`Handling hover event for action [${encodedValue}]`, { event })\n\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n\n        this.registerKeyPresses(event)\n\n        this.handleActionHover(event, encodedValue)\n    }\n\n    /**\n     * Overide for the TAH system module\n     * @override\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     */\n    handleActionHover (event, encodedValue) {}\n\n    /**\n     * Handle group click events\n     * @param {object} event        The event\n     * @param {string} nestId       The nest ID\n     * @param {class} actionHandler The ActionHandler class\n     */\n    async handleGroupClickCore (event, nestId, actionHandler) {\n        Logger.debug(`Handling click event for group [${nestId}]`, { event })\n\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n\n        const group = actionHandler.getGroup({ nestId })\n\n        this.registerKeyPresses(event)\n\n        this.handleGroupClick(event, group)\n    }\n\n    /**\n     * Overide for the TAH system module\n     * @override\n     * @param {object} event The event\n     * @param {object} group The group\n     */\n    handleGroupClick (event, group) {}\n\n    /**\n     * Add a pre-roll handler\n     * @public\n     * @param {object} handler The roll handler\n     */\n    addPreRollHandler (handler) {\n        Logger.debug(`Adding pre-roll handler ${handler.constructor.name}`)\n        this.preRollHandlers.push(handler)\n    }\n\n    /**\n     * Registers key presses\n     * @public\n     * @param {object} event The events\n     */\n    registerKeyPresses (event) {\n        this.rightClick = this.isRightClick(event)\n        this.ctrl = this.isCtrl(event)\n        this.alt = this.isAlt(event)\n        this.shift = this.isShift(event)\n    }\n\n    /**\n     * Renders the item sheet\n     * @public\n     * @param {object} actor  The actor\n     * @param {string} itemId The item id\n     * @returns {boolean}     Whether the item was rendered\n     */\n    renderItem (actor, itemId) {\n        // If actor is not specified, use the RollHandler's actor\n        if (!actor) {\n            actor = this.actor\n        }\n\n        // Get the item\n        const item = Utils.getItem(actor, itemId)\n\n        // If the item is not found, return false\n        if (!item) return false\n\n        // Render the item and return true\n        item.sheet.render(true)\n        return true\n    }\n\n    /**\n     * Whether the item sheet should be rendered\n     * @public\n     * @returns {boolean}\n     */\n    isRenderItem () {\n        return (\n            this.rightClick &&\n            !(this.alt || this.ctrl || this.shift)\n        )\n    }\n\n    /**\n     * Whether the button was right-clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isRightClick (event) {\n        return event?.originalEvent?.button === 2\n    }\n\n    /**\n     * Whether the ALT key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isAlt (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.ALT)\n        if (event.altKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT ALT key press')\n            KeyboardManager.emulateKeypress(false, 'AltLeft', { altKey: true, force: true })\n            game.keyboard.downKeys.add('AltLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the CTRL key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isCtrl (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.CONTROL)\n        if (event.ctrlKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT CTRL key press')\n            KeyboardManager.emulateKeypress(false, 'ControlLeft', { ctrlKey: true, force: true })\n            game.keyboard.downKeys.add('ControlLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the SHIFT key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isShift (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.SHIFT)\n        if (event.shiftKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT SHIFT key press')\n            KeyboardManager.emulateKeypress(false, 'ShiftLeft', { shiftKey: true, force: true })\n            game.keyboard.downKeys.add('ShiftLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the action is a generic action\n     * @private\n     * @param {string} encodedValue The encoded value\n     * @returns {boolean}           Whether the action is a generic action\n     */\n    #isGenericAction (encodedValue) {\n        const [actionType, actionId] = encodedValue.split(DELIMITER)\n        return actionType === 'utility' && actionId.includes('toggle')\n    }\n\n    /**\n     * Handle generic action\n     * @private\n     * @param {string} encodedValue The encoded value\n     */\n    async #handleGenericActionClick (encodedValue) {\n        const payload = encodedValue.split(DELIMITER)\n        const actionId = payload[1]\n\n        const firstControlledToken = Utils.getFirstControlledToken()\n\n        if (actionId === 'toggleVisibility') await firstControlledToken.toggleVisibility()\n        if (actionId === 'toggleCombat') await firstControlledToken.toggleCombat()\n\n        Hooks.callAll('forceUpdateTokenActionHud')\n    }\n\n    // DEPRECATED\n\n    /**\n     * Overide for the TAH system module\n     * @override\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     */\n    doHandleActionEvent (event, encodedValue) {}\n\n    /**\n     * Renders the item sheet\n     * @public\n     * @param {object} actor  The actor\n     * @param {string} itemId The item id\n     */\n    doRenderItem (actor, itemId) {\n        globalThis.logger.warn('Token Action HUD | RollHandler.doRenderItem is deprecated. Use RollHandler.renderItem')\n        this.renderItem(actor, itemId)\n    }\n}\n","import { RollHandler } from './roll-handler.js'\n\n/*\n * Used for adding support for actions not part of the core functions.\n * Returns true from prehandleActionEvent() if it can perform an action and stops\n * further actions being performed.\n */\nexport class PreRollHandler extends RollHandler {\n    prehandleActionEvent (event, encodedValue) {\n        return false\n    }\n}\n","import { CUSTOM_STYLE, MODULE, TEMPLATE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\nexport class CustomStyleForm extends FormApplication {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            title: Utils.i18n('tokenActionHud.settings.customStyle.form.title'),\n            template: TEMPLATE.customStyleForm,\n            id: 'token-action-hud-core-settings',\n            width: 600,\n            height: 600,\n            popOut: true,\n            resizable: true,\n            closeOnSubmit: true\n        })\n    }\n\n    constructor (...args) {\n        super(args)\n    }\n\n    getData () {\n        this.data = {\n            backgroundColor: Utils.getSetting('backgroundColor', CUSTOM_STYLE.backgroundColor.default),\n            buttonHeight: Utils.getSetting('buttonHeight', CUSTOM_STYLE.buttonHeight.default),\n            buttonBackgroundColor: Utils.getSetting('buttonBackgroundColor', CUSTOM_STYLE.buttonBackgroundColor.default),\n            buttonHoverBackgroundColor: Utils.getSetting('buttonHoverBackgroundColor', CUSTOM_STYLE.buttonHoverBackgroundColor.default),\n            buttonToggleActiveBackgroundColor: Utils.getSetting('buttonToggleActiveBackgroundColor', CUSTOM_STYLE.buttonToggleActiveBackgroundColor.default),\n            buttonToggleHoverBackgroundColor: Utils.getSetting('buttonToggleHoverBackgroundColor', CUSTOM_STYLE.buttonToggleHoverBackgroundColor.default),\n            buttonTextColor: Utils.getSetting('buttonTextColor', CUSTOM_STYLE.buttonTextColor.default),\n            buttonHoverTextColor: Utils.getSetting('buttonHoverTextColor', CUSTOM_STYLE.buttonHoverTextColor.default),\n            buttonToggleActiveTextColor: Utils.getSetting('buttonToggleActiveTextColor', CUSTOM_STYLE.buttonToggleActiveTextColor.default),\n            buttonToggleHoverTextColor: Utils.getSetting('buttonToggleHoverTextColor', CUSTOM_STYLE.buttonToggleHoverTextColor.default),\n            buttonBorderPrimaryColor: Utils.getSetting('buttonBorderPrimaryColor', CUSTOM_STYLE.buttonBorderPrimaryColor.default),\n            buttonBorderSecondaryColor: Utils.getSetting('buttonBorderSecondaryColor', CUSTOM_STYLE.buttonBorderSecondaryColor.default),\n            buttonHoverBorderPrimaryColor: Utils.getSetting('buttonHoverBorderPrimaryColor', CUSTOM_STYLE.buttonHoverBorderPrimaryColor.default),\n            buttonHoverBorderSecondaryColor: Utils.getSetting('buttonHoverBorderSecondaryColor', CUSTOM_STYLE.buttonHoverBorderSecondaryColor.default),\n            buttonToggleActiveBorderPrimaryColor: Utils.getSetting('buttonToggleActiveBorderPrimaryColor', CUSTOM_STYLE.buttonToggleActiveBorderPrimaryColor.default),\n            buttonToggleActiveBorderSecondaryColor: Utils.getSetting('buttonToggleActiveBorderSecondaryColor', CUSTOM_STYLE.buttonToggleActiveBorderSecondaryColor.default),\n            buttonToggleHoverBorderPrimaryColor: Utils.getSetting('buttonToggleHoverBorderPrimaryColor', CUSTOM_STYLE.buttonToggleHoverBorderPrimaryColor.default),\n            buttonToggleHoverBorderSecondaryColor: Utils.getSetting('buttonToggleHoverBorderSecondaryColor', CUSTOM_STYLE.buttonToggleHoverBorderSecondaryColor.default),\n            textPrimaryColor: Utils.getSetting('textPrimaryColor', CUSTOM_STYLE.textPrimaryColor.default),\n            textSecondaryColor: Utils.getSetting('textSecondaryColor', CUSTOM_STYLE.textSecondaryColor.default),\n            textTertiaryColor: Utils.getSetting('textTertiaryColor', CUSTOM_STYLE.textTertiaryColor.default),\n            textHoverPrimaryColor: Utils.getSetting('textHoverPrimaryColor', CUSTOM_STYLE.textHoverPrimaryColor.default),\n            textHoverSecondaryColor: Utils.getSetting('textHoverSecondaryColor', CUSTOM_STYLE.textHoverSecondaryColor.default),\n            textHoverTertiaryColor: Utils.getSetting('textHoverTertiaryColor', CUSTOM_STYLE.textHoverTertiaryColor.default)\n        }\n        return this.data\n    }\n\n    activateListeners (html) {\n        super.activateListeners(html)\n\n        const resetButtonElement = html.find('#tah-custom-style-reset-button')\n        resetButtonElement.on('click', this._reset.bind(this))\n\n        if (typeof ColorPicker !== 'undefined') { ColorPicker.install() }\n    }\n\n    _reset () {\n        for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n            Utils.setSetting(key, value.default)\n            document.querySelector(':root').style.setProperty(value.cssProperty, value.default)\n        }\n        this.render(true)\n    }\n\n    _updateObject (event, formData) {\n        const isCustom = Utils.getSetting('style') === 'custom'\n        for (const [key, value] of Object.entries(formData)) {\n            const customStyle = CUSTOM_STYLE[key]\n            if (value !== this.data[key]) {\n                Utils.setSetting(key, value)\n                if (isCustom) {\n                    document.querySelector(':root').style.setProperty(customStyle.cssProperty, value)\n                }\n            }\n        }\n    }\n}\n","import { CUSTOM_STYLE, MODULE, LAYOUT_SETTING, TEMPLATE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\nexport class TahSettingsForm extends FormApplication {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: TEMPLATE.settings,\n            id: 'token-action-hud-core-settings',\n            width: 600,\n            height: 'auto',\n            closeOnSubmit: true\n        })\n    }\n\n    constructor (...args) {\n        super(args)\n    }\n\n    async getData () {\n        const settings = []\n        for (const [key, setting] of Object.entries(this.settings)) {\n            if (setting?.scope === 'world' && !game.user.isGM) continue\n            const id = key\n            const hint = Utils.i18n(setting.hint)\n            const icon = setting.icon\n            const label = Utils.i18n(setting.label)\n            const name = Utils.i18n(setting.name)\n            const value = (setting?.scope)\n                ? (setting?.scope === 'user')\n                    ? await Utils.getUserFlag(key)\n                    : await Utils.getSetting(key)\n                : ''\n            const type = setting.type instanceof Function ? setting.type.name : 'String'\n            const isButton = setting.inputType === 'button'\n            const onClick = setting.onClick\n            const isCheckbox = setting.inputType === 'checkbox'\n            const isFilePicker = setting.inputType === 'filePicker'\n            const filePickerType = (setting.inputType === 'filePicker') ? type ?? 'any' : ''\n            const isNumber = setting.inputType === 'number'\n            const isRange = (setting.inputType === 'range') && setting.range\n            const isSelect = setting.choices !== undefined\n            settings.push({\n                id,\n                hint,\n                icon,\n                label,\n                name,\n                value,\n                type,\n                isButton,\n                onClick,\n                isCheckbox,\n                isFilePicker,\n                filePickerType,\n                isNumber,\n                isRange,\n                isSelect\n            })\n        }\n        return { settings }\n    }\n\n    activateListeners (html) {\n        super.activateListeners(html)\n\n        super.activateListeners(html)\n        const cancel = html.find('#tah-form-cancel')\n        cancel.on('click', this.close.bind(this))\n    }\n\n    async _updateObject (event, formData) {\n        for (const [key, value] of Object.entries(formData)) {\n            switch (this.settings[key].scope) {\n            case 'client':\n            case 'world':\n                await Utils.setSetting(key, value)\n                break\n            case 'user':\n                await Utils.setUserFlag(key, value)\n            }\n\n            await game.tokenActionHud.updateSettings(key, value)\n        }\n\n        game.tokenActionHud.update()\n    }\n}\n\nexport class TahSettingsFormLayout extends TahSettingsForm {\n    constructor () {\n        super()\n        this.settings = LAYOUT_SETTING\n    }\n\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            title: Utils.i18n('tokenActionHud.settings.layout.form.title')\n        })\n    }\n}\n","import { CustomStyleForm } from './forms/custom-style-form.js'\nimport { TahSettingsFormLayout } from './forms/settings-form.js'\nimport { CUSTOM_STYLE, MODULE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\nfunction onChangeFunction (setting, value) { if (game.tokenActionHud) game.tokenActionHud.updateSettings(setting, value) }\n\n// Register key bindings\nHooks.on('init', async () => {\n    game.keybindings.register(MODULE.ID, 'toggleHud', {\n        name: Utils.i18n('tokenActionHud.toggleHud'),\n        editable: [],\n        onDown: () => { game.tokenActionHud.toggleHud() }\n    })\n})\n\n/**\n * Register module settings\n * @param {object} systemManager The SystemManager class\n * @param {array} rollHandlers   The available roll handlers\n */\nexport const registerSettingsCore = function (systemManager, rollHandlers, styles) {\n    game.settings.registerMenu(MODULE.ID, 'customStyle', {\n        hint: Utils.i18n('tokenActionHud.settings.customStyle.hint'),\n        label: Utils.i18n('tokenActionHud.settings.customStyle.label'),\n        name: Utils.i18n('tokenActionHud.settings.customStyle.name'),\n        icon: 'fas fa-palette',\n        type: CustomStyleForm,\n        restricted: false,\n        scope: 'client'\n    })\n\n    game.settings.registerMenu(MODULE.ID, 'layout', {\n        hint: Utils.i18n('tokenActionHud.settings.layout.hint'),\n        label: Utils.i18n('tokenActionHud.settings.layout.label'),\n        name: Utils.i18n('tokenActionHud.settings.layout.name'),\n        icon: 'fas fa-table-layout',\n        type: TahSettingsFormLayout,\n        restricted: false,\n        scope: 'client'\n    })\n\n    game.settings.register(MODULE.ID, 'startup', {\n        name: 'One-Time Startup Prompt',\n        scope: 'world',\n        config: false,\n        type: Boolean,\n        default: false\n    })\n\n    game.settings.register(MODULE.ID, 'migrationVersion', {\n        name: 'Migration Version',\n        scope: 'world',\n        config: false,\n        type: String,\n        default: '0.0'\n    })\n\n    const styleChoices = Object.fromEntries(Object.entries(styles).map(([key, value]) => [key, value.name]))\n\n    game.settings.register(MODULE.ID, 'style', {\n        name: Utils.i18n('tokenActionHud.settings.style.name'),\n        hint: Utils.i18n('tokenActionHud.settings.style.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'foundryVTT',\n        choices: styleChoices,\n        onChange: (value) => {\n            Utils.switchCSS(value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'customLayout', {\n        name: Utils.i18n('tokenActionHud.settings.customLayout.name'),\n        hint: Utils.i18n('tokenActionHud.settings.customLayout.hint'),\n        scope: 'world',\n        config: false,\n        type: String\n    })\n\n    game.settings.register(MODULE.ID, 'userCustomLayout', {\n        name: Utils.i18n('tokenActionHud.settings.userCustomLayout.name'),\n        hint: Utils.i18n('tokenActionHud.settings.userCustomLayout.hint'),\n        scope: 'client',\n        config: false,\n        type: String\n    })\n\n    game.settings.register(MODULE.ID, 'direction', {\n        name: Utils.i18n('tokenActionHud.settings.direction.name'),\n        hint: Utils.i18n('tokenActionHud.settings.direction.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'auto',\n        choices: {\n            auto: Utils.i18n('tokenActionHud.settings.direction.choice.auto'),\n            up: Utils.i18n('tokenActionHud.settings.direction.choice.up'),\n            down: Utils.i18n('tokenActionHud.settings.direction.choice.down')\n        },\n        onChange: (value) => {\n            onChangeFunction('direction', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'grid', {\n        name: Utils.i18n('tokenActionHud.settings.grid.name'),\n        hint: Utils.i18n('tokenActionHud.settings.grid.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('grid', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'scale', {\n        name: Utils.i18n('tokenActionHud.settings.scale.name'),\n        hint: Utils.i18n('tokenActionHud.settings.scale.hint'),\n        scope: 'client',\n        config: true,\n        type: Number,\n        range: {\n            min: 0.5,\n            max: 2,\n            step: 0.05\n        },\n        default: 1,\n        onChange: (value) => {\n            onChangeFunction('scale', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'drag', {\n        name: Utils.i18n('tokenActionHud.settings.drag.name'),\n        hint: Utils.i18n('tokenActionHud.settings.drag.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'whenUnlocked',\n        choices: {\n            always: Utils.i18n('tokenActionHud.settings.drag.choices.always'),\n            whenUnlocked: Utils.i18n('tokenActionHud.settings.drag.choices.whenUnlocked'),\n            never: Utils.i18n('tokenActionHud.settings.drag.choices.never')\n        },\n        onChange: (value) => {\n            onChangeFunction('drag', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'enable', {\n        name: Utils.i18n('tokenActionHud.settings.enable.name'),\n        hint: Utils.i18n('tokenActionHud.settings.enable.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('enable', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'rollHandler', {\n        name: Utils.i18n('tokenActionHud.settings.rollHandler.name'),\n        hint: Utils.i18n('tokenActionHud.settings.rollHandler.hint'),\n        scope: 'world',\n        config: true,\n        type: String,\n        choices: rollHandlers,\n        default: 'core',\n        onChange: (value) => {\n            onChangeFunction('rollHandler', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'allow', {\n        name: Utils.i18n('tokenActionHud.settings.allow.name'),\n        hint: Utils.i18n('tokenActionHud.settings.allow.hint'),\n        scope: 'world',\n        config: true,\n        type: String,\n        choices: {\n            4: Utils.i18n('tokenActionHud.settings.allow.choice.4'),\n            3: Utils.i18n('tokenActionHud.settings.allow.choice.3'),\n            2: Utils.i18n('tokenActionHud.settings.allow.choice.2'),\n            1: Utils.i18n('tokenActionHud.settings.allow.choice.1')\n        },\n        default: 1,\n        requiresReload: true\n    })\n\n    game.settings.register(MODULE.ID, 'enableCustomization', {\n        name: Utils.i18n('tokenActionHud.settings.enableCustomization.name'),\n        hint: Utils.i18n('tokenActionHud.settings.enableCustomization.hint'),\n        scope: 'world',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('enableCustomization', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'alwaysShowHud', {\n        name: Utils.i18n('tokenActionHud.settings.alwaysShowHud.name'),\n        hint: Utils.i18n('tokenActionHud.settings.alwaysShowHud.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('alwaysShowHud', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'displayCharacterName', {\n        name: Utils.i18n('tokenActionHud.settings.displayCharacterName.name'),\n        hint: Utils.i18n('tokenActionHud.settings.displayCharacterName.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('displayCharacterName', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'sortActions', {\n        name: Utils.i18n('tokenActionHud.settings.sortActions.name'),\n        hint: Utils.i18n('tokenActionHud.settings.sortActions.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('sortActions', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'displayIcons', {\n        name: Utils.i18n('tokenActionHud.settings.displayIcons.name'),\n        hint: Utils.i18n('tokenActionHud.settings.displayIcons.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('displayIcons', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'tooltips', {\n        name: Utils.i18n('tokenActionHud.settings.tooltips.name'),\n        hint: Utils.i18n('tokenActionHud.settings.tooltips.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'full',\n        choices: {\n            full: Utils.i18n('tokenActionHud.settings.tooltips.choices.full'),\n            nameOnly: Utils.i18n('tokenActionHud.settings.tooltips.choices.nameOnly'),\n            none: Utils.i18n('tokenActionHud.settings.tooltips.choices.none')\n        },\n        onChange: (value) => {\n            onChangeFunction('tooltips', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'tooltipDelay', {\n        name: Utils.i18n('tokenActionHud.settings.tooltipDelay.name'),\n        hint: Utils.i18n('tokenActionHud.settings.tooltipDelay.hint'),\n        scope: 'client',\n        config: true,\n        type: Number,\n        default: 1500,\n        onChange: (value) => {\n            setTooltipDelay(value)\n        }\n    })\n\n    const tooltipDelay = Utils.getSetting('tooltipDelay') || 1500\n    setTooltipDelay(tooltipDelay)\n\n    function setTooltipDelay (ms) {\n        const root = document.querySelector(':root')\n        root.style.setProperty('--tah-tooltip-delay', `${ms}ms`)\n    }\n\n    game.settings.register(MODULE.ID, 'clickOpenCategory', {\n        name: Utils.i18n('tokenActionHud.settings.clickOpenCategory.name'),\n        hint: Utils.i18n('tokenActionHud.settings.clickOpenCategory.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('clickOpenCategory', value)\n        }\n    })\n\n    if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) {\n        game.settings.register(MODULE.ID, 'itemMacro', {\n            name: Utils.i18n('tokenActionHud.settings.itemMacro.name'),\n            hint: Utils.i18n('tokenActionHud.settings.itemMacro.hint'),\n            scope: 'client',\n            config: true,\n            type: String,\n            choices: {\n                both: Utils.i18n('tokenActionHud.settings.itemMacro.choices.both'),\n                itemMacro: Utils.i18n('tokenActionHud.settings.itemMacro.choices.itemMacro'),\n                original: Utils.i18n('tokenActionHud.settings.itemMacro.choices.original')\n            },\n            default: 'both',\n            onChange: (value) => {\n                onChangeFunction('itemMacro', value)\n            }\n        })\n    }\n\n    game.settings.register(MODULE.ID, 'activeCssAsText', {\n        name: Utils.i18n('tokenActionHud.settings.activeCssAsText.name'),\n        hint: Utils.i18n('tokenActionHud.settings.activeCssAsText.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('activeCssAsText', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'debug', {\n        name: Utils.i18n('tokenActionHud.settings.debug.name'),\n        hint: Utils.i18n('tokenActionHud.settings.debug.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('debug', value)\n        }\n    })\n\n    registerCustomStyleSettings()\n\n    if (systemManager.registerSettings.toString().slice(-2) !== '{}') {\n        systemManager.registerSettings(onChangeFunction)\n    } else {\n        globalThis.logger.warn('Token Action HUD | SystemHandler.doRegisterSettings is deprecated. Use SystemHandler.registerSettings')\n        systemManager.doRegisterSettings(onChangeFunction)\n    }\n\n    Logger.debug('Available roll handlers', { rollHandlers })\n}\n\n/**\n * Register color settings\n */\nfunction registerCustomStyleSettings () {\n    for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n        game.settings.register(MODULE.ID, key, {\n            scope: 'client',\n            config: false,\n            type: value.type,\n            default: value.default\n        })\n    }\n}\n","import { ActionHandlerExtender } from './action-handler-extender.js'\nimport { DELIMITER, ITEM_MACRO_ICON } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building actions related to the Item Macro module.\n */\nexport class ItemMacroActionHandlerExtender extends ActionHandlerExtender {\n    constructor (actionHandler) {\n        super(actionHandler)\n        this.actionHandler = actionHandler\n        this.actor = this.actionHandler.actor\n        this.token = this.actionHandler.token\n    }\n\n    /**\n     * Extend the action list\n     * @override\n     */\n    extendActionHandler () {\n        // Update actor and token with current action handler context\n        this.actor = this.actionHandler.actor\n        this.token = this.actionHandler.token\n\n        if (!this.actor) return\n        const items = this.actor.items.filter((item) => item.flags?.itemacro?.macro?.command)\n\n        let itemIds\n        if (Utils.isModuleActive('midi-qol')) {\n            itemIds = items\n                .filter(this.#isUnsupportedByMidiQoL)\n                .map((item) => item.id)\n        } else {\n            itemIds = items.map((item) => item.id)\n        }\n\n        if (!itemIds) return\n\n        if (itemIds.length === 0) return\n\n        const itemMacroSetting = Utils.getSetting('itemMacro')\n\n        if (itemMacroSetting === 'original') return\n\n        const replace = itemMacroSetting === 'itemMacro'\n\n        Object.keys(this.actionHandler.groups).forEach(groupKey => {\n            const group = this.actionHandler.groups[groupKey]\n            this.#addGroupActions(itemIds, group, replace)\n        })\n    }\n\n    /**\n     * Add group actions\n     * @private\n     * @param {array} itemIds   The list of item IDs\n     * @param {object} group    The group\n     * @param {boolean} replace Whether to replace the action or not\n     */\n    #addGroupActions (itemIds, group, replace) {\n        // Exit if no actions exist\n        if (!group?.actions?.length) return\n\n        const actions = []\n        group.actions.forEach(existingAction => {\n            if (!itemIds.includes(existingAction.id)) return\n\n            const existingItemMacroAction = group.actions.find(action => action.id === `itemMacro+${existingAction.id}`)\n            const actionToReplace = existingItemMacroAction ?? existingAction\n\n            if (existingItemMacroAction) {\n                replace = true\n            }\n\n            const macroAction = this.#createItemMacroAction(existingAction, actionToReplace, replace)\n\n            if (!replace) actions.push(macroAction)\n        })\n\n        this.#addActions(actions, group)\n    }\n\n    /**\n     * Create item macro action\n     * @private\n     * @param {object} existingAction  The existing action\n     * @param {object} actionToReplace The action to replace\n     * @param {boolean} replace        Whether to replace the action or not\n     * @returns {object}               The item macro action\n     */\n    #createItemMacroAction (existingAction, actionToReplace, replace) {\n        const action = (replace) ? actionToReplace : Utils.deepClone(existingAction)\n        action.encodedValue = `itemMacro${existingAction.encodedValue?.substr(existingAction.encodedValue.indexOf(DELIMITER))}`\n        action.id = `itemMacro+${existingAction.id}`\n        action.fullName = existingAction.fullName\n        action.listName = `Item Macro: ${existingAction.fullName}`\n        action.name = existingAction.name\n        action.itemMacroIcon = `<i class=\"${ITEM_MACRO_ICON.ICON}\" data-tooltip=\"${ITEM_MACRO_ICON.TOOLTIP}\"></i>`\n        return action\n    }\n\n    /**\n     * Add actions to the group\n     * @private\n     * @param {object} actions The actions\n     * @param {object} group   The group\n     */\n    #addActions (actions, group) {\n        actions.forEach(macroAction => {\n            const index = group.actions.findIndex(action => action.id === macroAction.id) + 1\n            group.actions.splice(index, 0, macroAction)\n        })\n    }\n\n    /**\n     * Whether the item is supported by MidiQoL or not\n     * @private\n     * @param {object} item The item\n     * @returns {boolean}\n     */\n    #isUnsupportedByMidiQoL (item) {\n        const flag = item.getFlag('midi-qol', 'onUseMacroName')\n        return !flag\n    }\n}\n","import { PreRollHandler } from './pre-roll-handler.js'\nimport { COMPENDIUM_ACTION_TYPES, DELIMITER } from '../constants.js'\n\nexport class CompendiumMacroPreHandler extends PreRollHandler {\n    /** @override */\n    prehandleActionEvent (event, encodedValue) {\n        const payload = encodedValue.split(DELIMITER)\n\n        if (payload.length < 2) return false\n\n        let actionType = null\n        let key = null\n        let actionId = null\n\n        if (payload.length === 2) {\n            actionType = payload[0]\n            actionId = payload[1]\n        }\n        if (payload.length === 3) {\n            actionType = payload[0]\n            key = payload[1]\n            actionId = payload[2]\n        }\n\n        if (!COMPENDIUM_ACTION_TYPES.includes(actionType)) return false\n\n        switch (actionType) {\n        case 'compendiumEntry':\n            this.#handleCompendium(key, actionId)\n            break\n        case 'compendiumMacro':\n            this.#handleMacroCompendium(key, actionId)\n            break\n        case 'compendiumPlaylist':\n            this.#handlePlaylistCompendium(key, actionId)\n            break\n        case 'macro':\n            this.#handleMacro(actionId)\n            break\n        default:\n            return false\n        }\n\n        return true\n    }\n\n    /**\n     * Handle compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    #handleCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        pack.getDocument(actionId).then((entity) => entity.sheet.render(true))\n    }\n\n    /**\n     * Handle macro compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    #handleMacroCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        pack.getDocument(actionId).then((entity) => entity.execute())\n    }\n\n    /**\n     * Handle playlist compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    async #handlePlaylistCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        const actionPayload = actionId.split('>')\n        const playlistId = actionPayload[0]\n        const soundId = actionPayload[1]\n        const playlist = await pack.getDocument(playlistId)\n        const sound = playlist.sounds.find((sound) => sound._id === soundId)\n        AudioHelper.play({ src: sound.path }, {})\n    }\n\n    /**\n     * Handle macro\n     * @private\n     * @param {string} actionId The action id\n     */\n    #handleMacro (actionId) {\n        game.macros.get(actionId).execute()\n    }\n}\n","import { PreRollHandler } from './pre-roll-handler.js'\nimport { DELIMITER } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\nexport class ItemMacroPreRollHandler extends PreRollHandler {\n    /** @override */\n    prehandleActionEvent (event, encodedValue, actionHandler) {\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        const payload = encodedValue.split(DELIMITER)\n\n        if (payload.length !== 2) return false\n\n        const actionType = payload[0]\n        const actionId = payload[1]\n\n        if (actionType !== 'itemMacro') return false\n\n        if (this.isRenderItem()) {\n            this.doRenderItem(this.actor, actionId)\n            return true\n        }\n\n        return this.#tryExecuteItemMacro(actionId)\n    }\n\n    /**\n     * Try to execute item macro\n     * @private\n     * @param {string} actionId The action id\n     * @returns {boolean}       Whether the item macro executed\n     */\n    #tryExecuteItemMacro (actionId) {\n        const item = Utils.getItem(this.actor, actionId)\n\n        try {\n            item.executeMacro()\n        } catch (e) {\n            Logger.debug('ItemMacro Error', e)\n            return false\n        }\n\n        return true\n    }\n}\n","import { registerSettingsCore } from './settings.js'\nimport { ItemMacroActionHandlerExtender } from './action-handlers/item-macro-extender.js'\nimport { CompendiumMacroPreHandler } from './roll-handlers/compendium-macro-pre-handler.js'\nimport { ItemMacroPreRollHandler } from './roll-handlers/pre-item-macro.js'\nimport { MODULE, CSS_STYLE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\nexport class SystemManager {\n    constructor () {\n        this.coreModuleId = MODULE.ID\n        this.styles = null\n    }\n\n    /** ACTION HANDLERS */\n    /** OVERRIDDEN BY SYSTEM */\n\n    getActionHandler () {}\n    getRollHandler (rollHandlerId) {}\n    getAvailableRollHandlers () {}\n    registerSettings (onChangeFunction) {}\n    async registerDefaults () {}\n\n    /**\n     * Register defaults\n     * @public\n     */\n    async registerDefaultsCore () {\n        let func = null\n        if (this.registerDefaults.toString().slice(-2) !== '{}') {\n            func = this.registerDefaults\n        } else {\n            globalThis.logger.warn('Token Action HUD | SystemHandler.doRegisterDefaultFlags is deprecated. Use SystemHandler.registerDefaults')\n            func = this.doRegisterDefaultFlags\n        }\n        const defaults = await func() ?? []\n\n        Hooks.callAll('tokenActionHudCoreRegisterDefaults', defaults)\n\n        if (defaults) {\n            game.tokenActionHud.defaults = defaults\n        }\n    }\n\n    /**\n     * Register styles\n     */\n    async registerStylesCore () {\n        const systemStyles = this.registerStyles() ?? {}\n        this.styles = foundry.utils.mergeObject(CSS_STYLE, systemStyles)\n\n        Hooks.callAll('tokenActionHudCoreRegisterStyles', this.styles)\n    }\n\n    /**\n     * @override\n     */\n    async registerStyles () {}\n\n    /**\n     * Initialise the action handler\n     * @public\n     * @returns {class} The ActionHandler class\n     */\n    async getActionHandlerCore () {\n        let func = null\n        if (this.getActionHandler.toString().slice(-2) !== '{}') {\n            func = this.getActionHandler\n        } else {\n            globalThis.logger.warn('Token Action HUD | SystemHandler.doGetActionHandler is deprecated. Use SystemHandler.getActionHandler')\n            func = this.doGetActionHandler\n        }\n        const actionHandler = func()\n\n        this.#addActionHandlerExtenders(actionHandler)\n\n        return actionHandler\n    }\n\n    /**\n     * Add action handler extensions\n     * @public\n     * @param {class} actionHandler The ActionHandler class\n     */\n    #addActionHandlerExtenders (actionHandler) {\n        if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) {\n            actionHandler.addActionHandlerExtender(new ItemMacroActionHandlerExtender(actionHandler))\n        }\n\n        Hooks.callAll('tokenActionHudCoreAddActionHandlerExtenders', actionHandler)\n    }\n\n    /**\n     * Get the roll handler\n     * @public\n     * @returns {class} The RollHandler class\n     */\n    getRollHandlerCore () {\n        let rollHandlerId = Utils.getSetting('rollHandler')\n\n        if (!(rollHandlerId === 'core' || Utils.isModuleActive(rollHandlerId))) {\n            Logger.error(rollHandlerId, Utils.i18n('tokenActionHud.handlerNotFound'))\n            rollHandlerId = 'core'\n            Utils.setSetting('rollHandler', rollHandlerId)\n        }\n\n        let func = null\n        if (this.getRollHandler.toString().slice(-2) !== '{}') {\n            func = this.getRollHandler\n        } else {\n            globalThis.logger.warn('Token Action HUD | SystemHandler.doGetRollHandler is deprecated. Use SystemHandler.getRollHandler')\n            func = this.doGetRollHandler\n        }\n        const rollHandler = func(rollHandlerId)\n        this.addPreHandlers(rollHandler)\n        return rollHandler\n    }\n\n    /**\n     * Add pre-handlers\n     * @public\n     * @param {object} rollHandler\n     */\n    addPreHandlers (rollHandler) {\n        rollHandler.addPreRollHandler(new CompendiumMacroPreHandler())\n\n        if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) {\n            rollHandler.addPreRollHandler(new ItemMacroPreRollHandler())\n        }\n    }\n\n    /**\n     * Register module settings\n     * @public\n     */\n    registerSettingsCore () {\n        const rollHandlers = this.getAvailableRollHandlers()\n        registerSettingsCore(this, rollHandlers, this.styles)\n    }\n\n    /**\n     * Add handler\n     * @param {array} choices The choices\n     * @param {string} id     The module id\n     */\n    static addHandler (choices, id) {\n        if (Utils.isModuleActive(id)) {\n            const title = Utils.getModuleTitle(id)\n            foundry.utils.mergeObject(choices, { [id]: title })\n        }\n    }\n\n    // DEPRECATED\n    doGetActionHandler () {}\n    doGetRollHandler (rollHandlerId) {}\n    async doRegisterDefaultFlags () {}\n    doRegisterSettings (onChangeFunction) {}\n}\n","!function(t,e){var s=s||{};\"function\"==typeof s&&s.amd?s([],e):\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"object\"==typeof exports?exports.DragSort=e():t.DragSort=e()}(this,(function(){var t,e=0,s={},i={},r=(t=window.MutationObserver||window.WebKitMutationObserver,function(e,s){e&&1===e.nodeType&&(t?new t((function(t,e){s(t)})).observe(e,{childList:!0,subtree:!1}):window.addEventListener&&e.addEventListener(\"DOMNodeInserted\",s,!1))});function a(t,e){if(!t)return this;e=e||{},this.parentElm=t,this.uid=e.uid,this.settings={selector:\"*\",callbacks:{}},Object.assign(this.settings,e),this.setup(),r(this.parentElm,this.setup.bind(this)),this.bindEvents()}return a.prototype={namespace:\"dragsort\",setup(){[...this.parentElm.childNodes].forEach((t=>{if(1!=t.nodeType)return t.parentNode.removeChild(t);t.matches(this.settings.selector)&&(t.draggable=!0)})),this.gap=this.getItemsGap(this.parentElm.firstElementChild)},throttle(t,e){var s=!1,i=this;return function(r){s||(t.call(i,r),s=!0,setTimeout((()=>s=!1),e))}},getDraggableElm(t){if(!t.closest)return null;var e=t.closest('[draggable=\"true\"]');return this.uid==s.uid?e:null},dragstart(t,e){s=this;var i,r=this.getDraggableElm(e);r?(this.source=this.getInitialState(),this.target=this.getInitialState(),i=r.getBoundingClientRect(),this.source.elm=r,this.source.idx=this.getNodeIndex(r),this.source.size.width=i.width,this.source.size.height=i.height,t.dataTransfer.effectAllowed=\"move\",this.settings.callbacks.dragStart&&this.settings.callbacks.dragStart(this.source.elm,t),setTimeout(this.afterDragStart.bind(this))):s={}},afterDragStart(){var t=\"vertical\"==this.settings.mode?\"height\":\"width\";this.parentElm.classList.add(`${this.namespace}--dragStart`),this.source.elm.style[t]=this.source.size[t]+\"px\",this.source.elm.classList.add(`${this.namespace}--dragElem`)},dragover(t){t.preventDefault(),t.stopPropagation();var e=t.target;if((e=this.getDraggableElm(e))&&this.target){var s=this.target.elm,i=this.target.hoverDirection;t.dataTransfer.dropEffect=\"move\",this.target.hoverDirection=this.getTargetDirection(t),s==e&&i==this.target.hoverDirection||this.directionAwareDragEnter(t,e)}},dragenter(t,e){(e=this.getDraggableElm(e))&&this.target&&this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(this.target.bounding=e.getBoundingClientRect())},directionAwareDragEnter(t,e){var s;t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=\"none\",this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(t.dataTransfer.dropEffect=\"move\",this.cleanupLastTarget(),this.target.elm=e,this.target.idx=this.getNodeIndex(e),e.classList.add(\"over\"),s=Math.abs(this.target.idx-this.source.idx),this.source.elm.classList.toggle(`${this.namespace}--hide`,s>0),\"vertical\"==this.settings.mode?this.target.elm.style[this.target.hoverDirection?\"marginBottom\":\"marginTop\"]=this.source.size.height+this.gap+\"px\":this.target.elm.style[this.target.hoverDirection?\"marginRight\":\"marginLeft\"]=this.source.size.width+this.gap+\"px\")},dragend(t){if(clearTimeout(this.dragoverTimeout),this.dragoverTimeout=null,this.parentElm.classList.remove(`${this.namespace}--dragStart`),!this.isValidElm(this.target.elm))return this.cleanup();var e=this.target.hoverDirection?this.target.elm.nextElementSibling:this.target.elm;return this.source.elm!=this.target.elm&&this.target.elm&&(this.target.elm.classList.add(`${this.namespace}--noAnim`),this.cleanup(),this.parentElm.insertBefore(this.source.elm,e)),this.source.elm&&this.source.elm.classList.remove(`${this.namespace}--dragElem`,`${this.namespace}--hide`),this.settings.callbacks.dragEnd&&this.settings.callbacks.dragEnd(this.source.elm),this},isTargetLastChild(){return this.parentElm.lastElementChild==this.target.elm},getTargetDirection(t){if(this.target.bounding)return\"vertical\"==this.settings.mode?t.pageY>this.target.bounding.top+this.target.bounding.height/2?1:0:t.pageX>this.target.bounding.left+this.target.bounding.width/2?1:0},getNodeIndex(t){for(var e=0;t=t.previousSibling;)3==t.nodeType&&/^\\s*$/.test(t.data)||e++;return e},isValidElm(t){return t&&t.nodeType&&t.parentNode==this.parentElm},cleanup(){s={},[...this.parentElm.children].forEach((t=>{t.removeAttribute(\"style\"),setTimeout((()=>{t.classList.remove(`${this.namespace}--over`,`${this.namespace}--noAnim`,`${this.namespace}--dragElem`)}),50)}))},cleanupLastTarget(){this.target.elm&&(this.target.elm.classList.remove(`${this.namespace}--hide`,`${this.namespace}--over`),this.target.elm.removeAttribute(\"style\"))},getInitialState:()=>({elm:null,size:{}}),getItemsGap(t){var e=getComputedStyle(t),s=getComputedStyle(t.parentNode),i=\"vertical\"==this.settings.mode,r=parseInt(s.gap)||0;return parseInt(e[\"margin\"+(i?\"Top\":\"Left\")])+parseInt(e[\"margin\"+(i?\"Bottom\":\"Right\")])+r},bindEvents(t){for(var e in this.listeners=this.listeners||{dragstart:t=>this.dragstart(t,t.target),dragenter:t=>this.dragenter(t,t.target),dragend:t=>this.dragend(t,t.target),dragover:this.throttle(this.dragover,350)},this.listeners)this.parentElm[t?\"removeEventListener\":\"addEventListener\"](e,this.listeners[e])},destroy(){this.cleanup(),this.bindEvents(!0),delete i[this.uid]}},function(t,s){return i[++e]=t.DragSort?i[t.DragSort]:new a(t,{...s,uid:e}),t.DragSort=e,i[e]}}));","/**\n * Tagify (v 4.17.8) - tags input component\n * By undefined\n * https://github.com/yairEO/tagify\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n * \r\n * THE SOFTWARE IS NOT PERMISSIBLE TO BE SOLD.\n */\n\n!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).Tagify=e()}(this,(function(){\"use strict\";function t(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function e(e){for(var s=1;s<arguments.length;s++){var a=null!=arguments[s]?arguments[s]:{};s%2?t(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||\"default\");if(\"object\"!=typeof s)return s;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const s=(t,e,i,s)=>(t=\"\"+t,e=\"\"+e,s&&(t=t.trim(),e=e.trim()),i?t==e:t.toLowerCase()==e.toLowerCase()),a=(t,e)=>t&&Array.isArray(t)&&t.map((t=>n(t,e)));function n(t,e){var i,s={};for(i in t)e.indexOf(i)<0&&(s[i]=t[i]);return s}function o(t){var e=document.createElement(\"div\");return t.replace(/\\&#?[0-9a-z]+;/gi,(function(t){return e.innerHTML=t,e.innerText}))}function r(t){return(new DOMParser).parseFromString(t.trim(),\"text/html\").body.firstElementChild}function l(t,e){for(e=e||\"previous\";t=t[e+\"Sibling\"];)if(3==t.nodeType)return t}function d(t){return\"string\"==typeof t?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\").replace(/`|'/g,\"&#039;\"):t}function h(t){var e=Object.prototype.toString.call(t).split(\" \")[1].slice(0,-1);return t===Object(t)&&\"Array\"!=e&&\"Function\"!=e&&\"RegExp\"!=e&&\"HTMLUnknownElement\"!=e}function g(t,e,i){function s(t,e){for(var i in e)if(e.hasOwnProperty(i)){if(h(e[i])){h(t[i])?s(t[i],e[i]):t[i]=Object.assign({},e[i]);continue}if(Array.isArray(e[i])){t[i]=Object.assign([],e[i]);continue}t[i]=e[i]}}return t instanceof Object||(t={}),s(t,e),i&&s(t,i),t}function p(){const t=[],e={};for(let i of arguments)for(let s of i)h(s)?e[s.value]||(t.push(s),e[s.value]=1):t.includes(s)||t.push(s);return t}function c(t){return String.prototype.normalize?\"string\"==typeof t?t.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g,\"\"):void 0:t}var u=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent);function m(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}function v(t){return t&&t.classList&&t.classList.contains(this.settings.classNames.tag)}function f(t,e){var i=window.getSelection();return e=e||i.getRangeAt(0),\"string\"==typeof t&&(t=document.createTextNode(t)),e&&(e.deleteContents(),e.insertNode(t)),t}function T(t,e,i){return t?(e&&(t.__tagifyTagData=i?e:g({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(console.warn(\"tag element doesn't exist\",t,e),e)}var w={delimiters:\",\",pattern:null,tagTextProp:\"value\",maxTags:1/0,callbacks:{},addTagOnBlur:!0,onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\\.|\\:|\\s/,mixTagsInterpolator:[\"[[\",\"]]\"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:\" \"},autoComplete:{enabled:!0,rightKey:!1},classNames:{namespace:\"tagify\",mixMode:\"tagify--mix\",selectMode:\"tagify--select\",input:\"tagify__input\",focus:\"tagify--focus\",tagNoAnimation:\"tagify--noAnim\",tagInvalid:\"tagify--invalid\",tagNotAllowed:\"tagify--notAllowed\",scopeLoading:\"tagify--loading\",hasMaxTags:\"tagify--hasMaxTags\",hasNoTags:\"tagify--noTags\",empty:\"tagify--empty\",inputInvalid:\"tagify__input--invalid\",dropdown:\"tagify__dropdown\",dropdownWrapper:\"tagify__dropdown__wrapper\",dropdownHeader:\"tagify__dropdown__header\",dropdownFooter:\"tagify__dropdown__footer\",dropdownItem:\"tagify__dropdown__item\",dropdownItemActive:\"tagify__dropdown__item--active\",dropdownItemHidden:\"tagify__dropdown__item--hidden\",dropdownInital:\"tagify__dropdown--initial\",tag:\"tagify__tag\",tagText:\"tagify__tag-text\",tagX:\"tagify__tag__removeBtn\",tagLoading:\"tagify__tag--loading\",tagEditing:\"tagify__tag--editable\",tagFlash:\"tagify__tag--flash\",tagHide:\"tagify__tag--hide\"},dropdown:{classname:\"\",enabled:2,maxItems:10,searchKeys:[\"value\",\"searchBy\"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,highlightFirst:!1,closeOnSelect:!0,clearOnSelect:!0,position:\"all\",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve()}};function b(){this.dropdown={};for(let t in this._dropdown)this.dropdown[t]=\"function\"==typeof this._dropdown[t]?this._dropdown[t].bind(this):this._dropdown[t];this.dropdown.refs()}var y={refs(){this.DOM.dropdown=this.parseTemplate(\"dropdown\",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-wrapper']\")},getHeaderRef(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-header']\")},getFooterRef(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-footer']\")},getAllSuggestionsRefs(){return[...this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector)]},show(t){var e,i,a,n=this.settings,o=\"mix\"==n.mode&&!n.enforceWhitelist,r=!n.whitelist||!n.whitelist.length,l=\"manual\"==n.dropdown.position;if(t=void 0===t?this.state.inputText:t,!(r&&!o&&!n.templates.dropdownItemNoMatch||!1===n.dropdown.enable||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger(\"dropdown:noMatch\",t),n.templates.dropdownItemNoMatch&&(a=n.templates.dropdownItemNoMatch.call(this,{value:t}))),!a){if(this.suggestedListItems.length)t&&o&&!this.state.editing.scope&&!s(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!o||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}i=\"\"+(h(e=this.suggestedListItems[0])?e.value:e),n.autoComplete&&i&&0==i.indexOf(t)&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(a),n.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(n.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),l||setTimeout((()=>{this.dropdown.position(),this.dropdown.render()})),setTimeout((()=>{this.trigger(\"dropdown:show\",this.DOM.dropdown)}))}},hide(t){var e=this.DOM,i=e.scope,s=e.dropdown,a=\"manual\"==this.settings.dropdown.position&&!t;if(s&&document.body.contains(s)&&!a)return window.removeEventListener(\"resize\",this.dropdown.position),this.dropdown.events.binding.call(this,!1),i.setAttribute(\"aria-expanded\",!1),s.parentNode.removeChild(s),setTimeout((()=>{this.state.dropdown.visible=!1}),100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger(\"dropdown:hide\",s),this},toggle(t){this.dropdown[this.state.dropdown.visible&&!t?\"hide\":\"show\"]()},render(){var t,e,i,s=(t=this.DOM.dropdown,(i=t.cloneNode(!0)).style.cssText=\"position:fixed; top:-9999px; opacity:0\",document.body.appendChild(i),e=i.clientHeight,i.parentNode.removeChild(i),e),a=this.settings;return\"number\"==typeof a.dropdown.enabled&&a.dropdown.enabled>=0?(this.DOM.scope.setAttribute(\"aria-expanded\",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a.classNames.dropdownInital),this.dropdown.position(s),a.dropdown.appendTarget.appendChild(this.DOM.dropdown),setTimeout((()=>this.DOM.dropdown.classList.remove(a.classNames.dropdownInital)))),this):this},fill(t){t=\"string\"==typeof t?t:this.dropdown.createListHTML(t||this.suggestedListItems);var e,i=this.settings.templates.dropdownContent.call(this,t);this.DOM.dropdown.content.innerHTML=(e=i)?e.replace(/\\>[\\r\\n ]+\\</g,\"><\").replace(/(<.*?>)|\\s+/g,((t,e)=>e||\" \")):\"\"},fillHeaderFooter(){var t=this.dropdown.filterListItems(this.state.dropdown.query),e=this.parseTemplate(\"dropdownHeader\",[t]),i=this.parseTemplate(\"dropdownFooter\",[t]),s=this.dropdown.getHeaderRef(),a=this.dropdown.getFooterRef();e&&s?.parentNode.replaceChild(e,s),i&&a?.parentNode.replaceChild(i,a)},refilter(t){t=t||this.state.dropdown.query||\"\",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger(\"dropdown:updated\",this.DOM.dropdown)},position(t){var e=this.settings.dropdown;if(\"manual\"!=e.position){var i,s,a,n,o,r,l=this.DOM.dropdown,d=e.placeAbove,h=e.appendTarget===document.body,g=h?window.pageYOffset:e.appendTarget.scrollTop,p=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,c=p.clientHeight,u=Math.max(p.clientWidth||0,window.innerWidth||0)>480?e.position:\"all\",m=this.DOM[\"input\"==u?\"input\":\"scope\"];if(t=t||l.clientHeight,this.state.dropdown.visible){if(\"text\"==u?(a=(i=function(){const t=document.getSelection();if(t.rangeCount){const e=t.getRangeAt(0),i=e.startContainer,s=e.startOffset;let a,n;if(s>0)return n=document.createRange(),n.setStart(i,s-1),n.setEnd(i,s),a=n.getBoundingClientRect(),{left:a.right,top:a.top,bottom:a.bottom};if(i.getBoundingClientRect)return i.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,s=i.top,n=i.left,o=\"auto\"):(r=function(t){for(var e=0,i=0;t&&t!=p;)e+=t.offsetLeft||0,i+=t.offsetTop||0,t=t.parentNode;return{left:e,top:i}}(e.appendTarget),s=(i=m.getBoundingClientRect()).top-r.top,a=i.bottom-1-r.top,n=i.left-r.left,o=i.width+\"px\"),!h){let t=function(){for(var t=0,i=e.appendTarget.parentNode;i;)t+=i.scrollTop||0,i=i.parentNode;return t}();s+=t,a+=t}s=Math.floor(s),a=Math.ceil(a),d=void 0===d?c-i.bottom<t:d,l.style.cssText=\"left:\"+(n+window.pageXOffset)+\"px; width:\"+o+\";\"+(d?\"top: \"+(s+g)+\"px\":\"top: \"+(a+g)+\"px\"),l.setAttribute(\"placement\",d?\"top\":\"bottom\"),l.setAttribute(\"position\",u)}}},events:{binding(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},s=t?\"addEventListener\":\"removeEventListener\";\"manual\"!=this.settings.dropdown.position&&(document[s](\"scroll\",i.position,!0),window[s](\"resize\",i.position),window[s](\"keydown\",i.onKeyDown)),this.DOM.dropdown[s](\"mouseover\",i.onMouseOver),this.DOM.dropdown[s](\"mouseleave\",i.onMouseLeave),this.DOM.dropdown[s](\"mousedown\",i.onClick),this.DOM.dropdown.content[s](\"scroll\",i.onScroll)},callbacks:{onKeyDown(t){if(this.state.hasFocus&&!this.state.composing){var e=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownItemActiveSelector),i=this.dropdown.getSuggestionDataByNode(e);switch(t.key){case\"ArrowDown\":case\"ArrowUp\":case\"Down\":case\"Up\":t.preventDefault();var s=this.dropdown.getAllSuggestionsRefs(),a=\"ArrowUp\"==t.key||\"Up\"==t.key;e&&(e=this.dropdown.getNextOrPrevOption(e,!a)),e&&e.matches(this.settings.classNames.dropdownItemSelector)||(e=s[a?s.length-1:0]),this.dropdown.highlightOption(e,!0);break;case\"Escape\":case\"Esc\":this.dropdown.hide();break;case\"ArrowRight\":if(this.state.actions.ArrowLeft)return;case\"Tab\":if(\"mix\"!=this.settings.mode&&e&&!this.settings.autoComplete.rightKey&&!this.state.editing){t.preventDefault();var n=this.dropdown.getMappedValue(i);return this.input.autocomplete.set.call(this,n),!1}return!0;case\"Enter\":t.preventDefault(),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:e}).then((()=>{if(e)return this.dropdown.selectOption(e),e=this.dropdown.getNextOrPrevOption(e,!a),void this.dropdown.highlightOption(e);this.dropdown.hide(),\"mix\"!=this.settings.mode&&this.addTags(this.state.inputText.trim(),!0)})).catch((t=>t));break;case\"Backspace\":{if(\"mix\"==this.settings.mode||this.state.editing.scope)return;const t=this.input.raw.call(this);\"\"!=t&&8203!=t.charCodeAt(0)||(!0===this.settings.backspace?this.removeTags():\"edit\"==this.settings.backspace&&setTimeout(this.editTag.bind(this),0))}}}},onMouseOver(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);e&&this.dropdown.highlightOption(e)},onMouseLeave(t){this.dropdown.highlightOption()},onClick(t){if(0==t.button&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var e=t.target.closest(this.settings.classNames.dropdownItemSelector),i=this.dropdown.getSuggestionDataByNode(e);this.state.actions.selectOption=!0,setTimeout((()=>this.state.actions.selectOption=!1),50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:e}).then((()=>{e?this.dropdown.selectOption(e,t):this.dropdown.hide()})).catch((t=>console.warn(t)))}},onScroll(t){var e=t.target,i=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger(\"dropdown:scroll\",{percentage:Math.round(i)})}}},getSuggestionDataByNode(t){var e=t&&t.getAttribute(\"value\");return this.suggestedListItems.find((t=>t.value==e))||null},getNextOrPrevOption(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=this.dropdown.getAllSuggestionsRefs(),s=i.findIndex((e=>e===t));return e?i[s+1]:i[s-1]},highlightOption(t,e){var i,s=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(s),this.state.ddItemElm.removeAttribute(\"aria-selected\")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.dropdown.getSuggestionDataByNode(t),this.state.ddItemData=i,this.state.ddItemElm=t,t.classList.add(s),t.setAttribute(\"aria-selected\",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption(t,e){var i=this.settings.dropdown,s=i.clearOnSelect,a=i.closeOnSelect;if(!t)return this.addTags(this.state.inputText,!0),void(a&&this.dropdown.hide());e=e||{};var n=t.getAttribute(\"value\"),o=\"noMatch\"==n,r=this.suggestedListItems.find((t=>(t.value??t)==n));this.trigger(\"dropdown:select\",{data:r,elm:t,event:e}),n&&(r||o)?(this.state.editing?this.onEditTagDone(null,g({__isValid:!0},this.normalizeTags([r])[0])):this[\"mix\"==this.settings.mode?\"addMixTags\":\"addTags\"]([r||this.input.raw.call(this)],s),this.DOM.input.parentNode&&(setTimeout((()=>{this.DOM.input.focus(),this.toggleFocusClass(!0)})),a&&setTimeout(this.dropdown.hide.bind(this)),t.addEventListener(\"transitionend\",(()=>{this.dropdown.fillHeaderFooter(),setTimeout((()=>t.remove()),100)}),{once:!0}),t.classList.add(this.settings.classNames.dropdownItemHidden))):a&&setTimeout(this.dropdown.hide.bind(this))},selectAll(t){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems(\"\");var e=this.dropdown.filterListItems(\"\");return t||(e=this.state.dropdown.suggestions),this.addTags(e,!0),this},filterListItems(t,e){var i,s,a,n,o,r=this.settings,l=r.dropdown,d=(e=e||{},[]),g=[],p=r.whitelist,u=l.maxItems>=0?l.maxItems:1/0,m=l.searchKeys,v=0;if(!(t=\"select\"==r.mode&&this.value.length&&this.value[0][r.tagTextProp]==t?\"\":t)||!m.length)return d=l.includeSelectedTags?p:p.filter((t=>!this.isTagDuplicate(h(t)?t.value:t))),this.state.dropdown.suggestions=d,d.slice(0,u);function f(t,e){return e.toLowerCase().split(\" \").every((e=>t.includes(e.toLowerCase())))}for(o=l.caseSensitive?\"\"+t:(\"\"+t).toLowerCase();v<p.length;v++){let t,r;i=p[v]instanceof Object?p[v]:{value:p[v]};let u=!Object.keys(i).some((t=>m.includes(t)))?[\"value\"]:m;l.fuzzySearch&&!e.exact?(a=u.reduce(((t,e)=>t+\" \"+(i[e]||\"\")),\"\").toLowerCase().trim(),l.accentedSearch&&(a=c(a),o=c(o)),t=0==a.indexOf(o),r=a===o,s=f(a,o)):(t=!0,s=u.some((t=>{var s=\"\"+(i[t]||\"\");return l.accentedSearch&&(s=c(s),o=c(o)),l.caseSensitive||(s=s.toLowerCase()),r=s===o,e.exact?s===o:0==s.indexOf(o)}))),n=!l.includeSelectedTags&&this.isTagDuplicate(h(i)?i.value:i),s&&!n&&(r&&t?g.push(i):\"startsWith\"==l.sortby&&t?d.unshift(i):d.push(i))}return this.state.dropdown.suggestions=g.concat(d),\"function\"==typeof l.sortby?l.sortby(g.concat(d),o):g.concat(d).slice(0,u)},getMappedValue(t){var e=this.settings.dropdown.mapValueTo;return e?\"function\"==typeof e?e(t):t[e]||t.value:t.value},createListHTML(t){return g([],t).map(((t,i)=>{\"string\"!=typeof t&&\"number\"!=typeof t||(t={value:t});var s=this.dropdown.getMappedValue(t);return s=\"string\"==typeof s?d(s):s,this.settings.templates.dropdownItem.apply(this,[e(e({},t),{},{mappedValue:s}),this])})).join(\"\")}};const x=\"@yaireo/tagify/\";var O,D={empty:\"empty\",exceed:\"number of tags exceeded\",pattern:\"pattern mismatch\",duplicate:\"already exists\",notAllowed:\"not allowed\"},M={wrapper:(t,e)=>`<tags class=\"${e.classNames.namespace} ${e.mode?`${e.classNames[e.mode+\"Mode\"]}`:\"\"} ${t.className}\"\\n                    ${e.readonly?\"readonly\":\"\"}\\n                    ${e.disabled?\"disabled\":\"\"}\\n                    ${e.required?\"required\":\"\"}\\n                    ${\"select\"===e.mode?\"spellcheck='false'\":\"\"}\\n                    tabIndex=\"-1\">\\n            <span ${!e.readonly&&e.userInput?\"contenteditable\":\"\"} tabIndex=\"0\" data-placeholder=\"${e.placeholder||\"&#8203;\"}\" aria-placeholder=\"${e.placeholder||\"\"}\"\\n                class=\"${e.classNames.input}\"\\n                role=\"textbox\"\\n                aria-autocomplete=\"both\"\\n                aria-multiline=\"${\"mix\"==e.mode}\"></span>\\n                &#8203;\\n        </tags>`,tag(t,e){let i=e.settings;return`<tag title=\"${t.title||t.value}\"\\n                    contenteditable='false'\\n                    spellcheck='false'\\n                    tabIndex=\"${i.a11y.focusableTags?0:-1}\"\\n                    class=\"${i.classNames.tag} ${t.class||\"\"}\"\\n                    ${this.getAttributes(t)}>\\n            <x title='' class=\"${i.classNames.tagX}\" role='button' aria-label='remove tag'></x>\\n            <div>\\n                <span class=\"${i.classNames.tagText}\">${t[i.tagTextProp]||t.value}</span>\\n            </div>\\n        </tag>`},dropdown(t){var e=t.dropdown,i=\"manual\"==e.position,s=`${t.classNames.dropdown}`;return`<div class=\"${i?\"\":s} ${e.classname}\" role=\"listbox\" aria-labelledby=\"dropdown\">\\n                    <div data-selector='tagify-suggestions-wrapper' class=\"${t.classNames.dropdownWrapper}\"></div>\\n                </div>`},dropdownContent(t){var e=this.settings,i=this.state.dropdown.suggestions;return`\\n            ${e.templates.dropdownHeader.call(this,i)}\\n            ${t}\\n            ${e.templates.dropdownFooter.call(this,i)}\\n        `},dropdownItem(t){return`<div ${this.getAttributes(t)}\\n                    class='${this.settings.classNames.dropdownItem} ${t.class?t.class:\"\"}'\\n                    tabindex=\"0\"\\n                    role=\"option\">${t.mappedValue||t.value}</div>`},dropdownHeader(t){return`<header data-selector='tagify-suggestions-header' class=\"${this.settings.classNames.dropdownHeader}\"></header>`},dropdownFooter(t){var e=t.length-this.settings.dropdown.maxItems;return e>0?`<footer data-selector='tagify-suggestions-footer' class=\"${this.settings.classNames.dropdownFooter}\">\\n                ${e} more items. Refine your search.\\n            </footer>`:\"\"},dropdownItemNoMatch:null};var I={customBinding(){this.customEventsList.forEach((t=>{this.on(t,this.settings.callbacks[t])}))},binding(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e,i=this.events.callbacks,s=t?\"addEventListener\":\"removeEventListener\";if(!this.state.mainEvents||!t){for(var a in this.state.mainEvents=t,t&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on(\"tagify.removeAllTags\",this.removeAllTags.bind(this))),e=this.listeners.main=this.listeners.main||{focus:[\"input\",i.onFocusBlur.bind(this)],keydown:[\"input\",i.onKeydown.bind(this)],click:[\"scope\",i.onClickScope.bind(this)],dblclick:[\"scope\",i.onDoubleClickScope.bind(this)],paste:[\"input\",i.onPaste.bind(this)],drop:[\"input\",i.onDrop.bind(this)],compositionstart:[\"input\",i.onCompositionStart.bind(this)],compositionend:[\"input\",i.onCompositionEnd.bind(this)]})this.DOM[e[a][0]][s](a,e[a][1]);clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(i.observeOriginalInputValue.bind(this),500);var n=this.listeners.main.inputMutationObserver||new MutationObserver(i.onInputDOMChange.bind(this));n.disconnect(),\"mix\"==this.settings.mode&&n.observe(this.DOM.input,{childList:!0})}},bindGlobal(t){var e,i=this.events.callbacks,s=t?\"removeEventListener\":\"addEventListener\";if(this.listeners&&(t||!this.listeners.global))for(e of(this.listeners.global=this.listeners.global||[{type:this.isIE?\"keydown\":\"input\",target:this.DOM.input,cb:i[this.isIE?\"onInputIE\":\"onInput\"].bind(this)},{type:\"keydown\",target:window,cb:i.onWindowKeyDown.bind(this)},{type:\"blur\",target:this.DOM.input,cb:i.onFocusBlur.bind(this)},{type:\"click\",target:document,cb:i.onClickAnywhere.bind(this)}],this.listeners.global))e.target[s](e.type,e.cb)},unbindGlobal(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur(t){var e=this.settings,i=t.target?this.trim(t.target.textContent):\"\",s=this.value?.[0]?.[e.tagTextProp],a=t.type,n=e.dropdown.enabled>=0,o={relatedTarget:t.relatedTarget},r=this.state.actions.selectOption&&(n||!e.dropdown.closeOnSelect),l=this.state.actions.addNew&&n,d=t.relatedTarget&&v.call(this,t.relatedTarget)&&this.DOM.scope.contains(t.relatedTarget);if(\"blur\"==a){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),e.onChangeAfterBlur&&this.triggerChangeEvent()}if(!r&&!l)if(this.state.hasFocus=\"focus\"==a&&+new Date,this.toggleFocusClass(this.state.hasFocus),\"mix\"!=e.mode){if(\"focus\"==a)return this.trigger(\"focus\",o),void(0!==e.dropdown.enabled&&e.userInput||this.dropdown.show(this.value.length?\"\":void 0));\"blur\"==a&&(this.trigger(\"blur\",o),this.loading(!1),\"select\"==e.mode&&(d&&(this.removeTags(),i=\"\"),s===i&&(i=\"\")),i&&!this.state.actions.selectOption&&e.addTagOnBlur&&this.addTags(i,!0)),this.DOM.input.removeAttribute(\"style\"),this.dropdown.hide()}else\"focus\"==a?this.trigger(\"focus\",o):\"blur\"==t.type&&(this.trigger(\"blur\",o),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart(t){this.state.composing=!0},onCompositionEnd(t){this.state.composing=!1},onWindowKeyDown(t){var e,i=document.activeElement,s=v.call(this,i)&&this.DOM.scope.contains(document.activeElement),a=s&&i.hasAttribute(\"readonly\");if(s&&!a)switch(e=i.nextElementSibling,t.key){case\"Backspace\":this.settings.readonly||(this.removeTags(i),(e||this.DOM.input).focus());break;case\"Enter\":setTimeout(this.editTag.bind(this),0,i)}},onKeydown(t){var e=this.settings;if(!this.state.composing&&e.userInput){\"select\"==e.mode&&e.enforceWhitelist&&this.value.length&&\"Tab\"!=t.key&&t.preventDefault();var i=this.trim(t.target.textContent);if(this.trigger(\"keydown\",{event:t}),\"mix\"==e.mode){switch(t.key){case\"Left\":case\"ArrowLeft\":this.state.actions.ArrowLeft=!0;break;case\"Delete\":case\"Backspace\":if(this.state.editing)return;var s=document.getSelection(),a=\"Delete\"==t.key&&s.anchorOffset==(s.anchorNode.length||0),n=s.anchorNode.previousSibling,r=1==s.anchorNode.nodeType||!s.anchorOffset&&n&&1==n.nodeType&&s.anchorNode.previousSibling;o(this.DOM.input.innerHTML);var d,h,g,p=this.getTagElms();if(\"edit\"==e.backspace&&r)return d=1==s.anchorNode.nodeType?null:s.anchorNode.previousElementSibling,setTimeout(this.editTag.bind(this),0,d),void t.preventDefault();if(u()&&r instanceof Element)return g=l(r),r.hasAttribute(\"readonly\")||r.remove(),this.DOM.input.focus(),void setTimeout((()=>{this.placeCaretAfterNode(g),this.DOM.input.click()}));if(\"BR\"==s.anchorNode.nodeName)return;if((a||r)&&1==s.anchorNode.nodeType?h=0==s.anchorOffset?a?p[0]:null:p[Math.min(p.length,s.anchorOffset)-1]:a?h=s.anchorNode.nextElementSibling:r instanceof Element&&(h=r),3==s.anchorNode.nodeType&&!s.anchorNode.nodeValue&&s.anchorNode.previousElementSibling&&t.preventDefault(),(r||a)&&!e.backspace)return void t.preventDefault();if(\"Range\"!=s.type&&!s.anchorOffset&&s.anchorNode==this.DOM.input&&\"Delete\"!=t.key)return void t.preventDefault();if(\"Range\"!=s.type&&h&&h.hasAttribute(\"readonly\"))return void this.placeCaretAfterNode(l(h));clearTimeout(O),O=setTimeout((()=>{var t=document.getSelection();o(this.DOM.input.innerHTML),!a&&t.anchorNode.previousSibling,this.value=[].map.call(p,((t,e)=>{var i=T(t);if(t.parentNode||i.readonly)return i;this.trigger(\"remove\",{tag:t,index:e,data:i})})).filter((t=>t))}),20)}return!0}switch(t.key){case\"Backspace\":\"select\"==e.mode&&e.enforceWhitelist&&this.value.length?this.removeTags():this.state.dropdown.visible&&\"manual\"!=e.dropdown.position||\"\"!=t.target.textContent&&8203!=i.charCodeAt(0)||(!0===e.backspace?this.removeTags():\"edit\"==e.backspace&&setTimeout(this.editTag.bind(this),0));break;case\"Esc\":case\"Escape\":if(this.state.dropdown.visible)return;t.target.blur();break;case\"Down\":case\"ArrowDown\":this.state.dropdown.visible||this.dropdown.show();break;case\"ArrowRight\":{let t=this.state.inputSuggestion||this.state.ddItemData;if(t&&e.autoComplete.rightKey)return void this.addTags([t],!0);break}case\"Tab\":{let s=\"select\"==e.mode;if(!i||s)return!0;t.preventDefault()}case\"Enter\":if(this.state.dropdown.visible&&\"manual\"!=e.dropdown.position)return;t.preventDefault(),setTimeout((()=>{this.state.dropdown.visible||this.state.actions.selectOption||this.addTags(i,!0)}))}}},onInput(t){this.postUpdate();var e=this.settings;if(\"mix\"==e.mode)return this.events.callbacks.onMixTagsInput.call(this,t);var i=this.input.normalize.call(this),s=i.length>=e.dropdown.enabled,a={value:i,inputElm:this.DOM.input},n=this.validateTag({value:i});\"select\"==e.mode&&this.toggleScopeValidation(n),a.isValid=n,this.state.inputText!=i&&(this.input.set.call(this,i,!1),-1!=i.search(e.delimiters)?this.addTags(i)&&this.input.set.call(this):e.dropdown.enabled>=0&&this.dropdown[s?\"show\":\"hide\"](i),this.trigger(\"input\",a))},onMixTagsInput(t){var e,i,s,a,n,o,r,l,d=this.settings,h=this.value.length,p=this.getTagElms(),c=document.createDocumentFragment(),m=window.getSelection().getRangeAt(0),v=[].map.call(p,(t=>T(t).value));if(\"deleteContentBackward\"==t.inputType&&u()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:\"Backspace\"}),this.value.slice().forEach((t=>{t.readonly&&!v.includes(t.value)&&c.appendChild(this.createTagElem(t))})),c.childNodes.length&&(m.insertNode(c),this.setRangeAtStartEnd(!1,c.lastChild)),p.length!=h)return this.value=[].map.call(this.getTagElms(),(t=>T(t))),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o=window.getSelection()).rangeCount>0&&3==o.anchorNode.nodeType){if((m=o.getRangeAt(0).cloneRange()).collapse(!0),m.setStart(o.focusNode,0),s=(e=m.toString().slice(0,m.endOffset)).split(d.pattern).length-1,(i=e.match(d.pattern))&&(a=e.slice(e.lastIndexOf(i[i.length-1]))),a){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:a.match(d.pattern)[0],value:a.replace(d.pattern,\"\")},this.state.tag.baseOffset=o.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(d.delimiters))return this.state.tag.value=this.state.tag.value.replace(d.delimiters,\"\"),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,d.dropdown.clearOnSelect),void this.dropdown.hide();n=this.state.tag.value.length>=d.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(t){}(r||s<this.state.mixMode.matchedPatternCount)&&(n=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=s}setTimeout((()=>{this.update({withoutChangeEvent:!0}),this.trigger(\"input\",g({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[n?\"show\":\"hide\"](this.state.tag.value)}),10)},onInputIE(t){var e=this;setTimeout((function(){e.events.callbacks.onInput.call(e,t)}))},observeOriginalInputValue(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere(t){t.target==this.DOM.scope||this.DOM.scope.contains(t.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1)},onClickScope(t){var e=this.settings,i=t.target.closest(\".\"+e.classNames.tag),s=+new Date-this.state.hasFocus;if(t.target!=this.DOM.scope){if(!t.target.classList.contains(e.classNames.tagX))return i?(this.trigger(\"click\",{tag:i,index:this.getNodeIndex(i),data:T(i),event:t}),void(1!==e.editTags&&1!==e.editTags.clicks||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&(\"mix\"==e.mode&&this.fixFirefoxLastTagNoCaret(),s>500)?this.state.dropdown.visible?this.dropdown.hide():0===e.dropdown.enabled&&\"mix\"!=e.mode&&this.dropdown.show(this.value.length?\"\":void 0):\"select\"!=e.mode||0!==e.dropdown.enabled||this.state.dropdown.visible||this.dropdown.show());this.removeTags(t.target.parentNode)}else this.DOM.input.focus()},onPaste(t){t.preventDefault();var e,i,s=this.settings;if(\"select\"==s.mode&&s.enforceWhitelist||!s.userInput)return!1;s.readonly||(e=t.clipboardData||window.clipboardData,i=e.getData(\"Text\"),s.hooks.beforePaste(t,{tagify:this,pastedText:i,clipboardData:e}).then((e=>{void 0===e&&(e=i),e&&(this.injectAtCaret(e,window.getSelection().getRangeAt(0)),\"mix\"==this.settings.mode?this.events.callbacks.onMixTagsInput.call(this,t):this.settings.pasteAsTags?this.addTags(this.state.inputText+e,!0):this.state.inputText=e)})).catch((t=>t)))},onDrop(t){t.preventDefault()},onEditTagInput(t,e){var i=t.closest(\".\"+this.settings.classNames.tag),s=this.getNodeIndex(i),a=T(i),n=this.input.normalize.call(this,t),o={[this.settings.tagTextProp]:n,__tagId:a.__tagId},r=this.validateTag(o);this.editTagChangeDetected(g(a,o))||!0!==t.originalIsValid||(r=!0),i.classList.toggle(this.settings.classNames.tagInvalid,!0!==r),a.__isValid=r,i.title=!0===r?a.title||a.value:r,n.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=n),this.dropdown.show(n)),this.trigger(\"edit:input\",{tag:i,index:s,data:g({},this.value[s],{newValue:n}),event:e})},onEditTagPaste(t,e){var i=(e.clipboardData||window.clipboardData).getData(\"Text\");e.preventDefault();var s=f(i);this.setRangeAtStartEnd(!1,s)},onEditTagFocus(t){this.state.editing={scope:t,input:t.querySelector(\"[contenteditable]\")}},onEditTagBlur(t){if(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t)){var e,i,s=this.settings,a=t.closest(\".\"+s.classNames.tag),n=T(a),o=this.input.normalize.call(this,t),r={[s.tagTextProp]:o,__tagId:n.__tagId},l=n.__originalData,d=this.editTagChangeDetected(g(n,r)),h=this.validateTag(r);if(o)if(d){if(e=this.hasMaxTags(),i=g({},l,{[s.tagTextProp]:this.trim(o),__isValid:h}),s.transformTag.call(this,i,l),!0!==(h=(!e||!0===l.__isValid)&&this.validateTag(i))){if(this.trigger(\"invalid\",{data:i,tag:a,message:h}),s.editTags.keepInvalid)return;s.keepInvalidTags?i.__isValid=h:i=l}else s.keepInvalidTags&&(delete i.title,delete i[\"aria-invalid\"],delete i.class);this.onEditTagDone(a,i)}else this.onEditTagDone(a,l);else this.onEditTagDone(a)}},onEditTagkeydown(t,e){if(!this.state.composing)switch(this.trigger(\"edit:keydown\",{event:t}),t.key){case\"Esc\":case\"Escape\":e.parentNode.replaceChild(e.__tagifyTagData.__originalHTML,e),this.state.editing=!1;case\"Enter\":case\"Tab\":t.preventDefault(),t.target.blur()}},onDoubleClickScope(t){var e,i,s=t.target.closest(\".\"+this.settings.classNames.tag),a=T(s),n=this.settings;s&&n.userInput&&!1!==a.editable&&(e=s.classList.contains(this.settings.classNames.tagEditing),i=s.hasAttribute(\"readonly\"),\"select\"==n.mode||n.readonly||e||i||!this.settings.editTags||this.editTag(s),this.toggleFocusClass(!0),this.trigger(\"dblclick\",{tag:s,index:this.getNodeIndex(s),data:T(s)}))},onInputDOMChange(t){t.forEach((t=>{t.addedNodes.forEach((t=>{if(\"<div><br></div>\"==t.outerHTML)t.replaceWith(document.createElement(\"br\"));else if(1==t.nodeType&&t.querySelector(this.settings.classNames.tagSelector)){let e=document.createTextNode(\"\");3==t.childNodes[0].nodeType&&\"BR\"!=t.previousSibling.nodeName&&(e=document.createTextNode(\"\\n\")),t.replaceWith(e,...[...t.childNodes].slice(0,-1)),this.placeCaretAfterNode(e)}else if(v.call(this,t)&&(3!=t.previousSibling?.nodeType||t.previousSibling.textContent||t.previousSibling.remove(),t.previousSibling&&\"BR\"==t.previousSibling.nodeName)){t.previousSibling.replaceWith(\"\\n​\");let e=t.nextSibling,i=\"\";for(;e;)i+=e.textContent,e=e.nextSibling;i.trim()&&this.placeCaretAfterNode(t.previousSibling)}})),t.removedNodes.forEach((t=>{t&&\"BR\"==t.nodeName&&v.call(this,e)&&(this.removeTags(e),this.fixFirefoxLastTagNoCaret())}))}));var e=this.DOM.input.lastChild;e&&\"\"==e.nodeValue&&e.remove(),e&&\"BR\"==e.nodeName||this.DOM.input.appendChild(document.createElement(\"br\"))}}};function N(t,e){if(!t){console.warn(\"Tagify:\",\"input element not found\",t);const e=new Proxy(this,{get:()=>()=>e});return e}if(t.__tagify)return console.warn(\"Tagify: \",\"input element is already Tagified - Same instance is returned.\",t),t.__tagify;var i;g(this,function(t){var e=document.createTextNode(\"\");function i(t,i,s){s&&i.split(/\\s+/g).forEach((i=>e[t+\"EventListener\"].call(e,i,s)))}return{off(t,e){return i(\"remove\",t,e),this},on(t,e){return e&&\"function\"==typeof e&&i(\"add\",t,e),this},trigger(i,s,a){var n;if(a=a||{cloneData:!0},i)if(t.settings.isJQueryPlugin)\"remove\"==i&&(i=\"removeTag\"),jQuery(t.DOM.originalInput).triggerHandler(i,[s]);else{try{var o=\"object\"==typeof s?s:{value:s};if((o=a.cloneData?g({},o):o).tagify=this,s.event&&(o.event=this.cloneEvent(s.event)),s instanceof Object)for(var r in s)s[r]instanceof HTMLElement&&(o[r]=s[r]);n=new CustomEvent(i,{detail:o})}catch(t){console.warn(t)}e.dispatchEvent(n)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e=e||{},this.getPersistedData=(i=e.id,t=>{let e,s=\"/\"+t;if(1==localStorage.getItem(x+i+\"/v\",1))try{e=JSON.parse(localStorage[x+i+s])}catch(t){}return e}),this.setPersistedData=(t=>t?(localStorage.setItem(x+t+\"/v\",1),(e,i)=>{let s=\"/\"+i,a=JSON.stringify(e);e&&i&&(localStorage.setItem(x+t+s,a),dispatchEvent(new Event(\"storage\")))}):()=>{})(e.id),this.clearPersistedData=(t=>e=>{const i=x+\"/\"+t+\"/\";if(e)localStorage.removeItem(i+e);else for(let t in localStorage)t.includes(i)&&localStorage.removeItem(t)})(e.id),this.applySettings(t,e),this.state={inputText:\"\",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),b.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t.autofocus&&this.DOM.input.focus(),t.__tagify=this}return N.prototype={_dropdown:y,getSetTagData:T,helpers:{sameStr:s,removeCollectionProp:a,omit:n,isObject:h,parseHTML:r,escapeHTML:d,extend:g,concatWithoutDups:p,getUID:m,isNodeTag:v},customEventsList:[\"change\",\"add\",\"remove\",\"invalid\",\"input\",\"click\",\"keydown\",\"focus\",\"blur\",\"edit:input\",\"edit:beforeUpdate\",\"edit:updated\",\"edit:start\",\"edit:keydown\",\"dropdown:show\",\"dropdown:hide\",\"dropdown:select\",\"dropdown:updated\",\"dropdown:noMatch\",\"dropdown:scroll\"],dataProps:[\"__isValid\",\"__removed\",\"__originalData\",\"__originalHTML\",\"__tagId\"],trim(t){return this.settings.trim&&t&&\"string\"==typeof t?t.trim():t},parseHTML:r,templates:M,parseTemplate(t,e){return r((t=this.settings.templates[t]||t).apply(this,e))},set whitelist(t){const e=t&&Array.isArray(t);this.settings.whitelist=e?t:[],this.setPersistedData(e?t:[],\"whitelist\")},get whitelist(){return this.settings.whitelist},generateClassSelectors(t){for(let e in t){let i=e;Object.defineProperty(t,i+\"Selector\",{get(){return\".\"+this[i].split(\" \")[0]}})}},applySettings(t,i){w.templates=this.templates;var s=g({},w,\"mix\"==i.mode?{dropdown:{position:\"text\"}}:{}),a=this.settings=g({},s,i);if(a.disabled=t.hasAttribute(\"disabled\"),a.readonly=a.readonly||t.hasAttribute(\"readonly\"),a.placeholder=d(t.getAttribute(\"placeholder\")||a.placeholder||\"\"),a.required=t.hasAttribute(\"required\"),this.generateClassSelectors(a.classNames),void 0===a.dropdown.includeSelectedTags&&(a.dropdown.includeSelectedTags=a.duplicates),this.isIE&&(a.autoComplete=!1),[\"whitelist\",\"blacklist\"].forEach((e=>{var i=t.getAttribute(\"data-\"+e);i&&(i=i.split(a.delimiters))instanceof Array&&(a[e]=i)})),\"autoComplete\"in i&&!h(i.autoComplete)&&(a.autoComplete=w.autoComplete,a.autoComplete.enabled=i.autoComplete),\"mix\"==a.mode&&(a.pattern=a.pattern||/@/,a.autoComplete.rightKey=!0,a.delimiters=i.delimiters||null,a.tagTextProp&&!a.dropdown.searchKeys.includes(a.tagTextProp)&&a.dropdown.searchKeys.push(a.tagTextProp)),t.pattern)try{a.pattern=new RegExp(t.pattern)}catch(t){}if(a.delimiters){a._delimiters=a.delimiters;try{a.delimiters=new RegExp(this.settings.delimiters,\"g\")}catch(t){}}a.disabled&&(a.userInput=!1),this.TEXTS=e(e({},D),a.texts||{}),(\"select\"!=a.mode||i.dropdown?.enabled)&&a.userInput||(a.dropdown.enabled=0),a.dropdown.appendTarget=i.dropdown?.appendTarget||document.body;let n=this.getPersistedData(\"whitelist\");Array.isArray(n)&&(this.whitelist=Array.isArray(a.whitelist)?p(a.whitelist,n):n)},getAttributes(t){var e,i=this.getCustomAttributes(t),s=\"\";for(e in i)s+=\" \"+e+(void 0!==t[e]?`=\"${i[e]}\"`:\"\");return s},getCustomAttributes(t){if(!h(t))return\"\";var e,i={};for(e in t)\"__\"!=e.slice(0,2)&&\"class\"!=e&&t.hasOwnProperty(e)&&void 0!==t[e]&&(i[e]=d(t[e]));return i},setStateSelection(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCSSVars(){var t=getComputedStyle(this.DOM.scope,null);var e;this.CSSVars={tagHideTransition:(t=>{let e=t.value;return\"s\"==t.unit?1e3*e:e})(function(t){if(!t)return{};var e=(t=t.trim().split(\" \")[0]).split(/\\d+/g).filter((t=>t)).pop().trim();return{value:+t.split(e).filter((t=>t))[0].trim(),unit:e}}((e=\"tag-hide-transition\",t.getPropertyValue(\"--\"+e))))}},build(t){var e=this.DOM;this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.originalInput_tabIndex=t.tabIndex,e.scope=this.parseTemplate(\"wrapper\",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t),t.tabIndex=-1)},destroy(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues(t){var e,i=this.settings;if(this.state.blockChangeEvent=!0,void 0===t){const e=this.getPersistedData(\"value\");t=e&&!this.DOM.originalInput.value?e:i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t)if(\"mix\"==i.mode)this.parseMixTags(t),(e=this.DOM.input.lastChild)&&\"BR\"==e.tagName||this.DOM.input.insertAdjacentHTML(\"beforeend\",\"<br>\");else{try{JSON.parse(t)instanceof Array&&(t=JSON.parse(t))}catch(t){}this.addTags(t,!0).forEach((t=>t&&t.classList.add(i.classNames.tagNoAnimation)))}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?\"\":this.DOM.originalInput.value},cloneEvent(t){var e={};for(var i in t)\"path\"!=i&&(e[i]=t[i]);return e},loading(t){return this.state.isLoading=t,this.DOM.scope.classList[t?\"add\":\"remove\"](this.settings.classNames.scopeLoading),this},tagLoading(t,e){return t&&t.classList[e?\"add\":\"remove\"](this.settings.classNames.tagLoading),this},toggleClass(t,e){\"string\"==typeof t&&this.DOM.scope.classList.toggle(t,e)},toggleScopeValidation(t){var e=!0===t||void 0===t;!this.settings.required&&t&&t===this.TEXTS.empty&&(e=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e),this.DOM.scope.title=e?\"\":t},toggleFocusClass(t){this.toggleClass(this.settings.classNames.focus,!!t)},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,i=new CustomEvent(\"change\",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,i.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(i),this.trigger(\"change\",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:I,fixFirefoxLastTagNoCaret(){},setRangeAtStartEnd(t,e){if(e){t=\"number\"==typeof t?t:!!t,e=e.lastChild||e;var i=document.getSelection();if(i.focusNode instanceof Element&&!this.DOM.input.contains(i.focusNode))return!0;try{i.rangeCount>=1&&[\"Start\",\"End\"].forEach((s=>i.getRangeAt(0)[\"set\"+s](e,t||e.length)))}catch(t){}}},placeCaretAfterNode(t){if(t&&t.parentNode){var e=t,i=window.getSelection(),s=i.getRangeAt(0);i.rangeCount&&(s.setStartAfter(e),s.collapse(!0),i.removeAllRanges(),i.addRange(s))}},insertAfterTag(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e=\"string\"==typeof e?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTagChangeDetected(t){var e=t.__originalData;for(var i in e)if(!this.dataProps.includes(i)&&t[i]!=e[i])return!0;return!1},getTagTextNode(t){return t.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode(t,e){this.getTagTextNode(t).innerHTML=d(e)},editTag(t,e){t=t||this.getLastTag(),e=e||{},this.dropdown.hide();var i=this.settings,s=this.getTagTextNode(t),a=this.getNodeIndex(t),n=T(t),o=this.events.callbacks,r=this,l=!0;if(s){if(!(n instanceof Object&&\"editable\"in n)||n.editable)return n=T(t,{__originalData:g({},n),__originalHTML:t.cloneNode(!0)}),T(n.__originalHTML,n.__originalData),s.setAttribute(\"contenteditable\",!0),t.classList.add(i.classNames.tagEditing),s.addEventListener(\"focus\",o.onEditTagFocus.bind(this,t)),s.addEventListener(\"blur\",(function(){setTimeout((()=>o.onEditTagBlur.call(r,r.getTagTextNode(t))))})),s.addEventListener(\"input\",o.onEditTagInput.bind(this,s)),s.addEventListener(\"paste\",o.onEditTagPaste.bind(this,s)),s.addEventListener(\"keydown\",(e=>o.onEditTagkeydown.call(this,e,t))),s.addEventListener(\"compositionstart\",o.onCompositionStart.bind(this)),s.addEventListener(\"compositionend\",o.onCompositionEnd.bind(this)),e.skipValidation||(l=this.editTagToggleValidity(t)),s.originalIsValid=l,this.trigger(\"edit:start\",{tag:t,index:a,data:n,isValid:l}),s.focus(),this.setRangeAtStartEnd(!1,s),this}else console.warn(\"Cannot find element in Tag template: .\",i.classNames.tagTextSelector)},editTagToggleValidity(t,e){var i;if(e=e||T(t))return(i=!(\"__isValid\"in e)||!0===e.__isValid)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!i),e.__isValid;console.warn(\"tag has no data: \",t,e)},onEditTagDone(t,e){e=e||{};var i={tag:t=t||this.state.editing.scope,index:this.getNodeIndex(t),previousData:T(t),data:e};this.trigger(\"edit:beforeUpdate\",i,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&e[this.settings.tagTextProp]?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),this.settings.a11y.focusableTags?t.focus():this.placeCaretAfterNode(t)):t&&this.removeTags(t),this.trigger(\"edit:updated\",i),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(t,e){e&&e.value||(e=t.__tagifyTagData),e.__isValid&&1!=e.__isValid&&g(e,this.getInvalidTagAttrs(e,e.__isValid));var i=this.createTagElem(e);return t.parentNode.replaceChild(i,t),this.updateValueByDOMTags(),i},updateValueByDOMTags(){this.value.length=0,[].forEach.call(this.getTagElms(),(t=>{t.classList.contains(this.settings.classNames.tagNotAllowed.split(\" \")[0])||this.value.push(T(t))})),this.update()},injectAtCaret(t,e){return!(e=e||this.state.selection?.range)&&t?(this.appendMixTags(t),this):(f(t,e),this.setRangeAtStartEnd(!1,t),this.updateValueByDOMTags(),this.update(),this)},input:{set(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=this.settings.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=d(\"\"+t)),!t&&i&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw(){return this.DOM.input.textContent},validate(){var t=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize(t){var e=t||this.DOM.input,i=[];e.childNodes.forEach((t=>3==t.nodeType&&i.push(t.nodeValue))),i=i.join(\"\\n\");try{i=i.replace(/(?:\\r\\n|\\r|\\n)/g,this.settings.delimiters.source.charAt(0))}catch(t){}return i=i.replace(/\\s/g,\" \"),this.trim(i)},autocomplete:{suggest(t){if(this.settings.autoComplete.enabled){\"string\"==typeof(t=t||{value:\"\"})&&(t={value:t});var e=this.dropdown.getMappedValue(t);if(\"number\"!=typeof e){var i=e.substr(0,this.state.inputText.length).toLowerCase(),s=e.substring(this.state.inputText.length);e&&this.state.inputText&&i==this.state.inputText.toLowerCase()?(this.DOM.input.setAttribute(\"data-suggest\",s),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute(\"data-suggest\"),delete this.state.inputSuggestion)}}},set(t){var e=this.DOM.input.getAttribute(\"data-suggest\"),i=t||(e?this.state.inputText+e:null);return!!i&&(\"mix\"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx(t){return this.value.findIndex((e=>e.__tagId==(t||{}).__tagId))},getNodeIndex(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var s=\".\"+[...this.settings.classNames.tag.split(\" \"),...e].join(\".\");return[].slice.call(this.DOM.scope.querySelectorAll(s))},getLastTag(){var t=this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);return t[t.length-1]},isTagDuplicate(t,e,i){var a=0;if(\"select\"==this.settings.mode)return!1;for(let n of this.value){s(this.trim(\"\"+t),n.value,e)&&i!=n.__tagId&&a++}return a},getTagIndexByValue(t){var e=[];return this.getTagElms().forEach(((i,a)=>{s(this.trim(i.textContent),t,this.settings.dropdown.caseSensitive)&&e.push(a)})),e},getTagElmByValue(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag(t){t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout((()=>{t.classList.remove(this.settings.classNames.tagFlash)}),100))},isTagBlacklisted(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter((e=>(\"\"+e).toLowerCase()==t)).length},isTagWhitelisted(t){return!!this.getWhitelistItem(t)},getWhitelistItem(t,e,i){e=e||\"value\";var a,n=this.settings;return(i=i||n.whitelist).some((i=>{var o=\"string\"==typeof i?i:i[e]||i.value;if(s(o,t,n.dropdown.caseSensitive,n.trim))return a=\"string\"==typeof i?{value:i}:i,!0})),a||\"value\"!=e||\"value\"==n.tagTextProp||(a=this.getWhitelistItem(t,n.tagTextProp,i)),a},validateTag(t){var e=this.settings,i=\"value\"in t?\"value\":e.tagTextProp,s=this.trim(t[i]+\"\");return(t[i]+\"\").trim()?e.pattern&&e.pattern instanceof RegExp&&!e.pattern.test(s)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(s,e.dropdown.caseSensitive,t.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(s)||e.enforceWhitelist&&!this.isTagWhitelisted(s)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs(t,e){return{\"aria-invalid\":!0,class:`${t.class||\"\"} ${this.settings.classNames.tagNotAllowed}`.trim(),title:e}},hasMaxTags(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly(t,e){var i=this.settings;document.activeElement.blur(),i[e||\"readonly\"]=t,this.DOM.scope[(t?\"set\":\"remove\")+\"Attribute\"](e||\"readonly\",!0),this.setContentEditable(!t)},setContentEditable(t){this.settings.userInput&&(this.DOM.input.contentEditable=t,this.DOM.input.tabIndex=t?0:-1)},setDisabled(t){this.setReadonly(t,\"disabled\")},normalizeTags(t){var e=this.settings,i=e.whitelist,s=e.delimiters,a=e.mode,n=e.tagTextProp,o=[],r=!!i&&i[0]instanceof Object,l=Array.isArray(t),d=l&&t[0].value,h=t=>(t+\"\").split(s).filter((t=>t)).map((t=>({[n]:this.trim(t),value:this.trim(t)})));if(\"number\"==typeof t&&(t=t.toString()),\"string\"==typeof t){if(!t.trim())return[];t=h(t)}else l&&(t=[].concat(...t.map((t=>null!=t.value?t:h(t)))));return r&&!d&&(t.forEach((t=>{var e=o.map((t=>t.value)),i=this.dropdown.filterListItems.call(this,t[n],{exact:!0});this.settings.duplicates||(i=i.filter((t=>!e.includes(t.value))));var s=i.length>1?this.getWhitelistItem(t[n],n,i):i[0];s&&s instanceof Object?o.push(s):\"mix\"!=a&&(null==t.value&&(t.value=t[n]),o.push(t))})),o.length&&(t=o)),t},parseMixTags(t){var e=this.settings,i=e.mixTagsInterpolator,s=e.duplicates,a=e.transformTag,n=e.enforceWhitelist,o=e.maxTags,r=e.tagTextProp,l=[];return t=t.split(i[0]).map(((t,e)=>{var d,h,g,p=t.split(i[1]),c=p[0],u=l.length==o;try{if(c==+c)throw Error;h=JSON.parse(c)}catch(t){h=this.normalizeTags(c)[0]||{value:c}}if(a.call(this,h),u||!(p.length>1)||n&&!this.isTagWhitelisted(h.value)||!s&&this.isTagDuplicate(h.value)){if(t)return e?i[0]+t:t}else h[d=h[r]?r:\"value\"]=this.trim(h[d]),g=this.createTagElem(h),l.push(h),g.classList.add(this.settings.classNames.tagNoAnimation),p[0]=g.outerHTML,this.value.push(h);return p.join(\"\")})).join(\"\"),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode(\"\")),this.DOM.input.normalize(),this.getTagElms().forEach(((t,e)=>T(t,l[e]))),this.update({withoutChangeEvent:!0}),t},replaceTextWithNode(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var i,s,a=this.state.selection||window.getSelection(),n=a.anchorNode,o=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return n.splitText(a.anchorOffset-o),-1==(i=n.nodeValue.lastIndexOf(e))?!0:(s=n.splitText(i),t&&n.parentNode.replaceChild(t,s),!0)}},selectTag(t,e){var i=this.settings;if(!i.enforceWhitelist||this.isTagWhitelisted(e.value)){this.input.set.call(this,e[i.tagTextProp]||e.value,!0),this.state.actions.selectOption&&setTimeout((()=>this.setRangeAtStartEnd(!1,this.DOM.input)));var s=this.getLastTag();return s?this.replaceTag(s,e):this.appendTag(t),this.value[0]=e,this.update(),this.trigger(\"add\",{tag:t,data:e}),[t]}},addEmptyTag(t){var e=g({value:\"\"},t||{}),i=this.createTagElem(e);T(i,e),this.appendTag(i),this.editTag(i,{skipValidation:!0})},addTags(t,e,i){var s=[],a=this.settings,n=[],o=document.createDocumentFragment();if(i=i||a.skipInvalid,!t||0==t.length)return s;switch(t=this.normalizeTags(t),a.mode){case\"mix\":return this.addMixTags(t);case\"select\":e=!1,this.removeAllTags()}return this.DOM.input.removeAttribute(\"style\"),t.forEach((t=>{var e,r={},l=Object.assign({},t,{value:t.value+\"\"});if(t=Object.assign({},l),a.transformTag.call(this,t),t.__isValid=this.hasMaxTags()||this.validateTag(t),!0!==t.__isValid){if(i)return;if(g(r,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:l}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value)),!a.createInvalidTags)return void n.push(t.value)}if(\"readonly\"in t&&(t.readonly?r[\"aria-readonly\"]=!0:delete t.readonly),e=this.createTagElem(t,r),s.push(e),\"select\"==a.mode)return this.selectTag(e,t);o.appendChild(e),t.__isValid&&!0===t.__isValid?(this.value.push(t),this.trigger(\"add\",{tag:e,index:this.value.length-1,data:t})):(this.trigger(\"invalid\",{data:t,index:this.value.length,tag:e,message:t.__isValid}),a.keepInvalidTags||setTimeout((()=>this.removeTags(e,!0)),1e3)),this.dropdown.position()})),this.appendTag(o),this.update(),t.length&&e&&(this.input.set.call(this,a.createInvalidTags?\"\":n.join(a._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),a.dropdown.enabled&&this.dropdown.refilter(),s},addMixTags(t){if((t=this.normalizeTags(t))[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);var e=document.createDocumentFragment();return t.forEach((t=>{var i=this.createTagElem(t);e.appendChild(i)})),this.appendMixTags(e),e},appendMixTags(t){var e=!!this.state.selection;e?this.injectAtCaret(t):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(t),this.updateValueByDOMTags(),this.update())},prefixedTextToTag(t){var e,i=this.settings,s=this.state.tag.delimiters;if(i.transformTag.call(this,t),t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(i.pattern.source||i.pattern)[0],e=this.createTagElem(t),this.replaceTextWithNode(e)||this.DOM.input.appendChild(e),setTimeout((()=>e.classList.add(this.settings.classNames.tagNoAnimation)),300),this.value.push(t),this.update(),!s){var a=this.insertAfterTag(e)||e;setTimeout(this.placeCaretAfterNode,0,a)}return this.state.tag=null,this.trigger(\"add\",g({},{tag:e},{data:t})),e},appendTag(t){var e=this.DOM,i=e.input;e.scope.insertBefore(t,i)},createTagElem(t,i){t.__tagId=m();var s,a=g({},t,e({value:d(t.value+\"\")},i));return function(t){for(var e,i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);e=i.nextNode();)e.textContent.trim()||e.parentNode.removeChild(e)}(s=this.parseTemplate(\"tag\",[a,this])),T(s,t),s},reCheckInvalidTags(){var t=this.settings;this.getTagElms(t.classNames.tagNotAllowed).forEach(((e,i)=>{var s=T(e),a=this.hasMaxTags(),n=this.validateTag(s),o=!0===n&&!a;if(\"select\"==t.mode&&this.toggleScopeValidation(n),o)return s=s.__preInvalidData?s.__preInvalidData:{value:s.value},this.replaceTag(e,s);e.title=a||n}))},removeTags(t,e,i){var s,a=this.settings;if(t=t&&t instanceof HTMLElement?[t]:t instanceof Array?t:t?[t]:[this.getLastTag()],s=t.reduce(((t,e)=>{e&&\"string\"==typeof e&&(e=this.getTagElmByValue(e));var i=T(e);return e&&i&&!i.readonly&&t.push({node:e,idx:this.getTagIdx(i),data:T(e,{__removed:!0})}),t}),[]),i=\"number\"==typeof i?i:this.CSSVars.tagHideTransition,\"select\"==a.mode&&(i=0,this.input.set.call(this)),1==s.length&&\"select\"!=a.mode&&s[0].node.classList.contains(a.classNames.tagNotAllowed)&&(e=!0),s.length)return a.hooks.beforeRemoveTag(s,{tagify:this}).then((()=>{function t(t){t.node.parentNode&&(t.node.parentNode.removeChild(t.node),e?a.keepInvalidTags&&this.trigger(\"remove\",{tag:t.node,index:t.idx}):(this.trigger(\"remove\",{tag:t.node,index:t.idx,data:t.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a.keepInvalidTags&&this.reCheckInvalidTags()))}i&&i>10&&1==s.length?function(e){e.node.style.width=parseFloat(window.getComputedStyle(e.node).width)+\"px\",document.body.clientTop,e.node.classList.add(a.classNames.tagHide),setTimeout(t.bind(this),i,e)}.call(this,s[0]):s.forEach(t.bind(this)),e||(this.removeTagsFromValue(s.map((t=>t.node))),this.update(),\"select\"==a.mode&&this.setContentEditable(!0))})).catch((t=>{}))},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach((t=>t.parentNode.removeChild(t)))},removeTagsFromValue(t){(t=Array.isArray(t)?t:[t]).forEach((t=>{var e=T(t),i=this.getTagIdx(e);i>-1&&this.value.splice(i,1)}))},removeAllTags(t){t=t||{},this.value=[],\"mix\"==this.settings.mode?this.DOM.input.innerHTML=\"\":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout((()=>{this.DOM.input.focus()})),\"select\"==this.settings.mode&&(this.input.set.call(this),this.setContentEditable(!0)),this.update(t)},postUpdate(){this.state.blockChangeEvent=!1;var t=this.settings,e=t.classNames,i=\"mix\"==t.mode?t.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;this.toggleClass(e.hasMaxTags,this.value.length>=t.maxTags),this.toggleClass(e.hasNoTags,!this.value.length),this.toggleClass(e.empty,!i),\"select\"==t.mode&&this.toggleScopeValidation(this.value?.[0]?.__isValid)},setOriginalInputValue(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=t,e.tagifyValue=e.value,this.setPersistedData(t,\"value\"))},update(t){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout(function(){var e=this.getInputValue();this.setOriginalInputValue(e),this.settings.onChangeAfterBlur&&(t||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent();this.postUpdate()}.bind(this),100)},getInputValue(){var t=this.getCleanValue();return\"mix\"==this.settings.mode?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):\"\"},getCleanValue(t){return a(t||this.value,this.dataProps)},getMixedTagsAsString(){var t=\"\",e=this,i=this.settings,s=i.originalInputValueFormat||JSON.stringify,a=i.mixTagsInterpolator;return function i(o){o.childNodes.forEach((o=>{if(1==o.nodeType){const r=T(o);if(\"BR\"==o.tagName&&(t+=\"\\r\\n\"),r&&v.call(e,o)){if(r.__removed)return;t+=a[0]+s(n(r,e.dataProps))+a[1]}else o.getAttribute(\"style\")||[\"B\",\"I\",\"U\"].includes(o.tagName)?t+=o.textContent:\"DIV\"!=o.tagName&&\"P\"!=o.tagName||(t+=\"\\r\\n\",i(o))}else t+=o.textContent}))}(this.DOM.input),t}},N.prototype.removeTag=N.prototype.removeTags,N}));\n","import { MODULE, TEMPLATE } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\nimport DragSort from '@yaireo/dragsort'\nimport Tagify from '@yaireo/tagify'\n\n/**\n * Form Application for the dialogs.\n */\nexport class TagDialog extends FormApplication {\n    tagify = null\n    dragSort = null\n\n    constructor (data) {\n        super(data, { title: data.title })\n        this.content = data.content\n        this.submit = data.submit\n        this.categoryId = null\n        this.subcategoryId = null\n    }\n\n    static get defaultOptions () {\n        const defaults = super.defaultOptions\n        const overrides = {\n            classes: ['tah-dialog', 'sheet'],\n            closeOnSubmit: true,\n            id: 'token-action-hud-dialog',\n            popOut: true,\n            resizable: true,\n            height: 'auto',\n            width: 600\n        }\n\n        const mergedOptions = foundry.utils.mergeObject(defaults, overrides)\n\n        return mergedOptions\n    }\n\n    getData (options) {\n        return this.content\n    }\n\n    /**\n     * Activate listeners\n     * @public\n     * @param {object} html The HTML element\n     */\n    activateListeners (html) {\n        super.activateListeners(html)\n        const cancel = html.find('#tah-form-cancel')\n        cancel.on('click', this.close.bind(this))\n\n        const resetActions = html.find('#tah-dialog-reset-actions')\n        resetActions.on('click', this.#resetActions)\n    }\n\n    /**\n     * Show dialog\n     * @public\n     * @param {string} dialogType      The dialog type\n     * @param {string} nestId          The nest id\n     * @param {object} tags            The available and selected tags\n     * @param {object} dialogData      The dialog data\n     * @param {function*} dialogSubmit The dialog submit function\n     */\n    static showDialog (dialogType, nestId, tags, dialogData, dialogSubmit) {\n        this.nestId = nestId\n        TagDialog._prepareHook(tags)\n\n        const data = {\n            title: dialogData.title,\n            content: dialogData.content,\n            submit: dialogSubmit\n        }\n\n        let dialog\n        switch (dialogType) {\n        case 'hud':\n            dialog = new TagDialogHud(data)\n            break\n        case 'topLevelGroup':\n            dialog = new TagDialogTopLevelGroup(data)\n            break\n        case 'group':\n            dialog = new TagDialogGroup(data)\n            break\n        }\n\n        dialog.render(true)\n    }\n\n    /**\n     * Prepare dialog hook\n     * @private\n     * @param {object} tags The tags\n     */\n    static _prepareHook (tags) {\n        Hooks.once('renderTagDialog', (app, html, options) => {\n            const $tagFilter = html.find('input[class=\"tah-dialog-tagify\"]')\n\n            if ($tagFilter.length > 0) {\n                const tagifyOptions = {\n                    delimiters: ';',\n                    maxTags: 'Infinity',\n                    dropdown: {\n                        position: 'manual',\n                        maxItems: Infinity, // <- maximum allowed rendered suggestions\n                        classname: 'tah-dialog-tags-dropdown', // <- custom classname for this dropdown, so it could be targeted\n                        enabled: 0 // <- show suggestions on focus\n                    },\n                    templates: {\n                        dropdownItemNoMatch () {\n                            return '<div class=\\'empty\\'>Nothing Found</div>'\n                        }\n                    }\n                }\n\n                if (tags.available) tagifyOptions.whitelist = tags.available\n                TagDialog.tagify = new Tagify($tagFilter[0], tagifyOptions)\n\n                if (tags.selected) TagDialog.tagify.addTags(tags.selected)\n\n                TagDialog.dragSort = new DragSort(TagDialog.tagify.DOM.scope, {\n                    selector: '.' + TagDialog.tagify.settings.classNames.tag,\n                    callbacks: { dragEnd: onDragEnd }\n                })\n\n                function onDragEnd (elm) {\n                    TagDialog.tagify.updateValueByDOMTags()\n                }\n\n                html.find('.tagify__input').on('keydown', (event) => {\n                    if (event.key === 'Enter') {\n                        event.preventDefault()\n                        TagDialog.tagify.addTags(TagDialog.tagify.state.inputText, !0)\n                    }\n                })\n\n                // \"remove all tags\" button event listener\n                const unselectAllButton = html.find('#tah-dialog-unselect-all')\n                unselectAllButton.on('click', TagDialog.tagify.removeAllTags.bind(TagDialog.tagify))\n\n                if (app.constructor.name === 'TagDialogHud') return\n\n                TagDialog.tagify.dropdown.show()\n                const dropdownLabelElement = document.createElement('div')\n                dropdownLabelElement.classList.add('tah-dialog-label')\n                dropdownLabelElement.innerHTML = Utils.i18n('tokenActionHud.form.hud.availableItems')\n                TagDialog.tagify.DOM.scope.parentNode.appendChild(dropdownLabelElement)\n                TagDialog.tagify.DOM.scope.parentNode.appendChild(TagDialog.tagify.DOM.dropdown)\n            }\n        })\n\n        Hooks.on('renderApplication', (app, html, options) => {\n            if (app.constructor.name.startsWith('TagDialog')) {\n                app.setPosition()\n                app.setPosition({ top: 50 })\n            }\n        })\n    }\n\n    /**\n     * Reset actions\n     * @private\n     */\n    async #resetActions () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetActions.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetActions.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        await game.tokenActionHud.resetActorData()\n                        Logger.info('Actions reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    /** @override */\n    _onKeyDown (event) {\n    // Close dialog\n        if (event.key === 'Escape' && !event.target.className.includes('tagify')) {\n            event.preventDefault()\n            event.stopPropagation()\n            return this.close()\n        }\n\n        // Confirm default choice\n        if (\n            event.key === 'Enter' &&\n            this.data.default &&\n            !event.target.className.includes('tagify')\n        ) {\n            event.preventDefault()\n            event.stopPropagation()\n            const defaultChoice = this.data.buttons[this.data.default]\n            return this.submit(defaultChoice)\n        }\n    }\n\n    /**\n     * Handle form submission\n     * @param {object} event       The event\n     * @param {object} formDataThe form data\n     */\n    async _updateObject (event, formData) {\n        const selection = TagDialog.tagify.value.map((c) => {\n            c.id = c.id ?? c.value.slugify({ replacement: '-', strict: true })\n            return {\n                id: c.id,\n                listName: c.value,\n                name: c.name ?? c.value,\n                type: c.type\n            }\n        })\n        await this.submit(selection, formData)\n    }\n}\n\nexport class TagDialogHud extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions,\n            {\n                template: TEMPLATE.tagDialogHud\n            })\n    }\n}\n\nexport class TagDialogTopLevelGroup extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: TEMPLATE.tagDialogTopLevelGroup,\n            tabs: [{\n                navSelector: '.tabs',\n                contentSelector: 'form',\n                initial: 'groups'\n            }]\n        })\n    }\n}\n\nexport class TagDialogGroup extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: TEMPLATE.tagDialogGroup,\n            tabs: [{\n                navSelector: '.tabs',\n                contentSelector: 'form',\n                initial: 'groups'\n            }]\n        })\n    }\n}\n","import { TEMPLATE } from '../constants.js'\nimport { TagDialog } from './tag-dialog.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Generates data for the dialogs.\n */\nexport class TagDialogHelper {\n    /**\n     * Show the HUD dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     */\n    static async showHudDialog (actionHandler) {\n        // Set available and selected tags\n        const tags = {}\n        tags.available = []\n        tags.selected = await actionHandler.getSelectedGroups()\n        const grid = await Utils.getSetting('grid')\n\n        // Set dialog data\n        const dialogData = {\n            title: Utils.i18n('tokenActionHud.form.hud.hudTitle'),\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.hudDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: { grid }\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            const grid = formData?.grid\n            await actionHandler.updateGroups(choices, { level: 0 })\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n            await Utils.setSetting('grid', grid)\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        // Show dialog\n        TagDialog.showDialog('hud', null, tags, dialogData, dialogSubmit)\n    }\n\n    /**\n     * Show group dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     * @param {object} groupData    The group data\n     */\n    static async showGroupDialog (actionHandler, groupData) {\n        const { nestId, name, level } = groupData\n\n        // Set available and selected tags\n        const tags = {}\n\n        // Get available subcategories\n        tags.available = await actionHandler.getAvailableGroups({ nestId, level })\n\n        // Get selected subcategories\n        tags.selected = await actionHandler.getSelectedGroups({ nestId, level })\n\n        // Set dialog data\n        const dialogData = {\n            title: Utils.i18n('tokenActionHud.form.hud.groupTitle') + ` (${name})`,\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.groupDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: await actionHandler.getGroupSettings(groupData)\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            choices = choices.map((choice) => {\n                choice.id =\n                choice.id ??\n                choice.name.slugify({\n                    replacement: '-',\n                    strict: true\n                })\n                choice.type = choice.type ?? 'custom'\n                return {\n                    id: choice.id,\n                    listName: choice.listName,\n                    name: choice.name,\n                    type: choice.type\n                }\n            })\n\n            const characterCount = formData?.characterCount\n            const customWidth = formData?.customWidth\n            const grid = formData?.grid\n            const image = formData?.image\n            const showTitle = formData?.showTitle\n            const sort = formData?.sort\n            groupData.settings = { characterCount, customWidth, grid, image, showTitle, sort }\n\n            // Save selected subcategories to user action list\n            await actionHandler.updateGroups(choices, groupData)\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        TagDialog.showDialog(\n            'topLevelGroup',\n            nestId,\n            tags,\n            dialogData,\n            dialogSubmit\n        )\n    }\n\n    /**\n     * Show action dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     * @param {object} groupData    The group data\n     */\n    static async showActionDialog (actionHandler, groupData) {\n        const { nestId, name, level } = groupData\n\n        // Set available and selected tags\n        const tags = {}\n\n        // Get available actions and subcategories\n        const availableActions = await actionHandler.getAvailableActions(groupData)\n        const availableSubcategories = await actionHandler.getAvailableGroups({ nestId, level })\n        tags.available = [...availableActions, ...availableSubcategories]\n\n        // Get selected actions and subcategories\n        const selectedActions = await actionHandler.getSelectedActions(groupData)\n        const selectedGroups = await actionHandler.getSelectedGroups({ nestId, level })\n        tags.selected = [...selectedActions, ...selectedGroups]\n\n        // Set dialog data\n        const dialogData = {\n            title: `${Utils.i18n('tokenActionHud.form.hud.groupTitle')} (${name})`,\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.groupDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: await actionHandler.getGroupSettings(groupData)\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            const selectedGroups = []\n            const selectedActions = []\n            for (const choice of choices) {\n                if (choice.type === 'action') {\n                    selectedActions.push(choice)\n                } else {\n                    selectedGroups.push(choice)\n                }\n            }\n\n            // Get advanced category options\n            const characterCount = formData?.characterCount\n            const collapse = formData?.collapse\n            const customWidth = formData?.customWidth\n            const grid = formData?.grid\n            const image = formData?.image\n            const showTitle = formData?.showTitle\n            const sort = formData?.sort\n            const style = formData?.style\n            groupData.settings = { characterCount, collapse, customWidth, grid, image, showTitle, sort, style }\n\n            // Save subcategories to user action list\n            await actionHandler.updateGroups(selectedGroups, groupData)\n            await actionHandler.updateActions(selectedActions, groupData)\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        TagDialog.showDialog(\n            'group',\n            nestId,\n            tags,\n            dialogData,\n            dialogSubmit\n        )\n    }\n}\n","import { Utils } from './utils.js'\n\nexport class GroupResizer {\n    direction = null\n    minCols = 3\n    isCustomWidth = false\n    settings = null\n    spacing = 10\n\n    /**\n     * Resize the groups element\n     * @param {ActionHandler} actionHandler The actionHandler class\n     * @param {object} groupElement         The group element\n     * @param {string} autoDirection        The direction the HUD will expand\n     * @param {boolean} gridModuleSetting   The grid module setting\n     */\n    async resizeGroup (actionHandler, groupElement, autoDirection, gridModuleSetting) {\n        // Exit early if no group element exists\n        if (!groupElement) return\n\n        this.#resetVariables()\n\n        this.groupElement = groupElement\n\n        // Get groups element\n        await this.#getGroupsElement()\n\n        // Exit early if no groups element exists\n        if (!this.groupsElement) return\n\n        this.actionsElements = this.groupElement.querySelectorAll('.tah-actions')\n\n        // Exit early if no action elements exist\n        if (this.actionsElements.length === 0) return\n\n        // Reset groups elements\n        this.#resetGroupsElements()\n\n        // Set direction\n        this.direction = autoDirection\n\n        // Get group settings\n        const nestId = this.groupElement.dataset.nestId\n        this.settings = await actionHandler.getGroupSettings({ nestId, level: 1 })\n\n        // Get available width\n        this.availableWidth = this.#getAvailableWidth()\n\n        // Get groups\n        this.#getGroupElements()\n\n        // Loop groups\n        let hasGrid = false\n        for (const groupElement of this.groupElements) {\n            const actionsElement = groupElement.querySelector('.tah-actions')\n            if (!actionsElement) continue\n            const nestId = groupElement.dataset.nestId\n            const groupSettings = await actionHandler.getGroupSettings({ nestId })\n            const groupCustomWidth = groupSettings.customWidth\n            const grid = gridModuleSetting || this.settings?.grid || groupSettings?.grid\n            if (grid) {\n                if (!hasGrid) {\n                    await this.#getGridWidth()\n                    hasGrid = true\n                }\n                await this.#resizeGrid(actionsElement, groupCustomWidth)\n            } else {\n                await this.#resize(actionsElement, groupCustomWidth)\n            }\n        }\n\n        // Set group height\n        await this.#setHeight()\n    }\n\n    /**\n     * Reset variables\n     * @private\n     */\n    #resetVariables () {\n        this.actionsElements = null\n        this.availableHeight = null\n        this.availableWidth = null\n        this.direction = null\n        this.gridWidth = null\n        this.groupElement = null\n        this.groupElements = null\n        this.groupsElement = null\n        this.groupsElementPadding = null\n        this.groupsElementRect = null\n        this.isCustomWidth = false\n        this.minCols = 3\n        this.settings = null\n        this.spacing = 10\n    }\n\n    /**\n     * Reset groups elements\n     */\n    #resetGroupsElements () {\n        const level1GroupElement = this.groupElement.closest('.tah-tab-group[data-level=\"1\"]')\n        const groupsElements = level1GroupElement.querySelectorAll('.tah-groups')\n        const style = { maxHeight: '', overflowY: '' }\n        this.#resetCSS(groupsElements, style)\n    }\n\n    /**\n     * Get the grid width\n     * @private\n     */\n    async #getGridWidth () {\n        // Reset action elements\n        const emptyStyle = { display: '', gridTemplateColumns: '', width: '' }\n        await this.#resetCSS(this.actionsElements, emptyStyle)\n\n        const actionWidths = []\n        const actionWidthsForMedian = []\n        for (const actionsElement of this.actionsElements) {\n            const actionElements = actionsElement.querySelectorAll('.tah-action:not(.shrink)')\n            for (const actionElement of actionElements) {\n                const actionRect = actionElement.getBoundingClientRect()\n                const actionWidth = Math.round(parseFloat(actionRect.width) + 1 || 0)\n                const actionButtonText = actionElement.querySelector('.tah-action-button-text')\n                const actionButtonTextRect = actionButtonText?.getBoundingClientRect()\n                const actionButtonTextWidth = Math.round(parseFloat(actionButtonTextRect?.width) || 0)\n                actionWidthsForMedian.push(actionWidth)\n                actionWidths.push({ actionWidth, actionButtonTextWidth })\n            }\n        }\n\n        let upperQuartileAverage = Math.ceil(Utils.getUpperQuartileAverage(actionWidthsForMedian))\n        const minActionButtonTextWidth = 30\n\n        for (const actionWidth of actionWidths) {\n            const availableactionButtonTextWidth = upperQuartileAverage - (actionWidth.actionWidth - actionWidth.actionButtonTextWidth)\n            if (availableactionButtonTextWidth < minActionButtonTextWidth) {\n                upperQuartileAverage = (upperQuartileAverage - availableactionButtonTextWidth) + minActionButtonTextWidth\n            }\n        }\n\n        this.gridWidth = upperQuartileAverage\n    }\n\n    /**\n     * Resize the actions element into the grid format\n     * @private\n     * @param {object} actionsElement The actions element\n     * @param {number} customWidth    The custom width\n     */\n    async #resizeGrid (actionsElement, groupCustomWidth) {\n        if (!actionsElement) return\n        const emptyStyle = { display: '', gridTemplateColumns: '', width: '' }\n        await this.#assignCSS(actionsElement, emptyStyle)\n\n        const actions = actionsElement.querySelectorAll('.tah-action')\n        const squaredCols = Math.ceil(Math.sqrt(actions.length))\n        const availableGroupWidth = groupCustomWidth ?? this.availableWidth\n        const availableCols = Math.floor(availableGroupWidth / this.gridWidth)\n        const cols = (squaredCols > availableCols || groupCustomWidth) ? availableCols : (actions.length <= this.minCols) ? actions.length : squaredCols\n        // Apply maxHeight and width styles to content\n        const style = { display: 'grid', gridTemplateColumns: `repeat(${cols}, ${this.gridWidth}px)` }\n        await this.#assignCSS(actionsElement, style)\n    }\n\n    /**\n     * Resize the actions element\n     * @private\n     * @param {object} actionsElement The actions element\n     * @param {number} customWidth    The custom width\n     */\n    async #resize (actionsElement, groupCustomWidth) {\n        if (!actionsElement) return\n\n        let width = 500\n\n        if (this.isCustomWidth) {\n            width = this.availableWidth\n        } else if (groupCustomWidth) {\n            width = groupCustomWidth\n        } else {\n            const actions = actionsElement.querySelectorAll('.tah-action')\n            if (!actions.length) return\n            const sqrtActions = Math.ceil(Math.sqrt(actions.length)) // 4\n\n            // Initialize variables\n            let currentRow = 1\n            let maxRowWidth = 0\n            let rowWidth = 0\n            // Iterate through action groups, calculating dimensions and counts\n            if (actions.length > 0) {\n                actions.forEach((action, index) => {\n                    if ((index + 1) / sqrtActions > currentRow) {\n                        rowWidth = rowWidth - 5\n                        maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth\n                        rowWidth = 0\n                        currentRow++\n                    }\n                    const actionRect = action.getBoundingClientRect()\n                    // const actionLeft = (index === 0) ? actionRect.left - this.groupsElementRect.left : 0\n                    const actionWidth = Math.ceil(parseFloat(actionRect.width) + 1 || 0)\n                    rowWidth += actionWidth\n                    // + actionLeft + 5\n                    if (index + 1 === actions.length) {\n                        rowWidth = rowWidth - 5\n                        maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth\n                    }\n                })\n            }\n\n            // Add padding to maxAvgGroupWidth and maxGroupWidth\n            maxRowWidth += this.groupsElementPadding\n\n            // Determine width of content\n            width = (maxRowWidth < this.availableWidth && actions.length > 3) ? maxRowWidth : this.availableWidth\n            if (width < 200) width = 200\n        }\n\n        const style = { maxWidth: `${width}px` }\n        await this.#assignCSS(actionsElement, style)\n    }\n\n    /**\n     * Get available content width\n     * @private\n     */\n    #getAvailableWidth () {\n        const customWidth = this.settings?.customWidth\n\n        if (customWidth) {\n            this.isCustomWidth = true\n            return customWidth\n        }\n\n        const windowWidth = canvas.screenDimensions[0] || window.innerWidth\n        const contentLeft = this.groupsElementRect.left\n        const uiRight = document.querySelector('#ui-right')\n        const uiRightClientWidth = uiRight.clientWidth\n        return Math.floor((\n            uiRightClientWidth > 0\n                ? windowWidth - uiRightClientWidth\n                : windowWidth\n        ) - this.spacing - contentLeft)\n    }\n\n    /**\n     * Get available content height\n     * @private\n     */\n    #getAvailableHeight () {\n        const windowHeight = canvas.screenDimensions[1] || window.innerHeight\n        const contentBottom = this.groupsElementRect.bottom\n        const contentTop = this.groupsElementRect.top\n        const uiTopBottom = (this.direction === 'down')\n            ? document.querySelector('#ui-bottom')\n            : document.querySelector('#ui-top')\n        const uiTopBottomOffsetHeight = uiTopBottom.offsetHeight\n        const availableHeight = (this.direction === 'down')\n            ? windowHeight - contentTop - uiTopBottomOffsetHeight - this.spacing\n            : contentBottom - uiTopBottomOffsetHeight - this.spacing\n        return Math.floor(availableHeight < 100 ? 100 : availableHeight)\n    }\n\n    /**\n     * Get content\n     * @private\n     */\n    async #getGroupsElement () {\n        this.groupsElement = this.groupElement.querySelector('.tah-groups')\n        if (!this.groupsElement) return\n        this.groupsElementRect = this.groupsElement.getBoundingClientRect()\n        this.groupsElementComputed = getComputedStyle(this.groupsElement)\n        this.groupsElementPadding =\n            Math.ceil(parseFloat(this.groupsElementComputed.paddingLeft) || 0) +\n            Math.ceil(parseFloat(this.groupsElementComputed.paddingRight) || 0)\n    }\n\n    /**\n     * Get groups\n     * @private\n     */\n    #getGroupElements () {\n        this.groupElements = this.groupElement.querySelectorAll('.tah-group')\n        if (this.groupElements.length === 0) this.groupElements = [this.groupElement]\n    }\n\n    /**\n     * Set the content height\n     * @private\n     */\n    async #setHeight () {\n        requestAnimationFrame(() => {\n            this.availableHeight = this.#getAvailableHeight()\n            const style = { maxHeight: `${this.availableHeight}px`, overflowY: 'auto' }\n            Object.assign(this.groupsElement.style, style)\n        })\n    }\n\n    /**\n     * Assign CSS\n     * @private\n     * @param {object} element The DOM element\n     * @param {object} style   The style\n     */\n    async #assignCSS (element, style) {\n        if (!element) return\n        requestAnimationFrame(() => {\n            Object.assign(element.style, style)\n        })\n    }\n\n    /**\n     * Reset CSS\n     * @private\n     * @param {array} elements The DOM elements\n     * @param {object} style   The style\n     */\n    async #resetCSS (elements, style) {\n        for (const element of elements) {\n            Object.assign(element.style, style)\n        }\n    }\n}\n","import { TagDialogHelper } from './dialogs/tag-dialog-helper.js'\nimport { GroupResizer } from './group-resizer.js'\nimport { DataHandler } from './data-handler.js'\nimport { CSS_STYLE, MODULE, SETTING, TEMPLATE } from './constants.js'\nimport { Logger, Timer, Utils } from './utils.js'\n\n/**\n * Token Action HUD application\n */\nexport class TokenActionHud extends Application {\n    // Set defaults\n    hoveredGroups = []\n    defaults = {}\n    defaultHeight = 200\n    defaultWidth = 20\n    defaultLeftPos = 150\n    defaultTopPos = 80\n    leftPos = this.defaultLeftPos\n    topPos = this.defaultTopPos\n    defaultScale = 1\n    refreshTimeout = null\n    rendering = false\n    tokens = null\n    isUpdatePending = false\n    isUpdating = false\n    updatePendingTimer = new Timer(10)\n    updateTimer = new Timer(10)\n\n    constructor (module, systemManager) {\n        super()\n        this.module = MODULE\n        this.systemManager = systemManager\n        this.autoDirection = 'down'\n        this.directionSetting = 'down'\n        this.alwaysShowSetting = false\n        this.clickOpenCategorySetting = false\n        this.isCollapsed = false\n        this.enableCustomizationSetting = false\n        this.dragSetting = 'whenUnlocked'\n        this.enableSetting = false\n        this.isHudEnabled = false\n        this.gridSetting = false\n        this.isUnlocked = false\n        this.styleSetting = null\n    }\n\n    /**\n     * Initialise the HUD\n     * @public\n     */\n    async init () {\n        this.activeCssAsTextSetting = Utils.getSetting('activeCssAsText')\n        this.allowSetting = Utils.getSetting('allow')\n        this.alwaysShowSetting = Utils.getSetting('alwaysShowHud')\n        this.clickOpenCategorySetting = Utils.getSetting('clickOpenCategory')\n        this.directionSetting = Utils.getSetting('direction')\n        this.debugSetting = Utils.getSetting('debug')\n        this.displayIconsSetting = Utils.getSetting('displayIcons')\n        this.dragSetting = Utils.getSetting('drag')\n        this.enableCustomizationSetting = Utils.getSetting('enableCustomization')\n        this.enableSetting = Utils.getSetting('enable')\n        this.gridSetting = Utils.getSetting('grid')\n        this.scaleSetting = Utils.getSetting('scale')\n        this.styleSetting = Utils.getSetting('style')\n\n        this.isCollapsed = Utils.getUserFlag('isCollapsed')\n        this.isHudEnabled = this.#getHudEnabled()\n        this.hudPosition = Utils.getUserFlag('position')\n        this.isUnlocked = Utils.getUserFlag('isUnlocked')\n\n        await this.systemManager.registerDefaultsCore()\n\n        this.dataHandler = new DataHandler()\n        await this.dataHandler.init()\n\n        this.actionHandler = await this.systemManager.getActionHandlerCore()\n        this.actionHandler.customLayoutSetting = Utils.getSetting('customLayout')\n        this.actionHandler.userCustomLayoutFlag = Utils.getUserFlag('userCustomLayout')\n        this.actionHandler.enableCustomizationSetting = this.enableCustomizationSetting\n        this.actionHandler.displayCharacterNameSetting = Utils.getSetting('displayCharacterName')\n        this.actionHandler.sortActionsSetting = Utils.getSetting('sortActions')\n        this.actionHandler.tooltipsSetting = Utils.getSetting('tooltips')\n\n        this.GroupResizer = new GroupResizer()\n        this.rollHandler = this.systemManager.getRollHandlerCore()\n    }\n\n    /**\n     * Update Token Action HUD following change to module settings\n     * @public\n     */\n    async updateSettings (key, value = null) {\n        if (!this.updateSettingsPending) {\n            this.updateSettingsPending = true\n            Logger.debug('Updating settings...')\n        }\n\n        const setting = SETTING[key]\n        const variable = setting?.variable\n        if (variable) {\n            if (setting.classes.includes('TokenActionHud')) this[variable] = value\n            if (setting.classes.includes('ActionHandler')) this.actionHandler[variable] = value\n        }\n\n        switch (key) {\n        case 'allow':\n        case 'enable':\n            this.isHudEnabled = this.#getHudEnabled()\n            break\n        case 'customLayout':\n        case 'userCustomLayout':\n            this.actionHandler.customLayout = null\n            break\n        case 'rollHandler':\n            this.updateRollHandler()\n            break\n        }\n    }\n\n    /**\n     * Update the RollHandler\n     * @public\n     */\n    updateRollHandler () {\n        this.rollHandler = this.systemManager.getRollHandlerCore()\n    }\n\n    /**\n     * Merge Token Action Hud's default options with Application\n     * @override\n     */\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: TEMPLATE.hud,\n            id: 'token-action-hud',\n            classes: [],\n            width: this.defaultWidth,\n            height: this.defaultHeight,\n            left: this.defaultLeftPos,\n            top: this.defaultTopPos,\n            scale: this.defaultScale,\n            background: 'none',\n            popOut: false,\n            minimizable: false,\n            resizable: false,\n            title: 'token-action-hud',\n            dragDrop: [],\n            tabs: [],\n            scrollY: [],\n            zIndex: 100\n        })\n    }\n\n    /**\n     * Whether the HUD can be dragged\n     * @returns {boolean} Whether the HUD can be dragged\n     */\n    #isDraggable () {\n        return ((this.dragSetting === 'always') || (this.dragSetting === 'whenUnlocked' && this.isUnlocked))\n    }\n\n    /**\n     * Get Token Action Hud scale\n     * @private\n     * @returns {number} The scale\n     */\n    #getScale () {\n        const scale = parseFloat(this.scaleSetting)\n        if (scale < 0.5) return 0.5\n        if (scale > 2) return 2\n        return scale\n    }\n\n    /**\n     * Get data\n     * @override\n     */\n    getData (options = {}) {\n        const data = super.getData()\n        data.hud = this.hud\n        data.id = 'token-action-hud'\n        data.style = game.tokenActionHud.systemManager.styles[this.styleSetting].class ?? ''\n        data.scale = this.#getScale()\n        data.background = '#00000000'\n        Logger.debug('Application data', { data })\n\n        return data\n    }\n\n    /**\n     * Activate listeners\n     * @override\n     */\n    activateListeners (html) {\n        const elements = {\n            action: html.find('.tah-action'),\n            buttons: html.find('#tah-buttons'),\n            tabGroup: html.find('.tah-tab-group'),\n            groups: html.find('#tah-groups'),\n            editHudButton: html.find('#tah-edit-hud'),\n            listGroups: html.find('.tah-list-groups'),\n            group: html.find('.tah-group'),\n            subtitle: html.find('.tah-subtitle'),\n            groupButton: html.find('.tah-group-button'),\n            collapseHudButton: html.find('#tah-collapse-hud'),\n            expandHudButton: html.find('#tah-expand-hud'),\n            unlockButton: html.find('#tah-unlock'),\n            lockButton: html.find('#tah-lock')\n        }\n\n        // Bind event listeners\n        this.#bindGroupEvents(elements)\n        this.#bindActionEvents(elements)\n        this.#bindEditHudButton(elements)\n        this.#bindLockUnlockButtons(elements)\n        this.#bindCollapseExpandButtons(elements)\n    }\n\n    /**\n     * Post-render HUD\n     */\n    postRender () {\n        this.#applySettings()\n\n        // Resize category\n        if (this.hoveredGroups.length) {\n            for (const groupId of this.hoveredGroups) {\n                const group = document.querySelector(`#${groupId}`)\n                this.GroupResizer.resizeGroup(this.actionHandler, group, this.autoDirection, this.gridSetting)\n            }\n        }\n    }\n\n    /**\n    * Bind category events\n    * @private\n    */\n    #bindGroupEvents (elements) {\n        /**\n         * Close the group\n         * @param {object} event The event\n         */\n        const closeGroup = (event) => {\n            if (game.tokenActionHud.rendering) return\n            const group = (this.clickOpenCategorySetting) ? event.currentTarget.parentElement : event.currentTarget\n            group.classList.remove('hover')\n            const closestGroupElement = group.closest('.tah-group')\n            let sibling = closestGroupElement?.nextElementSibling\n            while (sibling) {\n                if (sibling.classList.contains('tah-group')) {\n                    sibling.classList.remove('tah-hidden')\n                }\n                sibling = sibling.nextElementSibling\n            }\n            this.#clearHoveredGroup(group.id)\n        }\n\n        /**\n         * Open the group\n         * @param {object} event The event\n         */\n        const openGroup = async (event) => {\n            const group = (this.clickOpenCategorySetting) ? event.currentTarget.parentElement : event.currentTarget\n            group.classList.add('hover')\n            const closestGroupElement = group.closest('.tah-group')\n            let sibling = closestGroupElement?.nextElementSibling\n            while (sibling) {\n                if (sibling.classList.contains('tah-group')) {\n                    sibling.classList.add('tah-hidden')\n                }\n                sibling = sibling.nextElementSibling\n            }\n            this.GroupResizer.resizeGroup(this.actionHandler, group, this.autoDirection, this.gridSetting)\n            this.#setHoveredGroup(group.id)\n        }\n\n        /**\n         * Toggle the group\n         * @param {object} event The event\n         */\n        const toggleGroup = (event) => {\n            const group = event.currentTarget.parentElement\n            if (group.classList.contains('hover')) {\n                closeGroup(event)\n            } else {\n                const groupElements = group.parentElement.querySelectorAll('.tah-tab-group')\n                for (const groupElement of groupElements) {\n                    groupElement.classList.remove('hover')\n                    this.#clearHoveredGroup(groupElement.id)\n                }\n                openGroup(event)\n            }\n            // Remove focus to allow core ESC interactions\n            event.currentTarget.blur()\n        }\n\n        // Bring HUD to top\n        elements.groupButton.on('click', (event) => {\n            this.bringToTop()\n            // Remove focus to allow core ESC interactions\n            event.currentTarget.blur()\n        })\n\n        if (this.clickOpenCategorySetting) {\n            // When a category button is clicked...\n            elements.groupButton.on('click', toggleGroup)\n        } else {\n            // When a category button is hovered over...\n            elements.tabGroup.get().forEach(element => {\n                element.addEventListener('touchstart', toggleGroup, { passive: true })\n            })\n            elements.tabGroup.hover(openGroup, closeGroup)\n        }\n\n        // When a category button is clicked and held...\n        elements.groupButton.on('mousedown', (event) => this.#dragEvent(event))\n        elements.groupButton.get().forEach(element => {\n            element.addEventListener('touchstart', (event) => this.#dragEvent(event), { passive: true })\n        })\n    }\n\n    /**\n     * Bind action events\n     * @private\n     * @param {object} elements The DOM elements\n     */\n    #bindActionEvents (elements) {\n        /**\n         * Action click\n         * @param {object} event The event\n         */\n        const actionClick = (event) => {\n            const target = ((event.target.tagName === 'BUTTON')) ? event.target : event.currentTarget.children[0]\n            const value = target.value\n            try {\n                this.rollHandler.handleActionClickCore(event, value, this.actionHandler)\n                target.blur()\n            } catch (error) {\n                Logger.error(event)\n            }\n        }\n\n        /**\n         * Action hover\n         * @param {object} event The event\n         */\n        const actionHover = (event) => {\n            const target = ((event.target.tagName === 'BUTTON')) ? event.target : event.currentTarget.children[0]\n            const value = target.value\n            try {\n                this.rollHandler.handleActionHoverCore(event, value, this.actionHandler)\n            } catch (error) {\n                Logger.error(event)\n            }\n        }\n\n        /**\n         * Group click\n         * @param {object} event The event\n         */\n        const groupClick = (event) => {\n            const target = (event.target.classList.contains('tah-button-text')) || (event.target.classList.contains('tah-button-image')) || (event.target.classList.contains('tah-group-button'))\n                ? event.target.closest('.tah-tab-group')\n                : event.target.closest('.tah-group')\n            if (!target?.dataset?.nestId) return\n            const nestId = target?.dataset?.nestId\n            try {\n                this.rollHandler.handleGroupClickCore(event, nestId, this.actionHandler)\n            } catch (error) {\n                Logger.error(event)\n            }\n        }\n\n        /**\n         * Open the group dialog\n         * @param {object} event\n         */\n        const openGroupDialog = (event) => {\n            const target = event.currentTarget\n            if (!target?.parentElement?.dataset?.nestId) return\n\n            const nestId = target?.parentElement?.dataset?.nestId\n            const name = target?.parentElement?.dataset?.name ?? target.innerText ?? target.outerText\n            const level = parseInt(target?.parentElement?.dataset?.level) || null\n            const type = target?.parentElement?.dataset?.type\n\n            TagDialogHelper.showGroupDialog(\n                this.actionHandler,\n                { nestId, name, level, type }\n            )\n        }\n\n        /**\n         * Open the Action dialog\n         * @param {object} event The event\n         */\n        const openActionDialog = (event) => {\n            const target = (event.target.classList.contains('tah-button-text')) || (event.target.classList.contains('tah-button-image')) || (event.target.classList.contains('tah-group-button'))\n                ? event.target.closest('.tah-tab-group')\n                : event.target.closest('.tah-group')\n            if (!target?.dataset?.nestId) return\n            const nestId = target?.dataset?.nestId\n            const name = event.target.innerText ?? event.target.outerText\n            const level = parseInt(target?.dataset?.level) || null\n            const type = target?.dataset?.type\n\n            TagDialogHelper.showActionDialog(\n                this.actionHandler,\n                { nestId, name, level, type }\n            )\n        }\n\n        /**\n         * Collapse/expand group\n         * @param {object} event                   The event\n         * @param {boolean} enableCustomizationSetting Whether customization is enabled\n         */\n        const collapseExpandGroup = (event, enableCustomizationSetting) => {\n            const target = event.target.classList.contains('tah-subtitle-text')\n                ? event.target.parentElement\n                : event.target\n            const groupElement = target?.closest('.tah-group')\n            const nestId = groupElement?.dataset?.nestId\n            const tabGroup = target.closest('.tah-tab-group.hover')\n            const groupsElement = groupElement?.querySelector('.tah-groups')\n            const collapseIcon = target.querySelector('.tah-collapse-icon')\n            const expandIcon = target.querySelector('.tah-expand-icon')\n            const imageElement = groupElement.querySelector('.tah-list-image')\n\n            const toggleGroupVisibility = () => {\n                groupsElement?.classList.toggle('tah-hidden')\n                collapseIcon?.classList.toggle('tah-hidden')\n                expandIcon?.classList.toggle('tah-hidden')\n                imageElement?.classList.toggle('tah-hidden')\n            }\n\n            const saveGroupSettings = (collapse) => {\n                if (enableCustomizationSetting) {\n                    this.actionHandler.saveGroupSettings({ nestId, settings: { collapse } })\n                }\n            }\n\n            if (groupsElement?.classList.contains('tah-hidden')) {\n                toggleGroupVisibility()\n                saveGroupSettings(false)\n                this.GroupResizer.resizeGroup(this.actionHandler, tabGroup, this.autoDirection, this.gridSetting)\n            } else {\n                toggleGroupVisibility()\n                saveGroupSettings(true)\n            }\n        }\n\n        // When a subcategory title is right-clicked...\n        elements.subtitle.on('contextmenu', (event) => {\n            if (this.isUnlocked) {\n                openActionDialog(event)\n            } else {\n                groupClick(event)\n            }\n        })\n\n        // When a subcategory title is clicked...\n        elements.subtitle.on('click', (event) => {\n            if (event.target.classList.contains('tah-button-text')) return\n            collapseExpandGroup(event, this.enableCustomizationSetting)\n        })\n\n        // When an action is clicked or right-clicked...\n        elements.action.on('click contextmenu', (event) => {\n            event.preventDefault()\n            actionClick(event)\n        })\n\n        // When an action is hovered...\n        elements.action.hover((event) => {\n            actionHover(event)\n        })\n\n        elements.groupButton.on('contextmenu', (event) => {\n            if (this.isUnlocked) {\n                if (event.currentTarget.parentElement.dataset.level === '1') {\n                    openGroupDialog(event)\n                } else {\n                    openActionDialog(event)\n                }\n            } else {\n                groupClick(event)\n            }\n        })\n    }\n\n    /**\n     * Bind 'Edit HUD' button\n     * @private\n     */\n    #bindEditHudButton (elements) {\n        // When the 'Edit HUD' button is clicked...\n        elements.editHudButton.on('click', (event) => {\n            event.preventDefault()\n            event = event || window.event\n            TagDialogHelper.showHudDialog(this.actionHandler)\n        })\n    }\n\n    /**\n     * Bind lock and unlock buttons\n     * @private\n     */\n    #bindLockUnlockButtons (elements) {\n        /**\n         * Unlock the HUD\n         * @param {object} event\n         */\n        const unlockHud = async (event) => {\n            if (event) {\n                event.preventDefault()\n            }\n\n            const target = event?.target || elements.unlockButton\n            $(target).addClass('tah-hidden')\n            elements.editHudButton.removeClass('tah-hidden')\n            elements.group.removeClass('tah-hidden')\n            elements.groupButton.removeClass('disable-edit')\n            elements.groups.addClass('tah-unlocked')\n            elements.listGroups.removeClass('tah-hidden')\n            elements.lockButton.removeClass('tah-hidden')\n            elements.tabGroup.removeClass('tah-hidden')\n            elements.subtitle.removeClass('disable-edit tah-hidden')\n\n            if (!this.isUnlocked) {\n                await Utils.setUserFlag('isUnlocked', true)\n                this.isUnlocked = true\n            }\n        }\n\n        /**\n         * Lock the HUD\n         * @param {object} event\n         */\n        const lockHud = async (event = null) => {\n            if (event) {\n                event.preventDefault()\n            }\n            const target = event?.target || elements.lockButton\n            $(target).addClass('tah-hidden')\n            elements.unlockButton.removeClass('tah-hidden')\n            elements.editHudButton.addClass('tah-hidden')\n            elements.groups.removeClass('tah-unlocked')\n            for (const topGroupElement of elements.tabGroup) {\n                const hasActions = (topGroupElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) topGroupElement.classList.add('tah-hidden')\n            }\n            for (const groupElement of elements.group) {\n                const hasActions = (groupElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) groupElement.classList.add('tah-hidden')\n            }\n            for (const listGroupsElement of elements.listGroups) {\n                const hasActions = (listGroupsElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) listGroupsElement.classList.add('tah-hidden')\n            }\n            for (const subtitleElement of elements.subtitle) {\n                const groupElement = subtitleElement.closest('.tah-group')\n                if (groupElement?.dataset?.showTitle === 'false') {\n                    subtitleElement.classList.add('tah-hidden')\n                }\n            }\n            elements.groupButton.addClass('disable-edit')\n            elements.subtitle.addClass('disable-edit')\n            if (this.isUnlocked) {\n                await Utils.setUserFlag('isUnlocked', false)\n                this.isUnlocked = false\n            }\n        }\n\n        // Set initial lock state\n        if (this.isUnlocked && this.enableCustomizationSetting) {\n            unlockHud()\n        } else {\n            lockHud()\n        }\n\n        if (!this.enableCustomizationSetting) {\n            elements.unlockButton.addClass('tah-hidden')\n        }\n\n        // Add event listeners\n        elements.unlockButton.on('click', unlockHud)\n        elements.lockButton.on('click', lockHud)\n    }\n\n    /**\n     * Bind collapse and expand buttons\n     * @private\n     */\n    #bindCollapseExpandButtons (elements) {\n        /**\n         * Collapse the HUD\n         * @param {object} event The event\n         */\n        const collapseHud = (event = null) => {\n            if (event) {\n                event.preventDefault()\n                event = event || window.event\n            }\n            const target = event?.target || elements.collapseHudButton\n            $(target).addClass('tah-hidden')\n            elements.expandHudButton.removeClass('tah-hidden')\n            elements.groups.addClass('tah-hidden')\n            elements.buttons.addClass('tah-hidden')\n            if (!this.isCollapsed) {\n                Utils.setUserFlag('isCollapsed', true)\n                this.isCollapsed = true\n            }\n        }\n\n        /**\n         * Expand the HUD\n         * @param {object} event The event\n         */\n        const expandHud = (event) => {\n            event.preventDefault()\n            event = event || window.event\n            $(event.target).addClass('tah-hidden')\n            elements.collapseHudButton.removeClass('tah-hidden')\n            elements.groups.removeClass('tah-hidden')\n            elements.buttons.removeClass('tah-hidden')\n            if (this.isCollapsed) {\n                Utils.setUserFlag('isCollapsed', false)\n                this.isCollapsed = false\n            }\n        }\n\n        // Set initial state\n        if (this.isCollapsed) { collapseHud() }\n\n        // Add event listeners\n        // When the 'Collapse HUD' button is clicked...\n        elements.collapseHudButton.on('click', collapseHud)\n\n        // When the 'Expand HUD' Button is clicked...\n        elements.expandHudButton.on('click', expandHud)\n\n        // When the 'Expand HUD' button is clicked and held...\n        elements.expandHudButton.on('mousedown', (event) => this.#dragEvent(event))\n        elements.expandHudButton.get(0).addEventListener('touchstart', (event) => this.#dragEvent(event), { passive: true })\n    }\n\n    /**\n     * Drag event handler\n     * @private\n     * @param {object} event The event\n     */\n    #dragEvent (event) {\n        if (!this.#isDraggable()) return\n\n        // Get the main element\n        const element = document.getElementById('token-action-hud')\n\n        const clientX = event.clientX ?? event.changedTouches[0].clientX\n        const clientY = event.clientY ?? event.changedTouches[0].clientY\n\n        // Initialise positions and starting positions\n        let pos1 = 0\n        let pos2 = 0\n        let pos3 = clientX\n        let pos4 = clientY\n        const originalElementTop = element.offsetTop\n        const originalElementLeft = element.offsetLeft\n        let newElementTop = originalElementTop\n        let newElementLeft = originalElementLeft\n\n        /**\n         * Mouse movement event handler\n         * @param {object} event The event\n         */\n        const mouseMoveEvent = (event) => {\n            const clientX = event.clientX ?? event.changedTouches[0].clientX\n            const clientY = event.clientY ?? event.changedTouches[0].clientY\n            pos1 = pos3 - clientX\n            pos2 = pos4 - clientY\n            pos3 = clientX\n            pos4 = clientY\n\n            // If the mouse has not moved, do not update\n            if (pos1 === pos3 && pos2 === pos4) return\n\n            newElementTop = newElementTop - pos2\n            newElementLeft = newElementLeft - pos1\n\n            this.topPos = newElementTop\n\n            // Apply styles\n            requestAnimationFrame(() => {\n                Object.assign(element.style, { left: `${newElementLeft}px`, position: 'fixed', top: `${newElementTop}px` })\n            })\n        }\n\n        /**\n         * Mouse up event handler\n         */\n        const mouseUpEvent = () => {\n            // Remove the mouse move and touch move events\n            document.onmousemove = null\n            element.ontouchmove = null\n\n            // Remove the mouse up and touch end events\n            document.onmouseup = null\n            element.ontouchend = null\n\n            // If position has not changed, do not update\n            if (newElementTop === originalElementTop && newElementLeft === originalElementLeft) return\n\n            this.topPos = newElementTop\n\n            this.#applySettings()\n\n            // Save the new position to the user's flags\n            this.hudPosition = { top: newElementTop, left: newElementLeft }\n            Utils.setUserFlag('position', this.hudPosition)\n\n            Logger.debug(`Set position to x: ${newElementTop}px, y: ${newElementLeft}px`)\n        }\n\n        // Bind mouse move and touch move events\n        document.onmousemove = mouseMoveEvent\n        element.ontouchmove = mouseMoveEvent\n\n        // Bind mouse up and touch end events\n        document.onmouseup = mouseUpEvent\n        element.ontouchend = mouseUpEvent\n    }\n\n    /**\n     * Get the automatic direction the HUD expands\n     * @private\n     * @returns {string} The direction\n     */\n    #getAutoDirection () {\n        if (this.directionSetting === 'up' || (this.directionSetting === 'auto' && this.topPos > window.innerHeight / 2)) return 'up'\n        return 'down'\n    }\n\n    /**\n     * Apply settings\n     * @private\n     */\n    #applySettings () {\n        this.autoDirection = this.#getAutoDirection()\n        if (this.autoDirection === 'up') {\n            $(document).find('.tah-groups-container').removeClass('expand-down')\n            $(document).find('.tah-groups-container').addClass('expand-up')\n            $(document).find('.tah-groups-container').removeClass('expand-down')\n            $(document).find('.tah-groups-container').addClass('expand-up')\n            $(document).find('#tah-character-name').addClass('tah-hidden')\n        } else {\n            $(document).find('.tah-groups-container').addClass('expand-down')\n            $(document).find('.tah-groups-container').removeClass('expand-up')\n            $(document).find('.tah-groups-container').addClass('expand-down')\n            $(document).find('.tah-groups-container').removeClass('expand-up')\n            $(document).find('#tah-character-name').removeClass('tah-hidden')\n        }\n    }\n\n    /**\n     * Set position of the HUD\n     * @public\n     */\n    setPosition () {\n        if (!this.hud) return\n        this.#setPositionFromFlag()\n        this.#restoreHoveredGroups()\n        this.rendering = false\n    }\n\n    /**\n     * Set the position of the HUD based on user flag\n     * @private\n     */\n    #setPositionFromFlag () {\n        if (!this.hudPosition) return\n\n        const defaultLeftPos = this.defaultLeftPos\n        const defaultTopPos = this.defaultTopPos\n\n        return new Promise((resolve) => {\n            const check = () => {\n                const element = document.getElementById('token-action-hud')\n                if (element) {\n                    element.style.bottom = null\n                    this.topPos = this.hudPosition.top < 5 || this.hudPosition.top > window.innerHeight + 5\n                        ? defaultTopPos\n                        : this.hudPosition.top\n                    element.style.top = `${this.topPos}px`\n                    this.leftPos = this.hudPosition.left < 5 || this.hudPosition.left > window.innerWidth + 5\n                        ? defaultLeftPos\n                        : this.hudPosition.left\n                    element.style.left = `${this.leftPos}px`\n                    element.style.position = 'fixed'\n                    resolve()\n                } else {\n                    setTimeout(check, 10)\n                }\n            }\n\n            check()\n        })\n    }\n\n    /**\n     * Reset the position of the HUD\n     * @public\n     */\n    async resetPosition () {\n        Logger.debug('Resetting position...')\n        this.hudPosition = { top: this.defaultTopPos, left: this.defaultLeftPos }\n        await Utils.setUserFlag('position', this.hudPosition)\n        Logger.debug(`Position reset to x: ${this.defaultTopPos}px, y: ${this.defaultLeftPos}px`)\n    }\n\n    /**\n     * Set hovered group\n     * @private\n     * @param {string} groupId The group id\n     */\n    #setHoveredGroup (groupId) {\n        if (this.hoveredGroups.length > 10) { this.hoveredGroups = [] }\n        this.hoveredGroups.push(groupId)\n    }\n\n    /**\n     * Clear hovered group\n     * @private\n     * @param {string} groupId The group id\n     */\n    #clearHoveredGroup (groupId) {\n        this.hoveredGroups = this.hoveredGroups.filter(id => id !== groupId)\n    }\n\n    /**\n     * Restore the hovered category state on the HUD\n     * @private\n     */\n    #restoreHoveredGroups () {\n        if (!this.hoveredGroups.length) return\n\n        for (const groupId of this.hoveredGroups) {\n            const groupElement = $(`#${groupId}`)\n\n            if (!groupElement[0]) continue\n\n            if (this.clickOpenCategorySetting) {\n                const button = groupElement.find('.tah-group-button')[0]\n                button.click()\n            } else {\n                groupElement.mouseenter()\n            }\n        }\n    }\n\n    /**\n     * Toggle HUD\n     * @public\n     */\n    async toggleHud () {\n        const binding = Utils.humanizeBinding('toggleHud')\n        if (this.enableSetting) {\n            this.#close()\n            this.enableSetting = false\n            await Utils.setSetting('enable', false)\n            Logger.info(game.i18n.format('tokenActionHud.keybinding.toggleHud.disabled', { binding }), true)\n        } else {\n            this.enableSetting = true\n            await Utils.setSetting('enable', true)\n            Logger.info(game.i18n.format('tokenActionHud.keybinding.toggleHud.enabled', { binding }), true)\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n    }\n\n    /**\n     * Copy user's 'groups' flag to others users\n     * @public\n     * @param {string} fromUserId      The user id to copy from\n     * @param {string|array} toUserIds The user ids to copy to\n     */\n    async copy (fromUserId, toUserIds) {\n        if (!game.user.isGM) return\n\n        const isCopied = await this.#copyUserData(fromUserId, toUserIds)\n        if (isCopied) {\n            Logger.info('HUD copied', true)\n        } else {\n            Logger.info('Copy HUD failed', true)\n        }\n    }\n\n    /**\n     * Copy user's 'groups' flag to others users\n     * @private\n     * @param {string} fromUserId      The user id to copy from\n     * @param {string|array} toUserIds The user ids to copy to\n     */\n    async #copyUserData (fromUserId, toUserIds) {\n        // Exit if parameters are missing\n        if (!fromUserId || !toUserIds.length) return false\n\n        Logger.debug('Copying user data...')\n\n        const fromGroup = await DataHandler.getDataAsGm({ type: 'user', id: fromUserId })\n\n        if (typeof toUserIds === 'string') {\n            await DataHandler.saveDataAsGm('user', toUserIds, fromGroup)\n        } else if (Array.isArray(toUserIds)) {\n            for (const userId of toUserIds) {\n                await DataHandler.saveDataAsGm('user', userId, fromGroup)\n            }\n        }\n\n        Logger.debug('User data copied')\n        return true\n    }\n\n    /**\n     * Reset the HUD\n     * @public\n     */\n    async resetDialog () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetLayout.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetLayout.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        const customLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=customLayout]')\n                        if (customLayoutElement) {\n                            await this.updateSettings('customLayout', customLayoutElement?.value ?? '')\n                            await Utils.setSetting('customLayout', customLayoutElement?.value ?? '')\n                        }\n                        const userCustomLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=userCustomLayout]')\n                        if (userCustomLayoutElement) {\n                            await this.updateSettings('userCustomLayout', userCustomLayoutElement?.value ?? '')\n                            await Utils.setUserFlag('userCustomLayout', userCustomLayoutElement?.value ?? '')\n                        }\n                        await TokenActionHud.reset()\n                        Logger.info('Layout reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    /**\n     * Reset the HUD\n     * @public\n     */\n    async resetAllDialog () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetAllLayouts.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetAllLayouts.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        const customLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=customLayout]')\n                        if (customLayoutElement) {\n                            await Utils.setSetting('customLayout', customLayoutElement?.value ?? '')\n                        }\n                        const userCustomLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=userCustomLayout]')\n                        if (userCustomLayoutElement) {\n                            await Utils.setUserFlag('userCustomLayout', userCustomLayoutElement?.value ?? '')\n                        }\n                        await game.tokenActionHud.socket.executeForEveryone('reset')\n                        Logger.info('All layouts reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    static async reset () {\n        Logger.debug('Resetting layout...')\n        await game?.tokenActionHud?.resetUserAndActorData()\n        game?.tokenActionHud?.resetPosition()\n        Logger.debug('Layout reset')\n    }\n\n    /**\n     * Reset actor data\n     */\n    async resetActorData () {\n        Logger.debug('Resetting actor data...')\n\n        await DataHandler.saveDataAsGm('actor', this.actor.id, {})\n        this.actionHandler.hardResetActionHandler()\n\n        Logger.debug('Actor data reset')\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset all actor data\n     * @public\n     */\n    async resetAllActorData () {\n        Logger.debug('Resetting all actor data...')\n\n        for (const actor of game.actors) {\n            Logger.debug(`Resetting flags for actor [${actor.id}]`, { actor })\n            await DataHandler.saveDataAsGm('actor', actor.id, {})\n        }\n        this.actionHandler.hardResetActionHandler()\n\n        Logger.debug('All actor data reset')\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetAllActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset user data\n     * @public\n     */\n    async resetUserData () {\n        Logger.debug('Resetting user data...')\n        await DataHandler.saveDataAsGm('user', game.userId, {})\n        Logger.debug('User data reset')\n        this.actionHandler.hardResetActionHandler()\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetUserData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset all user data\n     * @public\n     */\n    async resetAllUserData () {\n        Logger.debug('Resetting all user data...')\n        for (const user of game.users) {\n            await DataHandler.saveDataAsGm('user', user.id, {})\n        }\n        Logger.debug('All user data reset')\n        this.actionHandler.hardResetActionHandler()\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetAllUserData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset user and actor data\n     */\n    async resetUserAndActorData () {\n        Logger.debug('Resetting user data...')\n        await DataHandler.saveDataAsGm('user', game.userId, {})\n        Logger.debug('User data reset')\n\n        Logger.debug('Resetting actor data...')\n        await DataHandler.saveDataAsGm('actor', this.actor.id, {})\n        Logger.debug('Actor data reset')\n\n        this.actionHandler.hardResetActionHandler()\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetUserAndActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Update the HUD\n     * @public\n     * @param {object} trigger The trigger for the update\n     */\n    async update (trigger = null) {\n        // Stops settings updates from triggering the HUD update multiple times\n        // Instead an update is triggered when settings are updated and the settings config window is closed\n        if (trigger?.name === 'closeSettingsConfig') {\n            if (!this.updateSettingsPending) return\n            this.updateSettingsPending = false\n            Logger.debug('Settings updated')\n        }\n\n        await this.#handleUpdate()\n\n        await this.#performUpdate(trigger)\n    }\n\n    /**\n     * Handles HUD updates to avoid overlapping updates\n     */\n    async #handleUpdate () {\n        // Start a timer and reset it each time an update call is received before the timer has elapsed\n        if (this.isUpdatePending) this.updatePendingTimer.abort()\n\n        this.isUpdatePending = true\n        await this.updatePendingTimer.start()\n        this.isUpdatePending = false\n\n        // Wait for the current update to complete before progressing a pending update\n        // Stop waiting if the current update takes longer than 5 seconds\n        const waitForUpdateCompletion = async () => {\n            const maxWaitTime = 5000\n            const interval = 10\n            const iterations = maxWaitTime / interval\n\n            let i = 0\n            while (i < iterations && this.isUpdating) {\n                await this.updateTimer.start()\n                i++\n            }\n\n            return !this.isUpdating\n        }\n\n        if (this.isUpdating) {\n            const hasCompleted = await waitForUpdateCompletion()\n            if (!hasCompleted) {\n                Logger.debug('Update took too long. Aborting...')\n            }\n        }\n    }\n\n    /**\n     * Perform the HUD update following handling\n     * @param {object} trigger The trigger for the update\n     */\n    async #performUpdate (trigger) {\n        this.isUpdating = true\n\n        Logger.debug('Updating HUD...', trigger)\n\n        const previousActorId = this.actor?.id\n        const controlledTokens = Utils.getControlledTokens()\n        const character = this.#getCharacter(controlledTokens)\n        const multipleTokens = controlledTokens.length > 1 && !character\n\n        if ((!character && !multipleTokens) || !this.isHudEnabled) {\n            this.#close()\n            this.hoveredGroups = []\n            Logger.debug('HUD update aborted as no character(s) found or HUD is disabled')\n            this.isUpdating = false\n            return\n        }\n\n        const options = (trigger === 'controlToken' && previousActorId !== this.actor?.id) ? { saveActor: true } : {}\n\n        this.hud = await this.actionHandler.buildHud(options)\n\n        if (this.hud.length === 0) {\n            this.#close()\n            this.hoveredGroups = []\n            Logger.debug('HUD update aborted as action list empty')\n            this.isUpdating = false\n            return\n        }\n\n        this.rendering = true\n        this.render(true)\n        if (!ui.windows[this.appId]) {\n            ui.windows[this.appId] = this\n        }\n\n        this.isUpdating = false\n\n        Hooks.callAll('tokenActionHudCoreHudUpdated', this.module)\n        Logger.debug('HUD updated')\n    }\n\n    /**\n     * Close application\n     * @private\n     */\n    #close () {\n        this.close()\n    }\n\n    /**\n     * Whether the token change is valid for a HUD update\n     * @public\n     * @param {object} token The token\n     * @param {object} data  The data\n     * @returns {boolean}    Whether the token change is valid for a HUD update\n     */\n    isValidTokenChange (token, data = null) {\n        if (data?.actorData?.flags) return false\n        if (this.alwaysShowSetting) {\n            return (this.#isRelevantToken(token) || token.actorId === game.user.character?.id)\n        } else {\n            return this.#isRelevantToken(token)\n        }\n    }\n\n    /**\n     * Whether the token is controlled or on the canvas\n     * @private\n     * @param {object} token The token\n     * @returns {boolean} Whether the token is controlled or on the canvas\n     */\n    #isRelevantToken (token) {\n        const controlledTokens = Utils.getControlledTokens()\n        return (\n            controlledTokens?.some((controlledToken) => controlledToken.id === token.id) ||\n            (\n                controlledTokens?.length === 0 &&\n                canvas?.tokens?.placeables?.some((token) => token.id === this.hud?.tokenId)\n            )\n        )\n    }\n\n    /**\n     * Whether the given actor is the selected actor\n     * @param {object} actor The actor\n     * @returns {boolean}    Whether the given actor is the selected actor\n     */\n    isSelectedActor (actor) {\n        if (!actor?.id) return true\n        if (actor?.id === this.actor?.id) return true\n        return false\n    }\n\n    /**\n     * Whether the actor or item update is valid for a HUD update\n     * @param {object} actor The actor\n     * @param {object} data  The data\n     * @returns {boolean}    Whether the actor or item update is valid for a HUD update\n     */\n    isValidActorOrItemUpdate (actor, data) {\n        if (!this.isSelectedActor(actor)) return false\n\n        if (actor) {\n            if (!actor) {\n                Logger.debug('No actor, update hud', { data })\n                return true\n            }\n\n            if (this.hud && actor.id === this.hud.actorId) {\n                Logger.debug('Same actor, update hud', { actor, data })\n                return true\n            }\n\n            Logger.debug('Different actor, do not update hud', { actor, data })\n            return false\n        }\n    }\n\n    /**\n     * Whether the character is a valid selection for the current user\n     * @private\n     * @param {object} [token = {}] The token\n     * @returns {boolean}           Whether the character is a valid selection for the current user\n     */\n    #isValidCharacter (token = {}) {\n        const actor = token?.actor\n        return game.user.isGM || actor?.testUserPermission(game.user, 'OWNER')\n    }\n\n    /**\n     * Whether the hud is enabled for the current user\n     * @private\n     * @returns {boolean} Whether the hud is enabled for the current user\n     */\n    #getHudEnabled () {\n        const userRole = game.user.role\n        const isGM = game.user.isGM\n        const isEnabled = this.enableSetting\n\n        if (!isEnabled) return false\n\n        if (isGM) return true\n\n        return Utils.checkAllow(userRole, this.allowSetting)\n    }\n\n    /**\n     * Get character from selected tokens\n     * @private\n     * @param {array} [controlled = []] The controlled tokens\n     */\n    #getCharacter (controlled = []) {\n        if (controlled.length > 1) {\n            this.actor = null\n            this.token = null\n            this.actionHandler.characterName = 'Multiple'\n            this.actionHandler.actor = null\n            this.actionHandler.token = null\n            this.rollHandler.actor = null\n            this.rollHandler.token = null\n            return null\n        }\n\n        const character = { token: null, actor: null }\n        if (controlled.length === 1) {\n            const token = controlled[0]\n            const actor = token.actor\n\n            if (!this.#isValidCharacter(token)) return null\n\n            character.token = token\n            character.actor = actor\n        } else if (controlled.length === 0 && game.user.character && this.alwaysShowSetting) {\n            character.actor = game.user.character\n            character.token = canvas.tokens?.placeables.find(t => t.actor?.id === character.actor.id) ?? null\n        }\n\n        if (!character.actor) return null\n\n        this.actor = character.actor\n        this.token = character.token\n        this.actionHandler.characterName = character.token?.name ?? character.actor.name\n        this.actionHandler.actor = character.actor\n        this.actionHandler.token = character.token\n        this.rollHandler.actor = character.actor\n        this.rollHandler.token = character.token\n        return character\n    }\n}\n","import { ActionHandler } from './action-handlers/action-handler.js'\nimport { ActionHandlerExtender } from './action-handlers/action-handler-extender.js'\nimport { DataHandler } from './data-handler.js'\nimport { MigrationManager } from './migration-manager.js'\nimport { PreRollHandler } from './roll-handlers/pre-roll-handler.js'\nimport { RollHandler } from './roll-handlers/roll-handler.js'\nimport { SystemManager } from './system-manager.js'\nimport { TokenActionHud } from './token-action-hud.js'\nimport { MODULE, TEMPLATE } from './constants.js'\nimport { Logger, Timer, Utils } from './utils.js'\n\nlet systemManager\nlet module\nlet socket\n\nHooks.once('socketlib.ready', () => {\n    socket = socketlib.registerModule(MODULE.ID)\n    socket.register('getFilePaths', DataHandler.getFilePaths)\n    socket.register('getData', DataHandler.getData)\n    socket.register('saveData', DataHandler.saveData)\n    socket.register('reset', TokenActionHud.reset)\n})\n\nHooks.on('ready', async () => {\n    module = game.modules.get(MODULE.ID)\n    const ActionListExtender = ActionHandlerExtender\n    module.api = {\n        ActionListExtender,\n        ActionHandlerExtender,\n        ActionHandler,\n        DataHandler,\n        Logger,\n        PreRollHandler,\n        RollHandler,\n        SystemManager,\n        Timer,\n        Utils\n    }\n\n    Hooks.callAll('tokenActionHudCoreApiReady', module)\n})\n\nHooks.on('tokenActionHudSystemReady', async (systemModule) => {\n    // Exit if core module version is not compatible with the system module\n    const isCompatible = await Utils.checkModuleCompatibility(systemModule.api.requiredCoreModuleVersion)\n    if (!isCompatible) return\n\n    const socketlibModule = game.modules.get('socketlib')\n    if (!socketlibModule || !socketlibModule.active) {\n        Logger.error(\n            'This module requires the \\'socketlib\\' module to be installed and enabled.',\n            true\n        )\n        return\n    }\n\n    // Create new SystemManager and register core and system module settings\n    systemManager = new systemModule.api.SystemManager(MODULE.ID)\n    systemManager.registerStylesCore()\n    systemManager.registerSettingsCore()\n    // Set stylesheet to 'style' core module setting\n    Utils.switchCSS(Utils.getSetting('style'))\n\n    // Register Handlebar helpers\n    Utils.registerHandlebars()\n\n    // Load templates\n    loadTemplates([\n        TEMPLATE.action,\n        TEMPLATE.customStyleForm,\n        TEMPLATE.group,\n        TEMPLATE.hud,\n        TEMPLATE.listGroup,\n        TEMPLATE.settings,\n        TEMPLATE.tabGroup,\n        TEMPLATE.tagDialogGroup,\n        TEMPLATE.tagDialogHud,\n        TEMPLATE.tagDialogTopLevelGroup\n    ])\n\n    Hooks.callAll('tokenActionHudCoreReady')\n})\n\nHooks.on('tokenActionHudCoreReady', async () => {\n    // If no supported color picker modules are active, for the first time only, display a notification\n    if (game.user.isGM && !(game.modules.get('color-picker')?.active ?? false)) {\n        const firstStartup = Utils.getSetting('startup') === false\n        if (firstStartup) {\n            Logger.info(\n                'To enable color pickers in this module\\'s settings, install the \\'Color Picker\\' module.',\n                true\n            )\n            Utils.setSetting('startup', true)\n        }\n    }\n\n    // Create directories for json data\n    const enableCustomizationSetting = Utils.getSetting('enableCustomization')\n    if (game.user.isGM && enableCustomizationSetting) {\n        await DataHandler.createDirectories()\n    }\n\n    // Initialise MigrationManager\n    const migrationManager = new MigrationManager(socket)\n    await migrationManager.init()\n\n    // If no Token Action Hud application exists, create a new TokenActionHud and initialise it\n    if (!game.tokenActionHud) {\n        game.tokenActionHud = new TokenActionHud(module, systemManager)\n        game.tokenActionHud.socket = socket\n        await game.tokenActionHud.init()\n    }\n\n    // Register hooks\n    Hooks.on('renderTokenActionHud', () => game.tokenActionHud.postRender())\n    Hooks.on('deleteActor', (actor, data) => handleHookEvent({ actor, data }, 'deleteActor'))\n    Hooks.on('updateActor', (actor, data) => handleHookEvent({ actor, data }, 'updateActor'))\n    Hooks.on('createActiveEffect', (activeEffect, options, userId) => handleHookEvent({ activeEffect, options, userId }, 'createActiveEffect'))\n    Hooks.on('deleteActiveEffect', (activeEffect, options, userId) => handleHookEvent({ activeEffect, options, userId }, 'deleteActiveEffect'))\n    Hooks.on('createCombat', (combat) => handleHookEvent({ combat }, 'createCombat'))\n    Hooks.on('deleteCombat', (combat) => handleHookEvent({ combat }, 'deleteCombat'))\n    Hooks.on('updateCombat', (combat) => handleHookEvent({ combat }, 'updateCombat'))\n    Hooks.on('updateCombatant', (combatant, data, options, userId) => handleHookEvent({ combatant, data, options, userId }, 'updateCombatant'))\n    Hooks.on('deleteCompendium', (source, html) => handleHookEvent({ source, html }, 'deleteCompendium'))\n    Hooks.on('renderCompendium', (source, html) => handleHookEvent({ source, html }, 'renderCompendium'))\n    Hooks.on('updateCompendium', (source, html) => handleHookEvent({ source, html }, 'updateCompendium'))\n    Hooks.on('createItem', (item) => handleHookEvent({ item }, 'createItem'))\n    Hooks.on('deleteItem', (item) => handleHookEvent({ item }, 'deleteItem'))\n    Hooks.on('updateItem', (item) => handleHookEvent({ item }, 'updateItem'))\n    Hooks.on('deleteMacro', () => handleHookEvent({}, 'deleteMacro'))\n    Hooks.on('updateMacro', () => handleHookEvent({}, 'updateMacro'))\n    Hooks.on('controlToken', (token, controlled) => handleHookEvent({ token, controlled }, 'controlToken'))\n    Hooks.on('deleteToken', (scene, token, change, userId) => handleHookEvent({ scene, token, change, userId }, 'deleteToken'))\n    Hooks.on('updateToken', (token, data, diff) => handleHookEvent({ token, data, diff }, 'updateToken'))\n    Hooks.on('closeSettingsConfig', () => handleHookEvent({}, 'closeSettingsConfig'))\n    Hooks.on('forceUpdateTokenActionHud', () => handleHookEvent({}, 'forceUpdateTokenActionHud'))\n\n    function handleHookEvent (hookData, hookName) {\n        const trigger = { type: 'hook', name: hookName, data: hookData }\n        switch (hookName) {\n        case 'deleteActor':\n        case 'updateActor':\n            if (!game.tokenActionHud.isValidActorOrItemUpdate(hookData.actor, hookData.data)) return\n            break\n        case 'createActiveEffect':\n        case 'deleteActiveEffect':\n            if (!game.tokenActionHud.isSelectedActor(hookData.activeEffect.parent)) return\n            break\n        case 'updateCombatant':\n            if (!game.tokenActionHud.isSelectedActor(hookData.combatant.actor)) return\n            break\n        case 'deleteCompendium':\n        case 'updateCompendium':\n            if (!game.tokenActionHud.actionHandler.compendiumActionHandler.isLinkedCompendium(hookData.source?.metadata?.id)) return\n            game.tokenActionHud.actionHandler.compendiumActionHandler.compendiumActions = new Map()\n            break\n        case 'createItem':\n        case 'deleteItem':\n        case 'updateItem':\n            if (!game.tokenActionHud.isValidActorOrItemUpdate(hookData.item?.actor)) return\n            break\n        case 'deleteMacro':\n        case 'updateMacro':\n            game.tokenActionHud.actionHandler.macroActionHandler.macroActions = null\n            break\n        case 'updateToken':\n            // If it's an X or Y change, assume the token is just moving\n            if (Object.hasOwn(hookData.data, 'y') || Object.hasOwn(hookData.data, 'x' || Object.hasOwn(hookData.data, 'rotation'))) return\n            // If it's a flag change\n            if (Object.hasOwn(hookData.data, 'flags') && Object.keys(hookData.data).length <= 2) return\n            if (!game.tokenActionHud.isValidTokenChange(hookData.token, hookData.data)) return\n            break\n        }\n        game.tokenActionHud.update(trigger)\n    }\n\n    const trigger = { type: 'hook', name: 'canvasReady' }\n    game.tokenActionHud.update(trigger)\n})\n\n/**\n  * Move the HUD below the scene context menus\n  */\nHooks.on('renderSceneNavigation', (data, html) => {\n    html.find('li.scene.nav-item').contextmenu((ev) => sendHudToBottom())\n})\n\n/**\n  * Move the HUD below the hotbar context menus\n  */\nHooks.on('renderHotbar', (data, html) => {\n    html.find('li.macro').contextmenu((ev) => sendHudToBottom())\n})\n\n/**\n * Send HUD to bottom\n */\nfunction sendHudToBottom () {\n    if (!game.tokenActionHud?.element[0]) return\n    game.tokenActionHud.element[0].style.zIndex = 0\n}\n"],"names":["MODULE","ID","NAME","TEMPLATE_DIR","TEMPLATE","action","customStyleForm","group","hud","listGroup","settings","tabGroup","tagDialogGroup","tagDialogHud","tagDialogTopLevelGroup","DELIMITER","ACTION_TYPE","compendiumEntry","compendiumMacro","compendiumPlaylist","macro","COMPENDIUM_ACTION_TYPES","COMPENDIUM_PACK_TYPES","CSS_STYLE","foundryVTT","class","file","moduleId","name","primaryColor","secondaryColor","tertiaryColor","foundryVttLight","compact","dorakoUI","pathfinder","highContrast","custom","CUSTOM_STYLE","backgroundColor","cssProperty","type","String","default","buttonHeight","Number","buttonBackgroundColor","buttonBorderPrimaryColor","buttonBorderSecondaryColor","buttonTextColor","buttonHoverBorderPrimaryColor","buttonHoverBorderSecondaryColor","buttonHoverBackgroundColor","buttonHoverTextColor","buttonToggleActiveBackgroundColor","buttonToggleActiveBorderPrimaryColor","buttonToggleActiveBorderSecondaryColor","buttonToggleActiveTextColor","buttonToggleHoverBackgroundColor","buttonToggleHoverBorderPrimaryColor","buttonToggleHoverBorderSecondaryColor","buttonToggleHoverTextColor","textPrimaryColor","textSecondaryColor","textTertiaryColor","textHoverPrimaryColor","textHoverSecondaryColor","textHoverTertiaryColor","GROUP_TYPE","ITEM_MACRO_ICON","LAYOUT_SETTING","customLayout","hint","inputType","filePickerType","dtype","scope","userCustomLayout","exportLayout","label","icon","onClick","resetLayout","resetAllLayouts","SETTING","activeCssAsText","classes","variable","allow","alwaysShowHud","clickOpenCategory","customStyle","debug","direction","displayCharacterName","displayIcons","drag","enable","enableCustomization","grid","itemMacro","migrationVersion","reset","renderItemOnRightClick","rollHandler","scale","sortActions","startup","style","tooltips","Logger","info","message","notify","ui","notifications","console","log","error","data","game","tokenActionHud","debugSetting","Utils","getSetting","dataClone","deepClone","Timer","constructor","milliseconds","this","timer","start","abort","Promise","resolve","setTimeout","clearTimeout","checkAllow","userRole","allowSetting","original","options","foundry","utils","getActor","actorId","tokenId","token","canvas","tokens","placeables","find","id","actor","actors","get","getStatusEffect","statusId","isNewerVersion","version","effects","effect","statuses","every","status","flags","core","getImage","entity","defaultImages","push","result","displayIconsSetting","img","includes","getItem","itemId","items","getToken","getControlledTokens","controlled","getFirstControlledToken","controlledToken","character","user","key","defaultValue","value","setSetting","set","getActorFlag","getFlag","setActorFlag","setFlag","unsetActorFlag","unsetFlag","getUserFlag","setUserFlag","unsetUserFlag","i18n","toTranslate","localize","isGmActive","users","some","isGM","active","isModuleActive","module","modules","getModuleTitle","title","getModuleVersion","humanizeBinding","binding","keybindings","modifiers","reduce","parts","part","KeyboardManager","MODIFIER_CODES","unshift","getKeycodeDisplayString","join","median","numbers","mid","Math","floor","length","nums","sort","a","b","getUpperQuartileAverage","sortedNumbers","slice","endIndex","sum","count","i","ceil","getModifier","sortItems","Map","entries","localeCompare","sortItemsByName","switchCSS","Object","href","values","document","styleSheets","ss","disabled","setting","querySelector","setProperty","tahElement","classList","remove","add","registerHandlebars","Handlebars","registerHelper","string","toUpperCase","tokenActionHudCoreTrue","args","reducer","Array","from","pop","first","shift","reduceOp","arguments","block","activeCssAsTextSetting","fn","inverse","getModuleVersionParts","moduleVersion","trigger","moduleVersionParts","split","major","minor","patch","checkModuleCompatibility","requiredCoreModuleVersion","requiredCoreModuleVersionParts","coreModuleVersionParts","getSubcategories","subcategories","order","subcategoryId","subcategoryType","isArray","foundSubcategories","subcategory","level","nestId","assign","keys","getNestedGroups","groups","groupId","groupType","foundGroups","getGroupByNestId","async","findGroup","groupStyle","foundGroup","deleteGroupByNestId","index","splice","deleteGroupsById","getFileParts","filename","folder","isPersistentStorage","ForgeVTT","DataHandler","init","path","getPath","private","isPrivate","fileMap","getFilePathsAsGm","createDirectories","DATA_FOLDER","moduleDirectory","directoriesToCreate","world","directory","FilePicker","browse","catch","_","createDirectory","dataHandler","hasPermission","files","getFilePaths","socket","executeAsGM","map","actorFiles","userFiles","all","canSaveData","saveDataAsGm","saveData","fileName","encodeURI","File","JSON","stringify","response","upload","has","canGetData","getDataAsGm","getData","foundFile","endsWith","ms","Date","now","fetch","ok","json","saveDataMigrate","folderPath","getDataMigrate","foundFilePath","then","GenericActionHandler","actionHandler","buildGenericActions","buildUtilities","buildSingleTokenUtilities","buildMultipleTokenUtilities","actionsData","actionType","toggleCombatId","toggleCombatName","inCombat","toggleCombatEncodedValue","toggleCombatAction","encodedValue","toggleVisibilityId","toggleVisibilityName","hidden","toggleVisbilityEncodedValue","toggleVisibilityAction","groupData","addActions","toggleVisibilityname","CompendiumActionHandler","compendiumActions","packIds","buildCompendiumActions","size","packs","filter","pack","documentName","visible","metadata","packId","setCompendiumActions","getIndex","getCompendiumActionType","entry","_id","listName","getGroupId","replace","isLinkedCompendium","MacroActionHandler","macroActions","buildMacroActions","getActions","macros","permissions","ownership","userId","ActionHandler","characterName","actionHandlerExtenders","delimiter","genericActionHandler","compendiumActionHandler","macroActionHandler","defaultGroups","defaultLayout","actorGroups","userGroups","actions","availableActionsMap","customLayoutSetting","userCustomLayoutFlag","enableCustomizationSetting","displayCharacterNameSetting","sortActionsSetting","tooltipsSetting","softResetActionHandler","hardResetActionHandler","registerDefaultCategories","buildHud","previousActor","isSameActor","getDefaultGroups","getDefaultLayout","getCustomLayout","isGmInactiveUserNotified","getSavedUserGroups","getSavedActorGroups","prepareHud","buildSystemActions","buildExtendedActions","updateNonPresetActions","setHasActions","setCharacterLimit","saveGroups","getUserGroups","userGroup","createGroup","parentNestId","parentGroup","tabs","lists","getActorGroups","actorGroup","existingGroup","selected","groupIds","extender","extendActionHandler","nonPresetActions","isPreset","nonPresetAction","availableAction","systemSelected","userSelected","createAction","hasActions","defaults","defaultGroup","layout","saveDataToFile","savedUserData","getGroup","getGroups","startsWith","getGroupSettings","saveGroupSettings","saveActor","saveUser","keepData","groupDataClone","tooltip","getTooltip","defaultSettings","showTitle","groupSettings","subtitleClass","groupSystem","system","commonProps","cssClass","info1","info2","info3","isSelected","defaultSelected","updateGroups","groupsData","parentGroupData","childGroupData","existingGroups","existingParentGroup","saveActorGroups","saveUserGroups","getReducedGroupData","keepActions","actionData","fullName","infoProps","text","icons","icon1","icon2","icon3","isAction","isItem","isitem","useRawHtmlName","updateActions","reorderedActions","existingAction","actionClone","addToAvailableActions","actionsMap","forEach","actionId","getAvailableActions","toActionTagifyEntry","getSelectedActions","getSelectedGroups","toGroupTagifyEntry","getAvailableGroups","getDerivedGroups","getSystemGroups","getCompendiumGroups","getMacroGroups","derivedGroups","addGroup","update","parentGroups","updateGroup","updateExistingGroups","removeGroup","addGroupInfo","groupInfo","existingActions","existingActionId","topLevelGroups","topLevelGroup","topLevelGroupCharacterCount","characterCount","groupCharacterCount","word","addActionHandlerExtender","actionHandlerExtender","addFurtherActionHandler","handler","globalThis","logger","warn","ActionHandlerExtender","extendActionList","MigrationManager","isSuccess","unsetOldFlags","migrateFiles","objects","children","scene","scenes","err","RollHandler","preRollHandlers","throwInvalidValueErr","Error","handleActionClickCore","event","registerKeyPresses","handled","prehandleActionEvent","isGenericAction","handleGenericActionClick","handleActionClick","toString","doHandleActionEvent","handleActionHoverCore","handleActionHover","handleGroupClickCore","handleGroupClick","addPreRollHandler","rightClick","isRightClick","ctrl","isCtrl","alt","isAlt","isShift","renderItem","item","sheet","render","isRenderItem","originalEvent","button","isModiferActive","keyboard","isModifierActive","MODIFIER_KEYS","ALT","altKey","emulateKeypress","force","downKeys","CONTROL","ctrlKey","SHIFT","shiftKey","firstControlledToken","toggleVisibility","toggleCombat","Hooks","callAll","doRenderItem","PreRollHandler","CustomStyleForm","FormApplication","defaultOptions","mergeObject","super","template","width","height","popOut","resizable","closeOnSubmit","activateListeners","html","on","_reset","bind","ColorPicker","install","_updateObject","formData","isCustom","TahSettingsForm","Function","isButton","isCheckbox","isFilePicker","isNumber","isRange","range","isSelect","undefined","choices","close","updateSettings","TahSettingsFormLayout","onChangeFunction","register","editable","onDown","toggleHud","registerSettingsCore","systemManager","rollHandlers","styles","registerMenu","restricted","config","Boolean","styleChoices","fromEntries","onChange","auto","up","down","min","max","step","always","whenUnlocked","never","requiresReload","full","nameOnly","none","setTooltipDelay","both","registerCustomStyleSettings","registerSettings","doRegisterSettings","ItemMacroActionHandlerExtender","itemacro","command","itemIds","isUnsupportedByMidiQoL","itemMacroSetting","groupKey","addGroupActions","existingItemMacroAction","actionToReplace","macroAction","createItemMacroAction","substr","indexOf","itemMacroIcon","findIndex","CompendiumMacroPreHandler","payload","handleCompendium","handleMacroCompendium","handlePlaylistCompendium","handleMacro","compendiumKey","getDocument","execute","actionPayload","playlistId","soundId","sound","sounds","AudioHelper","play","src","ItemMacroPreRollHandler","tryExecuteItemMacro","executeMacro","e","SystemManager","coreModuleId","getActionHandler","getRollHandler","rollHandlerId","getAvailableRollHandlers","registerDefaults","registerDefaultsCore","func","doRegisterDefaultFlags","registerStylesCore","systemStyles","registerStyles","getActionHandlerCore","doGetActionHandler","addActionHandlerExtenders","getRollHandlerCore","doGetRollHandler","addPreHandlers","addHandler","s","t","r","window","MutationObserver","WebKitMutationObserver","nodeType","observe","childList","subtree","addEventListener","parentElm","uid","selector","callbacks","setup","bindEvents","prototype","namespace","childNodes","parentNode","removeChild","matches","draggable","gap","getItemsGap","firstElementChild","throttle","call","getDraggableElm","closest","dragstart","source","getInitialState","target","getBoundingClientRect","elm","idx","getNodeIndex","dataTransfer","effectAllowed","dragStart","afterDragStart","mode","dragover","preventDefault","stopPropagation","hoverDirection","dropEffect","getTargetDirection","directionAwareDragEnter","dragenter","isValidElm","bounding","cleanupLastTarget","abs","toggle","dragend","dragoverTimeout","cleanup","nextElementSibling","insertBefore","dragEnd","isTargetLastChild","lastElementChild","pageY","top","pageX","left","previousSibling","test","removeAttribute","getComputedStyle","parseInt","listeners","destroy","DragSort","amd","exports","getOwnPropertySymbols","getOwnPropertyDescriptor","enumerable","apply","getOwnPropertyDescriptors","defineProperties","defineProperty","Symbol","toPrimitive","TypeError","configurable","writable","trim","toLowerCase","n","o","createElement","innerHTML","innerText","DOMParser","parseFromString","body","l","d","h","g","hasOwnProperty","p","c","normalize","u","navigator","userAgent","m","crypto","getRandomValues","Uint8Array","v","contains","classNames","tag","f","getSelection","getRangeAt","createTextNode","deleteContents","insertNode","T","__tagifyTagData","w","delimiters","pattern","tagTextProp","maxTags","addTagOnBlur","onChangeAfterBlur","duplicates","whitelist","blacklist","enforceWhitelist","userInput","keepInvalidTags","createInvalidTags","mixTagsAllowedAfter","mixTagsInterpolator","backspace","skipInvalid","pasteAsTags","editTags","clicks","keepInvalid","transformTag","a11y","focusableTags","mixMode","insertAfterTag","autoComplete","enabled","rightKey","selectMode","input","focus","tagNoAnimation","tagInvalid","tagNotAllowed","scopeLoading","hasMaxTags","hasNoTags","empty","inputInvalid","dropdown","dropdownWrapper","dropdownHeader","dropdownFooter","dropdownItem","dropdownItemActive","dropdownItemHidden","dropdownInital","tagText","tagX","tagLoading","tagEditing","tagFlash","tagHide","classname","maxItems","searchKeys","fuzzySearch","caseSensitive","accentedSearch","includeSelectedTags","highlightFirst","closeOnSelect","clearOnSelect","position","appendTarget","hooks","beforeRemoveTag","beforePaste","suggestionClick","_dropdown","refs","y","DOM","parseTemplate","content","getHeaderRef","getFooterRef","getAllSuggestionsRefs","querySelectorAll","dropdownItemSelector","show","state","inputText","templates","dropdownItemNoMatch","isLoading","readonly","dropdownHide__bindEventsTimeout","suggestedListItems","filterListItems","editing","autocomplete","suggest","hide","fill","highlightOption","events","query","setStateSelection","removeEventListener","setAttribute","ddItemData","ddItemElm","selection","flaggedTags","baseOffset","cloneNode","cssText","appendChild","clientHeight","createListHTML","dropdownContent","fillHeaderFooter","replaceChild","refilter","placeAbove","pageYOffset","scrollTop","fullscreenElement","webkitFullscreenElement","documentElement","clientWidth","innerWidth","rangeCount","startContainer","startOffset","createRange","setStart","setEnd","right","bottom","offsetLeft","offsetTop","pageXOffset","onKeyDown","onMouseOver","onMouseLeave","onScroll","hasFocus","composing","dropdownItemActiveSelector","getSuggestionDataByNode","getNextOrPrevOption","ArrowLeft","getMappedValue","tagify","tagData","suggestionElm","selectOption","addTags","raw","charCodeAt","removeTags","editTag","scrollHeight","percentage","round","getAttribute","onEditTagDone","__isValid","normalizeTags","toggleFocusClass","once","selectAll","suggestions","isTagDuplicate","exact","sortby","concat","mapValueTo","mappedValue","x","O","D","exceed","duplicate","notAllowed","M","wrapper","className","required","placeholder","getAttributes","I","customBinding","customEventsList","mainEvents","main","bindGlobal","isJQueryPlugin","jQuery","originalInput","removeAllTags","onFocusBlur","keydown","onKeydown","click","onClickScope","dblclick","onDoubleClickScope","paste","onPaste","drop","onDrop","compositionstart","onCompositionStart","compositionend","onCompositionEnd","clearInterval","originalInputValueObserverInterval","setInterval","observeOriginalInputValue","inputMutationObserver","onInputDOMChange","disconnect","global","isIE","cb","onWindowKeyDown","onClickAnywhere","unbindGlobal","textContent","relatedTarget","addNew","postUpdate","triggerChangeEvent","loading","activeElement","hasAttribute","anchorOffset","anchorNode","getTagElms","previousElementSibling","Element","placeCaretAfterNode","nodeName","nodeValue","blur","inputSuggestion","onInput","onMixTagsInput","inputElm","validateTag","toggleScopeValidation","isValid","search","createDocumentFragment","createTagElem","setRangeAtStartEnd","lastChild","withoutChangeEvent","cloneRange","collapse","focusNode","endOffset","match","lastIndexOf","prefix","matchedPatternCount","onInputIE","tagifyValue","loadOriginalValues","fixFirefoxLastTagNoCaret","clipboardData","pastedText","injectAtCaret","onEditTagInput","__tagId","editTagChangeDetected","originalIsValid","newValue","onEditTagPaste","onEditTagFocus","onEditTagBlur","__originalData","onEditTagkeydown","__originalHTML","addedNodes","outerHTML","replaceWith","tagSelector","nextSibling","removedNodes","N","Proxy","__tagify","off","cloneData","triggerHandler","cloneEvent","HTMLElement","CustomEvent","detail","dispatchEvent","isFirefox","documentMode","getPersistedData","localStorage","parse","setPersistedData","setItem","Event","clearPersistedData","removeItem","applySettings","build","getCSSVars","autofocus","getSetTagData","helpers","sameStr","removeCollectionProp","omit","isObject","parseHTML","escapeHTML","extend","concatWithoutDups","getUID","isNodeTag","dataProps","generateClassSelectors","RegExp","_delimiters","TEXTS","texts","getCustomAttributes","CSSVars","tagHideTransition","unit","getPropertyValue","integrated","originalInput_tabIndex","tabIndex","inputSelector","blockChangeEvent","parseMixTags","tagName","insertAdjacentHTML","lastOriginalValueReported","toggleClass","bubbles","simulated","_valueTracker","setValue","random","setStartAfter","removeAllRanges","addRange","getTagTextNode","tagTextSelector","setTagTextNode","getLastTag","skipValidation","editTagToggleValidity","removeTagsFromValue","previousData","replaceTag","reCheckInvalidTags","getInvalidTagAttrs","updateValueByDOMTags","appendMixTags","validate","charAt","substring","replaceTextWithNode","getTagIdx","getTagIndexByValue","getTagElmByValue","flashTag","isTagBlacklisted","isTagWhitelisted","getWhitelistItem","setReadonly","setContentEditable","contentEditable","setDisabled","splitText","selectTag","appendTag","addEmptyTag","addMixTags","__preInvalidData","prefixedTextToTag","createNodeIterator","NodeFilter","SHOW_TEXT","nextNode","node","__removed","parseFloat","clientTop","removeTagsFromDOM","setOriginalInputValue","debouncedUpdateTimeout","getInputValue","getCleanValue","getMixedTagsAsString","originalInputValueFormat","removeTag","TagDialog","dragSort","submit","categoryId","resetActions","showDialog","dialogType","tags","dialogData","dialogSubmit","_prepareHook","dialog","TagDialogHud","TagDialogTopLevelGroup","TagDialogGroup","app","$tagFilter","tagifyOptions","Infinity","onDragEnd","available","Tagify","dropdownLabelElement","setPosition","Dialog","buttons","yes","callback","resetActorData","no","_onKeyDown","defaultChoice","slugify","replacement","strict","navSelector","contentSelector","initial","TagDialogHelper","showHudDialog","topLabel","showGroupDialog","choice","customWidth","image","showActionDialog","availableActions","availableSubcategories","selectedActions","selectedGroups","GroupResizer","minCols","isCustomWidth","spacing","resizeGroup","groupElement","autoDirection","gridModuleSetting","resetVariables","getGroupsElement","groupsElement","actionsElements","resetGroupsElements","dataset","availableWidth","getAvailableWidth","getGroupElements","hasGrid","groupElements","actionsElement","groupCustomWidth","getGridWidth","resizeGrid","resize","setHeight","availableHeight","gridWidth","groupsElementPadding","groupsElementRect","groupsElements","resetCSS","maxHeight","overflowY","display","gridTemplateColumns","actionWidths","actionWidthsForMedian","actionElements","actionElement","actionRect","actionWidth","actionButtonText","actionButtonTextRect","actionButtonTextWidth","upperQuartileAverage","availableactionButtonTextWidth","assignCSS","squaredCols","sqrt","availableGroupWidth","availableCols","sqrtActions","currentRow","maxRowWidth","rowWidth","maxWidth","windowWidth","screenDimensions","contentLeft","uiRightClientWidth","getAvailableHeight","windowHeight","innerHeight","contentBottom","contentTop","uiTopBottomOffsetHeight","offsetHeight","groupsElementComputed","paddingLeft","paddingRight","requestAnimationFrame","element","elements","TokenActionHud","Application","hoveredGroups","defaultHeight","defaultWidth","defaultLeftPos","defaultTopPos","leftPos","topPos","defaultScale","refreshTimeout","rendering","isUpdatePending","isUpdating","updatePendingTimer","updateTimer","directionSetting","alwaysShowSetting","clickOpenCategorySetting","isCollapsed","dragSetting","enableSetting","isHudEnabled","gridSetting","isUnlocked","styleSetting","scaleSetting","getHudEnabled","hudPosition","updateSettingsPending","updateRollHandler","background","minimizable","dragDrop","scrollY","zIndex","isDraggable","getScale","editHudButton","listGroups","subtitle","groupButton","collapseHudButton","expandHudButton","unlockButton","lockButton","bindGroupEvents","bindActionEvents","bindEditHudButton","bindLockUnlockButtons","bindCollapseExpandButtons","postRender","closeGroup","currentTarget","parentElement","closestGroupElement","sibling","clearHoveredGroup","openGroup","setHoveredGroup","toggleGroup","bringToTop","passive","hover","dragEvent","actionClick","actionHover","groupClick","openGroupDialog","outerText","openActionDialog","collapseExpandGroup","collapseIcon","expandIcon","imageElement","toggleGroupVisibility","unlockHud","$","addClass","removeClass","lockHud","topGroupElement","getElementsByClassName","listGroupsElement","subtitleElement","collapseHud","getElementById","clientX","changedTouches","clientY","pos1","pos2","pos3","pos4","originalElementTop","originalElementLeft","newElementTop","newElementLeft","mouseMoveEvent","mouseUpEvent","onmousemove","ontouchmove","onmouseup","ontouchend","getAutoDirection","setPositionFromFlag","restoreHoveredGroups","check","resetPosition","mouseenter","format","copy","fromUserId","toUserIds","copyUserData","fromGroup","resetDialog","customLayoutElement","userCustomLayoutElement","resetAllDialog","executeForEveryone","resetUserAndActorData","resetAllActorData","resetUserData","resetAllUserData","handleUpdate","performUpdate","waitForUpdateCompletion","maxWaitTime","previousActorId","controlledTokens","getCharacter","multipleTokens","windows","appId","isValidTokenChange","actorData","isRelevantToken","isSelectedActor","isValidActorOrItemUpdate","isValidCharacter","testUserPermission","role","sendHudToBottom","socketlib","registerModule","ActionListExtender","api","systemModule","socketlibModule","loadTemplates","migrationManager","handleHookEvent","hookData","hookName","activeEffect","parent","combatant","hasOwn","combat","change","diff","contextmenu","ev"],"mappings":"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","x_google_ignoreList":[18,19]}