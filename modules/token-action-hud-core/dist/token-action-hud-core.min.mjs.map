{"version":3,"file":"token-action-hud-core.min.mjs","sources":["../module/core/constants.mjs","../module/core/utils.mjs","../module/handlers/data-handler.mjs","../module/managers/migration-manager.mjs","../module/handlers/character-handler.mjs","../module/handlers/layout-handler.mjs","../module/handlers/tooltip-handler.mjs","../module/handlers/group-handler.mjs","../module/managers/hud-manager.mjs","../node_modules/@yaireo/dragsort/dist/dragsort.js","../node_modules/@yaireo/tagify/dist/tagify.esm.js","../module/applications/tagify-app.mjs","../module/applications/tagify-app-helper.mjs","../module/handlers/group-resizer.mjs","../module/applications/token-action-hud.mjs","../module/core/sockets.mjs","../module/handlers/action-handlers/generic-action-handler.mjs","../module/handlers/action-handlers/compendium-action-handler.mjs","../module/handlers/action-handlers/macro-action-handler.mjs","../module/handlers/action-handlers/action-handler.mjs","../module/handlers/action-handlers/action-handler-extender.mjs","../module/handlers/roll-handlers/roll-handler.mjs","../module/handlers/roll-handlers/pre-roll-handler.mjs","../module/handlers/roll-handlers/roll-handler-extender.mjs","../module/applications/custom-style-form.mjs","../module/dialogs/reset-layout.mjs","../module/dialogs/reset-all-layouts.mjs","../module/applications/settings-form.mjs","../module/core/settings.mjs","../module/handlers/action-handlers/item-macro-extender.mjs","../module/managers/system-manager.mjs","../module/main.mjs","../module/core/api.mjs"],"sourcesContent":["/**\n * Module-based constants\n */\nexport const MODULE = {\n  ID: \"token-action-hud-core\",\n  NAME: \"Token Action HUD\"\n};\n\n\n/* -------------------------------------------- */\n\n/**\n * Template directory\n */\nconst TEMPLATE_DIR = `modules/${MODULE.ID}/templates`;\n\n/* -------------------------------------------- */\n\n/**\n * Templates\n */\nexport const TEMPLATE = {\n  action: `${TEMPLATE_DIR}/action.hbs`,\n  customStyleForm: `${TEMPLATE_DIR}/custom-style-form.hbs`,\n  group: `${TEMPLATE_DIR}/group.hbs`,\n  hud: `${TEMPLATE_DIR}/hud.hbs`,\n  listSubgroup: `${TEMPLATE_DIR}/list-subgroup.hbs`,\n  settings: `${TEMPLATE_DIR}/settings.hbs`,\n  tabSubgroup: `${TEMPLATE_DIR}/tab-subgroup.hbs`,\n  tagifyAppHud: `${TEMPLATE_DIR}/tag-dialog-hud.hbs`,\n  tagifyAppGroup: `${TEMPLATE_DIR}/tag-dialog-group.hbs`,\n  tagifyAppSubgroup: `${TEMPLATE_DIR}/tag-dialog-subgroup.hbs`\n};\n\n/* -------------------------------------------- */\n\n/**\n * Delimiter character\n */\nexport const DELIMITER = \"|\";\n\n/* -------------------------------------------- */\n\n/**\n * Action types\n */\nexport const ACTION_TYPE = {\n  compendiumEntry: \"tokenActionHud.compendiumEntry\",\n  compendiumMacro: \"tokenActionHud.compendiumMacro\",\n  compendiumPlaylist: \"tokenActionHud.compendiumPlaylist\",\n  macro: \"tokenActionHud.macro\"\n};\n\n/* -------------------------------------------- */\n\n/**\n * Compendium action types\n */\nexport const COMPENDIUM_ACTION_TYPES = [\"compendiumEntry\", \"compendiumMacro\", \"compendiumPlaylist\", \"macro\"];\n\n/* -------------------------------------------- */\n\n/**\n * Compendium pack types\n */\nexport const COMPENDIUM_PACK_TYPES = [\"JournalEntry\", \"Macro\", \"RollTable\"];\n\n/* -------------------------------------------- */\n\n/**\n * CSS styles\n */\nexport const CSS_STYLE = {\n  foundryVTT: {\n    class: \"tah-style-foundry-vtt-dark\",\n    file: \"tah-foundry-vtt-dark\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Dark\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\"\n  },\n  foundryVttLight: {\n    class: \"tah-style-foundry-vtt-light\",\n    file: \"tah-foundry-vtt-light\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Light\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\"\n  },\n  compact: {\n    class: \"tah-style-foundry-vtt\",\n    file: \"tah-foundry-vtt-dark-compact\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Dark Compact\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\"\n  },\n  pathfinder: {\n    class: \"tah-style-pathfinder\",\n    file: \"tah-pathfinder\",\n    moduleId: MODULE.ID,\n    name: \"Pathfinder\"\n  },\n  highContrast: {\n    class: \"tah-style-high-contrast\",\n    file: \"tah-high-contrast\",\n    moduleId: MODULE.ID,\n    name: \"High Contrast\",\n    primaryColor: \"#ffff00\",\n    secondaryColor: \"#ffff00\",\n    tertiaryColor: \"#0C7BDC\"\n  },\n  custom: {\n    class: \"tah-style-custom\",\n    file: \"tah-custom\",\n    moduleId: MODULE.ID,\n    name: \"Custom\"\n  },\n  dockedLeft: {\n    class: \"tah-style-docked-left\",\n    file: \"tah-docked-left\",\n    moduleId: MODULE.ID,\n    name: \"Docked Left\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\",\n    isDocked: true\n  },\n  dockedCenterRight: {\n    class: \"tah-style-docked-right\",\n    file: \"tah-docked-right\",\n    moduleId: MODULE.ID,\n    name: \"Docked Center-Right\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\",\n    collapseIcon: \"fa-caret-right\",\n    expandIcon: \"fa-caret-left\",\n    isDocked: true\n  },\n  dockedRight: {\n    class: \"tah-style-docked-right\",\n    file: \"tah-docked-right\",\n    moduleId: MODULE.ID,\n    name: \"Docked Right\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\",\n    collapseIcon: \"fa-caret-right\",\n    expandIcon: \"fa-caret-left\",\n    isDocked: true\n  }\n};\n\n/* -------------------------------------------- */\n\n/**\n * Custom styles\n */\nexport const CUSTOM_STYLE = {\n  backgroundColor: { cssProperty: \"--tah-background-color\", type: String, default: \"#00000000\" },\n  buttonHeight: { cssProperty: \"--tah-button-height-editable\", type: Number, default: 32 },\n  buttonBackgroundColor: { cssProperty: \"--tah-button-background-color-editable\", type: String, default: \"#000000b3\" },\n  buttonBorderPrimaryColor: { cssProperty: \"--tah-button-border-primary-color-editable\", type: String, default: \"#0C0C0CFF\" },\n  buttonBorderSecondaryColor: { cssProperty: \"--tah-button-border-secondary-color-editable\", type: String, default: \"#060606FF\" },\n  buttonTextColor: { cssProperty: \"--tah-button-text-color-editable\", type: String, default: \"#DDDDDDFF\" },\n  buttonHoverBorderPrimaryColor: { cssProperty: \"--tah-button-hover-border-primary-color-editable\", type: String, default: \"#FF6400FF\" },\n  buttonHoverBorderSecondaryColor: { cssProperty: \"--tah-button-hover-border-secondary-color-editable\", type: String, default: \"#FF0000FF\" },\n  buttonHoverBackgroundColor: { cssProperty: \"--tah-button-hover-background-color-editable\", type: String, default: \"#000000B3\" },\n  buttonHoverTextColor: { cssProperty: \"--tah-button-hover-text-color-editable\", type: String, default: \"#FFFFFFFF\" },\n  buttonToggleActiveBackgroundColor: { cssProperty: \"--tah-button-toggle-active-background-color-editable\", type: String, default: \"#3C0078BF\" },\n  buttonToggleActiveBorderPrimaryColor: { cssProperty: \"--tah-button-toggle-active-border-primary-color-editable\", type: String, default: \"#9B8DFFFF\" },\n  buttonToggleActiveBorderSecondaryColor: { cssProperty: \"--tah-button-toggle-active-border-secondary-color-editable\", type: String, default: \"#9B8DFFFF\" },\n  buttonToggleActiveTextColor: { cssProperty: \"--tah-button-toggle-active-text-color-editable\", type: String, default: \"#FFFFFFFF\" },\n  buttonToggleHoverBackgroundColor: { cssProperty: \"--tah-button-toggle-hover-background-color-editable\", type: String, default: \"#3C0078BF\" },\n  buttonToggleHoverBorderPrimaryColor: { cssProperty: \"--tah-button-toggle-hover-border-primary-color-editable\", type: String, default: \"#9B8DFFFF\" },\n  buttonToggleHoverBorderSecondaryColor: { cssProperty: \"--tah-button-toggle-hover-secondary-color-editable\", type: String, default: \"#9B8DFFFF\" },\n  buttonToggleHoverTextColor: { cssProperty: \"--tah-button-toggle-hover-text-color-editable\", type: String, default: \"#FFFFFFFF\" },\n  textPrimaryColor: { cssProperty: \"--tah-text-primary-color-editable\", type: String, default: \"#DDDDDDFF\" },\n  textSecondaryColor: { cssProperty: \"--tah-text-secondary-color-editable\", type: String, default: \"#DDDDDD80\" },\n  textTertiaryColor: { cssProperty: \"--tah-text-tertiary-color-editable\", type: String, default: \"#FF6400FF\" },\n  textHoverPrimaryColor: { cssProperty: \"--tah-text-hover-primary-color-editable\", type: String, default: \"#DDDDDDFF\" },\n  textHoverSecondaryColor: { cssProperty: \"--tah-text-hover-secondary-color-editable\", type: String, default: \"#DDDDDD80\" },\n  textHoverTertiaryColor: { cssProperty: \"--tah-text-tertiary-color-editable\", type: String, default: \"#FF6400FF\" }\n};\n\n/* -------------------------------------------- */\n\n/**\n * Group types\n */\nexport const GROUP_TYPE = {\n  COMPENDIUM: \"compendium\",\n  CUSTOM: \"custom\",\n  SYSTEM: \"system\",\n  SYSTEM_DERIVED: \"system-derived\"\n};\n\n/* -------------------------------------------- */\n\n/**\n * HUD\n */\nexport const HUD = {\n  defaultHeight: 200,\n  defaultWidth: 20,\n  defaultLeftPos: 150,\n  defaultTopPos: 80,\n  defaultScale: 1\n};\n\n/* -------------------------------------------- */\n\n/**\n * Item Macro icon\n */\nexport const ITEM_MACRO_ICON = {\n  ICON: \"fas fa-sd-card\",\n  TOOLTIP: \"Item Macro\"\n};\n\n/* -------------------------------------------- */\n\n/**\n * Layout settings\n */\nexport const LAYOUT_SETTING = {\n  customLayout: {\n    hint: \"tokenActionHud.settings.customLayout.hint\",\n    name: \"tokenActionHud.settings.customLayout.name\",\n    inputType: \"filePicker\",\n    filePickerType: \"json\",\n    dtype: \"String\",\n    scope: \"world\"\n  },\n  userCustomLayout: {\n    hint: \"tokenActionHud.settings.userCustomLayout.hint\",\n    name: \"tokenActionHud.settings.userCustomLayout.name\",\n    inputType: \"filePicker\",\n    filePickerType: \"json\",\n    dtype: \"String\",\n    scope: \"user\"\n  },\n  exportLayout: {\n    hint: \"tokenActionHud.settings.exportLayout.hint\",\n    label: \"tokenActionHud.settings.exportLayout.label\",\n    name: \"tokenActionHud.settings.exportLayout.name\",\n    inputType: \"button\",\n    icon: \"fa-solid fa-file-export\",\n    action: \"exportLayout\"\n  },\n  resetLayout: {\n    hint: \"tokenActionHud.settings.resetLayout.hint\",\n    label: \"tokenActionHud.settings.resetLayout.label\",\n    name: \"tokenActionHud.settings.resetLayout.name\",\n    inputType: \"button\",\n    icon: \"fa-solid fa-arrow-rotate-left\",\n    action: \"resetLayout\",\n    scope: \"client\"\n  },\n  resetAllLayouts: {\n    hint: \"tokenActionHud.settings.resetAllLayouts.hint\",\n    label: \"tokenActionHud.settings.resetAllLayouts.label\",\n    name: \"tokenActionHud.settings.resetAllLayouts.name\",\n    inputType: \"button\",\n    icon: \"fa-solid fa-bomb\",\n    action: \"resetAllLayouts\",\n    scope: \"world\"\n  }\n};\n\n/* -------------------------------------------- */\n\n/**\n * Settings\n */\nexport const SETTING = {\n  activeCssAsText: { classes: [\"TokenActionHud\"], variable: \"activeCssAsTextSetting\" },\n  allow: { classes: [\"TokenActionHud\"], variable: \"allowSetting\" },\n  alwaysShowHud: { classes: [\"TokenActionHud\"], variable: \"alwaysShowHudSetting\" },\n  backgroundColor: {},\n  buttonBackgroundColor: {},\n  buttonBorderPrimaryColor: {},\n  buttonBorderSecondaryColor: {},\n  buttonHeight: {},\n  buttonHoverBorderPrimaryColor: {},\n  buttonHoverBorderSecondaryColor: {},\n  buttonHoverBackgroundColor: {},\n  buttonHoverTextColor: {},\n  buttonTextColor: {},\n  buttonToggleActiveBackgroundColor: {},\n  buttonToggleActiveBorderPrimaryColor: {},\n  buttonToggleActiveBorderSecondaryColor: {},\n  buttonToggleActiveTextColor: {},\n  buttonToggleHoverBackgroundColor: {},\n  buttonToggleHoverBorderPrimaryColor: {},\n  buttonToggleHoverBorderSecondaryColor: {},\n  buttonToggleHoverTextColor: {},\n  clickOpenCategory: { classes: [\"TokenActionHud\"], variable: \"clickOpenCategorySetting\" },\n  customLayout: { classes: [\"ActionHandler\"], variable: \"customLayoutSetting\" },\n  customStyle: {},\n  debug: { classes: [\"TokenActionHud\"], variable: \"debugSetting\" },\n  direction: { classes: [\"TokenActionHud\"], variable: \"directionSetting\" },\n  displayCharacterName: { classes: [\"TokenActionHud\"], variable: \"displayCharacterName\" },\n  displayIcons: { classes: [\"TokenActionHud\"], variable: \"displayIconsSetting\" },\n  drag: { classes: [\"TokenActionHud\"], variable: \"dragSetting\" },\n  enable: { classes: [\"TokenActionHud\"], variable: \"enableSetting\" },\n  enableCustomization: { classes: [\"ActionHandler\", \"TokenActionHud\"], variable: \"enableCustomizationSetting\" },\n  grid: { classes: [\"TokenActionHud\"], variable: \"gridSetting\" },\n  itemMacro: {},\n  migrationVersion: {},\n  reset: {},\n  renderItemOnRightClick: {},\n  rollHandler: { default: \"core\" },\n  scale: { classes: [\"TokenActionHud\"], variable: \"scaleSetting\" },\n  sortActions: { classes: [\"ActionHandler\"], variable: \"sortActionsSetting\" },\n  startup: {},\n  style: { classes: [\"TokenActionHud\"], variable: \"styleSetting\"},\n  tooltips: { classes: [\"ActionHandler\"], variable: \"tooltipsSetting\" },\n  textPrimaryColor: {},\n  textSecondaryColor: {},\n  textTertiaryColor: {},\n  textHoverPrimaryColor: {},\n  textHoverSecondaryColor: {},\n  textHoverTertiaryColor: {},\n  userCustomLayout: { classes: [\"ActionHandler\"], variable: \"userCustomLayoutFlag\" }\n};\n","import { CSS_STYLE, CUSTOM_STYLE, MODULE } from \"./constants.mjs\";\n\n/**\n * A class responsible for logging messages to the console.\n */\nexport class Logger {\n  /**\n   * Log an info message to the console. If 'notify' is true, also send a notification\n   * @param {string} message The message\n   * @param {boolean} notify Whether to send a notification\n   */\n  static info(message, notify = false) {\n    if (notify) ui.notifications.info(`Token Action HUD | ${message}`);\n    else console.log(`Token Action HUD Info | ${message}`);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Log an error message to the console. If 'notify' is true, also send a notification\n   * @param {string} message The message\n   * @param {boolean} notify Whether to send a notification\n   */\n  static error(message, notify = false) {\n    if (notify) ui.notifications.error(`Token Action HUD | ${message}`);\n    else console.error(`Token Action HUD Error | ${message}`);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Log a debug message and, optionally, data to the console\n   * @param {string} message   The message\n   * @param {object|null} data The data\n   */\n  static debug(message, data = null) {\n    const isDebug = (game.tokenActionHud) ? game.tokenActionHud.debugSetting : Utils.getSetting(\"debug\");\n    if (isDebug) {\n      if (!data) {\n        console.log(`Token Action HUD Debug | ${message}`);\n        return;\n      }\n      const dataClone = Utils.deepClone(data);\n      console.log(`Token Action HUD Debug | ${message}`, dataClone);\n    }\n  }\n}\n\n/* -------------------------------------------- */\n\n/**\n * A class responsible for setting and aborting timers.\n */\nexport class Timer {\n  constructor(milliseconds) {\n    this.milliseconds = milliseconds;\n    this.timer = null;\n  }\n\n  async start() {\n    if (this.timer) this.abort();\n    return new Promise(resolve => {\n      this.timer = setTimeout(() => { resolve(); }, this.milliseconds ?? 100);\n    });\n  }\n\n  async abort() {\n    clearTimeout(this.timer);\n    this.timer = null;\n  }\n}\n\n/* -------------------------------------------- */\n\n/**\n * A class of helper functions.\n */\nexport class Utils {\n  /**\n   * Whether the user is allowed to use the HUD\n   * @public\n   * @param {number} userRole     The user's role\n   * @param {number} allowSetting The 'allow' setting value\n   * @returns {boolean} Whether the user is allowed to use the HUD\n   */\n  static checkAllow(userRole, allowSetting) {\n    return userRole >= allowSetting;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Capitalize the first letter of every word\n   * @param {string} value The string\n   * @returns {string}     The capitalized string\n   */\n  static capitalize(value) {\n    return value.replace(\n      /\\w\\S*/g,\n      text => text.charAt(0).toUpperCase() + text.substring(1).toLowerCase()\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Foundry VTT's deepClone function wrapped here to avoid code error highlighting due to missing definition\n   * @public\n   * @param {object} original The original object\n   * @param {object} options  The options\n   * @returns {object}        The cloned object\n   */\n  static deepClone(original, options) {\n    // eslint-disable-next-line no-undef\n    return foundry.utils.deepClone(original, options);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actor from the token or actor\n   * @public\n   * @param {string} actorId The actor id\n   * @param {string} tokenId The token id\n   * @returns {object}       The actor\n   */\n  static getActor(actorId, tokenId) {\n    let token = null;\n    if (tokenId) token = canvas.tokens.placeables.find(token => token.id === tokenId);\n    if (token) return token.actor;\n    return game.actors.get(actorId);\n  }\n\n  /**\n   * Get closest group to the event target\n   * @param {object} event The event\n   * @returns {object}     The closest group element\n   */\n  static getClosestGroupElement(event) {\n    if (!event) return null;\n    return event.target.closest(\"[data-part=\\\"subgroup\\\"]\") || event.target.closest(\"[data-part=\\\"group\\\"]\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actors of controlled tokens\n   * @public\n   * @returns {Array} The actors\n   */\n  static getControlledActors() {\n    const tokens = game.canvas.tokens?.controlled ?? [];\n    return tokens.map(token => token.actor);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get status effect from actor based on the status ID\n   * @param {object} actor    The actor\n   * @param {string} statusId The status ID\n   * @returns {object}        The status effect\n   */\n  static getStatusEffect(actor, statusId) {\n    return actor.effects.find(effect => effect.statuses.every(status => status === statusId));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get image from the entity\n   * @public\n   * @param {object} entity       The entity, e.g., actor, item\n   * @param {Array} defaultImages Any default images to exclude\n   * @returns {string}            The image URL\n   */\n  static getImage(entity, defaultImages = []) {\n    defaultImages.push(\"icons/svg/mystery-man.svg\");\n    let result = \"\";\n    if (game.tokenActionHud.displayIconsSetting) {\n      result = (typeof entity === \"string\")\n        ? entity\n        : entity?.img ?? entity?.icon ?? \"\";\n    }\n    return !defaultImages.includes(result) ? result : \"\";\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get item from the actor\n   * @public\n   * @param {object} actor  The actor\n   * @param {string} itemId The item id\n   * @returns {object}      The item\n   */\n  static getItem(actor, itemId) {\n    return actor.items.get(itemId);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get token\n   * @public\n   * @param {string} tokenId The token id\n   * @returns {object}       The token\n   */\n  static getToken(tokenId) {\n    return canvas.tokens.placeables.find(token => token.id === tokenId);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get controlled tokens\n   * @public\n   * @returns {Array} The controlled tokens\n   */\n  static getControlledTokens() {\n    return game.canvas.tokens?.controlled ?? [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get first controlled tokens\n   * @public\n   * @returns {object|null} The first controlled token\n   */\n  static getFirstControlledToken() {\n    const controlledToken = game.canvas.tokens.controlled[0];\n    if (controlledToken) {\n      return controlledToken;\n    }\n\n    const character = game.user?.character;\n    if (character) {\n      return canvas.tokens.placeables.find(token => token.actor?.id === character.id);\n    }\n\n    return null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get setting value\n   * @public\n   * @param {string} key               The setting key\n   * @param {string=null} defaultValue The setting default value\n   * @returns {*}                      The setting value\n   */\n  static getSetting(key, defaultValue = null) {\n    let value = defaultValue ?? null;\n    try {\n      value = game.settings.get(MODULE.ID, key);\n    } catch{\n      Logger.debug(`Setting '${key}' not found`);\n    }\n    return value;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set setting value\n   * @public\n   * @param {string} key   The setting key\n   * @param {string} value The setting value\n   */\n  static async setSetting(key, value) {\n    if (game.settings.settings.get(`${MODULE.ID}.${key}`)) {\n      await game.settings.set(MODULE.ID, key, value);\n      Logger.debug(`Setting '${key}' set to '${value}'`);\n    } else if (key !== \"debug\") {\n      Logger.debug(`Setting '${key}' not found`);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get module actor flag\n   * @public\n   * @param {string} key The flag key\n   * @returns {*}        The flag value\n   */\n  static getActorFlag(key) {\n    return game.tokenActionHud.actor.getFlag(MODULE.ID, key);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set module actor flag\n   * @public\n   * @param {string} key The flag key\n   * @param {*} value    The flag value\n   */\n  static async setActorFlag(key, value) {\n    await game.tokenActionHud.actor.setFlag(MODULE.ID, key, value);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Unset module actor flag\n   * @public\n   * @param {string} key The flag key\n   */\n  static async unsetActorFlag(key) {\n    await game.tokenActionHud.actor.unsetFlag(MODULE.ID, key);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get module user flag\n   * @public\n   * @param {string} key The flag key\n   * @returns {*}        The flag value\n   */\n  static getUserFlag(key) {\n    return game.user.getFlag(MODULE.ID, key);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set module user flag\n   * @public\n   * @param {string} key The flag key\n   * @param {*} value    The flag value\n   */\n  static async setUserFlag(key, value) {\n    await game.user.setFlag(MODULE.ID, key, value);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Unset module user flag\n   * @public\n   * @param {string} key The flag key\n   */\n  static async unsetUserFlag(key) {\n    await game.user.unsetFlag(MODULE.ID, key);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Language translation\n   * @public\n   * @param {string} toTranslate The value to translate\n   * @returns {string}           The translated value\n   */\n  static i18n(toTranslate) {\n    return game.i18n.localize(toTranslate);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether a GM is active\n   * @public\n   * @returns {boolean} Whether a GM is active\n   */\n  static isGmActive() {\n    return game.users.some(user => user.isGM && user.active);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the given module is active\n   * @public\n   * @param {string} moduleId The module id\n   * @returns {boolean}       Whether the given module is active\n   */\n  static isModuleActive(moduleId) {\n    const module = game.modules.get(moduleId);\n    return module && module.active;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the given module's title\n   * @public\n   * @param {string} moduleId The module id\n   * @returns {string}        The module title\n   */\n  static getModuleTitle(moduleId) {\n    return game.modules.get(moduleId)?.title ?? \"\";\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the given module's version\n   * @public\n   * @param {string} moduleId The module id\n   * @returns {string}        The module version\n   */\n  static getModuleVersion(moduleId) {\n    return game.modules.get(moduleId)?.version ?? \"\";\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Humanize keybinding\n   * @param {object} key The keybinding key\n   * @returns {string}   The humanized keybinding\n   */\n  static humanizeBinding(key) {\n    const binding = game.keybindings.get(MODULE.ID, key);\n    if (!binding) return \"\";\n    const stringParts = binding[0].modifiers.reduce((parts, part) => {\n      if (KeyboardManager.MODIFIER_CODES[part]?.includes(binding[0].key)) return parts;\n      parts.unshift(KeyboardManager.getKeycodeDisplayString(part));\n      return parts;\n    }, [KeyboardManager.getKeycodeDisplayString(binding[0].key)]);\n    return stringParts.join(\" + \");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the median\n   * @public\n   * @param {Array} numbers The array of numbers\n   * @returns {number}      The median\n   */\n  static median(numbers) {\n    const mid = Math.floor(numbers.length / 2);\n    const nums = [...numbers].sort((a, b) => a - b);\n    return numbers.length % 2 !== 0 ? nums[mid] : (nums[mid - 1] + nums[mid]) / 2;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get upper quartile average\n   * @param {Array} numbers The numbers\n   * @returns {number}      The upper quartile average\n   */\n  static getUpperQuartileAverage(numbers) {\n    const sortedNumbers = numbers.slice().sort((a, b) => a - b);\n    const length = sortedNumbers.length;\n    const startIndex = Math.ceil(length * 0.75);\n    const endIndex = length - 1;\n\n    let sum = 0;\n    let count = 0;\n\n    for (let i = startIndex; i <= endIndex; i++) {\n      sum += sortedNumbers[i];\n      count++;\n    }\n\n    const upperQuartileAverage = sum / count;\n\n    return upperQuartileAverage;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get modifier (e.g., +5) from number\n   * @param {number} num The number\n   * @returns {string}   The modifier\n   */\n  static getModifier(num) {\n    if (!num && num !== 0) return \"\";\n    const sign = (num >= 0) ? \"+\" : \"\";\n    return `${sign}${num}`;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Sort items\n   * @public\n   * @param {object} items The items\n   * @returns {object}     The sorted items\n   */\n  static sortItems(items) {\n    return new Map([...items.entries()].sort((a, b) => a[1].sort.localeCompare(b[1].sort)));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Sort items by name\n   * @public\n   * @param {object} items The items\n   * @returns {object}     The sorted items\n   */\n  static sortItemsByName(items) {\n    return new Map([...items.entries()].sort((a, b) => a[1].name.localeCompare(b[1].name)));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Enable stylesheet based on setting and disable all other stylesheets\n   * @public\n   * @param {string} style The 'style' setting value\n   */\n  static switchCSS(style) {\n    const { file, moduleId } = CSS_STYLE[style];\n\n    for (const [key, value] of Object.entries(CSS_STYLE)) {\n      const href = [`modules/${value.moduleId}/`, `${value.file}`];\n      const stylesheet = Object.values(document.styleSheets).find(\n        ss => ss.href?.includes(href[0]) && ss.href?.includes(href[1])\n      );\n\n      if (key === style) {\n        stylesheet.disabled = false;\n      } else if (moduleId !== value.moduleId || file !== value.file) {\n        stylesheet.disabled = true;\n      }\n    }\n\n    if (style === \"custom\") {\n      for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n        const setting = Utils.getSetting(key);\n        if (setting) {\n          document.querySelector(\":root\").style.setProperty(value.cssProperty, setting);\n        }\n      }\n    }\n\n    const tahElement = document.querySelector(\"#token-action-hud\");\n    if (tahElement) {\n      tahElement.classList.remove(...tahElement.classList);\n      tahElement.classList.add(CSS_STYLE[style].class);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Register Handlebar helpers\n   * @public\n   */\n  static registerHandlebars() {\n    // Capitalise first character\n    Handlebars.registerHelper(\"tokenActionHudCoreCap\", function(string) {\n      if (!string || string.length < 1) return \"\";\n      return string[0].toUpperCase() + string.slice(1);\n    });\n    const reduceOp = function(args, reducer) {\n      args = Array.from(args);\n      args.pop(); // => options\n      const first = args.shift();\n      return args.reduce(reducer, first);\n    };\n\n    // Support operators\n    Handlebars.registerHelper({\n      tokenActionHudCoreTrue: function() { return reduceOp(arguments, a => a); }\n    });\n\n    // Add asterisk to toggleable actions\n    Handlebars.registerHelper(\"tokenActionHudCoreActiveText\", function(block) {\n      if (game.tokenActionHud.activeCssAsTextSetting) {\n        return block.fn(this);\n      }\n      return block.inverse(this);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the major, minor and patch parts of the module version\n   * @public\n   * @param {string} moduleVersion The module version\n   * @returns {object|null}        The module version parts\n   */\n  static getModuleVersionParts(moduleVersion) {\n    if (!moduleVersion) {\n      Logger.debug(\"Module version not retrieved\", { trigger: \"getModuleVersionParts\" });\n      return null;\n    }\n    const moduleVersionParts = moduleVersion.split(\".\");\n    return {\n      major: moduleVersionParts[0],\n      minor: moduleVersionParts[1],\n      patch: moduleVersionParts[2]\n    };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the system module is compatible with the core module version\n   * @public\n   * @param {string} requiredCoreModuleVersion The required core module version\n   * @returns {boolean}                        Whether the system module is compatible with the core module version\n   */\n  static isSystemModuleCompatible(requiredCoreModuleVersion) {\n    if (!requiredCoreModuleVersion) return true;\n\n    // Get core module version in parts\n    const requiredCoreModuleVersionParts = this.getModuleVersionParts(requiredCoreModuleVersion);\n    const coreModuleVersionParts = this.getModuleVersionParts(game.modules.get(MODULE.ID).version);\n\n    if (coreModuleVersionParts.major !== requiredCoreModuleVersionParts.major\n      || coreModuleVersionParts.minor !== requiredCoreModuleVersionParts.minor\n      || (requiredCoreModuleVersionParts.patch && coreModuleVersionParts.patch !== requiredCoreModuleVersionParts.patch)\n    ) {\n      ui.notifications.error(\n        `The installed Token Action HUD system module requires Token Action HUD Core module version ${requiredCoreModuleVersion}. Install the required version to continue using Token Action HUD.`\n      );\n      return false;\n    }\n    return true;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get nested groups by criteria\n   * @public\n   * @param {object} groups The groups\n   * @param {object} data   The search data\n   * @returns {object|null} The nested groups\n   */\n  static getNestedGroups(groups, data = {}) {\n    let order = 0;\n    if (!groups) return null;\n    const groupId = data?.id;\n    const groupType = data?.type;\n    groups = (Array.isArray(groups)) ? groups : Object.values(groups);\n    const foundGroups = {};\n    for (const group of groups) {\n      if ((!groupId || group.id === groupId) && (!groupType || group.type === groupType)) {\n        order++;\n        const level = group.nestId.split(\"_\").length;\n        foundGroups[group.nestId] = { ...group, order, level };\n      }\n      if (group.groups?.length > 0) {\n        const groups = this.getNestedGroups(group.groups, data);\n        if (groups) Object.assign(foundGroups, groups);\n      }\n    }\n    return (Object.keys(foundGroups).length > 0) ? foundGroups : null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get group by nest ID\n   * @public\n   * @param {object} groups The groups\n   * @param {string} data   The search data\n   * @returns {object|null} The group\n   */\n  static async getGroupByNestId(groups, data = {}) {\n    const nestId = (typeof data === \"string\" ? data : data?.nestId);\n    const groupType = data?.type;\n    if (!nestId) return null;\n\n    const parts = nestId.split(\"_\");\n    return await findGroup(groups, parts);\n\n    /* -------------------------------------------- */\n\n    /**\n     * Find group\n     * @param {object} groups The groups\n     * @param {Array} parts   The nestId parts\n     * @returns {object}      The group\n     */\n    async function findGroup(groups, parts) {\n      groups = (Array.isArray(groups)) ? groups : Object.values(groups);\n      for (const group of groups) {\n        if (group.id === parts[0]) {\n          if (parts.length === 1) {\n            if (!group.type || !groupType || group.type === groupType) return group;\n            return;\n          }\n          parts.shift();\n          for (const groupStyle of Object.values(group.groups)) {\n            if (groupStyle.length === 0) continue;\n            const foundGroup = await findGroup(groupStyle, parts);\n            if (foundGroup) return foundGroup;\n          }\n        }\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Delete group by nest id\n   * @public\n   * @param {object} groups The groups\n   * @param {string} data   The search data\n   */\n  static async deleteGroupByNestId(groups, data = {}) {\n    const nestId = (typeof data === \"string\" ? data : data?.nestId);\n    if (!nestId) return;\n\n    const parts = nestId.split(\"_\");\n    await findAndDeleteGroup(groups, parts);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Find and delete a group\n   * @param {object} groups The groups\n   * @param {Array} parts   The nestId parts\n   */\n  static async findAndDeleteGroup(groups, parts) {\n    groups = (Array.isArray(groups)) ? groups : Object.values(groups);\n    for (const [index, group] of groups.entries()) {\n      if (group.id === parts[0]) {\n        if (parts.length === 1) {\n          groups.splice(index, 1);\n          return;\n        }\n        if (group.groups.length === 0) return;\n        parts.shift();\n        const foundGroup = await findAndDeleteGroup(group.groups, parts);\n        if (foundGroup) return;\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Delete groups by id\n   * @public\n   * @param {object} groups The groups\n   * @param {string} data   The search data\n   */\n  static async deleteGroupsById(groups, data = {}) {\n    const id = (typeof data === \"string\" ? data : data?.id);\n    if (!id) return;\n\n    for (let i = groups.length - 1; i >= 0; i--) {\n      if (groups[i].id === id) {\n        groups.splice(i, 1);\n      } else if (groups[i].groups?.length > 0) {\n        deleteGroupsById(groups[i].groups, data);\n      }\n    }\n  }\n}\n","import { MODULE } from \"../core/constants.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\n\n/* -------------------------------------------- */\n\n/**\n * A class responsible for handling data-related activities.\n */\nexport class DataHandler {\n  constructor(socket) {\n    this.socket = socket;\n  }\n\n  /**\n   * Initialise the data handler\n   */\n  async init() {\n    await this.#createDirectories();\n    await Promise.all([\n      this.private = await this.isPrivate(),\n      this.fileMap = await this.getFilePathsAsGm()\n    ]);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether persistent storage can be used\n   * @returns {boolean} Whether persistent storage can be used\n   */\n  get isPersistentStorage() {\n    return (foundry.utils.isNewerVersion(game.version, \"11.305\") && typeof ForgeVTT === \"undefined\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Create directories for storage of files\n   * @private\n   */\n  async #createDirectories() {\n    if (!game.user.isGM || !Utils.getSetting(\"enableCustomization\")) return;\n\n    const DATA_FOLDER = \"data\";\n    const moduleDirectory = (this.isPersistentStorage)\n      ? `modules/${MODULE.ID}/storage`\n      : MODULE.ID;\n\n    const directoriesToCreate = [\n      moduleDirectory,\n      `${moduleDirectory}/${game.world.id}`,\n      `${moduleDirectory}/${game.world.id}/actor`,\n      `${moduleDirectory}/${game.world.id}/user`\n    ];\n\n    for (const directory of directoriesToCreate) {\n      await FilePicker.browse(DATA_FOLDER, directory).catch(async _ => {\n        if (!(await FilePicker.createDirectory(DATA_FOLDER, directory, {}))) {\n          Logger.debug(`Failed to create directory: ${directory}`);\n        }\n      });\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get base path to the layout files\n   * @returns {string} The path\n   */\n  get path() {\n    return (this.isPersistentStorage)\n      ? `modules/${MODULE.ID}/storage/${game.world.id}/`\n      : `${MODULE.ID}/${game.world.id}/`;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get file parts\n   * @param {string} file The file\n   * @returns {object}    The file parts\n   */\n  getFileParts(file) {\n    const parts = file.split(\"/\");\n    const filename = parts.pop();\n    const folder = parts.join(\"/\");\n    const id = filename.split(\".\")[0];\n    return { folder, filename, id };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the module directory is set to private\n   * @returns {boolean} Whether the module directory is set to private\n   */\n  async isPrivate() {\n    if (game.user.isGM) return false;\n\n    if (game.user.hasPermission(\"FILES_BROWSE\")) {\n      try {\n        await FilePicker.browse(\"data\", this.path);\n        return false;\n      } catch{\n        return true;\n      }\n    }\n    return true;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get file paths as GM\n   * @returns {object} The file paths\n   */\n  async getFilePathsAsGm() {\n    if ((!game.user.hasPermission(\"FILES_BROWSE\") || this.private) && !Utils.isGmActive()) {\n      Logger.info(\"Cannot get file paths without a GM present\", true);\n      return new Map(); // Return an empty map if no permissions and no GM\n    }\n\n    const files = game.user.hasPermission(\"FILES_BROWSE\") && !this.private\n      ? await this.getFilePaths()\n      : await this.socket.executeAsGM(\"getFilePaths\");\n\n    return new Map(files.map(file => {\n      const { id } = this.getFileParts(file);\n      return [id, file];\n    }));\n  }\n\n  /**\n   * Get file paths using socket\n   * @returns {Array} The file paths\n   */\n  static async getFilePathsWithSocket() {\n    return await game.tokenActionHud?.dataHandler?.getFilePaths() ?? [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get file paths\n   * @returns {Array} The file paths\n   */\n  async getFilePaths() {\n    const [actorFiles, userFiles] = await Promise.all([\n      FilePicker.browse(\"data\", `${this.path}actor/`),\n      FilePicker.browse(\"data\", `${this.path}user/`)\n    ]);\n\n    return [...(actorFiles?.files ?? []), ...(userFiles?.files ?? [])];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the user can save data\n   * @returns {boolean} Whether the user can save data\n   */\n  get canSaveData() {\n    return ((game.user.hasPermission(\"FILES_UPLOAD\") && !this.private) || Utils.isGmActive());\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save data the GM\n   * @public\n   * @param {string} type The type: actor or user\n   * @param {string} id   The actor or user id\n   * @param {object} data The data\n   */\n  async saveDataAsGm(type, id, data) {\n    if (game.user.hasPermission(\"FILES_UPLOAD\") && !this.private) {\n      await this.saveData(type, id, data);\n    }\n\n    if (!Utils.isGmActive()) {\n      Logger.info(\"Cannot save data without a GM present\", true);\n      return;\n    }\n\n    await this.socket.executeAsGM(\"saveData\", type, id, data);\n  }\n\n  /* -------------------------------------------- */\n\n  static async saveDataWithSocket(type, id, data) {\n    game.tokenActionHud.dataHandler.saveData(type, id, data);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save data\n   * @param {string} type The type: actor or user\n   * @param {string} id   The actor or user id\n   * @param {object} data The data\n   */\n  async saveData(type, id, data) {\n    try {\n      // Get the folder path\n      const folder = `${this.path}${type}`;\n\n      // Generate the system-safe filename\n      const fileName = encodeURI(`${id}.json`);\n\n      // Create the file and contents\n      const file = new File([JSON.stringify(data, null, \"\")], fileName, { type: \"application/json\" });\n\n      // Upload the file\n      const response = await FilePicker.upload(\"data\", folder, file, {}, { notify: false });\n\n      if (response.path) {\n        if (!this.fileMap.has(id)) {\n          this.fileMap.set(id, response.path);\n        }\n      } else {\n        Logger.debug(`Failed to save data to: ${fileName}\\nReason: ${response.error || \"Unknown error\"}`);\n      }\n    } catch(error) {\n      Logger.error(`An error occurred while saving data for ${id}.json: ${error.message}`);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the user can get data\n   * @returns {boolean} Whether the user can get data\n   */\n  get canGetData() {\n    return ((game.user.hasPermission(\"FILES_BROWSE\") && !this.private) || Utils.isGmActive());\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get data as GM\n   * @public\n   * @param {object} options The options: file, type, id\n   * @returns {object}       The data\n   */\n  async getDataAsGm(options) {\n    try {\n      if ((!game.user.hasPermission(\"FILES_BROWSE\") || this.private) && !Utils.isGmActive()) {\n        Logger.info(\"Cannot get data without a GM present\", true);\n        return;\n      }\n\n      return (game.user.hasPermission(\"FILES_BROWSE\"))\n        ? await this.getData(options)\n        : await this.socket.executeAsGM(\"getData\", options);\n    } catch(error) {\n      Logger.error(`An error occurred while getting data: ${error.message}`);\n      return null;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  static async getDataWithSocket(options) {\n    game.tokenActionHud.dataHandler.getData(options);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get data\n   * @param {string} options The options: file, type, id\n   * @returns {object}       The data\n   */\n  async getData(options) {\n    const { id, file } = options;\n\n    // Check if the file is available in the fileMap\n    let foundFile = this.fileMap.get(id) ?? null;\n\n    // If not found, try to browse, otherwise return null\n    if (!foundFile) {\n      if (!file) return null;\n      const { folder, filename } = this.getFileParts(file);\n      const foundFolder = await FilePicker.browse(\"data\", folder);\n      foundFile = foundFolder.files.find(file => file.endsWith(filename));\n      if (!foundFile) return null;\n    }\n\n    try {\n      const ms = Date.now();\n      const response = await fetch(`${foundFile}?ms=${ms}`);\n\n      // Check if the fetch was successful\n      if (response.ok) {\n        return await response.json();\n      } else {\n        return null;\n      }\n    } catch(error) {\n      console.error(error);\n      return null;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get data\n   * @param {string} type The type: actor or user\n   * @param {string} id   The actor or user id\n   * @returns {object}    The data\n   */\n  async getDataMigrate(type, id) {\n    const folderPath = `${MODULE.ID}/${game.world.id}/${type}`;\n    const fileName = encodeURI(`${id}.json`);\n    try {\n      const foundFolderPath = await FilePicker.browse(\"data\", folderPath);\n      const foundFilePath = foundFolderPath.files.find(file => file.endsWith(fileName));\n      if (foundFilePath) {\n        const ms = Date.now();\n        return await fetch(`${foundFilePath}?ms=${ms}`)\n          .then(response => {\n            if (response.ok) {\n              return response.json();\n            } else {\n              return null;\n            }\n          })\n          .catch(error => {\n            console.error(error);\n          });\n      } else {\n        return null;\n      }\n    } catch{\n      return null;\n    }\n  }\n}\n","import { MODULE } from \"../core/constants.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\n\n/**\n * Manages migrations between module versions\n */\nexport class MigrationManager {\n  constructor(dataHandler, socket) {\n    this.dataHandler = dataHandler;\n    this.socket = socket;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Initialise migrations\n   * @public\n   */\n  async init() {\n    if (!game.user.isGM) return;\n\n    const moduleVersion = game.modules.get(MODULE.ID).version;\n    const migrationVersion = Utils.getSetting(\"migrationVersion\");\n    if (moduleVersion === migrationVersion) return;\n\n    let isSuccess = true;\n    isSuccess = (!migrationVersion || foundry.utils.isNewerVersion(\"1.4.10\", migrationVersion))\n      ? await this.#unsetOldFlags()\n      : true;\n    isSuccess = (this.dataHandler.isPersistentStorage && (!migrationVersion || foundry.utils.isNewerVersion(\"1.4.11\", migrationVersion)))\n      ? await this.#migrateFiles()\n      : true;\n\n    if (isSuccess) {\n      Utils.setSetting(\"migrationVersion\", moduleVersion);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Unset old flags\n   * @private\n   * @returns {boolean} Whether the old flags were unset\n   */\n  async #unsetOldFlags() {\n    try {\n      const users = game.users.filter(user => user.getFlag(MODULE.ID, \"categories\"));\n      for (const user of users) {\n        user.unsetFlag(MODULE.ID, \"categories\");\n        user.unsetFlag(MODULE.ID, \"defaults\");\n      }\n\n      const actors = game.actors.filter(actor => actor.getFlag(MODULE.ID, \"categories\"));\n      for (const actor of actors) {\n        actor.unsetFlag(MODULE.ID, \"categories\");\n      }\n\n      const tokens = game.canvas.tokens.objects.children.filter(token => token.actor?.getFlag(MODULE.ID, \"categories\"));\n      for (const token of tokens) {\n        token.actor?.unsetFlag(MODULE.ID, \"categories\");\n      }\n\n      for (const scene of game.scenes) {\n        const tokens = scene.tokens.filter(token => token.actor?.getFlag(MODULE.ID, \"categories\"));\n        for (const token of tokens) {\n          token.actor?.unsetFlag(MODULE.ID, \"categories\");\n        }\n      }\n\n      return true;\n    } catch(err) {\n      Logger.debug(err.message, err);\n\n      return false;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Migrate files to storage\n   * @returns {boolean} Whether the files were migrated to storage\n   */\n  async #migrateFiles() {\n    try {\n      Logger.info(\"Migrating files to persistent storage...\", true);\n      for (const user of game.users) {\n        const data = await this.dataHandler.getDataMigrate(\"user\", user.id);\n        if (data) {\n          await this.dataHandler.saveData(\"user\", user.id, data);\n        }\n      }\n\n      for (const actor of game.actors) {\n        const data = await this.dataHandler.getDataMigrate(\"actor\", actor.id);\n        if (data) {\n          await this.dataHandler.saveData(\"actor\", actor.id, data);\n        }\n      }\n      Logger.info(\"Successfully migrated files to persistent storage\", true);\n      return true;\n    } catch{\n      Logger.info(\"Failed to migrate files to persistent storage\", true);\n      return false;\n    }\n  }\n}\n","import { Utils } from \"../core/utils.mjs\";\n\nexport class CharacterHandler {\n  constructor(hudManager) {\n    this.hudManager = hudManager;\n    this.groupHandler = hudManager.groupHandler;\n    this.actionHandler = hudManager.actionHandler;\n    this.rollHandler = hudManager.rollHandler;\n  }\n\n  /**\n   * Initialise Character Handler\n   */\n  init() {\n    this.previousActorId = this.actor?.id;\n    this.setCharacter();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether there is a character\n   * @returns {boolean} Whether there is a character\n   */\n  get isCharacter() {\n    return this.actor || this.isMultipleTokens;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether there is multiple tokens\n   * @returns {boolean} Whether there is multiple tokens\n   */\n  get isMultipleTokens() {\n    const controlledTokens = Utils.getControlledTokens();\n    return controlledTokens.length > 1 && !this.actor;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the current actor is the same actor\n   * @returns {boolean} Whether the current actor is the same actor\n   */\n  get isSameActor() {\n    return this.previousActorId !== this.actor?.id;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set character based on controlled tokens\n   * @private\n   */\n  setCharacter() {\n    this.resetCharacter();\n    const controlledTokens = Utils.getControlledTokens();\n    if (controlledTokens.length > 1) {\n      this.#handleMultipleTokens(controlledTokens);\n    } else {\n      this.#handleSingleToken(controlledTokens);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset actor and token properties\n   */\n  resetCharacter() {\n    this.token = null;\n    this.actor = null;\n    this.tokens = [];\n    this.actors = [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle multiple controlled tokens\n   * @param {*} controlledTokens\n   */\n  #handleMultipleTokens(controlledTokens) {\n    this.characterName = game.i18n.localize(\"tokenActionHud.multiple\");\n\n    // Empty singulars\n    this.token = null;\n    this.actor = null;\n\n    // Set multiples\n    this.tokens = controlledTokens;\n    this.actors = Utils.getControlledActors();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle a single controlled token\n   * @private\n   * @param {Array} controlledTokens The controlled tokens\n   */\n  #handleSingleToken(controlledTokens) {\n    const character = { token: null, actor: null };\n\n    if (controlledTokens.length === 1 && this.#isValidCharacter(controlledTokens[0])) {\n      character.token = controlledTokens[0];\n      character.actor = character.token?.actor;\n    } else if (controlledTokens.length === 0 && game.user.character && Utils.getSetting(\"alwaysShowHud\")) {\n      character.actor = game.user.character;\n      character.token = canvas.tokens?.placeables.find(t => t.actor?.id === character.actor.id) ?? null;\n    }\n\n    if (!character.actor) return;\n\n    this.characterName = character.token?.name ?? character.actor.name;\n\n    // Set in this class\n    this.token = character.token;\n    this.actor = character.actor;\n    this.tokens = [character.token];\n    this.actors = [character.actor];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the character is a valid selection for the current user\n   * @private\n   * @param {object} [token = {}] The token\n   * @returns {boolean}           Whether the character is a valid selection for the current user\n   */\n  #isValidCharacter(token = {}) {\n    return game.user.isGM || token.actor?.testUserPermission(game.user, \"OWNER\");\n  }\n\n}\n","import { Utils } from \"../core/utils.mjs\";\n\n/**\n * Handler for the HUD layout.\n */\nexport class LayoutHandler {\n  constructor(systemManager, dataHandler) {\n    this.systemManager = systemManager;\n    this.dataHandler = dataHandler;\n    this.defaultLayout = null;\n    this.customLayout = null;\n  }\n\n  /**\n   * Initialise the HUD layout\n   */\n  async init() {\n    await Promise.all([\n      this.#setDefaultLayout(),\n      this.#setCustomLayout()\n    ]);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Soft reset variables\n   */\n  softReset() {\n    this.defaultLayout = null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Hard reset variables\n   */\n  hardReset() {\n    this.softReset();\n    this.customLayout = null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the default layout\n   * @private\n   */\n  async #setDefaultLayout() {\n    if (this.defaultLayout) return;\n    const defaultLayout = this.systemManager.defaults?.layout;\n    if (!defaultLayout) { this.defaultLayout = null; return; }\n    this.defaultLayout = await Utils.getNestedGroups(defaultLayout);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set custom layout\n   * @private\n   */\n  async #setCustomLayout() {\n    if (this.customLayout) return;\n    const file = Utils.getUserFlag(\"userCustomLayout\") || Utils.getSetting(\"customLayout\") || null;\n    this.customLayout = (file) ? await this.dataHandler.getDataAsGm({ file }) : null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Export layout to file\n   * @public\n   */\n  async exportLayout() {\n    const data = await this.dataHandler.getDataAsGm({ type: \"user\", id: game.userId }) ?? this.customLayout ?? this.defaultLayout;\n    if (data) {\n      saveDataToFile(JSON.stringify(data, null, 2), \"text/json\", \"token-action-hud-layout.json\");\n    }\n  }\n\n  /**\n   * Get the layout\n   * @returns {object} The layout\n   */\n  get layout() {\n    return this.customLayout ?? this.defaultLayout;\n  }\n}\n","import { Utils } from \"../core/utils.mjs\";\n\n\n/**\n * Get tooltip based on module setting\n * @param {object|string} tooltip The tooltip\n * @param {string} name           The name\n * @returns {object}              The tooltip\n */\nexport function getTooltip(tooltip, name) {\n  const setting = Utils.getSetting(\"tooltips\");\n\n  if (setting === \"none\") return null;\n  if (setting === \"nameOnly\" || !tooltip) return name;\n\n  if (typeof tooltip !== \"object\") {\n    tooltip = { content: tooltip };\n  }\n\n  if (!tooltip.content.includes(\"tah-tooltip-wrapper\")) {\n    tooltip.content = `<div class=\"tah-tooltip-wrapper\">${tooltip.content}</div>`;\n  }\n\n  return tooltip;\n}\n","import { COMPENDIUM_PACK_TYPES, GROUP_TYPE } from \"../core/constants.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\nimport { getTooltip } from \"../handlers/tooltip-handler.mjs\";\n\n/**\n * Handler for the HUD groups.\n */\nexport class GroupHandler {\n  constructor(hudManager, systemManager, dataHandler, layoutHandler) {\n    this.hudManager = hudManager;\n    this.systemManager = systemManager;\n    this.dataHandler = dataHandler;\n    this.layoutHandler = layoutHandler;\n    this.defaultGroups = {};\n    this.groups = {};\n    this.actorGroups = {};\n    this.userGroups = {};\n  }\n\n  get actor() {\n    return this.hudManager?.actor;\n  }\n\n  get actors() {\n    return this.hudManager?.actors;\n  }\n\n  get token() {\n    return this.hudManager?.token;\n  }\n\n  get tokens() {\n    return this.hudManager?.tokens;\n  }\n\n  /**\n   * Initialise the groups\n   */\n  async init() {\n    this.#setDefaultGroups();\n    await Promise.all([\n      this.#setSavedActorGroups(),\n      this.#setSavedUserGroups()\n    ]);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Soft reset variables\n   */\n  softReset() {\n    this.defaultGroups = {};\n    this.groups = {};\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Hard reset variables\n   */\n  hardReset() {\n    this.softReset();\n    this.actorGroups = {};\n    this.userGroups = {};\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the default groups\n   * @private\n   */\n  #setDefaultGroups() {\n    const defaultGroups = this.systemManager.defaults?.groups;\n    if (!defaultGroups) return;\n    for (const defaultGroup of defaultGroups) {\n      this.defaultGroups[defaultGroup.id] = defaultGroup;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the saved groups from the actor flag\n   * @private\n   */\n  async #setSavedActorGroups() {\n    if (!this.actor) return;\n\n    if (!Utils.getSetting(\"enableCustomization\")) {\n      this.actorGroups = {};\n      return;\n    }\n\n    if (this.isSameActor && Object.entries(this.actorGroups).length) return;\n\n    if (!this.dataHandler.canGetData) {\n      this.actorGroups = {};\n      return;\n    }\n\n    Logger.debug(\"Retrieving groups from actor...\", { actor: this.actor });\n    this.actorGroups = {};\n    const actorGroups = await this.dataHandler.getDataAsGm({ type: \"actor\", id: this.actor.id }) ?? null;\n    if (!actorGroups) return;\n    for (const group of Object.entries(actorGroups)) {\n      group[1].nestId = group[0];\n    }\n    this.actorGroups = actorGroups;\n    Logger.debug(\"Groups from actor retrieved\", { actorGroups: this.actorGroups, actor: this.actor });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the saved groups from the user flag\n   * @private\n   */\n  async #setSavedUserGroups() {\n    const user = game.user;\n    const layout = this.layoutHandler.layout;\n\n    const getUserGroups = data => {\n      const userGroups = Object.keys(data).length ? data : layout;\n      for (const group of Object.entries(userGroups)) {\n        group[1].nestId = group[0];\n      }\n      return userGroups;\n    };\n\n    if (!Utils.getSetting(\"enableCustomization\")) {\n      this.userGroups = getUserGroups(layout);\n      return;\n    }\n\n    if (Object.entries(this.userGroups).length) return;\n\n    if (!this.dataHandler.canGetData) {\n      this.userGroups = getUserGroups(layout);\n      return;\n    }\n\n    Logger.debug(\"Retrieving groups from user...\", { user });\n    this.userGroups = {};\n    const savedUserData = await this.dataHandler.getDataAsGm({ type: \"user\", id: user.id }) ?? {};\n    this.userGroups = getUserGroups(savedUserData);\n    Logger.debug(\"Groups retrieved from user\", { userGroups: this.userGroups, user });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare groups in the HUD.\n   * @param {object} hud The HUD\n   * @returns {object}   The prepared groups\n   */\n  async prepareGroups(hud) {\n    if (Object.keys(this.userGroups).length) {\n      const userGroups = this.getUserGroups();\n      for (const userGroup of userGroups) {\n        if (userGroup.level === 1) {\n          const group = this.createGroup(userGroup);\n          hud.groups.push(group);\n          this.groups[group.nestId] = group;\n        } else {\n          const parentNestId = userGroup.nestId.split(\"_\", userGroup.level - 1).join(\"_\");\n          const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId });\n          if (parentGroup) {\n            const group = this.createGroup(userGroup);\n            if (group.settings.style === \"tab\") {\n              parentGroup.groups.tabs.push(group);\n            } else {\n              parentGroup.groups.lists.push(group);\n            }\n            this.groups[group.nestId] = group;\n          }\n        }\n      }\n    }\n\n    if (Object.keys(this.actorGroups).length) {\n      const actorGroups = this.getActorGroups();\n\n      for (const actorGroup of actorGroups) {\n        const parentNestId = actorGroup.nestId.split(\"_\", actorGroup.level - 1).join(\"_\");\n        const existingGroup = await Utils.getGroupByNestId(hud.groups, { nestId: actorGroup.nestId });\n        if (existingGroup) {\n          if (actorGroup.actions?.length) {\n            existingGroup.actions = actorGroup.actions;\n          }\n        } else {\n          const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId });\n\n          if (parentGroup && actorGroup.type === \"system-derived\") {\n            const group = this.createGroup(actorGroup, true);\n            if (actorGroup.actions?.length) {\n              group.actions = actorGroup.actions;\n            }\n\n            if (group.settings.style === \"tab\") {\n              parentGroup.groups.tabs.push(group);\n            } else {\n              parentGroup.groups.lists.push(group);\n            }\n\n            this.groups[group.nestId] = group;\n          }\n        }\n      }\n    }\n\n    return this.groups;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get first matching group\n   * @public\n   * @param {object} [data = {}]   The group data\n   * @param {string} [data.nestId] The nested group ID\n   * @param {string} [data.id]     The group ID\n   * @param {number} [data.level]  The group level\n   * @param {string} [data.type]   The group type\n   * @returns {Array}              The group\n   */\n  getGroup({ nestId, id, level, type } = {}) {\n    if (nestId) return this.groups[nestId];\n\n    return Object.values(this.groups).find(group =>\n      (!id || group.id === id)\n      && (!level || group.level === level)\n      && (!type || group.type === type)\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get matching groups\n   * @public\n   * @param {object}  [data = {}]     The group data\n   * @param {string}  [data.nestId]   The nested group ID\n   * @param {string}  [data.id]       The group ID\n   * @param {number}  [data.level]    The group level\n   * @param {string}  [data.type]     The group type\n   * @param {boolean} [data.selected] Whether the group is selected\n   * @returns {Array}                 The matching groups\n   */\n  getGroups({ nestId, id, level, type, selected } = {}) {\n    return Object.values(this.groups).filter(group =>\n      (!nestId || group.nestId.startsWith(nestId))\n      && (!id || group.id === id)\n      && (!level || group.level === level)\n      && (!type || group.type === type)\n      && (!selected || group.selected === selected)\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get matching actor-related groups\n   * @public\n   * @param {object}  [data = {}]   The group data\n   * @param {string}  [data.nestId] The nested group ID\n   * @param {string}  [data.id]     The group ID\n   * @param {number}  [data.level]  The group level\n   * @param {string}  [data.type]   The group type\n   * @returns {Array}               The groups\n   */\n  getActorGroups({ nestId, id, level, type } = {}) {\n    return Object.values(this.actorGroups).filter(group =>\n      (!nestId || group.nestId.startsWith(nestId))\n      && (!id || group.id === id)\n      && (!level || group.level === level)\n      && (!type || group.type === type)\n    ).sort((a, b) => (a.level - b.level || a.order - b.order));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get matching user-related groups\n   * @public\n   * @param {object}  [data = {}]   The group data\n   * @param {string}  [data.nestId] The nested group ID\n   * @param {string}  [data.id]     The group ID\n   * @param {number}  [data.level]  The group level\n   * @param {string}  [data.type]   The group type\n   * @returns {Array}               The groups\n   */\n  getUserGroups({ nestId, id, level, type } = {}) {\n    return Object.values(this.userGroups).filter(group =>\n      (!nestId || group.nestId.startsWith(nestId))\n      && (!id || group.id === id)\n      && (!level || group.level === level)\n      && (!type || group.type === type)\n    ).sort((a, b) => (a.level - b.level || a.order - b.order));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get group IDs\n   * @returns {Array} The group IDs\n   */\n  getGroupIds() {\n    return Object.values(this.groups).map(group => group.id);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get group settings\n   * @public\n   * @param {object} [groupData={}] The group data\n   * @returns {object|null}         The group settings\n   */\n  getGroupSettings(groupData = {}) {\n    return this.getGroup(groupData)?.settings ?? null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Create group\n   * @public\n   * @param {object} groupData The group data\n   * @param {boolean} keepData Whether to keep the data\n   * @returns {object}         The group\n   */\n  createGroup(groupData, keepData = false) {\n    const groupDataClone = Utils.deepClone(groupData);\n    const nestIdParts = groupData.nestId.split(\"_\");\n    const level = nestIdParts.length ?? 1;\n\n    const tooltip = getTooltip(groupData?.tooltip, groupDataClone?.name);\n\n    if (!keepData) {\n      groupDataClone.actions = [];\n      groupDataClone.groups = { lists: [], tabs: [] };\n    }\n\n    const defaultSettings = {\n      showTitle: true,\n      style: (level === 1) ? \"tab\" : \"list\"\n    };\n\n    const groupSettings = groupDataClone.settings || {};\n    groupSettings.showTitle ??= defaultSettings.showTitle;\n    groupSettings.style ??= defaultSettings.style;\n\n    groupDataClone.subtitleClass = (groupSettings.showTitle) ? \"\" : \"tah-hidden\";\n\n    const groupSystem = groupDataClone.system || {};\n\n    const commonProps = {\n      actions: groupDataClone.actions,\n      class: groupDataClone.class || groupDataClone.cssClass || \"\",\n      groups: groupDataClone.groups,\n      id: groupDataClone.id,\n      info1: groupDataClone.info1 || \"\",\n      info2: groupDataClone.info2 || \"\",\n      info3: groupDataClone.info3 || \"\",\n      level: groupDataClone.level || level || 1,\n      listName: groupDataClone.listName || groupDataClone.name,\n      name: groupDataClone.name,\n      nestId: groupDataClone.nestId || groupDataClone.id,\n      order: groupDataClone.order,\n      selected: groupDataClone.selected ?? groupDataClone.isSelected ?? groupDataClone.defaultSelected ?? true,\n      settings: groupSettings,\n      system: groupSystem,\n      tooltip,\n      type: groupDataClone.type || GROUP_TYPE.CUSTOM\n    };\n\n    if (level > 1) {\n      commonProps.subtitleClass = groupDataClone.subtitleClass || \"\";\n    }\n\n    return commonProps;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update groups\n   * @public\n   * @param {Array | object} groupsData         The groups data\n   * @param {object} [parentGroupData = null] The parent group data\n   */\n  updateGroups(groupsData, parentGroupData) {\n    if (!Array.isArray(groupsData)) groupsData = [groupsData];\n\n    const level = (parentGroupData?.level ?? 0) + 1;\n    const childGroupData = { level };\n    if (parentGroupData?.nestId) childGroupData.nestId = parentGroupData.nestId;\n\n    const existingGroups = this.getGroups(childGroupData);\n\n    // Remove any groups that are no longer present\n    for (const existingGroup of existingGroups) {\n      if (existingGroup.type === \"system-derived\") {\n        existingGroup.selected = false;\n        existingGroup.order = 999;\n      } else if (!groupsData.find(groupData => groupData.id === existingGroup.id)) {\n        delete this.groups[existingGroup.nestId];\n      }\n    }\n\n    // Add or update groups\n    let order = 0;\n    for (const groupData of groupsData) {\n      groupData.nestId = (parentGroupData?.nestId)\n        ? `${parentGroupData.nestId}_${groupData.id}`\n        : groupData.id;\n      groupData.selected = groupData.selected ?? true;\n      groupData.order = order;\n\n      const existingGroup = this.getGroup(groupData);\n\n      if (existingGroup) {\n        Object.assign(existingGroup, groupData);\n      } else {\n        const group = this.createGroup(groupData);\n        this.groups[groupData.nestId] = group;\n      }\n      order++;\n    }\n\n    // Update parent group settings\n    if (parentGroupData?.settings) {\n      const existingParentGroup = this.getGroup(parentGroupData);\n      if (existingParentGroup) {\n        existingParentGroup.settings = parentGroupData.settings;\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save group settings\n   * @public\n   * @param {object} groupData The group data\n   */\n  saveGroupSettings(groupData) {\n    const group = this.getGroup(groupData);\n    group.settings = { ...group.settings, ...groupData.settings };\n    this.saveGroups({ saveActor: true, saveUser: true });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save groups\n   * @public\n   * @param {object} options The options\n   */\n  async saveGroups(options = { saveActor: false, saveUser: false }) {\n    if (!Utils.getSetting(\"enableCustomization\")) return;\n\n    Logger.debug(\"Saving groups...\");\n\n    if (options?.saveActor) await this.saveActorGroups();\n    if (options?.saveUser) await this.saveUserGroups();\n\n    Logger.debug(\"Groups saved\", { groups: this.groups });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save actor groups to file\n   * @public\n   */\n  async saveActorGroups() {\n    if (!this.actor || !Object.keys(this.groups).length) return;\n\n    Logger.debug(\"Saving actor groups...\");\n\n    const actorGroups = {};\n    this.actorGroups = {};\n\n    for (const group of Object.values(this.groups)) {\n      this.actorGroups[group.nestId] = group;\n      actorGroups[group.nestId] = this.#getReducedGroupData(group, true);\n    }\n\n    if (this.dataHandler.canSaveData) {\n      await this.dataHandler.saveDataAsGm(\"actor\", this.actor.id, actorGroups);\n\n      Logger.debug(\"Actor groups saved\", { actorGroups });\n    } else {\n      Logger.debug(\"Actor groups not saved as no GM present\");\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save user groups to file\n   * @public\n   */\n  async saveUserGroups() {\n    if (!Object.keys(this.groups).length) return;\n\n    Logger.debug(\"Saving user groups...\");\n\n    const userGroups = {};\n    this.userGroups = {};\n\n    for (const group of Object.values(this.groups)) {\n      if (group.type !== \"system-derived\") {\n        this.userGroups[group.nestId] = group;\n        userGroups[group.nestId] = this.#getReducedGroupData(group, false);\n      }\n    }\n\n    if (this.dataHandler.canSaveData) {\n      await this.dataHandler.saveDataAsGm(\"user\", game.userId, userGroups);\n      Logger.debug(\"User groups saved\", { userGroups });\n    } else {\n      Logger.debug(\"User groups not saved as no GM present\");\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get reduced groups data for saving to flags\n   * @private\n   * @param {object}  data          The group data\n   * @param {string}  data.id       The group ID\n   * @param {string}  data.name     The group name\n   * @param {string}  data.listName The list name for the group\n   * @param {number}  data.level    The group level\n   * @param {number}  data.order    The order of the group\n   * @param {boolean} data.selected Whether the group is selected\n   * @param {object}  data.settings The group settings\n   * @param {string}  data.type     The group type\n   * @param {Array}   data.actions  The list of actions for the group (if `keepActions` is true)\n   * @param {boolean} keepActions   Whether to keep action data\n   * @returns {object}              The reduced group data\n   */\n  #getReducedGroupData({ id, name, listName, level, order, selected, settings, type, actions }, keepActions = false) {\n    const data = { id, name, listName, level, order, selected, settings, type };\n\n    if (keepActions) {\n      data.actions = actions.map(({ id, isPreset, userSelected }) => { return { id, isPreset, userSelected }; });\n    }\n\n    return data;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get selected groups as Tagify entries\n   * @public\n   * @param {object} groupData The group data\n   * @returns {object}         The selected groups\n   */\n  getSelectedGroupsAsTags(groupData = {}) {\n    groupData.selected = true;\n    groupData.level = (groupData.level || 0) + 1;\n    const groups = this.getGroups(groupData);\n    return groups?.map(group => this.#toTagify(group)) ?? [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get available groups as Tagify entries\n   * @public\n   * @param {object} groupData The group data\n   * @returns {object}         The groups\n   */\n  async getAvailableGroupAsTags(groupData) {\n    const derivedGroups = await this.#getDerivedGroupsAsTags(groupData);\n    const systemGroups = await this.#getSystemGroupsAsTags();\n    const compendiumGroups = await this.#getCompendiumGroupsAsTags();\n    const macroGroups = await this.#getMacroGroupsAsTags();\n    return [...derivedGroups, ...systemGroups, ...compendiumGroups, ...macroGroups];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get derived groups as Tagify entries\n   * @private\n   * @param {object} data        The group data\n   * @param {object} data.nestId The group nest ID\n   * @returns {object}           The derived groups\n   */\n  #getDerivedGroupsAsTags({ nestId }) {\n    const derivedGroups = this.getGroups({ nestId, type: GROUP_TYPE.SYSTEM_DERIVED });\n    return derivedGroups?.map(group => this.#toTagify(group)) ?? [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get system groups as Tagify entries\n   * @private\n   * @returns {object} The system groups\n   */\n  #getSystemGroupsAsTags() {\n    return Object.values(this.defaultGroups).map(group => this.#toTagify(group));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get compendium groups as Tagify entries\n   * @private\n   * @returns {object} The compendium groups\n   */\n  #getCompendiumGroupsAsTags() {\n    const packs = game.packs.filter(pack =>\n      COMPENDIUM_PACK_TYPES.includes(pack.documentName)\n            && (foundry.utils.isNewerVersion(game.version, \"10\") ? pack.visible : (!pack.private || game.user.isGM))\n    );\n    const groups = packs.map(pack => {\n      return {\n        id: pack.metadata.id.replace(\".\", \"-\"),\n        listName: `${game.i18n.localize(\"tokenActionHud.group\")}: ${pack.metadata.label}`,\n        name: pack.metadata.label,\n        type: \"core\"\n      };\n    });\n    return groups.map(group => this.#toTagify(group));\n  }\n\n  /**\n   * Get macro groups as Tagify entries\n   * @private\n   * @returns {object} The macro groups\n   */\n  #getMacroGroupsAsTags() {\n    return [this.#toTagify({\n      id: \"macros\",\n      listName: `${game.i18n.localize(\"tokenActionHud.group\")}: ${game.i18n.localize(\"tokenActionHud.macros\")}`,\n      name: game.i18n.localize(\"tokenActionHud.macros\"),\n      type: \"core\"\n    })];\n  }\n\n  /**\n   * Add group to the HUD\n   * @public\n   * @param {object} groupData         The group data\n   * @param {object} parentGroupData   The parent group data\n   * @param {boolean} [update = false] Whether to update an existing group\n   */\n  addGroup(groupData, parentGroupData, update = false) {\n    groupData.type = groupData?.type ?? \"system-derived\";\n    groupData.style = groupData?.style ?? \"list\";\n\n    if (!parentGroupData?.id && !parentGroupData?.nestId) return;\n\n    const parentGroups = this.getGroups(parentGroupData);\n    if (!parentGroups?.length) return;\n\n    for (const parentGroup of parentGroups) {\n      const nestId = `${parentGroup.nestId}_${groupData.id}`;\n      const existingGroups = this.getGroups({ ...groupData, nestId });\n\n      if (existingGroups.length) {\n        if (update) {\n          for (const existingGroup of existingGroups) {\n            // Temporary fix until info1-3 properties are grouped into info object\n            if (groupData.info) {\n              Object.assign(groupData, { ...groupData.info });\n              delete groupData.info;\n            }\n\n            Object.assign(existingGroup, this.createGroup({ ...existingGroup, ...groupData }, true));\n          }\n        } else {\n          for (const existingGroup of existingGroups) {\n            const tooltip = getTooltip(groupData.tooltip, existingGroup.name);\n            Object.assign(existingGroup, { tooltip });\n          }\n        }\n      } else {\n        const group = this.createGroup({ ...groupData, nestId });\n        if (group.settings.style === \"tab\") {\n          parentGroup.groups.tabs.push(group);\n        } else {\n          parentGroup.groups.lists.push(group);\n        }\n        this.groups[group.nestId] = group;\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update group in the HUD\n   * @public\n   * @param {object} groupData                The group data\n   * @param {object} [parentGroupData = null] The parent group data\n   */\n  updateGroup(groupData, parentGroupData = null) {\n    groupData.type = groupData?.type ?? \"system-derived\";\n\n    const updateExistingGroups = existingGroups => {\n      for (const existingGroup of existingGroups) {\n        // Temporary fix until info1-3 properties are grouped into info object\n        if (groupData.info) {\n          Object.assign(groupData, { ...groupData.info });\n          delete groupData.info;\n        }\n\n        Object.assign(existingGroup, this.createGroup({ ...existingGroup, ...groupData }, true));\n      }\n    };\n\n    if (parentGroupData) {\n      const parentGroups = this.getGroups(parentGroupData);\n      for (const parentGroup of parentGroups) {\n        const nestId = `${parentGroup.nestId}_${groupData.id}`;\n        const existingGroups = this.getGroups({ ...groupData, nestId });\n\n        updateExistingGroups(existingGroups);\n      }\n    } else {\n      const existingGroups = this.getGroups(groupData);\n\n      updateExistingGroups(existingGroups);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Remove group from HUD\n   * @public\n   * @param {object} groupData The group data\n   */\n  removeGroup(groupData) {\n    if (!groupData?.nestId && groupData?.id) {\n      Utils.deleteGroupsById(this.hud.groups, groupData.id);\n    }\n\n    const groups = this.getGroups(groupData);\n    if (!groups?.length) return;\n\n    for (const group of groups) {\n      delete this.groups[group.nestId];\n      if (groupData?.nestId) {\n        Utils.deleteGroupByNestId(this.hud.groups, group.nestId);\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add info to group in the HUD\n   * @public\n   * @param {string} groupData The group data\n   */\n  addGroupInfo(groupData) {\n    const groupId = groupData?.id;\n    const groupInfo = groupData?.info;\n\n    if (!groupId || !groupInfo) return;\n\n    const groups = this.getGroups(groupData);\n\n    groups.forEach(group => {\n      group.info1 = groupInfo.info1;\n      group.info2 = groupInfo.info2;\n      group.info3 = groupInfo.info3;\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set property to indicate whether a group has actions within it\n   * @public\n   */\n  setHasActions() {\n    Object.values(this.groups).forEach(group => {\n      if (group.actions.some(action => action.selected)) {\n        group.hasActions = true;\n      } else {\n        group.hasActions = false;\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Convert a group into a Tagify entry\n   * @private\n   * @param {object} groupData The group data\n   * @returns {object}         The Tagify entry\n   */\n  #toTagify(groupData) {\n    const { id, name, type, listName } = groupData;\n    return { id, name, type, value: listName ?? name };\n  }\n}\n","\nimport { CharacterHandler } from \"../handlers/character-handler.mjs\";\nimport { LayoutHandler } from \"../handlers/layout-handler.mjs\";\nimport { GroupHandler } from \"../handlers/group-handler.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\n\nexport class HudManager {\n  constructor(tokenActionHud, systemManager, dataHandler, socket) {\n    this.tokenActionHud = tokenActionHud;\n    this.dataHandler = dataHandler;\n    this.socket = socket;\n    this.layoutHandler = new LayoutHandler(systemManager, dataHandler);\n    this.groupHandler = new GroupHandler(this, systemManager, dataHandler, this.layoutHandler);\n    this.actionHandler = systemManager.getActionHandlerCore(this, this.dataHandler, this.groupHandler);\n    this.rollHandler = systemManager.getRollHandlerCore(this);\n    this.characterHandler = new CharacterHandler(this);\n  }\n\n  /**\n   * Initialise the HUD\n   * @param {string} trigger The update trigger\n   * @returns {boolean} Whether the HUD was initialised\n   */\n  async init(trigger) {\n    this.characterHandler.init();\n\n    if ( !this.characterHandler.isCharacter || !this.isHudEnabled) return false;\n\n    const options = (trigger === \"controlToken\" && this.characterHandler.isSameActor) ? { saveActor: true } : {};\n\n    await this.#buildHud(options);\n\n    return true;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Soft reset variables\n   * @public\n   */\n  softResetHud() {\n    this.hud = [];\n    this.groupHandler.softReset();\n    this.layoutHandler.softReset();\n    this.actionHandler.softReset();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Hard reset variables\n   * @public\n   */\n  hardResetHud() {\n    this.softResetHud();\n    this.groupHandler.hardReset();\n    this.layoutHandler.hardReset();\n  }\n\n  /**\n   * Build the HUD\n   * @private\n   * @param {object} options The options\n   * @returns {object}       The HUD\n   */\n  async #buildHud(options) {\n    Logger.debug(\"Building HUD...\", { actor: this.actor, token: this.token });\n\n    if (this.previousActor?.id === this.actor?.id) {\n      this.isSameActor = true;\n    } else {\n      this.previousActor = this.actor;\n      this.isSameActor = false;\n    }\n\n    this.softResetHud();\n\n    await this.layoutHandler.init();\n    await this.groupHandler.init();\n\n    if (!this.dataHandler.canGetData && !this.isGmInactiveUserNotified) {\n      Logger.info(\"Cannot retrieve HUD layout without GM present\", true);\n      this.isGmInactiveUserNotified = true;\n    }\n\n    this.hud = await this.#prepareHud();\n\n    await this.actionHandler.buildActionsCore();\n    this.groupHandler.setHasActions();\n    await this.groupHandler.saveGroups(options);\n\n    Logger.debug(\"HUD built\", { hud: this.hud, actor: this.actor, token: this.token });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare the HUD\n   * @private\n   * @returns {object} The HUD\n   */\n  async #prepareHud() {\n    Logger.debug(\"Preparing HUD...\", { actor: this.actor, token: this.token });\n\n    const name = (Utils.getSetting(\"displayCharacterName\"))\n      ? this.characterHandler.characterName ?? game.i18n.localize(\"tokenActionHud.multiple\")\n      : \"\";\n    const actorId = this.actor?.id ?? \"multi\";\n    const tokenId = this.token?.id ?? \"multi\";\n    const hud = { name, tokenId, actorId, groups: [] };\n\n    const groups = await this.groupHandler.prepareGroups(hud);\n    this.actionHandler.prepareActions(groups);\n\n    Logger.debug(\"HUD prepared\", { hud, actor: this.actor, token: this.token });\n    return hud;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle HUD event\n   * @param {string} eventType The event type\n   * @param {object} event     The event\n   */\n  handleHudEvent(eventType, event) {\n    const group = ([\"groupClick\"].includes(eventType)) ? this.getGroup(event) : null;\n    const action = ([\"clickAction\", \"hoverAction\"].includes(eventType)) ? this.getAction(event) : null;\n\n    this.#registerKeyPresses(event);\n    this.#setIsHover(event);\n\n    try {\n      switch (eventType) {\n        case \"groupClick\":\n          this.rollHandler.handleGroupClickCore(event, group);\n          break;\n        case \"clickAction\":\n          this.rollHandler.handleActionClickCore(event, action);\n          break;\n        case \"hoverAction\":\n          this.rollHandler.handleActionHoverCore(event, action);\n      }\n    } catch(error) {\n      Logger.error(event);\n    }\n  }\n\n  /**\n   * Registers key presses\n   * @private\n   * @param {object} event The events\n   */\n  #registerKeyPresses(event) {\n    this.#setIsRightClick(event);\n    this.#setIsAlt(event);\n    this.#setIsCtrl(event);\n    this.#setIsShift(event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the button was right-clicked\n   * @public\n   * @param {object} event The event\n   */\n  #setIsRightClick(event) {\n    const button = event?.originalEvent?.button || event.button;\n    this.isRightClick = button === 2;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set isAlt based on event\n   * @private\n   * @param {object} event The event\n   */\n  #setIsAlt(event) {\n    const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.ALT);\n    if (event.altKey && !isModiferActive) {\n      Logger.debug(\"Emulating LEFT ALT key press\");\n      KeyboardManager.emulateKeypress(false, \"AltLeft\", { altKey: true, force: true });\n      game.keyboard.downKeys.add(\"AltLeft\");\n      this.isAlt = true;\n    } else {\n      this.isAlt = isModiferActive;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set isCtrl based on event\n   * @private\n   * @param {object} event The event\n   */\n  #setIsCtrl(event) {\n    const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.CONTROL);\n    if (event.ctrlKey && !isModiferActive) {\n      Logger.debug(\"Emulating LEFT CTRL key press\");\n      KeyboardManager.emulateKeypress(false, \"ControlLeft\", { ctrlKey: true, force: true });\n      game.keyboard.downKeys.add(\"ControlLeft\");\n      this.isCtrl = true;\n    } else {\n      this.isCtrl = isModiferActive;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set isShift based on event\n   * @private\n   * @param {object} event The event\n   */\n  #setIsShift(event) {\n    const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.SHIFT);\n    if (event.shiftKey && !isModiferActive) {\n      Logger.debug(\"Emulating LEFT SHIFT key press\");\n      KeyboardManager.emulateKeypress(false, \"ShiftLeft\", { shiftKey: true, force: true });\n      game.keyboard.downKeys.add(\"ShiftLeft\");\n      this.isShift = true;\n    } else {\n      this.isShift = isModiferActive;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set isHover based on event\n   * @private\n   * @param {object} event The event\n   */\n  #setIsHover(event) {\n    this.isHover = [\"mouseenter\", \"mouseover\", \"pointerenter\"].includes(event.type);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the group from the nest ID\n   * @param {object} event The event\n   * @returns {object}     The group\n   */\n  getGroup(event) {\n    const groupElement = Utils.getClosestGroupElement(event);\n    const nestId = groupElement?.dataset?.nestId;\n    return this.groupHandler.getGroup({ nestId }) ?? null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the action from the action ID on the button\n   * @param {object} event  The event\n   * @returns {object}      The action\n   */\n  getAction(event) {\n    if (!event) return {};\n    const actionButtonElement = event.target.closest('[data-part=\"actionButton\"]')\n      ?? event.target.querySelector('[data-part=\"actionButton\"]');\n    const actionId = actionButtonElement?.dataset?.actionId;\n    if (!actionId) return {};\n    return this.actionHandler.availableActions.get(actionId) || {};\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the hud is enabled for the current user\n   * @private\n   * @returns {boolean} Whether the hud is enabled for the current user\n   */\n  get isHudEnabled() {\n    if (!Utils.getSetting(\"enable\")) return false;\n    if (game.user.isGM) return true;\n    return Utils.checkAllow(game.user.role, Utils.getSetting(\"allow\"));\n  }\n\n  /* -------------------------------------------- */\n  /* Shortcuts to CharacterHandler properties     */\n  /* -------------------------------------------- */\n\n  get characterName() {\n    return this.characterHandler?.characterName;\n  }\n\n  get actor() {\n    return this.characterHandler?.actor;\n  }\n\n  set actor(actor) {\n    this.characterHandler.actor = actor;\n  }\n\n  get actors() {\n    return this.characterHandler?.actors;\n  }\n\n  set actors(actors) {\n    this.characterHandler.actors = actors;\n  }\n\n  get token() {\n    return this.characterHandler?.token;\n  }\n\n  set token(token) {\n    this.characterHandler.token = token;\n  }\n\n  get tokens() {\n    return this.characterHandler?.tokens;\n  }\n\n  set tokens(tokens) {\n    this.characterHandler.tokens = tokens;\n  }\n}\n","!function(t,e){var i=i||{};\"function\"==typeof i&&i.amd?i([],e):\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"object\"==typeof exports?exports.DragSort=e():t.DragSort=e()}(this,(function(){var t,e=0,i={},s={},r=(t=window.MutationObserver||window.WebKitMutationObserver,function(e,i){e&&1===e.nodeType&&(t?new t((function(t,e){i(t)})).observe(e,{childList:!0,subtree:!1}):window.addEventListener&&e.addEventListener(\"DOMNodeInserted\",i,!1))});function a(t,e){if(!t)return this;e=e||{},this.parentElm=t,this.uid=e.uid,this.settings={selector:\"*\",callbacks:{}},Object.assign(this.settings,e),this.setup(),r(this.parentElm,this.setup.bind(this)),this.bindEvents()}return a.prototype={namespace:\"dragsort\",setup(){[...this.parentElm.childNodes].forEach((t=>{if(1!=t.nodeType)return t.parentNode.removeChild(t);t.matches(this.settings.selector)&&(t.draggable=!0)})),this.gap=this.getItemsGap(this.parentElm.firstElementChild)},throttle(t,e){var i=!1,s=this;return function(r){i||(t.call(s,r),i=!0,setTimeout((()=>i=!1),e))}},getDraggableElm(t){if(!t.closest)return null;var e=t.closest('[draggable=\"true\"]');return this.uid==i.uid?e:null},dragstart(t,e){i=this;var s,r=this.getDraggableElm(e);r?(this.saveInitialStyles(),this.source=this.getInitialState(),this.target=this.getInitialState(),s=r.getBoundingClientRect(),this.source.elm=r,this.source.idx=this.getNodeIndex(r),this.source.size.width=s.width,this.source.size.height=s.height,t.dataTransfer.effectAllowed=\"move\",this.settings.callbacks.dragStart&&this.settings.callbacks.dragStart(this.source.elm,t),setTimeout(this.afterDragStart.bind(this))):i={}},afterDragStart(){var t=\"vertical\"==this.settings.mode?\"height\":\"width\";this.parentElm.classList.add(`${this.namespace}--dragStart`),this.source.elm.style[t]=this.source.size[t]+\"px\",this.source.elm.classList.add(`${this.namespace}--dragElem`)},dragover(t){t.preventDefault(),t.stopPropagation();var e=t.target;if((e=this.getDraggableElm(e))&&this.target){var i=this.target.elm,s=this.target.hoverDirection;t.dataTransfer.dropEffect=\"move\",this.target.hoverDirection=this.getTargetDirection(t),i==e&&s==this.target.hoverDirection||this.directionAwareDragEnter(t,e)}},dragenter(t,e){(e=this.getDraggableElm(e))&&this.target&&this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(this.target.bounding=e.getBoundingClientRect())},directionAwareDragEnter(t,e){var i;t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=\"none\",this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(t.dataTransfer.dropEffect=\"move\",this.cleanupLastTarget(),this.target.elm=e,this.target.idx=this.getNodeIndex(e),e.classList.add(\"over\"),i=Math.abs(this.target.idx-this.source.idx),this.source.elm.classList.toggle(`${this.namespace}--hide`,i>0),\"vertical\"==this.settings.mode?this.target.elm.style[this.target.hoverDirection?\"marginBottom\":\"marginTop\"]=this.source.size.height+this.gap+\"px\":this.target.elm.style[this.target.hoverDirection?\"marginRight\":\"marginLeft\"]=this.source.size.width+this.gap+\"px\")},dragend(t){if(clearTimeout(this.dragoverTimeout),this.dragoverTimeout=null,this.parentElm.classList.remove(`${this.namespace}--dragStart`),!this.isValidElm(this.target.elm))return this.cleanup();var e=this.target.hoverDirection?this.target.elm.nextElementSibling:this.target.elm;return this.source.elm!=this.target.elm&&this.target.elm&&(this.target.elm.classList.add(`${this.namespace}--noAnim`),this.cleanup(),this.parentElm.insertBefore(this.source.elm,e)),this.source.elm&&this.source.elm.classList.remove(`${this.namespace}--dragElem`,`${this.namespace}--hide`),this.settings.callbacks.dragEnd&&this.settings.callbacks.dragEnd(this.source.elm),this},isTargetLastChild(){return this.parentElm.lastElementChild==this.target.elm},getTargetDirection(t){if(this.target.bounding)return\"vertical\"==this.settings.mode?t.pageY>this.target.bounding.top+this.target.bounding.height/2?1:0:t.pageX>this.target.bounding.left+this.target.bounding.width/2?1:0},getNodeIndex(t){for(var e=0;t=t.previousSibling;)3==t.nodeType&&/^\\s*$/.test(t.data)||e++;return e},isValidElm(t){return t&&t.nodeType&&t.parentNode==this.parentElm},saveInitialStyles(){[...this.parentElm.children].forEach((t=>{t.setAttribute(\"dragsort-initial-style\",t.getAttribute(\"style\"))}))},cleanup(){i={},[...this.parentElm.children].forEach((t=>{t.style=t.getAttribute(\"dragsort-initial-style\"),t.removeAttribute(\"dragsort-initial-style\"),setTimeout((()=>{t.classList.remove(`${this.namespace}--over`,`${this.namespace}--noAnim`,`${this.namespace}--dragElem`)}),50)}))},cleanupLastTarget(){const{elm:t}=this.target;t&&(t.classList.remove(`${this.namespace}--hide`,`${this.namespace}--over`),t.style=t.getAttribute(\"dragsort-initial-style\"))},getInitialState:()=>({elm:null,size:{}}),getItemsGap(t){var e=getComputedStyle(t),i=getComputedStyle(t.parentNode),s=\"vertical\"==this.settings.mode,r=parseInt(i.gap)||0;return parseInt(e[\"margin\"+(s?\"Top\":\"Left\")])+parseInt(e[\"margin\"+(s?\"Bottom\":\"Right\")])+r},bindEvents(t){for(var e in this.listeners=this.listeners||{dragstart:t=>this.dragstart(t,t.target),dragenter:t=>this.dragenter(t,t.target),dragend:t=>this.dragend(t,t.target),dragover:this.throttle(this.dragover,350)},this.listeners)this.parentElm[t?\"removeEventListener\":\"addEventListener\"](e,this.listeners[e])},destroy(){this.cleanup(),this.bindEvents(!0),delete s[this.uid]}},function(t,i){return s[++e]=t.DragSort?s[t.DragSort]:new a(t,{...i,uid:e}),t.DragSort=e,s[e]}}));","/*\nTagify v4.31.3 - tags input component\nBy: Yair Even-Or <vsync.design@gmail.com>\nhttps://github.com/yairEO/tagify\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\nThis Software may not be rebranded and sold as a library under any other name\r\nother than \"Tagify\" (by owner) or as part of another library.\n*/\n\nvar t=\"&#8203;\";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function i(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,i){if(!t)return;if(\"string\"==typeof t)return e(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===n&&t.constructor&&(n=t.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(n);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,i)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}var n={isEnabled:function(){var t;return null===(t=window.TAGIFY_DEBUG)||void 0===t||t},log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s;this.isEnabled()&&(s=console).log.apply(s,[\"[Tagify]:\"].concat(i(e)))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s;this.isEnabled()&&(s=console).warn.apply(s,[\"[Tagify]:\"].concat(i(e)))}},s=function(t,e,i,n){return t=\"\"+t,e=\"\"+e,n&&(t=t.trim(),e=e.trim()),i?t==e:t.toLowerCase()==e.toLowerCase()},a=function(t,e){return t&&Array.isArray(t)&&t.map((function(t){return o(t,e)}))};function o(t,e){var i,n={};for(i in t)e.indexOf(i)<0&&(n[i]=t[i]);return n}function r(t){return(new DOMParser).parseFromString(t.trim(),\"text/html\").body.firstElementChild}function l(t,e){for(e=e||\"previous\";t=t[e+\"Sibling\"];)if(3==t.nodeType)return t}function d(t){return\"string\"==typeof t?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\").replace(/`|'/g,\"&#039;\"):t}function c(t){var e=Object.prototype.toString.call(t).split(\" \")[1].slice(0,-1);return t===Object(t)&&\"Array\"!=e&&\"Function\"!=e&&\"RegExp\"!=e&&\"HTMLUnknownElement\"!=e}function u(t,e,i){var n,s;function a(t,e){for(var i in e)if(e.hasOwnProperty(i)){if(c(e[i])){c(t[i])?a(t[i],e[i]):t[i]=Object.assign({},e[i]);continue}if(Array.isArray(e[i])){t[i]=Object.assign([],e[i]);continue}t[i]=e[i]}}return n=t,(null!=(s=Object)&&\"undefined\"!=typeof Symbol&&s[Symbol.hasInstance]?s[Symbol.hasInstance](n):n instanceof s)||(t={}),a(t,e),i&&a(t,i),t}function g(){var t=[],e={},i=!0,n=!1,s=void 0;try{for(var a,o=arguments[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var r=a.value,l=!0,d=!1,u=void 0;try{for(var g,h=r[Symbol.iterator]();!(l=(g=h.next()).done);l=!0){var p=g.value;c(p)?e[p.value]||(t.push(p),e[p.value]=1):t.includes(p)||t.push(p)}}catch(t){d=!0,u=t}finally{try{l||null==h.return||h.return()}finally{if(d)throw u}}}}catch(t){n=!0,s=t}finally{try{i||null==o.return||o.return()}finally{if(n)throw s}}return t}function h(t){return String.prototype.normalize?\"string\"==typeof t?t.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g,\"\"):void 0:t}var p=function(){return/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent)};function f(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}function m(t){return t&&t.classList&&t.classList.contains(this.settings.classNames.tag)}function v(t){return t&&t.closest(this.settings.classNames.tagSelector)}function b(t,e){var i=window.getSelection();return e=e||i.getRangeAt(0),\"string\"==typeof t&&(t=document.createTextNode(t)),e&&(e.deleteContents(),e.insertNode(t)),t}function w(t,e,i){return t?(e&&(t.__tagifyTagData=i?e:u({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(n.warn(\"tag element doesn't exist\",{tagElm:t,data:e}),e)}function y(t){if(t&&t.parentNode){var e=t,i=window.getSelection(),n=i.getRangeAt(0);i.rangeCount&&(n.setStartAfter(e),n.collapse(!0),i.removeAllRanges(),i.addRange(n))}}function T(t,e){t.forEach((function(t){if(w(t.previousSibling)||!t.previousSibling){var i=document.createTextNode(\"\");t.before(i),e&&y(i)}}))}var O={delimiters:\",\",pattern:null,tagTextProp:\"value\",maxTags:1/0,callbacks:{},addTagOnBlur:!0,addTagOn:[\"blur\",\"tab\",\"enter\"],onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,focusable:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\\.|\\:|\\s/,mixTagsInterpolator:[\"[[\",\"]]\"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:function(){},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:\"\"},autoComplete:{enabled:!0,rightKey:!1,tabKey:!1},classNames:{namespace:\"tagify\",mixMode:\"tagify--mix\",selectMode:\"tagify--select\",input:\"tagify__input\",focus:\"tagify--focus\",tagNoAnimation:\"tagify--noAnim\",tagInvalid:\"tagify--invalid\",tagNotAllowed:\"tagify--notAllowed\",scopeLoading:\"tagify--loading\",hasMaxTags:\"tagify--hasMaxTags\",hasNoTags:\"tagify--noTags\",empty:\"tagify--empty\",inputInvalid:\"tagify__input--invalid\",dropdown:\"tagify__dropdown\",dropdownWrapper:\"tagify__dropdown__wrapper\",dropdownHeader:\"tagify__dropdown__header\",dropdownFooter:\"tagify__dropdown__footer\",dropdownItem:\"tagify__dropdown__item\",dropdownItemActive:\"tagify__dropdown__item--active\",dropdownItemHidden:\"tagify__dropdown__item--hidden\",dropdownItemSelected:\"tagify__dropdown__item--selected\",dropdownInital:\"tagify__dropdown--initial\",tag:\"tagify__tag\",tagText:\"tagify__tag-text\",tagX:\"tagify__tag__removeBtn\",tagLoading:\"tagify__tag--loading\",tagEditing:\"tagify__tag--editable\",tagFlash:\"tagify__tag--flash\",tagHide:\"tagify__tag--hide\"},dropdown:{classname:\"\",enabled:2,maxItems:10,searchKeys:[\"value\",\"searchBy\"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,escapeHTML:!0,highlightFirst:!0,closeOnSelect:!0,clearOnSelect:!0,position:\"all\",appendTarget:null},hooks:{beforeRemoveTag:function(){return Promise.resolve()},beforePaste:function(){return Promise.resolve()},suggestionClick:function(){return Promise.resolve()},beforeKeyDown:function(){return Promise.resolve()}}};function x(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function D(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){x(t,e,i[e])}))}return t}function I(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})),t}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function E(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function M(t){return function(t){if(Array.isArray(t))return S(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return S(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return S(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function N(){for(var t in this.dropdown={},this._dropdown)this.dropdown[t]=\"function\"==typeof this._dropdown[t]?this._dropdown[t].bind(this):this._dropdown[t];this.dropdown.refs(),this.DOM.dropdown.__tagify=this}var _,A,C=(_=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){E(t,e,i[e])}))}return t}({},{events:{binding:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},n=t?\"addEventListener\":\"removeEventListener\";\"manual\"!=this.settings.dropdown.position&&(document[n](\"scroll\",i.position,!0),window[n](\"resize\",i.position),window[n](\"keydown\",i.onKeyDown)),this.DOM.dropdown[n](\"mouseover\",i.onMouseOver),this.DOM.dropdown[n](\"mouseleave\",i.onMouseLeave),this.DOM.dropdown[n](\"mousedown\",i.onClick),this.DOM.dropdown.content[n](\"scroll\",i.onScroll)},callbacks:{onKeyDown:function(t){var e=this;if(this.state.hasFocus&&!this.state.composing){var i=this.settings,s=this.DOM.dropdown.querySelector(i.classNames.dropdownItemActiveSelector),a=this.dropdown.getSuggestionDataByNode(s),o=\"mix\"==i.mode,r=\"select\"==i.mode;i.hooks.beforeKeyDown(t,{tagify:this}).then((function(l){switch(t.key){case\"ArrowDown\":case\"ArrowUp\":case\"Down\":case\"Up\":t.preventDefault();var d=e.dropdown.getAllSuggestionsRefs(),c=\"ArrowUp\"==t.key||\"Up\"==t.key;s&&(s=e.dropdown.getNextOrPrevOption(s,!c)),s&&s.matches(i.classNames.dropdownItemSelector)||(s=d[c?d.length-1:0]),e.dropdown.highlightOption(s,!0);break;case\"Escape\":case\"Esc\":e.dropdown.hide();break;case\"ArrowRight\":if(e.state.actions.ArrowLeft||i.autoComplete.rightKey)return;case\"Tab\":var u=!i.autoComplete.rightKey||!i.autoComplete.tabKey;if(!o&&!r&&s&&u&&!e.state.editing&&a){t.preventDefault();var g=e.dropdown.getMappedValue(a);return e.input.autocomplete.set.call(e,g),!1}return!0;case\"Enter\":t.preventDefault(),i.hooks.suggestionClick(t,{tagify:e,tagData:a,suggestionElm:s}).then((function(){if(s)return e.dropdown.selectOption(s),s=e.dropdown.getNextOrPrevOption(s,!c),void e.dropdown.highlightOption(s);e.dropdown.hide(),o||e.addTags(e.state.inputText.trim(),!0)})).catch((function(t){return n.warn(t)}));break;case\"Backspace\":if(o||e.state.editing.scope)return;var h=e.input.raw.call(e);\"\"!=h&&8203!=h.charCodeAt(0)||(!0===i.backspace?e.removeTags():\"edit\"==i.backspace&&setTimeout(e.editTag.bind(e),0))}}))}},onMouseOver:function(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);this.dropdown.highlightOption(e)},onMouseLeave:function(t){this.dropdown.highlightOption()},onClick:function(t){var e=this;if(0==t.button&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var i=t.target.closest(this.settings.classNames.dropdownItemSelector),s=this.dropdown.getSuggestionDataByNode(i);this.state.actions.selectOption=!0,setTimeout((function(){return e.state.actions.selectOption=!1}),50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:s,suggestionElm:i}).then((function(){i?e.dropdown.selectOption(i,t):e.dropdown.hide()})).catch((function(t){return n.warn(t)}))}},onScroll:function(t){var e=t.target,i=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger(\"dropdown:scroll\",{percentage:Math.round(i)})}}},refilter:function(t){t=t||this.state.dropdown.query||\"\",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger(\"dropdown:updated\",this.DOM.dropdown)},getSuggestionDataByNode:function(t){for(var e,i=t&&t.getAttribute(\"value\"),n=this.suggestedListItems.length;n--;){if(c(e=this.suggestedListItems[n])&&e.value==i)return e;if(e==i)return{value:e}}},getNextOrPrevOption:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.dropdown.getAllSuggestionsRefs(),n=i.findIndex((function(e){return e===t}));return e?i[n+1]:i[n-1]},highlightOption:function(t,e){var i,n=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(n),this.state.ddItemElm.removeAttribute(\"aria-selected\")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.dropdown.getSuggestionDataByNode(t),this.state.ddItemData=i,this.state.ddItemElm=t,t.classList.add(n),t.setAttribute(\"aria-selected\",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption:function(t,e){var i=this,n=this.settings,s=n.dropdown,a=s.clearOnSelect,o=s.closeOnSelect;if(!t)return this.addTags(this.state.inputText,!0),void(o&&this.dropdown.hide());e=e||{};var r=t.getAttribute(\"value\"),l=\"noMatch\"==r,d=\"mix\"==n.mode,c=this.suggestedListItems.find((function(t){var e;return(null!==(e=t.value)&&void 0!==e?e:t)==r}));if(this.trigger(\"dropdown:select\",{data:c,elm:t,event:e}),c||l){if(this.state.editing){var g=this.normalizeTags([c])[0];c=n.transformTag.call(this,g)||g,this.onEditTagDone(null,u({__isValid:!0},c))}else this[d?\"addMixTags\":\"addTags\"]([c||this.input.raw.call(this)],a);(d||this.DOM.input.parentNode)&&(setTimeout((function(){i.DOM.input.focus(),i.toggleFocusClass(!0)})),o&&setTimeout(this.dropdown.hide.bind(this)),t.addEventListener(\"transitionend\",(function(){i.dropdown.fillHeaderFooter(),setTimeout((function(){t.remove(),i.dropdown.refilter()}),100)}),{once:!0}),t.classList.add(this.settings.classNames.dropdownItemHidden))}else o&&setTimeout(this.dropdown.hide.bind(this))},selectAll:function(t){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems(\"\");var e=this.dropdown.filterListItems(\"\");return t||(e=this.state.dropdown.suggestions),this.addTags(e,!0),this},filterListItems:function(t,e){var i,n,s,a,o,r,l=function(){var t,l,d=void 0,u=void 0;t=m[y],n=(null!=(l=Object)&&\"undefined\"!=typeof Symbol&&l[Symbol.hasInstance]?l[Symbol.hasInstance](t):t instanceof l)?m[y]:{value:m[y]};var v,b=!Object.keys(n).some((function(t){return w.includes(t)}))?[\"value\"]:w;g.fuzzySearch&&!e.exact?(a=b.reduce((function(t,e){return t+\" \"+(n[e]||\"\")}),\"\").toLowerCase().trim(),g.accentedSearch&&(a=h(a),r=h(r)),d=0==a.indexOf(r),u=a===r,v=a,s=r.toLowerCase().split(\" \").every((function(t){return v.includes(t.toLowerCase())}))):(d=!0,s=b.some((function(t){var i=\"\"+(n[t]||\"\");return g.accentedSearch&&(i=h(i),r=h(r)),g.caseSensitive||(i=i.toLowerCase()),u=i===r,e.exact?i===r:0==i.indexOf(r)}))),o=!g.includeSelectedTags&&i.isTagDuplicate(c(n)?n.value:n),s&&!o&&(u&&d?f.push(n):\"startsWith\"==g.sortby&&d?p.unshift(n):p.push(n))},d=this,u=this.settings,g=u.dropdown,p=(e=e||{},[]),f=[],m=u.whitelist,v=g.maxItems>=0?g.maxItems:1/0,b=g.includeSelectedTags||\"select\"==u.mode,w=g.searchKeys,y=0;if(!(t=\"select\"==u.mode&&this.value.length&&this.value[0][u.tagTextProp]==t?\"\":t)||!w.length)return p=b?m:m.filter((function(t){return!d.isTagDuplicate(c(t)?t.value:t)})),this.state.dropdown.suggestions=p,p.slice(0,v);for(r=g.caseSensitive?\"\"+t:(\"\"+t).toLowerCase();y<m.length;y++)i=this,l();return this.state.dropdown.suggestions=f.concat(p),\"function\"==typeof g.sortby?g.sortby(f.concat(p),r):f.concat(p).slice(0,v)},getMappedValue:function(t){var e=this.settings.dropdown.mapValueTo;return e?\"function\"==typeof e?e(t):t[e]||t.value:t.value},createListHTML:function(t){var e=this;return u([],t).map((function(t,i){\"string\"!=typeof t&&\"number\"!=typeof t||(t={value:t});var n=e.dropdown.getMappedValue(t);return n=\"string\"==typeof n&&e.settings.dropdown.escapeHTML?d(n):n,e.settings.templates.dropdownItem.apply(e,[I(D({},t),{mappedValue:n}),e])})).join(\"\")}}),A=null!=(A={refs:function(){this.DOM.dropdown=this.parseTemplate(\"dropdown\",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-wrapper']\")},getHeaderRef:function(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-header']\")},getFooterRef:function(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-footer']\")},getAllSuggestionsRefs:function(){return M(this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector))},show:function(t){var e,i,n,a=this,o=this.settings,r=\"mix\"==o.mode&&!o.enforceWhitelist,l=!o.whitelist||!o.whitelist.length,d=\"manual\"==o.dropdown.position;if(t=void 0===t?this.state.inputText:t,!(l&&!r&&!o.templates.dropdownItemNoMatch||!1===o.dropdown.enable||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger(\"dropdown:noMatch\",t),o.templates.dropdownItemNoMatch&&(n=o.templates.dropdownItemNoMatch.call(this,{value:t}))),!n){if(this.suggestedListItems.length)t&&r&&!this.state.editing.scope&&!s(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!r||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}i=\"\"+(c(e=this.suggestedListItems[0])?e.value:e),o.autoComplete&&i&&0==i.indexOf(t)&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(n),o.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(o.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),d||setTimeout((function(){a.dropdown.position(),a.dropdown.render()})),setTimeout((function(){a.trigger(\"dropdown:show\",a.DOM.dropdown)}))}},hide:function(t){var e=this,i=this.DOM,n=i.scope,s=i.dropdown,a=\"manual\"==this.settings.dropdown.position&&!t;if(s&&document.body.contains(s)&&!a)return window.removeEventListener(\"resize\",this.dropdown.position),this.dropdown.events.binding.call(this,!1),n.setAttribute(\"aria-expanded\",!1),s.parentNode.removeChild(s),setTimeout((function(){e.state.dropdown.visible=!1}),100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger(\"dropdown:hide\",s),this},toggle:function(t){this.dropdown[this.state.dropdown.visible&&!t?\"hide\":\"show\"]()},getAppendTarget:function(){var t=this.settings.dropdown;return\"function\"==typeof t.appendTarget?t.appendTarget():t.appendTarget},render:function(){var t,e,i,n=this,s=(t=this.DOM.dropdown,(i=t.cloneNode(!0)).style.cssText=\"position:fixed; top:-9999px; opacity:0\",document.body.appendChild(i),e=i.clientHeight,i.parentNode.removeChild(i),e),a=this.settings,o=this.dropdown.getAppendTarget();return!1===a.dropdown.enabled||(this.DOM.scope.setAttribute(\"aria-expanded\",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a.classNames.dropdownInital),this.dropdown.position(s),o.appendChild(this.DOM.dropdown),setTimeout((function(){return n.DOM.dropdown.classList.remove(a.classNames.dropdownInital)})))),this},fill:function(t){t=\"string\"==typeof t?t:this.dropdown.createListHTML(t||this.suggestedListItems);var e,i=this.settings.templates.dropdownContent.call(this,t);this.DOM.dropdown.content.innerHTML=(e=i)?e.replace(/\\>[\\r\\n ]+\\</g,\"><\").split(/>\\s+</).join(\"><\").trim():\"\"},fillHeaderFooter:function(){var t=this.dropdown.filterListItems(this.state.dropdown.query),e=this.parseTemplate(\"dropdownHeader\",[t]),i=this.parseTemplate(\"dropdownFooter\",[t]),n=this.dropdown.getHeaderRef(),s=this.dropdown.getFooterRef();e&&(null==n||n.parentNode.replaceChild(e,n)),i&&(null==s||s.parentNode.replaceChild(i,s))},position:function(t){var e=this.settings.dropdown,i=this.dropdown.getAppendTarget();if(\"manual\"!=e.position&&i){var n,s,a,o,r,l,d,c,u,g=this.DOM.dropdown,h=e.RTL,p=i===document.body,f=i===this.DOM.scope,m=p?window.pageYOffset:i.scrollTop,v=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,b=v.clientHeight,w=Math.max(v.clientWidth||0,window.innerWidth||0)>480?e.position:\"all\",y=this.DOM[\"input\"==w?\"input\":\"scope\"];if(t=t||g.clientHeight,this.state.dropdown.visible){if(\"text\"==w?(a=(n=function(){var t=document.getSelection();if(t.rangeCount){var e,i,n=t.getRangeAt(0),s=n.startContainer,a=n.startOffset;if(a>0)return(i=document.createRange()).setStart(s,a-1),i.setEnd(s,a),{left:(e=i.getBoundingClientRect()).right,top:e.top,bottom:e.bottom};if(s.getBoundingClientRect)return s.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,s=n.top,o=n.left,r=\"auto\"):(l=function(t){var e=0,i=0;for(t=t.parentNode;t&&t!=v;)e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.parentNode;return{top:e,left:i}}(i),n=y.getBoundingClientRect(),s=f?-1:n.top-l.top,a=(f?n.height:n.bottom-l.top)-1,o=f?-1:n.left-l.left,r=n.width+\"px\"),!p){var T=function(){for(var t=0,i=e.appendTarget.parentNode;i;)t+=i.scrollTop||0,i=i.parentNode;return t}();s+=T,a+=T}var O;s=Math.floor(s),a=Math.ceil(a),c=((d=null!==(O=e.placeAbove)&&void 0!==O?O:b-n.bottom<t)?s:a)+m,u=\"left: \".concat(o+(h&&n.width||0)+window.pageXOffset,\"px;\"),g.style.cssText=\"\".concat(u,\"; top: \").concat(c,\"px; min-width: \").concat(r,\"; max-width: \").concat(r),g.setAttribute(\"placement\",d?\"top\":\"bottom\"),g.setAttribute(\"position\",w)}}}})?A:{},Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(A)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(A)).forEach((function(t){Object.defineProperty(_,t,Object.getOwnPropertyDescriptor(A,t))})),_),k=\"@yaireo/tagify/\",L={empty:\"empty\",exceed:\"number of tags exceeded\",pattern:\"pattern mismatch\",duplicate:\"already exists\",notAllowed:\"not allowed\"},j={wrapper:function(e,i){return'<tags class=\"'.concat(i.classNames.namespace,\" \").concat(i.mode?\"\".concat(i.classNames[i.mode+\"Mode\"]):\"\",\" \").concat(e.className,'\"\\n                    ').concat(i.readonly?\"readonly\":\"\",\"\\n                    \").concat(i.disabled?\"disabled\":\"\",\"\\n                    \").concat(i.required?\"required\":\"\",\"\\n                    \").concat(\"select\"===i.mode?\"spellcheck='false'\":\"\",'\\n                    tabIndex=\"-1\">\\n                    ').concat(this.settings.templates.input.call(this),\"\\n                \").concat(t,\"\\n        </tags>\")},input:function(){var e=this.settings,i=e.placeholder||t;return\"<span \".concat(!e.readonly&&e.userInput?\"contenteditable\":\"\",' tabIndex=\"0\" data-placeholder=\"').concat(i,'\" aria-placeholder=\"').concat(e.placeholder||\"\",'\"\\n                    class=\"').concat(e.classNames.input,'\"\\n                    role=\"textbox\"\\n                    autocapitalize=\"false\"\\n                    autocorrect=\"off\"\\n                    spellcheck=\"false\"\\n                    aria-autocomplete=\"both\"\\n                    aria-multiline=\"').concat(\"mix\"==e.mode,'\"></span>')},tag:function(t,e){var i=e.settings;return'<tag title=\"'.concat(t.title||t.value,\"\\\"\\n                    contenteditable='false'\\n                    tabIndex=\\\"\").concat(i.a11y.focusableTags?0:-1,'\"\\n                    class=\"').concat(i.classNames.tag,\" \").concat(t.class||\"\",'\"\\n                    ').concat(this.getAttributes(t),\">\\n            <x title='' tabIndex=\\\"\").concat(i.a11y.focusableTags?0:-1,'\" class=\"').concat(i.classNames.tagX,\"\\\" role='button' aria-label='remove tag'></x>\\n            <div>\\n                <span \").concat(\"select\"===i.mode&&i.userInput?\"contenteditable='true'\":\"\",' autocapitalize=\"false\" autocorrect=\"off\" spellcheck=\\'false\\' class=\"').concat(i.classNames.tagText,'\">').concat(t[i.tagTextProp]||t.value,\"</span>\\n            </div>\\n        </tag>\")},dropdown:function(t){var e=t.dropdown,i=\"manual\"==e.position;return'<div class=\"'.concat(i?\"\":t.classNames.dropdown,\" \").concat(e.classname,'\" role=\"listbox\" aria-labelledby=\"dropdown\" dir=\"').concat(e.RTL?\"rtl\":\"\",\"\\\">\\n                    <div data-selector='tagify-suggestions-wrapper' class=\\\"\").concat(t.classNames.dropdownWrapper,'\"></div>\\n                </div>')},dropdownContent:function(t){var e=this.settings.templates,i=this.state.dropdown.suggestions;return\"\\n            \".concat(e.dropdownHeader.call(this,i),\"\\n            \").concat(t,\"\\n            \").concat(e.dropdownFooter.call(this,i),\"\\n        \")},dropdownItem:function(t){return\"<div \".concat(this.getAttributes(t),\"\\n                    class='\").concat(this.settings.classNames.dropdownItem,\" \").concat(this.isTagDuplicate(t.value)?this.settings.classNames.dropdownItemSelected:\"\",\" \").concat(t.class||\"\",'\\'\\n                    tabindex=\"0\"\\n                    role=\"option\">').concat(t.mappedValue||t.value,\"</div>\")},dropdownHeader:function(t){return\"<header data-selector='tagify-suggestions-header' class=\\\"\".concat(this.settings.classNames.dropdownHeader,'\"></header>')},dropdownFooter:function(t){var e=t.length-this.settings.dropdown.maxItems;return e>0?\"<footer data-selector='tagify-suggestions-footer' class=\\\"\".concat(this.settings.classNames.dropdownFooter,'\">\\n                ').concat(e,\" more items. Refine your search.\\n            </footer>\"):\"\"},dropdownItemNoMatch:null};function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function V(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function F(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=i){var n,s,a=[],o=!0,r=!1;try{for(i=i.call(t);!(o=(n=i.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){r=!0,s=t}finally{try{o||null==i.return||i.return()}finally{if(r)throw s}}return a}}(t,e)||function(t,e){if(!t)return;if(\"string\"==typeof t)return P(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return P(t,e)}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function H(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function B(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function W(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})),t}function K(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return R(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return R(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}var U={customBinding:function(){var t=this;this.customEventsList.forEach((function(e){t.on(e,t.settings.callbacks[e])}))},binding:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this.settings,n=this.events.callbacks,s=e?\"addEventListener\":\"removeEventListener\";if(!this.state.mainEvents||!e){for(var a in this.state.mainEvents=e,e&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on(\"tagify.removeAllTags\",this.removeAllTags.bind(this))),t=this.listeners.main=this.listeners.main||{keydown:[\"input\",n.onKeydown.bind(this)],click:[\"scope\",n.onClickScope.bind(this)],dblclick:\"select\"!=i.mode&&[\"scope\",n.onDoubleClickScope.bind(this)],paste:[\"input\",n.onPaste.bind(this)],drop:[\"input\",n.onDrop.bind(this)],compositionstart:[\"input\",n.onCompositionStart.bind(this)],compositionend:[\"input\",n.onCompositionEnd.bind(this)]})t[a]&&this.DOM[t[a][0]][s](a,t[a][1]);var o=this.listeners.main.inputMutationObserver||new MutationObserver(n.onInputDOMChange.bind(this));o.disconnect(),\"mix\"==i.mode&&o.observe(this.DOM.input,{childList:!0}),this.events.bindOriginaInputListener.call(this)}},bindOriginaInputListener:function(t){var e=(t||0)+500;this.listeners.main&&(clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(this.events.callbacks.observeOriginalInputValue.bind(this),e))},bindGlobal:function(t){var e,i=this.events.callbacks,n=t?\"removeEventListener\":\"addEventListener\";if(this.listeners&&(t||!this.listeners.global)){this.listeners.global=this.listeners.global||[{type:this.isIE?\"keydown\":\"input\",target:this.DOM.input,cb:i[this.isIE?\"onInputIE\":\"onInput\"].bind(this)},{type:\"keydown\",target:window,cb:i.onWindowKeyDown.bind(this)},{type:\"focusin\",target:this.DOM.scope,cb:i.onFocusBlur.bind(this)},{type:\"focusout\",target:this.DOM.scope,cb:i.onFocusBlur.bind(this)},{type:\"click\",target:document,cb:i.onClickAnywhere.bind(this),useCapture:!0}];var s=!0,a=!1,o=void 0;try{for(var r,l=this.listeners.global[Symbol.iterator]();!(s=(r=l.next()).done);s=!0)(e=r.value).target[n](e.type,e.cb,!!e.useCapture)}catch(t){a=!0,o=t}finally{try{s||null==l.return||l.return()}finally{if(a)throw o}}}},unbindGlobal:function(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur:function(t){var e,i,n=this.settings,s=v.call(this,t.target),a=m.call(this,t.target),o=t.target.classList.contains(n.classNames.tagX),r=\"focusin\"==t.type,l=\"focusout\"==t.type;s&&r&&!a&&!o&&this.toggleFocusClass(this.state.hasFocus=+new Date);var d=t.target?this.trim(this.DOM.input.textContent):\"\",c=null===(i=this.value)||void 0===i||null===(e=i[0])||void 0===e?void 0:e[n.tagTextProp],u=n.dropdown.enabled>=0,g={relatedTarget:t.relatedTarget},h=this.state.actions.selectOption&&(u||!n.dropdown.closeOnSelect),p=this.state.actions.addNew&&u;if(l){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),n.onChangeAfterBlur&&this.triggerChangeEvent()}if(!(h||p||o))if(r||s?(this.state.hasFocus=+new Date,this.toggleFocusClass(this.state.hasFocus)):this.state.hasFocus=!1,\"mix\"!=n.mode){if(r){if(!n.focusable)return;var f=0===n.dropdown.enabled&&!this.state.dropdown.visible,b=!a||\"select\"===n.mode;return this.toggleFocusClass(!0),this.trigger(\"focus\",g),void(f&&b&&this.dropdown.show(this.value.length?\"\":void 0))}if(l){if(this.trigger(\"blur\",g),this.loading(!1),\"select\"==n.mode){if(this.value.length){var w=this.getTagElms()[0];d=this.trim(w.textContent)}c===d&&(d=\"\")}d&&!this.state.actions.selectOption&&n.addTagOnBlur&&n.addTagOn.includes(\"blur\")&&this.addTags(d,!0)}s||(this.DOM.input.removeAttribute(\"style\"),this.dropdown.hide())}else r?this.trigger(\"focus\",g):l&&(this.trigger(\"blur\",g),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart:function(t){this.state.composing=!0},onCompositionEnd:function(t){this.state.composing=!1},onWindowKeyDown:function(t){var e,i=this.settings,n=document.activeElement,s=v.call(this,n)&&this.DOM.scope.contains(document.activeElement),a=s&&n.hasAttribute(\"readonly\");if(this.state.hasFocus||s&&!a){e=n.nextElementSibling;var o=t.target.classList.contains(i.classNames.tagX);switch(t.key){case\"Backspace\":i.readonly||this.state.editing||(this.removeTags(n),(e||this.DOM.input).focus());break;case\"Enter\":if(o)return void this.removeTags(t.target.parentNode);i.a11y.focusableTags&&m.call(this,n)&&setTimeout(this.editTag.bind(this),0,n);break;case\"ArrowDown\":this.state.dropdown.visible||\"mix\"==i.mode||this.dropdown.show()}}},onKeydown:function(t){var e=this,i=this.settings;if(!this.state.composing&&i.userInput){\"select\"==i.mode&&i.enforceWhitelist&&this.value.length&&\"Tab\"!=t.key&&t.preventDefault();var n=this.trim(t.target.textContent);this.trigger(\"keydown\",{event:t}),i.hooks.beforeKeyDown(t,{tagify:this}).then((function(s){if(\"mix\"==i.mode){switch(t.key){case\"Left\":case\"ArrowLeft\":e.state.actions.ArrowLeft=!0;break;case\"Delete\":case\"Backspace\":if(e.state.editing)return;var a=document.getSelection(),o=\"Delete\"==t.key&&a.anchorOffset==(a.anchorNode.length||0),r=a.anchorNode.previousSibling,d=1==a.anchorNode.nodeType||!a.anchorOffset&&r&&1==r.nodeType&&a.anchorNode.previousSibling;!function(t){var e=document.createElement(\"div\");t.replace(/\\&#?[0-9a-z]+;/gi,(function(t){return e.innerHTML=t,e.innerText}))}(e.DOM.input.innerHTML);var c,u,g,h=e.getTagElms(),f=1===a.anchorNode.length&&a.anchorNode.nodeValue==String.fromCharCode(8203);if(\"edit\"==i.backspace&&d)return c=1==a.anchorNode.nodeType?null:a.anchorNode.previousElementSibling,setTimeout(e.editTag.bind(e),0,c),void t.preventDefault();if(p()&&B(d,Element))return g=l(d),d.hasAttribute(\"readonly\")||d.remove(),e.DOM.input.focus(),void setTimeout((function(){y(g),e.DOM.input.click()}));if(\"BR\"==a.anchorNode.nodeName)return;if((o||d)&&1==a.anchorNode.nodeType?u=0==a.anchorOffset?o?h[0]:null:h[Math.min(h.length,a.anchorOffset)-1]:o?u=a.anchorNode.nextElementSibling:B(d,Element)&&(u=d),3==a.anchorNode.nodeType&&!a.anchorNode.nodeValue&&a.anchorNode.previousElementSibling&&t.preventDefault(),(d||o)&&!i.backspace)return void t.preventDefault();if(\"Range\"!=a.type&&!a.anchorOffset&&a.anchorNode==e.DOM.input&&\"Delete\"!=t.key)return void t.preventDefault();if(\"Range\"!=a.type&&u&&u.hasAttribute(\"readonly\"))return void y(l(u));\"Delete\"==t.key&&f&&w(a.anchorNode.nextSibling)&&e.removeTags(a.anchorNode.nextSibling)}return!0}var m=\"manual\"==i.dropdown.position;switch(t.key){case\"Backspace\":\"select\"==i.mode&&i.enforceWhitelist&&e.value.length?e.removeTags():e.state.dropdown.visible&&\"manual\"!=i.dropdown.position||\"\"!=t.target.textContent&&8203!=n.charCodeAt(0)||(!0===i.backspace?e.removeTags():\"edit\"==i.backspace&&setTimeout(e.editTag.bind(e),0));break;case\"Esc\":case\"Escape\":if(e.state.dropdown.visible)return;t.target.blur();break;case\"Down\":case\"ArrowDown\":e.state.dropdown.visible||e.dropdown.show();break;case\"ArrowRight\":var v=e.state.inputSuggestion||e.state.ddItemData;if(v&&i.autoComplete.rightKey)return void e.addTags([v],!0);break;case\"Tab\":var b=\"select\"==i.mode;if(!n||b)return!0;t.preventDefault();case\"Enter\":if(e.state.dropdown.visible&&!m)return;t.preventDefault(),setTimeout((function(){e.state.dropdown.visible&&!m||e.state.actions.selectOption||!i.addTagOn.includes(t.key.toLowerCase())||e.addTags(n,!0)}))}})).catch((function(t){return t}))}},onInput:function(t){this.postUpdate();var e=this.settings;if(\"mix\"==e.mode)return this.events.callbacks.onMixTagsInput.call(this,t);var i=this.input.normalize.call(this,void 0,{trim:!1}),n=i.length>=e.dropdown.enabled,s={value:i,inputElm:this.DOM.input},a=this.validateTag({value:i});\"select\"==e.mode&&this.toggleScopeValidation(a),s.isValid=a,this.state.inputText!=i&&(this.input.set.call(this,i,!1),-1!=i.search(e.delimiters)?this.addTags(i)&&this.input.set.call(this):e.dropdown.enabled>=0&&this.dropdown[n?\"show\":\"hide\"](i),this.trigger(\"input\",s))},onMixTagsInput:function(t){var e,i,n,s,a,o,r,l,d=this,c=this.settings,g=this.value.length,h=this.getTagElms(),f=document.createDocumentFragment(),m=window.getSelection().getRangeAt(0),v=[].map.call(h,(function(t){return w(t).value}));if(\"deleteContentBackward\"==t.inputType&&p()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:\"Backspace\"}),T(this.getTagElms()),this.value.slice().forEach((function(t){t.readonly&&!v.includes(t.value)&&f.appendChild(d.createTagElem(t))})),f.childNodes.length&&(m.insertNode(f),this.setRangeAtStartEnd(!1,f.lastChild)),h.length!=g)return this.value=[].map.call(this.getTagElms(),(function(t){return w(t)})),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o=window.getSelection()).rangeCount>0&&3==o.anchorNode.nodeType){if((m=o.getRangeAt(0).cloneRange()).collapse(!0),m.setStart(o.focusNode,0),n=(e=m.toString().slice(0,m.endOffset)).split(c.pattern).length-1,(i=e.match(c.pattern))&&(s=e.slice(e.lastIndexOf(i[i.length-1]))),s){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:s.match(c.pattern)[0],value:s.replace(c.pattern,\"\")},this.state.tag.baseOffset=o.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(c.delimiters))return this.state.tag.value=this.state.tag.value.replace(c.delimiters,\"\"),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,c.dropdown.clearOnSelect),void this.dropdown.hide();a=this.state.tag.value.length>=c.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(t){}(r||n<this.state.mixMode.matchedPatternCount)&&(a=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=n}setTimeout((function(){d.update({withoutChangeEvent:!0}),d.trigger(\"input\",u({},d.state.tag,{textContent:d.DOM.input.textContent})),d.state.tag&&d.dropdown[a?\"show\":\"hide\"](d.state.tag.value)}),10)},onInputIE:function(t){var e=this;setTimeout((function(){e.events.callbacks.onInput.call(e,t)}))},observeOriginalInputValue:function(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere:function(t){t.target==this.DOM.scope||this.DOM.scope.contains(t.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1,t.target.closest(\".tagify__dropdown\")&&t.target.closest(\".tagify__dropdown\").__tagify!=this&&this.dropdown.hide())},onClickScope:function(t){var e=this.settings,i=t.target.closest(\".\"+e.classNames.tag),n=t.target===this.DOM.scope,s=+new Date-this.state.hasFocus;if(n&&\"select\"!=e.mode)this.DOM.input.focus();else{if(!t.target.classList.contains(e.classNames.tagX))return i&&!this.state.editing?(this.trigger(\"click\",{tag:i,index:this.getNodeIndex(i),data:w(i),event:t}),void(1!==e.editTags&&1!==e.editTags.clicks&&\"select\"!=e.mode||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&(\"mix\"==e.mode&&this.fixFirefoxLastTagNoCaret(),s>500||!e.focusable)?this.state.dropdown.visible?this.dropdown.hide():0===e.dropdown.enabled&&\"mix\"!=e.mode&&this.dropdown.show(this.value.length?\"\":void 0):\"select\"!=e.mode||0!==e.dropdown.enabled||this.state.dropdown.visible||(this.events.callbacks.onDoubleClickScope.call(this,W(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){H(t,e,i[e])}))}return t}({},t),{target:this.getTagElms()[0]})),!e.userInput&&this.dropdown.show()));this.removeTags(t.target.parentNode)}},onPaste:function(t){var e=this;t.preventDefault();var i,n,s,a=this.settings;if(\"select\"==a.mode&&a.enforceWhitelist||!a.userInput)return!1;a.readonly||(n=t.clipboardData||window.clipboardData,s=n.getData(\"Text\"),a.hooks.beforePaste(t,{tagify:this,pastedText:s,clipboardData:n}).then((function(a){void 0===a&&(a=s),a&&(e.injectAtCaret(a,window.getSelection().getRangeAt(0)),\"mix\"==e.settings.mode?e.events.callbacks.onMixTagsInput.call(e,t):e.settings.pasteAsTags?i=e.addTags(e.state.inputText+a,!0):(e.state.inputText=a,e.dropdown.show(a))),e.trigger(\"paste\",{event:t,pastedText:s,clipboardData:n,tagsElems:i})})).catch((function(t){return t})))},onDrop:function(t){t.preventDefault()},onEditTagInput:function(t,e){var i,n=t.closest(\".\"+this.settings.classNames.tag),s=this.getNodeIndex(n),a=w(n),o=this.input.normalize.call(this,t),r=(H(i={},this.settings.tagTextProp,o),H(i,\"__tagId\",a.__tagId),i),l=this.validateTag(r);this.editTagChangeDetected(u(a,r))||!0!==t.originalIsValid||(l=!0),n.classList.toggle(this.settings.classNames.tagInvalid,!0!==l),a.__isValid=l,n.title=!0===l?a.title||a.value:l,o.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=o),this.dropdown.show(o)),this.trigger(\"edit:input\",{tag:n,index:s,data:u({},this.value[s],{newValue:o}),event:e})},onEditTagPaste:function(t,e){var i=(e.clipboardData||window.clipboardData).getData(\"Text\");e.preventDefault();var n=b(i);this.setRangeAtStartEnd(!1,n)},onEditTagClick:function(t,e){this.events.callbacks.onClickScope.call(this,e)},onEditTagFocus:function(t){this.state.editing={scope:t,input:t.querySelector(\"[contenteditable]\")}},onEditTagBlur:function(t,e){var i=m.call(this,e.relatedTarget);if(\"select\"==this.settings.mode&&i&&e.relatedTarget.contains(e.target))this.dropdown.hide();else if(this.state.editing&&(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t))){var n,s,a,o=this.settings,r=t.closest(\".\"+o.classNames.tag),l=w(r),d=this.input.normalize.call(this,t),c=(H(n={},o.tagTextProp,d),H(n,\"__tagId\",l.__tagId),n),g=l.__originalData,h=this.editTagChangeDetected(u(l,c)),p=this.validateTag(c);if(d)if(h){var f;if(s=this.hasMaxTags(),a=u({},g,(H(f={},o.tagTextProp,this.trim(d)),H(f,\"__isValid\",p),f)),o.transformTag.call(this,a,g),!0!==(p=(!s||!0===g.__isValid)&&this.validateTag(a))){if(this.trigger(\"invalid\",{data:a,tag:r,message:p}),o.editTags.keepInvalid)return;o.keepInvalidTags?a.__isValid=p:a=g}else o.keepInvalidTags&&(delete a.title,delete a[\"aria-invalid\"],delete a.class);this.onEditTagDone(r,a)}else this.onEditTagDone(r,g);else this.onEditTagDone(r)}},onEditTagkeydown:function(t,e){if(!this.state.composing)switch(this.trigger(\"edit:keydown\",{event:t}),t.key){case\"Esc\":case\"Escape\":this.state.editing=!1,!!e.__tagifyTagData.__originalData.value?e.parentNode.replaceChild(e.__tagifyTagData.__originalHTML,e):e.remove();break;case\"Enter\":case\"Tab\":t.preventDefault();setTimeout((function(){return t.target.blur()}),0)}},onDoubleClickScope:function(t){var e,i,n=t.target.closest(\".\"+this.settings.classNames.tag),s=w(n),a=this.settings;n&&!1!==s.editable&&(e=n.classList.contains(this.settings.classNames.tagEditing),i=n.hasAttribute(\"readonly\"),a.readonly||e||i||!this.settings.editTags||!a.userInput||(this.events.callbacks.onEditTagFocus.call(this,n),this.editTag(n)),this.toggleFocusClass(!0),\"select\"!=a.mode&&this.trigger(\"dblclick\",{tag:n,index:this.getNodeIndex(n),data:w(n)}))},onInputDOMChange:function(t){var e=this;t.forEach((function(t){t.addedNodes.forEach((function(t){if(\"<div><br></div>\"==t.outerHTML)t.replaceWith(document.createElement(\"br\"));else if(1==t.nodeType&&t.querySelector(e.settings.classNames.tagSelector)){var i,n=document.createTextNode(\"\");3==t.childNodes[0].nodeType&&\"BR\"!=t.previousSibling.nodeName&&(n=document.createTextNode(\"\\n\")),(i=t).replaceWith.apply(i,K([n].concat(K(K(t.childNodes).slice(0,-1))))),y(n)}else if(m.call(e,t)){var s;if(3!=(null===(s=t.previousSibling)||void 0===s?void 0:s.nodeType)||t.previousSibling.textContent||t.previousSibling.remove(),t.previousSibling&&\"BR\"==t.previousSibling.nodeName){t.previousSibling.replaceWith(\"\\n\");for(var a=t.nextSibling,o=\"\";a;)o+=a.textContent,a=a.nextSibling;o.trim()&&y(t.previousSibling)}else t.previousSibling&&!w(t.previousSibling)||t.before(\"\")}})),t.removedNodes.forEach((function(t){t&&\"BR\"==t.nodeName&&m.call(e,i)&&(e.removeTags(i),e.fixFirefoxLastTagNoCaret())}))}));var i=this.DOM.input.lastChild;i&&\"\"==i.nodeValue&&i.remove(),i&&\"BR\"==i.nodeName||this.DOM.input.appendChild(document.createElement(\"br\"))}}};function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function X(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function J(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){z(t,e,i[e])}))}return t}function G(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return q(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return q(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function $(t,e){if(!t){n.warn(\"input element not found\",t);var i=new Proxy(this,{get:function(){return function(){return i}}});return i}if(t.__tagify)return n.warn(\"input element is already Tagified - Same instance is returned.\",t),t.__tagify;var s;u(this,function(t){var e=document.createTextNode(\"\"),i={};function s(t,i,n){n&&i.split(/\\s+/g).forEach((function(i){return e[t+\"EventListener\"].call(e,i,n)}))}return{removeAllCustomListeners:function(){Object.entries(i).forEach((function(t){var e=F(t,2),i=e[0];e[1].forEach((function(t){return s(\"remove\",i,t)}))})),i={}},off:function(t,e){return t&&(e?s(\"remove\",t,e):t.split(/\\s+/g).forEach((function(t){var e;null===(e=i[t])||void 0===e||e.forEach((function(e){return s(\"remove\",t,e)})),delete i[t]}))),this},on:function(t,e){return e&&\"function\"==typeof e&&(t.split(/\\s+/g).forEach((function(t){Array.isArray(i[t])?i[t].push(e):i[t]=[e]})),s(\"add\",t,e)),this},trigger:function(i,s,a){var o;if(a=a||{cloneData:!0},i)if(t.settings.isJQueryPlugin)\"remove\"==i&&(i=\"removeTag\"),jQuery(t.DOM.originalInput).triggerHandler(i,[s]);else{try{var r=\"object\"==typeof s?s:{value:s};if((r=a.cloneData?u({},r):r).tagify=this,s.event&&(r.event=this.cloneEvent(s.event)),V(s,Object))for(var l in s)V(s[l],HTMLElement)&&(r[l]=s[l]);o=new CustomEvent(i,{detail:r})}catch(t){n.warn(t)}e.dispatchEvent(o)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e=e||{},this.getPersistedData=(s=e.id,function(t){var e,i=\"/\"+t;if(1==localStorage.getItem(k+s+\"/v\",1))try{e=JSON.parse(localStorage[k+s+i])}catch(t){}return e}),this.setPersistedData=function(t){return t?(localStorage.setItem(k+t+\"/v\",1),function(e,i){var n=\"/\"+i,s=JSON.stringify(e);e&&i&&(localStorage.setItem(k+t+n,s),dispatchEvent(new Event(\"storage\")))}):function(){}}(e.id),this.clearPersistedData=function(t){return function(e){var i=k+\"/\"+t+\"/\";if(e)localStorage.removeItem(i+e);else for(var n in localStorage)n.includes(i)&&localStorage.removeItem(n)}}(e.id),this.applySettings(t,e),this.state={inputText:\"\",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),N.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t.autofocus&&this.DOM.input.focus(),t.__tagify=this}$.prototype={_dropdown:C,placeCaretAfterNode:y,getSetTagData:w,helpers:{sameStr:s,removeCollectionProp:a,omit:o,isObject:c,parseHTML:r,escapeHTML:d,extend:u,concatWithoutDups:g,getUID:f,isNodeTag:m},customEventsList:[\"change\",\"add\",\"remove\",\"invalid\",\"input\",\"paste\",\"click\",\"keydown\",\"focus\",\"blur\",\"edit:input\",\"edit:beforeUpdate\",\"edit:updated\",\"edit:start\",\"edit:keydown\",\"dropdown:show\",\"dropdown:hide\",\"dropdown:select\",\"dropdown:updated\",\"dropdown:noMatch\",\"dropdown:scroll\"],dataProps:[\"__isValid\",\"__removed\",\"__originalData\",\"__originalHTML\",\"__tagId\"],trim:function(t){return this.settings.trim&&t&&\"string\"==typeof t?t.trim():t},parseHTML:r,templates:j,parseTemplate:function(t,e){return r((t=this.settings.templates[t]||t).apply(this,e))},set whitelist(t){var e=t&&Array.isArray(t);this.settings.whitelist=e?t:[],this.setPersistedData(e?t:[],\"whitelist\")},get whitelist(){return this.settings.whitelist},set userInput(t){this.settings.userInput=!!t,this.setContentEditable(!!t)},get userInput(){return this.settings.userInput},generateClassSelectors:function(t){var e=function(e){var i=e;Object.defineProperty(t,i+\"Selector\",{get:function(){return\".\"+this[i].split(\" \")[0]}})};for(var i in t)e(i)},applySettings:function(t,e){var i,n;O.templates=this.templates;var s=u({},O,\"mix\"==e.mode?{dropdown:{position:\"text\"}}:{}),a=this.settings=u({},s,e);if(a.disabled=t.hasAttribute(\"disabled\"),a.readonly=a.readonly||t.hasAttribute(\"readonly\"),a.placeholder=d(t.getAttribute(\"placeholder\")||a.placeholder||\"\"),a.required=t.hasAttribute(\"required\"),this.generateClassSelectors(a.classNames),void 0===a.dropdown.includeSelectedTags&&(a.dropdown.includeSelectedTags=a.duplicates),this.isIE&&(a.autoComplete=!1),[\"whitelist\",\"blacklist\"].forEach((function(e){var i=t.getAttribute(\"data-\"+e);i&&X(i=i.split(a.delimiters),Array)&&(a[e]=i)})),\"autoComplete\"in e&&!c(e.autoComplete)&&(a.autoComplete=O.autoComplete,a.autoComplete.enabled=e.autoComplete),\"mix\"==a.mode&&(a.pattern=a.pattern||/@/,a.autoComplete.rightKey=!0,a.delimiters=e.delimiters||null,a.tagTextProp&&!a.dropdown.searchKeys.includes(a.tagTextProp)&&a.dropdown.searchKeys.push(a.tagTextProp)),t.pattern)try{a.pattern=new RegExp(t.pattern)}catch(t){}if(a.delimiters){a._delimiters=a.delimiters;try{a.delimiters=new RegExp(this.settings.delimiters,\"g\")}catch(t){}}a.disabled&&(a.userInput=!1),this.TEXTS=J({},L,a.texts||{}),(\"select\"!=a.mode||(null===(i=e.dropdown)||void 0===i?void 0:i.enabled))&&a.userInput||(a.dropdown.enabled=0),a.dropdown.appendTarget=(null===(n=e.dropdown)||void 0===n?void 0:n.appendTarget)||document.body;var o=this.getPersistedData(\"whitelist\");Array.isArray(o)&&(this.whitelist=Array.isArray(a.whitelist)?g(a.whitelist,o):o)},getAttributes:function(t){var e,i=this.getCustomAttributes(t),n=\"\";for(e in i)n+=\" \"+e+(void 0!==t[e]?'=\"'.concat(i[e],'\"'):\"\");return n},getCustomAttributes:function(t){if(!c(t))return\"\";var e,i={};for(e in t)\"__\"!=e.slice(0,2)&&\"class\"!=e&&t.hasOwnProperty(e)&&void 0!==t[e]&&(i[e]=d(t[e]));return i},setStateSelection:function(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCSSVars:function(){var t,e,i,n=getComputedStyle(this.DOM.scope,null);this.CSSVars={tagHideTransition:(t=function(t){if(!t)return{};var e=(t=t.trim().split(\" \")[0]).split(/\\d+/g).filter((function(t){return t})).pop().trim();return{value:+t.split(e).filter((function(t){return t}))[0].trim(),unit:e}}((i=\"tag-hide-transition\",n.getPropertyValue(\"--\"+i))),e=t.value,\"s\"==t.unit?1e3*e:e)}},build:function(t){var e=this.DOM,i=t.closest(\"label\");this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.originalInput_tabIndex=t.tabIndex,e.scope=this.parseTemplate(\"wrapper\",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t),t.tabIndex=-1),i&&i.setAttribute(\"for\",\"\")},destroy:function(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),this.removeAllCustomListeners(),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues:function(t){var e,i=this.settings;if(this.state.blockChangeEvent=!0,void 0===t){var n=this.getPersistedData(\"value\");t=n&&!this.DOM.originalInput.value?n:i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t)if(\"mix\"==i.mode)this.parseMixTags(t),(e=this.DOM.input.lastChild)&&\"BR\"==e.tagName||this.DOM.input.insertAdjacentHTML(\"beforeend\",\"<br>\");else{try{X(JSON.parse(t),Array)&&(t=JSON.parse(t))}catch(t){}this.addTags(t,!0).forEach((function(t){return t&&t.classList.add(i.classNames.tagNoAnimation)}))}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?\"\":this.DOM.originalInput.value},cloneEvent:function(t){var e={};for(var i in t)\"path\"!=i&&(e[i]=t[i]);return e},loading:function(t){return this.state.isLoading=t,this.DOM.scope.classList[t?\"add\":\"remove\"](this.settings.classNames.scopeLoading),this},tagLoading:function(t,e){return t&&t.classList[e?\"add\":\"remove\"](this.settings.classNames.tagLoading),this},toggleClass:function(t,e){\"string\"==typeof t&&this.DOM.scope.classList.toggle(t,e)},toggleScopeValidation:function(t){var e=!0===t||void 0===t;!this.settings.required&&t&&t===this.TEXTS.empty&&(e=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e),this.DOM.scope.title=e?\"\":t},toggleFocusClass:function(t){this.toggleClass(this.settings.classNames.focus,!!t)},setPlaceholder:function(t){var e=this;[\"data\",\"aria\"].forEach((function(i){return e.DOM.input.setAttribute(\"\".concat(i,\"-placeholder\"),t)}))},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,i=new CustomEvent(\"change\",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,i.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(i),this.trigger(\"change\",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:U,fixFirefoxLastTagNoCaret:function(){},setRangeAtStartEnd:function(t,e){if(e){t=\"number\"==typeof t?t:!!t,e=e.lastChild||e;var i=document.getSelection();if(X(i.focusNode,Element)&&!this.DOM.input.contains(i.focusNode))return!0;try{i.rangeCount>=1&&[\"Start\",\"End\"].forEach((function(n){return i.getRangeAt(0)[\"set\"+n](e,t||e.length)}))}catch(t){console.warn(t)}}},insertAfterTag:function(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e=\"string\"==typeof e?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTagChangeDetected:function(t){var e=t.__originalData;for(var i in e)if(!this.dataProps.includes(i)&&t[i]!=e[i])return!0;return!1},getTagTextNode:function(t){return t.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode:function(t,e){this.getTagTextNode(t).innerHTML=d(e)},editTag:function(t,e){var i=this;t=t||this.getLastTag(),e=e||{};var s=this.settings,a=this.getTagTextNode(t),o=this.getNodeIndex(t),r=w(t),l=this.events.callbacks,d=!0,c=\"select\"==s.mode;if(!c&&this.dropdown.hide(),a){if(!X(r,Object)||!(\"editable\"in r)||r.editable)return r=w(t,{__originalData:u({},r),__originalHTML:t.cloneNode(!0)}),w(r.__originalHTML,r.__originalData),a.setAttribute(\"contenteditable\",!0),t.classList.add(s.classNames.tagEditing),this.events.callbacks.onEditTagFocus.call(this,t),a.addEventListener(\"click\",l.onEditTagClick.bind(this,t)),a.addEventListener(\"blur\",l.onEditTagBlur.bind(this,this.getTagTextNode(t))),a.addEventListener(\"input\",l.onEditTagInput.bind(this,a)),a.addEventListener(\"paste\",l.onEditTagPaste.bind(this,a)),a.addEventListener(\"keydown\",(function(e){return l.onEditTagkeydown.call(i,e,t)})),a.addEventListener(\"compositionstart\",l.onCompositionStart.bind(this)),a.addEventListener(\"compositionend\",l.onCompositionEnd.bind(this)),e.skipValidation||(d=this.editTagToggleValidity(t)),a.originalIsValid=d,this.trigger(\"edit:start\",{tag:t,index:o,data:r,isValid:d}),a.focus(),!c&&this.setRangeAtStartEnd(!1,a),0===s.dropdown.enabled&&!c&&this.dropdown.show(),this.state.hasFocus=!0,this}else n.warn(\"Cannot find element in Tag template: .\",s.classNames.tagTextSelector)},editTagToggleValidity:function(t,e){var i;if(e=e||w(t))return(i=!(\"__isValid\"in e)||!0===e.__isValid)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!i),e.__isValid=i,e.__isValid;n.warn(\"tag has no data: \",t,e)},onEditTagDone:function(t,e){t=t||this.state.editing.scope,e=e||{};var i,n,s={tag:t,index:this.getNodeIndex(t),previousData:w(t),data:e},a=this.settings;this.trigger(\"edit:beforeUpdate\",s,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&(void 0!==(n=e[a.tagTextProp])?null===(i=(n+=\"\").trim)||void 0===i?void 0:i.call(n):a.tagTextProp in e?void 0:e.value)?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),a.a11y.focusableTags?t.focus():\"select\"!=a.mode&&y(t)):t&&this.removeTags(t),this.trigger(\"edit:updated\",s),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag:function(t,e){e&&\"\"!==e.value&&void 0!==e.value||(e=t.__tagifyTagData),e.__isValid&&1!=e.__isValid&&u(e,this.getInvalidTagAttrs(e,e.__isValid));var i=this.createTagElem(e);return t.parentNode.replaceChild(i,t),this.updateValueByDOMTags(),i},updateValueByDOMTags:function(){var t=this;this.value.length=0;var e=this.settings.classNames,i=[e.tagNotAllowed.split(\" \")[0],e.tagHide];[].forEach.call(this.getTagElms(),(function(e){G(e.classList).some((function(t){return i.includes(t)}))||t.value.push(w(e))})),this.update()},injectAtCaret:function(t,e){var i;if(e=e||(null===(i=this.state.selection)||void 0===i?void 0:i.range),\"string\"==typeof t&&(t=document.createTextNode(t)),!e&&t)return this.appendMixTags(t),this;var n=b(t,e);return this.setRangeAtStartEnd(!1,n),this.updateValueByDOMTags(),this.update(),this},input:{set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.settings,n=i.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=d(\"\"+t),t&&this.toggleClass(i.classNames.empty,!this.DOM.input.innerHTML)),!t&&n&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw:function(){return this.DOM.input.textContent},validate:function(){var t=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize:function(t,e){var i=t||this.DOM.input,n=[];i.childNodes.forEach((function(t){return 3==t.nodeType&&n.push(t.nodeValue)})),n=n.join(\"\\n\");try{n=n.replace(/(?:\\r\\n|\\r|\\n)/g,this.settings.delimiters.source.charAt(0))}catch(t){}return n=n.replace(/\\s/g,\" \"),(null==e?void 0:e.trim)?this.trim(n):n},autocomplete:{suggest:function(t){if(this.settings.autoComplete.enabled){\"object\"!=typeof(t=t||{value:\"\"})&&(t={value:t});var e=this.dropdown.getMappedValue(t);if(\"number\"!=typeof e){var i=this.state.inputText.toLowerCase(),n=e.substr(0,this.state.inputText.length).toLowerCase(),s=e.substring(this.state.inputText.length);e&&this.state.inputText&&n==i?(this.DOM.input.setAttribute(\"data-suggest\",s),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute(\"data-suggest\"),delete this.state.inputSuggestion)}}},set:function(t){var e=this.DOM.input.getAttribute(\"data-suggest\"),i=t||(e?this.state.inputText+e:null);return!!i&&(\"mix\"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx:function(t){return this.value.findIndex((function(e){return e.__tagId==(t||{}).__tagId}))},getNodeIndex:function(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=\".\"+G(this.settings.classNames.tag.split(\" \")).concat(G(e)).join(\".\");return[].slice.call(this.DOM.scope.querySelectorAll(n))},getLastTag:function(){var t=this.settings.classNames,e=this.DOM.scope.querySelectorAll(\"\".concat(t.tagSelector,\":not(.\").concat(t.tagHide,\"):not([readonly])\"));return e[e.length-1]},isTagDuplicate:function(t,e,i){var n=0,a=!0,o=!1,r=void 0;try{for(var l,d=this.value[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var c=l.value;s(this.trim(\"\"+t),c.value,e)&&i!=c.__tagId&&n++}}catch(t){o=!0,r=t}finally{try{a||null==d.return||d.return()}finally{if(o)throw r}}return n},getTagIndexByValue:function(t){var e=this,i=[],n=this.settings.dropdown.caseSensitive;return this.getTagElms().forEach((function(a,o){a.__tagifyTagData&&s(e.trim(a.__tagifyTagData.value),t,n)&&i.push(o)})),i},getTagElmByValue:function(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag:function(t){var e=this;t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout((function(){t.classList.remove(e.settings.classNames.tagFlash)}),100))},isTagBlacklisted:function(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter((function(e){return(\"\"+e).toLowerCase()==t})).length},isTagWhitelisted:function(t){return!!this.getWhitelistItem(t)},getWhitelistItem:function(t,e,i){e=e||\"value\";var n,a=this.settings;return(i=i||a.whitelist).some((function(i){var o=\"object\"==typeof i?i[e]||i.value:i;if(s(o,t,a.dropdown.caseSensitive,a.trim))return n=\"object\"==typeof i?i:{value:i},!0})),n||\"value\"!=e||\"value\"==a.tagTextProp||(n=this.getWhitelistItem(t,a.tagTextProp,i)),n},validateTag:function(t){var e=this.settings,i=\"value\"in t?\"value\":e.tagTextProp,n=this.trim(t[i]+\"\");return(t[i]+\"\").trim()?\"mix\"!=e.mode&&e.pattern&&X(e.pattern,RegExp)&&!e.pattern.test(n)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(n,e.dropdown.caseSensitive,t.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(n)||e.enforceWhitelist&&!this.isTagWhitelisted(n)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs:function(t,e){return{\"aria-invalid\":!0,class:\"\".concat(t.class||\"\",\" \").concat(this.settings.classNames.tagNotAllowed).trim(),title:e}},hasMaxTags:function(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly:function(t,e){var i=this.settings;this.DOM.scope.contains(document.activeElement)&&document.activeElement.blur(),i[e||\"readonly\"]=t,this.DOM.scope[(t?\"set\":\"remove\")+\"Attribute\"](e||\"readonly\",!0),this.settings.userInput=!0,this.setContentEditable(!t)},setContentEditable:function(t){this.DOM.input.contentEditable=t,this.DOM.input.tabIndex=t?0:-1},setDisabled:function(t){this.setReadonly(t,\"disabled\")},normalizeTags:function(t){var e=this,i=this.settings,n=i.whitelist,s=i.delimiters,a=i.mode,o=i.tagTextProp,r=[],l=!!n&&X(n[0],Object),d=Array.isArray(t),g=d&&t[0].value,h=function(t){return(t+\"\").split(s).reduce((function(t,i){var n,s=e.trim(i);return s&&t.push((z(n={},o,s),z(n,\"value\",s),n)),t}),[])};if(\"number\"==typeof t&&(t=t.toString()),\"string\"==typeof t){if(!t.trim())return[];t=h(t)}else d&&(t=t.reduce((function(t,i){if(c(i)){var n=u({},i);o in n||(o=\"value\"),n[o]=e.trim(n[o]),(n[o]||0===n[o])&&t.push(n)}else if(i){var s;(s=t).push.apply(s,G(h(i)))}return t}),[]));return l&&!g&&(t.forEach((function(t){var i=r.map((function(t){return t.value})),n=e.dropdown.filterListItems.call(e,t[o],{exact:!0});e.settings.duplicates||(n=n.filter((function(t){return!i.includes(t.value)})));var s=n.length>1?e.getWhitelistItem(t[o],o,n):n[0];s&&X(s,Object)?r.push(s):\"mix\"!=a&&(null==t.value&&(t.value=t[o]),r.push(t))})),r.length&&(t=r)),t},parseMixTags:function(t){var e=this,i=this.settings,n=i.mixTagsInterpolator,s=i.duplicates,a=i.transformTag,o=i.enforceWhitelist,r=i.maxTags,l=i.tagTextProp,d=[];t=t.split(n[0]).map((function(t,i){var c,u,g,h=t.split(n[1]),p=h[0],f=d.length==r;try{if(p==+p)throw Error;u=JSON.parse(p)}catch(t){u=e.normalizeTags(p)[0]||{value:p}}if(a.call(e,u),f||!(h.length>1)||o&&!e.isTagWhitelisted(u.value)||!s&&e.isTagDuplicate(u.value)){if(t)return i?n[0]+t:t}else u[c=u[l]?l:\"value\"]=e.trim(u[c]),g=e.createTagElem(u),d.push(u),g.classList.add(e.settings.classNames.tagNoAnimation),h[0]=g.outerHTML,e.value.push(u);return h.join(\"\")})).join(\"\"),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode(\"\")),this.DOM.input.normalize();var c=this.getTagElms();return c.forEach((function(t,e){return w(t,d[e])})),this.update({withoutChangeEvent:!0}),T(c,this.state.hasFocus),t},replaceTextWithNode:function(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var i,n,s=this.state.selection||window.getSelection(),a=s.anchorNode,o=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return a.splitText(s.anchorOffset-o),-1==(i=a.nodeValue.lastIndexOf(e))?!0:(n=a.splitText(i),t&&a.parentNode.replaceChild(t,n),!0)}},prepareNewTagNode:function(t,e){e=e||{};var i=this.settings,n=[],s={},a=Object.assign({},t,{value:t.value+\"\"});if(t=Object.assign({},a),i.transformTag.call(this,t),t.__isValid=this.hasMaxTags()||this.validateTag(t),!0!==t.__isValid){if(e.skipInvalid)return;if(u(s,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:a}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value)),!i.createInvalidTags)return void n.push(t.value)}return\"readonly\"in t&&(t.readonly?s[\"aria-readonly\"]=!0:delete t.readonly),{tagElm:this.createTagElem(t,s),tagData:t,aggregatedInvalidInput:n}},postProcessNewTagNode:function(t,e){var i=this,n=this.settings,s=e.__isValid;s&&!0===s?this.value.push(e):(this.trigger(\"invalid\",{data:e,index:this.value.length,tag:t,message:s}),n.keepInvalidTags||setTimeout((function(){return i.removeTags(t,!0)}),1e3)),this.dropdown.position()},selectTag:function(t,e){var i=this;if(!this.settings.enforceWhitelist||this.isTagWhitelisted(e.value)){this.state.actions.selectOption&&setTimeout((function(){return i.setRangeAtStartEnd(!1,i.DOM.input)}));var n=this.getLastTag();return n?this.replaceTag(n,e):this.appendTag(t),this.value[0]=e,this.update(),this.trigger(\"add\",{tag:t,data:e}),[t]}},addEmptyTag:function(t){var e=u({value:\"\"},t||{}),i=this.createTagElem(e);w(i,e),this.appendTag(i),this.editTag(i,{skipValidation:!0}),this.toggleFocusClass(!0)},addTags:function(t,e,i){var n=this,s=[],a=this.settings,o=[],r=document.createDocumentFragment(),l=[];if(!t||0==t.length)return s;switch(t=this.normalizeTags(t),a.mode){case\"mix\":return this.addMixTags(t);case\"select\":e=!1,this.removeAllTags()}return this.DOM.input.removeAttribute(\"style\"),t.forEach((function(t){var e=n.prepareNewTagNode(t,{skipInvalid:i||a.skipInvalid});if(e){var d=e.tagElm;if(t=e.tagData,o=e.aggregatedInvalidInput,s.push(d),\"select\"==a.mode)return n.selectTag(d,t);r.appendChild(d),n.postProcessNewTagNode(d,t),l.push({tagElm:d,tagData:t})}})),this.appendTag(r),l.forEach((function(t){var e=t.tagElm,i=t.tagData;return n.trigger(\"add\",{tag:e,index:n.getTagIdx(i),data:i})})),this.update(),t.length&&e&&(this.input.set.call(this,a.createInvalidTags?\"\":o.join(a._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),this.dropdown.refilter(),s},addMixTags:function(t){var e=this;if((t=this.normalizeTags(t))[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);var i=document.createDocumentFragment();return t.forEach((function(t){var n=e.prepareNewTagNode(t);i.appendChild(n.tagElm),e.insertAfterTag(n.tagElm),e.postProcessNewTagNode(n.tagElm,n.tagData)})),this.appendMixTags(i),i.children},appendMixTags:function(t){var e=!!this.state.selection;e?this.injectAtCaret(t):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(t),this.updateValueByDOMTags(),this.update())},prefixedTextToTag:function(t){var e,i,n,s=this,a=this.settings,o=null===(e=this.state.tag)||void 0===e?void 0:e.delimiters;if(t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(a.pattern.source||a.pattern)[0],n=this.prepareNewTagNode(t),i=n.tagElm,this.replaceTextWithNode(i)||this.DOM.input.appendChild(i),setTimeout((function(){return i.classList.add(s.settings.classNames.tagNoAnimation)}),300),this.update(),!o){var r=this.insertAfterTag(i)||i;setTimeout(y,0,r)}return this.state.tag=null,this.postProcessNewTagNode(i,n.tagData),i},appendTag:function(t){var e=this.DOM,i=e.input;e.scope.insertBefore(t,i)},createTagElem:function(t,e){t.__tagId=f();var i,n=u({},t,J({value:d(t.value+\"\")},e));return function(t){for(var e,i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);e=i.nextNode();)e.textContent.trim()||e.parentNode.removeChild(e)}(i=this.parseTemplate(\"tag\",[n,this])),w(i,t),i},reCheckInvalidTags:function(){var t=this,e=this.settings;this.getTagElms(e.classNames.tagNotAllowed).forEach((function(i,n){var s=w(i),a=t.hasMaxTags(),o=t.validateTag(s),r=!0===o&&!a;if(\"select\"==e.mode&&t.toggleScopeValidation(o),r)return s=s.__preInvalidData?s.__preInvalidData:{value:s.value},t.replaceTag(i,s);i.title=a||o}))},removeTags:function(t,e,i){var n,s=this,a=this.settings;if(t=t&&X(t,HTMLElement)?[t]:X(t,Array)?t:t?[t]:[this.getLastTag()].filter((function(t){return t})),n=t.reduce((function(t,e){e&&\"string\"==typeof e&&(e=s.getTagElmByValue(e));var i=w(e);return e&&i&&!i.readonly&&t.push({node:e,idx:s.getTagIdx(i),data:w(e,{__removed:!0})}),t}),[]),i=\"number\"==typeof i?i:this.CSSVars.tagHideTransition,\"select\"==a.mode&&(i=0,this.input.set.call(this)),1==n.length&&\"select\"!=a.mode&&n[0].node.classList.contains(a.classNames.tagNotAllowed)&&(e=!0),n.length)return a.hooks.beforeRemoveTag(n,{tagify:this}).then((function(){var t=function(t){t.node.parentNode&&(t.node.parentNode.removeChild(t.node),e?a.keepInvalidTags&&this.trigger(\"remove\",{tag:t.node,index:t.idx}):(this.trigger(\"remove\",{tag:t.node,index:t.idx,data:t.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a.keepInvalidTags&&this.reCheckInvalidTags()))};i&&i>10&&1==n.length?function(e){e.node.style.width=parseFloat(window.getComputedStyle(e.node).width)+\"px\",document.body.clientTop,e.node.classList.add(a.classNames.tagHide),setTimeout(t.bind(this),i,e)}.call(s,n[0]):n.forEach(t.bind(s)),e||(s.removeTagsFromValue(n.map((function(t){return t.node}))),s.update(),\"select\"==a.mode&&a.userInput&&s.setContentEditable(!0))})).catch((function(t){}))},removeTagsFromDOM:function(){this.getTagElms().forEach((function(t){return t.remove()}))},removeTagsFromValue:function(t){var e=this;(t=Array.isArray(t)?t:[t]).forEach((function(t){var i=w(t),n=e.getTagIdx(i);n>-1&&e.value.splice(n,1)}))},removeAllTags:function(t){var e=this;t=t||{},this.value=[],\"mix\"==this.settings.mode?this.DOM.input.innerHTML=\"\":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout((function(){e.DOM.input.focus()})),\"select\"==this.settings.mode&&(this.input.set.call(this),this.settings.userInput&&this.setContentEditable(!0)),this.update(t)},postUpdate:function(){this.state.blockChangeEvent=!1;var t,e,i=this.settings,n=i.classNames,s=\"mix\"==i.mode?i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;(this.toggleClass(n.hasMaxTags,this.value.length>=i.maxTags),this.toggleClass(n.hasNoTags,!this.value.length),this.toggleClass(n.empty,!s),\"select\"==i.mode)&&this.toggleScopeValidation(null===(e=this.value)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.__isValid)},setOriginalInputValue:function(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=t,e.tagifyValue=e.value,this.setPersistedData(t,\"value\"))},update:function(t){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout(function(){var e=this.getInputValue();this.setOriginalInputValue(e),this.settings.onChangeAfterBlur&&(t||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent();this.postUpdate()}.bind(this),100),this.events.bindOriginaInputListener.call(this,100)},getInputValue:function(){var t=this.getCleanValue();return\"mix\"==this.settings.mode?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):\"\"},getCleanValue:function(t){return a(t||this.value,this.dataProps)},getMixedTagsAsString:function(){var t=\"\",e=this,i=this.settings,n=i.originalInputValueFormat||JSON.stringify,s=i.mixTagsInterpolator;return function i(a){a.childNodes.forEach((function(a){if(1==a.nodeType){var r=w(a);if(\"BR\"==a.tagName&&(t+=\"\\r\\n\"),r&&m.call(e,a)){if(r.__removed)return;t+=s[0]+n(o(r,e.dataProps))+s[1]}else a.getAttribute(\"style\")||[\"B\",\"I\",\"U\"].includes(a.tagName)?t+=a.textContent:\"DIV\"!=a.tagName&&\"P\"!=a.tagName||(t+=\"\\r\\n\",i(a))}else t+=a.textContent}))}(this.DOM.input),t}},$.prototype.removeTag=$.prototype.removeTags;export{$ as default};\n//# sourceMappingURL=tagify.esm.js.map\r\n","import { MODULE, TEMPLATE } from \"../core/constants.mjs\";\nimport { Logger } from \"../core/utils.mjs\";\nimport DragSort from \"@yaireo/dragsort\";\nimport Tagify from \"@yaireo/tagify\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Tagify-based application\n */\nexport class TagifyApp extends HandlebarsApplicationMixin(ApplicationV2) {\n  constructor(data) {\n    super(data);\n    this.tagify = null;\n    this.dragSort = null;\n    this.content = data.content;\n    this.submit = data.submit;\n    this.categoryId = null;\n    this.subcategoryId = null;\n    this.options.window.title = data.title;\n  }\n\n  /* -------------------------------------------- */\n\n  static DEFAULT_OPTIONS = {\n    actions: {\n      resetActions: TagifyApp.resetActions,\n      unselectAllTags: TagifyApp.unselectAllTags\n    },\n    classes: [`${MODULE.ID}-app`, \"tah-dialog\", \"sheet\"],\n    id: \"token-action-hud-dialog\",\n    form: {\n      closeOnSubmit: true,\n      handler: TagifyApp.submit\n    },\n    position: {\n      width: 600,\n      height: 680\n    },\n    tag: \"form\",\n    window: {\n      minimizable: true,\n      resizable: true\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  async _prepareContext() {\n    return this.content;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Show dialog\n   * @public\n   * @param {string} dialogType      The dialog type\n   * @param {string} nestId          The nest id\n   * @param {object} tags            The available and selected tags\n   * @param {object} dialogData      The dialog data\n   * @param {function*} dialogSubmit The dialog submit function\n   */\n  static open(dialogType, nestId, tags, dialogData, dialogSubmit) {\n    this.nestId = nestId;\n    TagifyApp.#prepareHook(tags);\n\n    const data = {\n      title: dialogData.title,\n      content: dialogData.content,\n      submit: dialogSubmit\n    };\n\n    let dialog;\n    switch (dialogType) {\n      case \"hud\":\n        dialog = new TagifyAppHud(data);\n        break;\n      case \"topLevelGroup\":\n        dialog = new TagifyAppGroup(data);\n        break;\n      case \"group\":\n        dialog = new TagifyAppSubgroup(data);\n        break;\n    }\n\n    dialog.render(true);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare dialog hook\n   * @private\n   * @param {object} tags The tags\n   */\n  static #prepareHook(tags) {\n    Hooks.once(\"renderTagifyApp\", (app, html, options) => {\n      const tagInput = html.querySelector('input[class=\"tah-dialog-tagify\"]');\n\n      if (tagInput) {\n        const options = {\n          delimiters: \";\",\n          maxTags: \"Infinity\",\n          dropdown: {\n            position: \"manual\",\n            maxItems: Infinity, // <- maximum allowed rendered suggestions\n            classname: \"tah-dialog-tags-dropdown\", // <- custom classname for this dropdown, so it could be targeted\n            enabled: 0 // <- show suggestions on focus\n          },\n          templates: {\n            dropdownItemNoMatch() {\n              return \"<div class='empty'>Nothing Found</div>\";\n            }\n          }\n        };\n\n        if (tags.available) options.whitelist = tags.available;\n\n        TagifyApp.tagify = new Tagify(tagInput, options);\n\n        if (tags.selected) TagifyApp.tagify.addTags(tags.selected);\n\n        TagifyApp.dragSort = new DragSort(TagifyApp.tagify.DOM.scope, {\n          selector: `.${TagifyApp.tagify.settings.classNames.tag}`,\n          callbacks: { dragEnd: onDragEnd }\n        });\n\n        /**\n         * On drag end\n         */\n        function onDragEnd() {\n          TagifyApp.tagify.updateValueByDOMTags();\n        }\n\n        const tagifyInput = html.querySelector(\".tagify__input\");\n        if (tagifyInput) {\n          tagifyInput.addEventListener(\"keydown\", event => {\n            if (event.key === \"Enter\") {\n              event.preventDefault();\n              TagifyApp.tagify.addTags(TagifyApp.tagify.state.inputText, !0);\n            }\n          });\n        }\n\n        if (app.constructor.name === \"TagifyAppHud\") return;\n\n        TagifyApp.tagify.dropdown.show();\n        const dropdownLabelElement = document.createElement(\"div\");\n        dropdownLabelElement.classList.add(\"tah-dialog-label\");\n        dropdownLabelElement.innerHTML = game.i18n.localize(\"tokenActionHud.form.hud.availableItems\");\n        TagifyApp.tagify.DOM.scope.parentNode.appendChild(dropdownLabelElement);\n        TagifyApp.tagify.DOM.scope.parentNode.appendChild(TagifyApp.tagify.DOM.dropdown);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Reset Actions within Groups' button is clicked, reset the actor's HUD data.\n   * Only used in the HUD dialog.\n   * @private\n   */\n  static async resetActions() {\n    await foundry.applications.api.DialogV2.confirm({\n      window: {\n        title: game.i18n.localize(\"tokenActionHud.dialog.resetActions.title\")\n      },\n      content: `<p>${game.i18n.localize(\"tokenActionHud.dialog.resetActions.content\")}</p>`,\n      modal: true,\n      yes: {\n        label: game.i18n.localize(\"tokenActionHud.dialog.button.yes\"),\n        callback: async () => {\n          await game.tokenActionHud.resetActorData();\n          Logger.info(\"Actions reset\", true);\n        }\n      },\n      no: {\n        label: game.i18n.localize(\"tokenActionHud.dialog.button.no\")\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Unselect All' button is clicked, unselect all tags\n   */\n  static unselectAllTags() {\n    TagifyApp.tagify.removeAllTags();\n  }\n\n  /* -------------------------------------------- */\n\n  /** @override */\n  _onKeyDown(event) {\n    // Close dialog\n    if (event.key === \"Escape\" && !event.target.className.includes(\"tagify\")) {\n      event.preventDefault();\n      event.stopPropagation();\n      return this.close();\n    }\n\n    // Confirm default choice\n    if (\n      event.key === \"Enter\"\n            && this.data.default\n            && !event.target.className.includes(\"tagify\")\n    ) {\n      event.preventDefault();\n      event.stopPropagation();\n      const defaultChoice = this.data.buttons[this.data.default];\n      return this.submit(defaultChoice);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle form submission\n   * @param {object} event    The event\n   * @param {object} form     The form\n   * @param {object} formData The form data\n   */\n  static async submit(event, form, formData) {\n    const selection = TagifyApp.tagify.value.map(c => {\n      c.id = c.id ?? c.value.slugify({ replacement: \"-\", strict: true });\n      return {\n        id: c.id,\n        listName: c.value,\n        name: c.name ?? c.value,\n        type: c.type\n      };\n    });\n    await this.submit(selection, formData.object);\n  }\n}\n\n/* -------------------------------------------- */\n\nexport class TagifyAppHud extends TagifyApp {\n  static PARTS = {\n    form: {\n      template: TEMPLATE.tagifyAppHud\n    }\n  };\n}\n\n/* -------------------------------------------- */\n\nexport class TagifyAppGroup extends TagifyApp {\n  static PARTS = {\n    form: {\n      template: TEMPLATE.tagifyAppGroup\n    }\n  };\n}\n\n/* -------------------------------------------- */\n\nexport class TagifyAppSubgroup extends TagifyApp {\n  static PARTS = {\n    form: {\n      template: TEMPLATE.tagifyAppSubgroup\n    }\n  };\n}\n","import { TagifyApp } from \"./tagify-app.mjs\";\nimport { Utils } from \"../core/utils.mjs\";\n\n/**\n * Generates data for the Tagify application.\n */\nexport class TagifyAppHelper {\n  /**\n   * Show the HUD dialog\n   * @public\n   * @param {class} groupHandler The GroupHandler instance\n   */\n  static async openEditHudApp(groupHandler) {\n    // Set available and selected tags\n    const tags = {};\n    tags.available = [];\n    tags.selected = await groupHandler.getSelectedGroupsAsTags();\n    const grid = await Utils.getSetting(\"grid\");\n\n    // Set dialog data\n    const dialogData = {\n      title: game.i18n.localize(\"tokenActionHud.form.hud.hudTitle\"),\n      content: {\n        topLabel: game.i18n.localize(\"tokenActionHud.form.hud.hudDetail\"),\n        placeholder: game.i18n.localize(\"tokenActionHud.form.hud.tagPlaceholder\"),\n        settings: { grid }\n      }\n    };\n\n    // Set function on submit\n    const dialogSubmit = async (choices, formData) => {\n      const grid = formData?.grid;\n      await groupHandler.updateGroups(choices, { level: 0 });\n      await groupHandler.saveGroups({ saveActor: true, saveUser: true });\n      await Utils.setSetting(\"grid\", grid);\n      Hooks.callAll(\"forceUpdateTokenActionHud\");\n    };\n\n    // Show dialog\n    TagifyApp.open(\"hud\", null, tags, dialogData, dialogSubmit);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Show group dialog\n   * @public\n   * @param {class} groupHandler The GroupHandler instance\n   * @param {object} groupData   The group data\n   */\n  static async openEditGroupApp(groupHandler, groupData) {\n    const { nestId, name, level } = groupData;\n\n    // Set available and selected tags\n    const tags = {};\n\n    // Get available subcategories\n    tags.available = await groupHandler.getAvailableGroupAsTags({ nestId, level });\n\n    // Get selected subcategories\n    tags.selected = await groupHandler.getSelectedGroupsAsTags({ nestId, level });\n\n    // Set dialog data\n    const dialogData = {\n      title: `${game.i18n.localize(\"tokenActionHud.form.hud.groupTitle\")}: ${name}`,\n      content: {\n        topLabel: game.i18n.localize(\"tokenActionHud.form.hud.groupDetail\"),\n        placeholder: game.i18n.localize(\"tokenActionHud.form.hud.tagPlaceholder\"),\n        settings: await groupHandler.getGroupSettings(groupData)\n      }\n    };\n\n    // Set function on submit\n    const dialogSubmit = async (choices, formData) => {\n      choices = choices.map(choice => {\n        choice.id =\n                choice.id\n                ?? choice.name.slugify({\n                  replacement: \"-\",\n                  strict: true\n                });\n        choice.type = choice.type ?? \"custom\";\n        return {\n          id: choice.id,\n          listName: choice.listName,\n          name: choice.name,\n          type: choice.type\n        };\n      });\n\n      const characterCount = formData?.characterCount;\n      const customWidth = formData?.customWidth;\n      const grid = formData?.grid;\n      const image = formData?.image;\n      const showTitle = formData?.showTitle;\n      const sort = formData?.sort;\n      groupData.settings = { characterCount, customWidth, grid, image, showTitle, sort };\n\n      // Save selected subcategories to user action list\n      await groupHandler.updateGroups(choices, groupData);\n      await groupHandler.saveGroups({ saveActor: true, saveUser: true });\n      Hooks.callAll(\"forceUpdateTokenActionHud\");\n    };\n\n    TagifyApp.open(\n      \"topLevelGroup\",\n      nestId,\n      tags,\n      dialogData,\n      dialogSubmit\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Show action dialog\n   * @public\n   * @param {class} groupHandler  The GroupHandler instance\n   * @param {class} actionHandler The ActionHandler instance\n   * @param {object} groupData    The group data\n   */\n  static async openEditSubgroupApp(groupHandler, actionHandler, groupData) {\n    const { nestId, name, level } = groupData;\n\n    // Set available and selected tags\n    const tags = {};\n\n    // Get available groups and actions\n    const availableActions = await actionHandler.getAvailableActionsAsTags(groupData);\n    const availableGroups = await groupHandler.getAvailableGroupAsTags({ nestId, level });\n    tags.available = [...availableActions, ...availableGroups];\n\n    // Get selected actions and subcategories\n    const selectedActions = await actionHandler.getSelectedActionsAsTags(groupData);\n    const selectedGroups = await groupHandler.getSelectedGroupsAsTags({ nestId, level });\n    tags.selected = [...selectedActions, ...selectedGroups];\n\n    // Set dialog data\n    const dialogData = {\n      title: `${game.i18n.localize(\"tokenActionHud.form.hud.groupTitle\")}: ${name} `,\n      content: {\n        topLabel: game.i18n.localize(\"tokenActionHud.form.hud.groupDetail\"),\n        placeholder: game.i18n.localize(\"tokenActionHud.form.hud.tagPlaceholder\"),\n        settings: await groupHandler.getGroupSettings(groupData)\n      }\n    };\n\n    // Set function on submit\n    const dialogSubmit = async (choices, formData) => {\n      const selectedGroups = [];\n      const selectedActions = [];\n      for (const choice of choices) {\n        if (choice.type === \"action\") {\n          selectedActions.push(choice);\n        } else {\n          selectedGroups.push(choice);\n        }\n      }\n\n      // Get advanced category options\n      const characterCount = formData?.characterCount;\n      const collapse = formData?.collapse;\n      const customWidth = formData?.customWidth;\n      const grid = formData?.grid;\n      const image = formData?.image;\n      const showTitle = formData?.showTitle;\n      const sort = formData?.sort;\n      const style = formData?._style;\n      groupData.settings = { characterCount, collapse, customWidth, grid, image, showTitle, sort, style };\n\n      // Save subcategories to user action list\n      await groupHandler.updateGroups(selectedGroups, groupData);\n      await actionHandler.updateActions(selectedActions, groupData);\n      await groupHandler.saveGroups({ saveActor: true, saveUser: true });\n\n      Hooks.callAll(\"forceUpdateTokenActionHud\");\n    };\n\n    TagifyApp.open(\n      \"group\",\n      nestId,\n      tags,\n      dialogData,\n      dialogSubmit\n    );\n  }\n}\n","import { Utils } from \"../core/utils.mjs\";\n\nexport class GroupResizer {\n  constructor(tokenActionHud, hudManager) {\n    this.tokenActionHud = tokenActionHud;\n    this.hudManager = hudManager;\n    this.groupHandler = hudManager.groupHandler;\n    this.minCols = 3;\n    this.isCustomWidth = false;\n    this.settings = null;\n    this.spacing = 10;\n  }\n\n  /**\n   * Resize the groups element\n   * @param {object} groupElement The group element\n   */\n  async resizeGroup(groupElement) {\n    if (!groupElement) return;\n\n    this.#setVariables(groupElement);\n\n    if (!this.subgroupsElement) return;\n\n    if (!this.tokenActionHud.isDocked) {\n      await this.#setWidth();\n    }\n\n    await this.#setHeight();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set variables\n   * @private\n   * @param {object} groupElement The group element\n   */\n  async #setVariables(groupElement) {\n    this.#resetVariables();\n\n    this.groupElement = groupElement;\n\n    // Get groups element\n    await this.#setSubgroupsElement();\n    if (!this.subgroupsElement) return;\n\n    // Reset groups elements\n    this.#resetGroupsElements();\n\n    // Get groups\n    this.#setSubgroupElementArr();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset variables\n   * @private\n   */\n  #resetVariables() {\n    this.actionsElements = null;\n    this.availableHeight = null;\n    this.availableWidth = null;\n    this.gridWidth = null;\n    this.groupElement = null;\n    this.subgroupElementArr = null;\n    this.subgroupsElement = null;\n    this.subgroupsElementPadding = null;\n    this.subgroupsElementRect = null;\n    this.isCustomWidth = false;\n    this.minCols = 3;\n    this.settings = null;\n    this.spacing = 10;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset groups elements\n   */\n  #resetGroupsElements() {\n    const level1GroupElement = this.groupElement.closest('[data-part=\"group\"]');\n    const groupsElements = level1GroupElement.querySelectorAll(\".tah-subgroups\");\n    const style = { maxHeight: \"\", overflowY: \"\" };\n    this.#resetCSS(groupsElements, style);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the grid width\n   * @private\n   */\n  async #getGridWidth() {\n    // Reset action elements\n    const emptyStyle = { display: \"\", gridTemplateColumns: \"\", width: \"\" };\n    await this.#resetCSS(this.actionsElements, emptyStyle);\n\n    const actionWidths = [];\n    const actionWidthsForMedian = [];\n    for (const actionsElement of this.actionsElements) {\n      const actionElements = actionsElement.querySelectorAll(\".tah-action:not(.shrink)\");\n      for (const actionElement of actionElements) {\n        const actionRect = actionElement.getBoundingClientRect();\n        const actionWidth = Math.round(parseFloat(actionRect.width) + 1 || 0);\n        const actionButtonText = actionElement.querySelector(\".tah-action-button-text\");\n        const actionButtonTextRect = actionButtonText?.getBoundingClientRect();\n        const actionButtonTextWidth = Math.round(parseFloat(actionButtonTextRect?.width) || 0);\n        actionWidthsForMedian.push(actionWidth);\n        actionWidths.push({ actionWidth, actionButtonTextWidth });\n      }\n    }\n\n    let upperQuartileAverage = Math.ceil(Utils.getUpperQuartileAverage(actionWidthsForMedian));\n    const minActionButtonTextWidth = 30;\n\n    for (const actionWidth of actionWidths) {\n      const availableactionButtonTextWidth = upperQuartileAverage\n        - (actionWidth.actionWidth - actionWidth.actionButtonTextWidth);\n      if (availableactionButtonTextWidth < minActionButtonTextWidth) {\n        upperQuartileAverage = (upperQuartileAverage - availableactionButtonTextWidth) + minActionButtonTextWidth;\n      }\n    }\n\n    this.gridWidth = upperQuartileAverage;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Resize the actions element into the grid format\n   * @private\n   * @param {object} actionsElement   The actions element\n   * @param {number} groupCustomWidth The group custom width\n   */\n  async #resizeGrid(actionsElement, groupCustomWidth) {\n    if (!actionsElement) return;\n    const emptyStyle = { display: \"\", gridTemplateColumns: \"\", width: \"\" };\n    await this.#assignCSS(actionsElement, emptyStyle);\n\n    const actions = actionsElement.querySelectorAll(\".tah-action\");\n    const squaredCols = Math.ceil(Math.sqrt(actions.length));\n    const availableGroupWidth = groupCustomWidth ?? this.availableWidth;\n    const availableCols = Math.floor(availableGroupWidth / this.gridWidth);\n    const cols = (squaredCols > availableCols || groupCustomWidth)\n      ? availableCols\n      : (actions.length <= this.minCols) ? actions.length : squaredCols;\n    // Apply maxHeight and width styles to content\n    const style = { display: \"grid\", gridTemplateColumns: `repeat(${cols}, ${this.gridWidth}px)` };\n    await this.#assignCSS(actionsElement, style);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Resize the actions element\n   * @private\n   * @param {object} actionsElement   The actions element\n   * @param {number} groupCustomWidth The group custom width\n   */\n  async #resize(actionsElement, groupCustomWidth) {\n    if (!actionsElement) return;\n\n    let width = 500;\n\n    if (this.isCustomWidth) {\n      width = this.availableWidth;\n    } else if (groupCustomWidth) {\n      width = groupCustomWidth;\n    } else {\n      const actions = actionsElement.querySelectorAll(\".tah-action\");\n      if (!actions.length) return;\n      const sqrtActions = Math.ceil(Math.sqrt(actions.length)); // 4\n\n      // Initialize variables\n      let currentRow = 1;\n      let maxRowWidth = 0;\n      let rowWidth = 0;\n      // Iterate through action groups, calculating dimensions and counts\n      if (actions.length > 0) {\n        actions.forEach((action, index) => {\n          if ((index + 1) / sqrtActions > currentRow) {\n            rowWidth = rowWidth - 5;\n            maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth;\n            rowWidth = 0;\n            currentRow++;\n          }\n          const actionRect = action.getBoundingClientRect();\n          const actionWidth = Math.ceil(parseFloat(actionRect.width) + 1 || 0);\n          rowWidth += actionWidth;\n          if (index + 1 === actions.length) {\n            rowWidth = rowWidth - 5;\n            maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth;\n          }\n        });\n      }\n\n      // Add padding to maxAvgGroupWidth and maxGroupWidth\n      maxRowWidth += this.subgroupsElementPadding;\n\n      // Determine width of content\n      width = (maxRowWidth < this.availableWidth && actions.length > 3) ? maxRowWidth : this.availableWidth;\n      if (width < 200) width = 200;\n    }\n\n    const style = { maxWidth: `${width}px` };\n    await this.#assignCSS(actionsElement, style);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get available content width\n   * @private\n   * @returns {number} The available content width\n   */\n  #getAvailableWidth() {\n    const customWidth = this.settings?.customWidth;\n\n    if (customWidth) {\n      this.isCustomWidth = true;\n      return customWidth;\n    }\n\n    const windowWidth = canvas.screenDimensions[0] || window.innerWidth;\n    const contentLeft = this.subgroupsElementRect.left;\n    const uiRight = document.querySelector(\"#ui-right\");\n    const uiRightClientWidth = uiRight.clientWidth;\n    return Math.floor((\n      uiRightClientWidth > 0\n        ? windowWidth - uiRightClientWidth\n        : windowWidth\n    ) - this.spacing - contentLeft);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get subgroups element\n   * @private\n   */\n  async #setSubgroupsElement() {\n    this.subgroupsElement = this.groupElement.querySelector('[data-part=\"subgroups\"]');\n    if (!this.subgroupsElement) return;\n    this.subgroupsElementRect = this.subgroupsElement.getBoundingClientRect();\n    this.subgroupsElementComputed = getComputedStyle(this.subgroupsElement);\n    this.subgroupsElementPadding =\n      Math.ceil(parseFloat(this.subgroupsElementComputed.paddingLeft) || 0)\n      + Math.ceil(parseFloat(this.subgroupsElementComputed.paddingRight) || 0);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get subgroup elements\n   * @private\n   */\n  #setSubgroupElementArr() {\n    this.subgroupElementArr = this.groupElement.querySelectorAll('[data-part=\"subgroup\"]');\n    if (this.subgroupElementArr.length === 0) this.subgroupElementArr = [this.groupElement];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the width\n   */\n  async #setWidth() {\n    this.actionsElements = this.groupElement.querySelectorAll('[data-part=\"actions\"]');\n\n    // Exit early if no action elements exist\n    if (this.actionsElements.length === 0) return;\n\n    // Get group settings\n    const nestId = this.groupElement.dataset.nestId;\n    this.settings = await this.groupHandler.getGroupSettings({ nestId, level: 1 });\n\n    // Get available width\n    this.availableWidth = this.#getAvailableWidth();\n\n    // Loop groups\n    let hasGrid = false;\n    for (const subgroupElement of this.subgroupElementArr) {\n      const actionsElement = subgroupElement.querySelector('[data-part=\"actions\"]');\n      if (!actionsElement) continue;\n      const nestId = subgroupElement.dataset.nestId;\n      const groupSettings = await this.groupHandler.getGroupSettings({ nestId });\n      const groupCustomWidth = groupSettings.customWidth;\n      const grid = Utils.getSetting(\"grid\") || this.settings?.grid || groupSettings?.grid || actionsElement.style.display;\n      if (grid) {\n        if (!hasGrid) {\n          await this.#getGridWidth();\n          hasGrid = true;\n        }\n        await this.#resizeGrid(actionsElement, groupCustomWidth);\n      } else {\n        await this.#resize(actionsElement, groupCustomWidth);\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the height\n   * @private\n   */\n  async #setHeight() {\n    requestAnimationFrame(() => {\n      this.availableHeight = this.#getAvailableHeight();\n      const style = { maxHeight: `${this.availableHeight}px`, overflowY: \"auto\" };\n      Object.assign(this.subgroupsElement.style, style);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get available height\n   * @private\n   * @returns {number} The available height\n   */\n  #getAvailableHeight() {\n    const windowHeight = canvas.screenDimensions[1] || window.innerHeight;\n    const contentBottom = this.subgroupsElementRect.bottom;\n    const contentTop = this.subgroupsElementRect.top;\n\n    if (this.tokenActionHud.isDocked) {\n      let siblingsHeight = 0;\n      let sibling = this.groupElement.nextElementSibling;\n\n      if (sibling) {\n        const siblings = [sibling];\n        while (sibling) {\n          sibling = sibling.nextElementSibling;\n          if (sibling) siblings.push(sibling);\n        }\n        for (const sibling of siblings) {\n          const siblingHeight = sibling.getBoundingClientRect().height;\n          siblingsHeight += siblingHeight ?? 0;\n        }\n      }\n\n      return Math.max(windowHeight - contentTop - siblingsHeight - this.spacing, 100);\n    } else {\n      const uiTopBottom = (this.tokenActionHud.direction === \"down\")\n        ? document.querySelector(\"#ui-bottom\")\n        : document.querySelector(\"#ui-top\");\n      const uiTopBottomOffsetHeight = uiTopBottom.offsetHeight;\n      const availableHeight = (this.tokenActionHud.direction === \"down\")\n        ? windowHeight - contentTop - uiTopBottomOffsetHeight - this.spacing\n        : contentBottom - uiTopBottomOffsetHeight - this.spacing;\n      return Math.max(availableHeight, 100);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Assign CSS\n   * @private\n   * @param {object} element The DOM element\n   * @param {object} style   The style\n   */\n  async #assignCSS(element, style) {\n    if (!element) return;\n    requestAnimationFrame(() => {\n      Object.assign(element.style, style);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset CSS\n   * @private\n   * @param {Array} elements The DOM elements\n   * @param {object} style   The style\n   */\n  async #resetCSS(elements, style) {\n    for (const element of elements) {\n      Object.assign(element.style, style);\n    }\n  }\n}\n","import { HudManager } from \"../managers/hud-manager.mjs\";\nimport { TagifyAppHelper } from \"./tagify-app-helper.mjs\";\nimport { GroupResizer } from \"../handlers/group-resizer.mjs\";\nimport { HUD, MODULE, SETTING, TEMPLATE } from \"../core/constants.mjs\";\nimport { Logger, Timer, Utils } from \"../core/utils.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Token Action HUD application\n */\nexport class TokenActionHud extends HandlebarsApplicationMixin(ApplicationV2) {\n  constructor(systemManager, dataHandler, socket) {\n    super();\n    this.systemManager = systemManager;\n    this.dataHandler = dataHandler;\n    this.hudManager = new HudManager(this, systemManager, dataHandler, socket);\n    this.groupResizer = new GroupResizer(this, this.hudManager);\n    this.socket = socket;\n    this.openGroups = new Set();\n    this.updatePendingTimer = new Timer(10);\n    this.updateTimer = new Timer(10);\n    this.closeTimer = null;\n    this.renderTimer = null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Merge Token Action Hud's default options with ApplicationV2\n   * @override\n   */\n  static DEFAULT_OPTIONS = {\n    actions: {\n      clickGroup: {\n        buttons: [0, 2],\n        handler: TokenActionHud.clickGroup\n      },\n      clickSubgroup: {\n        buttons: [0, 2],\n        handler: TokenActionHud.clickSubgroup\n      },\n      clickAction: {\n        buttons: [0, 2],\n        handler: TokenActionHud.clickAction\n      },\n      collapseHud: TokenActionHud.collapseHud,\n      expandHud: TokenActionHud.expandHud,\n      lockHud: TokenActionHud.lockHud,\n      unlockHud: TokenActionHud.unlockHud,\n      editHud: TokenActionHud.editHud\n    },\n    background: \"none\",\n    id: \"token-action-hud-app\",\n    position: {\n      width: HUD.defaultWidth,\n      height: HUD.defaultHeight,\n      left: HUD.defaultLeftPos,\n      top: HUD.defaultTopPos,\n      scale: HUD.defaultScale\n    },\n    window: {\n      frame: false,\n      title: \"token-action-hud\"\n    },\n    zIndex: 100\n  };\n\n  /* -------------------------------------------- */\n\n  /**\n   * Define template parts\n   */\n  static PARTS = {\n    form: {\n      template: TEMPLATE.hud\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare context\n   * @override\n   */\n  async _prepareContext() {\n    const styleData = this.systemManager.styles[Utils.getSetting(\"style\")];\n    const context = {\n      hud: this.hudManager.hud,\n      id: \"token-action-hud\",\n      style: styleData.class ?? \"\",\n      scale: this.scale,\n      background: \"#00000000\",\n      collapseIcon: styleData.collapseIcon ?? \"fa-caret-left\",\n      expandIcon: styleData.expandIcon ?? \"fa-caret-right\"\n    };\n\n    Logger.debug(\"Application context\", { context });\n    return context;\n  }\n\n  /* -------------------------------------------- */\n  /* SETTINGS                                     */\n  /* -------------------------------------------- */\n\n  /**\n   * Initialise the HUD\n   * @public\n   */\n  async init() {\n    this.#cacheSettings();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Cache settings for slightly faster retrieval\n   */\n  #cacheSettings() {\n    const settings = [\n      \"activeCssAsText\", \"allow\", \"alwaysShowHud\", \"clickOpenCategory\", \"direction\",\n      \"debug\", \"displayIcons\", \"drag\", \"enable\", \"grid\",\n      \"scale\", \"style\"\n    ];\n\n    settings.forEach(setting => {\n      this[`${setting}Setting`] = Utils.getSetting(setting);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update cached settings following changes\n   * @param {string} key The setting key\n   * @param {*|null} value      The setting value\n   * @public\n   */\n  async updateCachedSettings(key, value = null) {\n    if (!this.updateSettingsPending) {\n      this.updateSettingsPending = true;\n      Logger.debug(\"Updating settings...\");\n    }\n\n    const { classes, variable } = SETTING[key];\n    if (variable) {\n      if (classes.includes(\"TokenActionHud\")) this[variable] = value;\n    }\n\n    switch (key) {\n      case \"customLayout\":\n      case \"userCustomLayout\":\n        this.hudManager.layoutHandler.customLayout = null;\n        break;\n      case \"rollHandler\":\n        this.hudManager.rollHandler = this.systemManager.getRollHandlerCore(this.hudManager.actionHandler);\n        break;\n      case \"style\":\n        this.setPosition();\n    }\n  }\n\n  /* -------------------------------------------- */\n  /* RENDER                                       */\n  /* -------------------------------------------- */\n\n  /**\n   * On render\n   * @param {options} context The context\n   * @param {options} options The options\n   */\n  _onRender(context, options) {\n    super._onRender(context, options);\n    this.element.classList.remove(\"tah-closed\");\n    clearTimeout(this.closeTimer);\n    clearTimeout(this.renderTimer);\n    this.#cacheElements();\n    this.#setInitialHudState();\n    this.#addHoverEvents(this.elements);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Cache HUD elements\n   */\n  #cacheElements() {\n    this.elements = {\n      characterName: this.element.querySelector(\"[data-part=\\\"characterName\\\"]\"),\n      actionArr: this.element.querySelectorAll(\"[data-part=\\\"action\\\"]\"),\n      buttons: this.element.querySelector(\"[data-part=\\\"buttons\\\"]\"),\n      tabSubgroupArr: this.element.querySelectorAll(\"[data-group-type=\\\"tab\\\"]\"),\n      groups: this.element.querySelector(\"[data-part=\\\"groups\\\"]\"),\n      editHudButton: this.element.querySelector(\"[data-part=\\\"editHudButton\\\"]\"),\n      listSubgroupsArr: this.element.querySelectorAll(\"[data-part=\\\"listSubgroups\\\"]\"),\n      subgroupsContainerArr: this.element.querySelectorAll(\"[data-part=\\\"subgroupsContainer\\\"]\"),\n      subgroupArr: this.element.querySelectorAll(\"[data-part=\\\"subgroup\\\"]\"),\n      listSubgroupTitleArr: this.element.querySelectorAll(\"[data-part=\\\"listSubgroupTitle\\\"]\"),\n      groupButtonArr: this.element.querySelectorAll(\"[data-part=\\\"groupButton\\\"]\"),\n      collapseExpandContainer: this.element.querySelector(\"[data-part=\\\"collapseExpandContainer\\\"]\"),\n      collapseHudButton: this.element.querySelector(\"[data-part=\\\"collapseHudButton\\\"]\"),\n      expandHudButton: this.element.querySelector(\"[data-part=\\\"expandHudButton\\\"]\"),\n      unlockButton: this.element.querySelector(\"[data-part=\\\"unlockHudButton\\\"]\"),\n      lockButton: this.element.querySelector(\"[data-part=\\\"lockHudButton\\\"]\")\n    };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the initial state of the HUD (collapsed or expanded, locked or unlocked)\n   * @private\n   */\n  #setInitialHudState() {\n    if (this.isCollapsed) { TokenActionHud.collapseHud.call(this); }\n\n    if (Utils.getSetting(\"enableCustomization\")) {\n      if (this.isUnlocked) {\n        TokenActionHud.unlockHud.call(this);\n      } else {\n        TokenActionHud.lockHud.call(this);\n      }\n    } else {\n      this.elements.unlockButton.classList.add(\"tah-hidden\");\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add hover events\n   * @param {object} elements The elements\n   */\n  #addHoverEvents(elements) {\n    if (!Utils.getSetting(\"clickOpenCategory\")) {\n      // When a category button is hovered over...\n      elements.tabSubgroupArr.forEach(element => {\n        element.addEventListener(\"touchstart\", this.toggleGroup.bind(this), { passive: true });\n        element.addEventListener(\"pointerenter\", this.toggleGroup.bind(this));\n        element.addEventListener(\"pointerleave\", this.toggleGroup.bind(this));\n      });\n    }\n\n    // When a category button is clicked and held...\n    if (!this.isDocked) {\n      elements.groupButtonArr.forEach(element => {\n        element.addEventListener(\"mousedown\", this.#dragEvent.bind(this));\n        element.addEventListener(\"touchstart\", this.#dragEvent.bind(this), { passive: true });\n      });\n    }\n\n    // When an action is hovered...\n    elements.actionArr.forEach(element => {\n      element.addEventListener(\"pointerenter\", this.handleActionHover.bind(this));\n      element.addEventListener(\"pointerleave\", this.handleActionHover.bind(this));\n    });\n  }\n\n  /* -------------------------------------------- */\n  /* POST-RENDER                                  */\n  /* -------------------------------------------- */\n\n  /**\n   * Functions to execute after the application is rendered\n   */\n  postRender() {\n    this.rendering = false;\n    this.#applyDirection();\n    this.#reopenGroups();\n    if (!this.isCollapsed) {\n      this.renderTimer = setTimeout(() => {\n        requestAnimationFrame(() => {\n          this.element?.classList?.add(\"tah-expanded\");\n        });\n      }, 25);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Apply classes for HUD direction\n   * @private\n   */\n  #applyDirection() {\n    if (this.isDocked) return;\n\n    const { characterName, subgroupsContainerArr } = this.elements;\n\n    if (this.direction === \"up\") {\n      characterName.classList.add(\"tah-hidden\");\n\n      subgroupsContainerArr.forEach(element => {\n        element.classList.remove(\"expand-down\");\n        element.classList.add(\"expand-up\");\n      });\n    } else {\n      if (!this.isCollapsed) {\n        characterName.classList.remove(\"tah-hidden\");\n      }\n\n      subgroupsContainerArr.forEach(element => {\n        element.classList.add(\"expand-down\");\n        element.classList.remove(\"expand-up\");\n      });\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reopen groups following a re-render of the HUD\n   * @private\n   */\n  #reopenGroups() {\n    if (!this.openGroups.size) return;\n\n    this.openGroups.forEach(groupId => {\n      const group = this.element.querySelector(`#${groupId}`);\n      if (group) {\n        this.toggleGroup(null, group);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n  /* INTERACTIVITY                                */\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Edit HUD' button is clicked, open the Edit HUD app\n   */\n  static editHud() {\n    TagifyAppHelper.openEditHudApp(this.hudManager.groupHandler);\n  }\n\n  /* -------------------------------------------- */\n  /* ENABLE/DISABLE HUD                           */\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle the HUD enabled state\n   */\n  async toggleHudEnable() {\n    const binding = Utils.humanizeBinding(\"enableDisableHud\");\n    const state = (this.isEnabled) ? \"disabled\" : \"enabled\";\n    if (this.isEnabled) {\n      this.#close();\n    } else {\n      Hooks.callAll(\"forceUpdateTokenActionHud\");\n    }\n    await Utils.setSetting(\"enable\", !this.isEnabled);\n    Logger.info(game.i18n.format(`tokenActionHud.keybinding.toggleHud.${state}`, { binding }), true);\n  }\n\n  /* -------------------------------------------- */\n  /* COLLAPSE/EXPAND HUD                          */\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Collapse HUD' button is clicked, collapse the HUD\n   */\n  static collapseHud() {\n    this.toggleHudCollapse(\"collapse\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Expand HUD' button is clicked, expand the HUD\n   */\n  static expandHud() {\n    this.toggleHudCollapse(\"expand\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle the HUD between collapse and expand states\n   * @param {string} state The state (\"collapse\" or \"expand\")\n   */\n  toggleHudCollapse(state) {\n    state = state ?? ((this.isCollapsed) ? \"expand\" : \"collapse\");\n    const isCollapsing = state === \"collapse\";\n    const { characterName, collapseHudButton, expandHudButton, groups, buttons } = this.elements;\n\n    collapseHudButton.classList.toggle(\"tah-hidden\", isCollapsing);\n    expandHudButton.classList.toggle(\"tah-hidden\", !isCollapsing);\n\n    if (this.isDocked) {\n      this.element.classList.toggle(\"tah-expanded\", !isCollapsing);\n    } else {\n      if (this.direction === \"down\") { characterName.classList.toggle(\"tah-hidden\", isCollapsing); }\n      groups.classList.toggle(\"tah-hidden\", isCollapsing);\n      buttons.classList.toggle(\"tah-hidden\", isCollapsing);\n    }\n\n    this.isCollapsed = isCollapsing;\n  }\n\n  /* -------------------------------------------- */\n  /* LOCK/UNLOCK HUD                              */\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Unlock HUD' button is clicked, unlock the HUD\n   * @param {object|null} event The event\n   */\n  static async unlockHud(event = null) {\n    this.toggleHudLock(\"unlock\", event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Lock HUD' button is clicked, lock the HUD\n   * @param {object|null} event The event\n   */\n  static async lockHud(event = null) {\n    this.toggleHudLock(\"lock\", event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle HUD lock state\n   * @param {string} state      The state (\"lock\" or \"unlock\")\n   * @param {object|null} event The event\n   */\n  toggleHudLock(state, event = null) {\n    if (event) event.preventDefault();\n\n    const isUnlocking = state === \"unlock\";\n    const { unlockButton, lockButton, editHudButton, subgroupArr, groupButtonArr,\n      groups, listSubgroupsArr, tabSubgroupArr, listSubgroupTitleArr } = this.elements;\n\n    // Toggle button visibiltiy\n    unlockButton.classList.toggle(\"tah-hidden\", isUnlocking);\n    lockButton.classList.toggle(\"tah-hidden\", !isUnlocking);\n    editHudButton.classList.toggle(\"tah-hidden\", !isUnlocking);\n\n    // Toggle class for styling when unlocked/locked\n    groups.classList.toggle(\"tah-unlocked\", isUnlocking);\n\n    // Helper function to toggle classes\n    const toggleElements = (elements, className, toggle) => {\n      elements.forEach(element => element.classList.toggle(className, toggle));\n    };\n\n    toggleElements(groupButtonArr, \"disable-edit\", !isUnlocking);\n    toggleElements(listSubgroupTitleArr, \"disable-edit\", !isUnlocking);\n\n    if (isUnlocking) {\n      // When the HUD is unlocked, unhide elements\n      toggleElements(subgroupArr, \"tah-hidden\", !isUnlocking);\n      toggleElements(listSubgroupsArr, \"tah-hidden\", !isUnlocking);\n      toggleElements(tabSubgroupArr, \"tah-hidden\", !isUnlocking);\n      toggleElements(listSubgroupTitleArr, \"tah-hidden\", !isUnlocking);\n    } else {\n      // When the HUD is locked, hide elements that have no underlying actions\n      const hideIfEmpty = elements => {\n        elements.forEach(element => {\n          const hasActions = element.querySelectorAll(\".tah-action\").length > 0;\n          if (!hasActions) element.classList.add(\"tah-hidden\");\n        });\n      };\n\n      hideIfEmpty(tabSubgroupArr);\n      hideIfEmpty(subgroupArr);\n      hideIfEmpty(listSubgroupsArr);\n\n      listSubgroupTitleArr.forEach(element => {\n        const groupElement = element.closest(\".tah-subgroup\");\n        if (groupElement.dataset?.showTitle === \"false\") {\n          element.classList.add(\"tah-hidden\");\n        }\n      });\n    }\n\n    this.isUnlocked = isUnlocking;\n  }\n\n  /* -------------------------------------------- */\n  /* GROUP EVENTS                                 */\n  /* -------------------------------------------- */\n\n  /**\n   * When a group is clicked\n   * @param {object} event The event\n   */\n  static clickGroup(event) {\n    this.bringToFront();\n\n    // Remove focus to allow core ESC interactions\n    event.currentTarget.blur();\n\n    if (event.type === \"contextmenu\") {\n      if (this.isUnlocked) {\n        this.openEditGroupApp(event);\n      } else {\n        this.handleGroupClick(event);\n      }\n    } else if (Utils.getSetting(\"clickOpenCategory\")) {\n      this.toggleGroup(event);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When a subgroup is clicked\n   * @param {object} event The event\n   */\n  static clickSubgroup(event) {\n    if (event.type === \"contextmenu\") {\n      if (this.isUnlocked) {\n        this.openEditGroupApp(event);\n      } else {\n        this.handleGroupClick(event);\n      }\n    } else {\n      const group = Utils.getClosestGroupElement(event);\n      if (group.dataset?.groupType === \"tab\") {\n        this.toggleGroup(event, group);\n      } else {\n        this.collapseExpandSubgroup(event);\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle the visibility of the group\n   * @param {object} event The event\n   * @param {object} group The group element\n   */\n  toggleGroup(event = null, group = null) {\n    group = group || Utils.getClosestGroupElement(event);\n    const isOpen = group.classList.contains(\"hover\");\n    const shouldOpen = !isOpen;\n    if ((isOpen && event?.type === \"pointerenter\") || (!isOpen && event?.type === \"pointerleave\")) return;\n    group.classList.toggle(\"hover\", shouldOpen);\n    if (shouldOpen) {\n      this.#toggleOtherGroups(group);\n      this.groupResizer.resizeGroup(group);\n\n      this.openGroups.add(group.id);\n    } else {\n      this.openGroups.delete(group.id);\n    }\n    // Remove focus to allow core ESC interactions\n    if (event) event.currentTarget.blur();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle visibility of other groups\n   * @private\n   * @param {string} groupToIgnore The group to ignore\n   */\n  #toggleOtherGroups(groupToIgnore) {\n    if (!this.openGroups.size) return;\n\n    this.openGroups.forEach(groupId => {\n      if (groupId === groupToIgnore.id) return;\n      const group = this.element.querySelector(`#${groupId}`);\n      // If group no longer exists on the HUD, delete it\n      if (!group) {\n        this.openGroups.delete(groupId);\n      }\n      const isParentToIgnore = group.querySelector(`#${groupToIgnore.id}`);\n      if (group && !isParentToIgnore) {\n        this.toggleGroup(null, group);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Collapse/expand a subgroup\n   * @param {object} event                       The event\n   */\n  collapseExpandSubgroup(event) {\n    const target = event.target.closest('[data-part=\"listSubgroupTitle\"]');\n\n    const groupElement = Utils.getClosestGroupElement(event);\n    const nestId = groupElement?.dataset?.nestId;\n    const tabSubgroup = target.closest(\".tah-tab-subgroup.hover\");\n    const groupsElement = groupElement?.querySelector(\"[data-part=\\\"subgroups\\\"]\");\n    const collapseIcon = target.querySelector(\".tah-collapse-icon\");\n    const expandIcon = target.querySelector(\".tah-expand-icon\");\n    const imageElement = groupElement.querySelector(\".tah-list-image\");\n\n    const toggleGroupVisibility = () => {\n      groupsElement?.classList.toggle(\"tah-hidden\");\n      collapseIcon?.classList.toggle(\"tah-hidden\");\n      expandIcon?.classList.toggle(\"tah-hidden\");\n      imageElement?.classList.toggle(\"tah-hidden\");\n    };\n\n    const saveGroupSettings = collapse => {\n      if (Utils.getSetting(\"enableCustomization\")) {\n        this.hudManager.groupHandler.saveGroupSettings({ nestId, settings: { collapse } });\n      }\n    };\n\n    if (groupsElement?.classList.contains(\"tah-hidden\")) {\n      toggleGroupVisibility();\n      saveGroupSettings(false);\n      this.groupResizer.resizeGroup(tabSubgroup);\n    } else {\n      toggleGroupVisibility();\n      saveGroupSettings(true);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle when a group is clicked\n   * @param {object} event The event\n   */\n  handleGroupClick(event) {\n    this.hudManager.handleHudEvent(\"groupClick\", event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Open the 'Edit Group' or 'Edit Subgroup' app\n   * @param {object} event\n   */\n  openEditGroupApp(event) {\n    const group = Utils.getClosestGroupElement(event);\n    const { nestId, level, type } = group.dataset;\n    if (!nestId) return;\n    const name = this.hudManager.groupHandler.groups[nestId].name;\n    const parsedLevel = parseInt(level, 10) || null;\n\n    if (parsedLevel === 1) {\n      TagifyAppHelper.openEditGroupApp(\n        this.hudManager.groupHandler,\n        { nestId, name, level: parsedLevel, type }\n      );\n    } else {\n      TagifyAppHelper.openEditSubgroupApp(\n        this.hudManager.groupHandler,\n        this.hudManager.actionHandler,\n        { nestId, name, level: parsedLevel, type }\n      );\n    }\n\n  }\n\n  /* -------------------------------------------- */\n  /* ACTION EVENTS                                */\n  /* -------------------------------------------- */\n\n  /**\n   * When an action is clicked\n   * @param {object} event The event\n   */\n  static clickAction(event) {\n    event.preventDefault();\n    this.hudManager.handleHudEvent(\"clickAction\", event);\n    event.currentTarget.blur();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle when an action is hovered\n   * @param {object} event The event\n   */\n  handleActionHover(event) {\n    this.hudManager.handleHudEvent(\"hoverAction\", event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Drag event handler\n   * @private\n   * @param {object} event The event\n   */\n  #dragEvent(event) {\n    if (!this.isDraggable) return;\n\n    // Get the main element\n    const element = this.element;\n\n    const clientX = event.clientX ?? event.changedTouches[0].clientX;\n    const clientY = event.clientY ?? event.changedTouches[0].clientY;\n\n    // Initialise positions and starting positions\n    let pos1 = 0;\n    let pos2 = 0;\n    let pos3 = clientX;\n    let pos4 = clientY;\n    const originalElementTop = element.offsetTop;\n    const originalElementLeft = element.offsetLeft;\n    let newElementTop = originalElementTop;\n    let newElementLeft = originalElementLeft;\n\n    /**\n     * Mouse movement event handler\n     * @param {object} event The event\n     */\n    const mouseMoveEvent = event => {\n      const clientX = event.clientX ?? event.changedTouches[0].clientX;\n      const clientY = event.clientY ?? event.changedTouches[0].clientY;\n      pos1 = pos3 - clientX;\n      pos2 = pos4 - clientY;\n      pos3 = clientX;\n      pos4 = clientY;\n\n      // If the mouse has not moved, do not update\n      if (pos1 === pos3 && pos2 === pos4) return;\n\n      newElementTop = newElementTop - pos2;\n      newElementLeft = newElementLeft - pos1;\n\n      this.topPos = newElementTop;\n\n      // Apply styles\n      requestAnimationFrame(() => {\n        Object.assign(element.style, { left: `${newElementLeft}px`, top: `${newElementTop}px` });\n      });\n    };\n\n    /* -------------------------------------------- */\n\n    /**\n     * Mouse up event handler\n     */\n    const mouseUpEvent = () => {\n      // Remove the mouse move and touch move events\n      document.onmousemove = null;\n      element.ontouchmove = null;\n\n      // Remove the mouse up and touch end events\n      document.onmouseup = null;\n      element.ontouchend = null;\n\n      // If position has not changed, do not update\n      if (newElementTop === originalElementTop && newElementLeft === originalElementLeft) return;\n\n      this.topPos = newElementTop;\n\n      this.#applyDirection();\n\n      // Save the new position to the user's flags\n      this.hudPosition = { top: newElementTop, left: newElementLeft };\n    };\n\n    // Bind mouse move and touch move events\n    document.onmousemove = mouseMoveEvent;\n    element.ontouchmove = mouseMoveEvent;\n\n    // Bind mouse up and touch end events\n    document.onmouseup = mouseUpEvent;\n    element.ontouchend = mouseUpEvent;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set position of the HUD\n   * @public\n   */\n  setPosition() {\n    if (!this.hudManager.hud) return;\n    if (this.isDocked) {\n      this.#setDockedPosition();\n    } else {\n      this.#setUndockedPosition();\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set docked position\n   */\n  #setDockedPosition() {\n    this.element.style.top = 0;\n    this.element.style.left = 0;\n\n    const interfaceElement = document.querySelector(\"#interface\");\n    switch (this.styleSetting) {\n      case \"dockedRight\":\n        interfaceElement.appendChild(this.element);\n        break;\n      case \"dockedCenterRight\":\n        const rightUiElement = interfaceElement.querySelector(\"#ui-right\");\n        interfaceElement.insertBefore(this.element, rightUiElement);\n        break;\n      case \"dockedLeft\":\n        const leftUiElement = interfaceElement.querySelector(\"#ui-left\");\n        interfaceElement.insertBefore(this.element, leftUiElement);\n        break;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set undocked position\n   */\n  #setUndockedPosition() {\n    document.body.appendChild(this.element);\n    this.#setPositionFromFlag();\n    this.#applyDirection();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the position of the HUD based on user flag\n   * @private\n   */\n  #setPositionFromFlag() {\n    if (!this.hudPosition) return;\n\n    const defaultLeftPos = this.defaultLeftPos;\n    const defaultTopPos = this.defaultTopPos;\n\n    return new Promise(resolve => {\n      const check = () => {\n        if (this.element) {\n          this.element.style.bottom = null;\n          this.topPos = this.hudPosition.top < 5 || this.hudPosition.top > window.innerHeight + 5\n            ? defaultTopPos\n            : this.hudPosition.top;\n          this.leftPos = this.hudPosition.left < 5 || this.hudPosition.left > window.innerWidth + 5\n            ? defaultLeftPos\n            : this.hudPosition.left;\n          this.element.style.top = `${this.topPos}px`;\n          this.element.style.left = `${this.leftPos}px`;\n          resolve();\n        } else {\n          setTimeout(check, 10);\n        }\n      };\n\n      check();\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * The direction the HUD will expand\n   * @private\n   * @returns {string} The direction\n   */\n  get direction() {\n    const direction = Utils.getSetting(\"direction\");\n    if (direction === \"up\" || (direction === \"auto\" && this.topPos > window.innerHeight / 2)) return \"up\";\n    return \"down\";\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * The HUD position\n   * @returns {object} The HUD position\n   */\n  get hudPosition() {\n    return Utils.getUserFlag(\"position\");\n  }\n\n  set hudPosition(obj) {\n    Utils.setUserFlag(\"position\", obj);\n    Logger.debug(`Position set to x: ${obj.top}px, y: ${obj.left}px`);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is enabled\n   * @returns {boolean} Whether the HUD is enabled\n   */\n  get isEnabled() {\n    return Utils.getSetting(\"enable\");\n  }\n\n  set isEnabled(bool) {\n    Utils.setSetting(\"enable\", bool);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is collapsed\n   * @returns {boolean} Whether the HUD is collapsed\n   */\n  get isCollapsed() {\n    return Utils.getUserFlag(\"isCollapsed\");\n  }\n\n  set isCollapsed(bool) {\n    Utils.setUserFlag(\"isCollapsed\", bool);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is docked\n   * @returns {boolean} Whether the HUD is docked\n   */\n  get isDocked() {\n    const dockedStyles = [\"dockedLeft\", \"dockedCenterLeft\", \"dockedCenterRight\", \"dockedRight\"];\n    return dockedStyles.includes(Utils.getSetting(\"style\"));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is unlocked\n   * @returns {boolean} Whether the HUD is unlocked\n   */\n  get isUnlocked() {\n    return Utils.getUserFlag(\"isUnlocked\");\n  }\n\n  set isUnlocked(bool) {\n    Utils.setUserFlag(\"isUnlocked\", bool);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is draggable\n   * @returns {boolean} Whether the HUD is draggable\n   */\n  get isDraggable() {\n    const drag = Utils.getSetting(\"drag\");\n    return ((drag === \"always\") || (drag === \"whenUnlocked\" && this.isUnlocked));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * The HUD scale\n   * @private\n   * @returns {number} The scale\n   */\n  get scale() {\n    if (this.isDocked) return 1;\n    const scale = parseFloat(Utils.getSetting(\"scale\")) || 1;\n    return Math.min(Math.max(scale, 0.5), 2);\n  }\n\n  /**\n   * Reset the position of the HUD\n   * @public\n   */\n  async resetPosition() {\n    Logger.debug(\"Resetting position...\");\n    this.hudPosition = { top: this.defaultTopPos, left: this.defaultLeftPos };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Copy user's data to others users\n   * @public\n   * @param {string} fromUserId        The user id to copy from\n   * @param {string | Array} toUserIds The user ids to copy to\n   */\n  async copy(fromUserId, toUserIds) {\n    await this.#copyUserData(fromUserId, toUserIds);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Copy user's data to others users\n   * @private\n   * @param {string} fromUserId        The user id to copy from\n   * @param {string | Array} toUserIds The user ids to copy to\n   */\n  async #copyUserData(fromUserId, toUserIds) {\n    if (!game.user.isGM) {\n      Logger.info(\"Copy failed: User is not a GM\", true);\n      return;\n    }\n    // Exit if parameters are missing\n    if (!fromUserId || !toUserIds.length) {\n      Logger.info(\"Copy failed: Parameters missing\", true);\n      return;\n    }\n\n    Logger.debug(\"Copying user data to users...\");\n\n    const fromGroup = await this.dataHandler.getDataAsGm({ type: \"user\", id: fromUserId });\n\n    if (typeof toUserIds === \"string\") {\n      await this.dataHandler.saveDataAsGm(\"user\", toUserIds, fromGroup);\n    } else if (Array.isArray(toUserIds)) {\n      for (const userId of toUserIds) {\n        await this.dataHandler.saveDataAsGm(\"user\", userId, fromGroup);\n      }\n    }\n\n    Logger.debug(\"User data copied to users\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset the HUD layout with the socket\n   */\n  static async resetLayoutWithSocket() {\n    game?.tokenActionHud?.resetLayout();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset the HUD layout\n   */\n  async resetLayout() {\n    Logger.debug(\"Resetting layout...\");\n    await this.resetUserAndActorData();\n    this.resetPosition();\n    Logger.debug(\"Layout reset\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset current actor's HUD data\n   */\n  async resetActorData() {\n    Logger.debug(\"Resetting actor data...\");\n\n    await this.dataHandler.saveDataAsGm(\"actor\", this.hudManager.actor.id, {});\n\n    Logger.debug(\"Actor data reset\");\n\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetActorData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset every actor's HUD data\n   * @public\n   */\n  async resetAllActorData() {\n    Logger.debug(\"Resetting all actor data...\");\n\n    for (const actor of game.actors) {\n      Logger.debug(`Resetting flags for actor [${actor.id}]`, { actor });\n      await this.dataHandler.saveDataAsGm(\"actor\", actor.id, {});\n    }\n\n    Logger.debug(\"All actor data reset\");\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetAllActorData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset user's HUD data\n   * @public\n   */\n  async resetUserData() {\n    Logger.debug(\"Resetting user data...\");\n    await this.dataHandler.saveDataAsGm(\"user\", game.userId, {});\n    Logger.debug(\"User data reset\");\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetUserData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset every user's HUD data\n   * @public\n   */\n  async resetAllUserData() {\n    Logger.debug(\"Resetting all user data...\");\n    for (const user of game.users) {\n      await this.dataHandler.saveDataAsGm(\"user\", user.id, {});\n    }\n    Logger.debug(\"All user data reset\");\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetAllUserData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset user and actor's HUD data\n   */\n  async resetUserAndActorData() {\n    Logger.debug(\"Resetting user data...\");\n    await this.dataHandler.saveDataAsGm(\"user\", game.userId, {});\n    Logger.debug(\"User data reset\");\n\n    Logger.debug(\"Resetting actor data...\");\n    await this.dataHandler.saveDataAsGm(\"actor\", this.hudManager.actor.id, {});\n    Logger.debug(\"Actor data reset\");\n\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetUserAndActorData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update the HUD\n   * @public\n   * @param {object} trigger The trigger for the update\n   */\n  async update(trigger = null) {\n    // Stops settings updates from triggering the HUD update multiple times\n    // Instead an update is triggered when settings are updated and the settings config window is closed\n    if (trigger?.name === \"closeSettingsConfig\") {\n      if (!this.updateSettingsPending) return;\n      this.updateSettingsPending = false;\n      Logger.debug(\"Settings updated\");\n    }\n\n    await this.#handleUpdate();\n    await this.#performUpdate(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handles HUD updates to avoid overlapping updates\n   */\n  async #handleUpdate() {\n    // Start a timer and reset it each time an update call is received before the timer has elapsed\n    if (this.isUpdatePending) this.updatePendingTimer.abort();\n\n    this.isUpdatePending = true;\n    await this.updatePendingTimer.start();\n    this.isUpdatePending = false;\n\n    // Wait for the current update to complete before progressing a pending update\n    // Stop waiting if the current update takes longer than 5 seconds\n    const waitForUpdateCompletion = async () => {\n      const maxWaitTime = 5000;\n      const interval = 10;\n      const iterations = maxWaitTime / interval;\n\n      let i = 0;\n      while (i < iterations && this.isUpdating) {\n        await this.updateTimer.start();\n        i++;\n      }\n\n      return !this.isUpdating;\n    };\n\n    if (this.isUpdating) {\n      const hasCompleted = await waitForUpdateCompletion();\n      if (!hasCompleted) {\n        Logger.debug(\"Update took too long. Aborting...\");\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Perform the HUD update following handling\n   * @param {object} trigger The trigger for the update\n   */\n  async #performUpdate(trigger) {\n    this.isUpdating = true;\n    Logger.debug(\"Updating HUD...\", trigger);\n\n    // Await does have an effect\n    const initialised = await this.hudManager.init(trigger);\n    if (!initialised) {\n      this.#abortUpdate();\n      return;\n    }\n\n    this.rendering = true;\n    this.render(true);\n\n    if (!ui.windows[this.appId]) {\n      ui.windows[this.appId] = this;\n    }\n\n    this.isUpdating = false;\n\n    Hooks.callAll(\"tokenActionHudCoreHudUpdated\", MODULE);\n    Logger.debug(\"HUD updated\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Abort the HUD update with a debug message\n   * @private\n   */\n  #abortUpdate() {\n    this.#close();\n    Logger.debug(\"HUD update aborted as no character(s) found or HUD is disabled\");\n    this.isUpdating = false;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Close the HUD\n   * @public\n   */\n  closeHud() {\n    this.#close();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Close the HUD\n   * @private\n   */\n  #close() {\n    requestAnimationFrame(() => {\n      this.element?.classList?.remove(\"tah-expanded\");\n      this.element?.classList?.add(\"tah-closed\");\n    });\n\n    this.openGroups = new Set();\n    this.closeTimer = setTimeout(() => {\n      this.close({ animate: false });\n    }, 500);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the token change is valid for a HUD update\n   * @public\n   * @param {object} token The token\n   * @param {object} data  The data\n   * @returns {boolean}    Whether the token change is valid for a HUD update\n   */\n  isValidTokenChange(token, data = null) {\n    if (data.flags) return false;\n    return this.#isRelevantToken(token) || (Utils.getSetting(\"alwaysShowHud\") && token.actorId === game.user.character?.id);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the token is controlled or on the canvas\n   * @private\n   * @param {object} token The token\n   * @returns {boolean} Whether the token is controlled or on the canvas\n   */\n  #isRelevantToken(token) {\n    const controlledTokens = Utils.getControlledTokens();\n    return (\n      controlledTokens?.some(controlledToken => controlledToken.id === token.id)\n        || (!controlledTokens?.length\n          && canvas?.tokens?.placeables?.some(token => token.id === this.hudManager.token?.id))\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the given actor is the selected actor\n   * @param {object} actor The actor\n   * @returns {boolean}    Whether the given actor is the selected actor\n   */\n  isControlledActor(actor) {\n    return actor?.id === this.hudManager.actor?.id;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the actor or item update is valid for a HUD update\n   * @param {object} actor The actor\n   * @param {object} data  The data\n   * @returns {boolean}    Whether the actor or item update is valid for a HUD update\n   */\n  isValidActorOrItemUpdate(actor, data) {\n    if (!actor) {\n      Logger.debug(\"No actor; updating HUD\", { data });\n      return true;\n    }\n\n    if (this.isControlledActor(actor)) {\n      Logger.debug(\"Same actor; updating HUD\", { actor, data });\n      return true;\n    } else {\n      Logger.debug(\"Different actor; skipping HUD update\", { actor, data });\n      return false;\n    }\n  }\n}\n","import { MODULE } from \"./constants.mjs\";\nimport { DataHandler } from \"../handlers/data-handler.mjs\";\nimport { TokenActionHud } from \"../applications/token-action-hud.mjs\";\n\nlet socket;\n\n/**\n * Register socket with socketlib module\n */\nexport function registerSocket() {\n  socket = socketlib.registerModule(MODULE.ID);\n  socket.register(\"getFilePaths\", DataHandler.getFilePathsWithSocket);\n  socket.register(\"getData\", DataHandler.getDataWithSocket);\n  socket.register(\"saveData\", DataHandler.saveDataWithSocket);\n  socket.register(\"reset\", TokenActionHud.resetLayoutWithSocket);\n}\n\n/**\n * Whether the socketlib module is active\n * @returns {boolean} Whether the socketlib module is active\n */\nexport function isSocketlibActive() {\n  if (game.modules.get(\"socketlib\")?.active) return true;\n\n  Logger.error(\"This module requires the 'socketlib' module to be installed and enabled.\", true);\n  return false;\n}\n\n\n/**\n * Get the socket\n * @returns {object} The socket\n */\nexport function getSocket() {\n  return socket;\n}\n","import { GROUP_TYPE } from \"../../core/constants.mjs\";\nimport { Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for building the HUD's generic actions.\n */\nexport class GenericActionHandler {\n  constructor(actionHandler) {\n    this.actionHandler = actionHandler;\n    this.actor = actionHandler.actor;\n    this.token = actionHandler.token;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build generic actions\n   * @public\n   */\n  buildActions() {\n    this.#buildUtilities();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build utilities\n   * @private\n   */\n  #buildUtilities() {\n    if (this.actor) {\n      this.#buildSingleTokenUtilities();\n    } else {\n      this.#buildMultipleTokenUtilities();\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build utilities for a single token\n   * @private\n   */\n  #buildSingleTokenUtilities() {\n    if (!this.token) return;\n    const actionsData = [];\n\n    // Build Toggle Combat action\n    const toggleCombatId = \"toggleCombat\";\n    const toggleCombatName = this.token?.inCombat\n      ? game.i18n.localize(\"tokenActionHud.removeFromCombat\")\n      : game.i18n.localize(\"tokenActionHud.addToCombat\");\n    const toggleCombatAction = {\n      id: toggleCombatId,\n      name: toggleCombatName,\n      onClick: async () => {\n        const token = Utils.getFirstControlledToken();\n        token.document.toggleCombatant();\n\n      }\n    };\n    actionsData.push(toggleCombatAction);\n\n    // Build Toggle Visibility action\n    if (game.user.isGM) {\n      const toggleVisibilityId = \"toggleVisibility\";\n      const toggleVisibilityName = this.token?.document?.hidden\n        ? game.i18n.localize(\"tokenActionHud.makeVisible\")\n        : game.i18n.localize(\"tokenActionHud.makeInvisible\");\n      const toggleVisibilityAction = {\n        id: toggleVisibilityId,\n        name: toggleVisibilityName,\n        onClick: async () => {\n          const token = Utils.getFirstControlledToken();\n          const isHidden = token.document.hidden;\n          await token.document.update({ hidden: !isHidden });\n        }\n      };\n      actionsData.push(toggleVisibilityAction);\n    }\n\n    const groupData = { id: \"token\", type: GROUP_TYPE.SYSTEM };\n\n    // Add actions to HUD\n    this.actionHandler.addActions(actionsData, groupData);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build utilities for multiple tokens\n   * @private\n   */\n  #buildMultipleTokenUtilities() {\n    const tokens = Utils.getControlledTokens();\n    const actionsData = [];\n\n    // Toggle Combat\n    const toggleCombatId = \"toggleCombat\";\n    const toggleCombatName = tokens.every(token => token.inCombat)\n      ? game.i18n.localize(\"tokenActionHud.removeFromCombat\")\n      : game.i18n.localize(\"tokenActionHud.addToCombat\");\n    const toggleCombatAction = {\n      id: toggleCombatId,\n      name: toggleCombatName,\n      onClick: async () => {\n        const controlledTokens = Utils.getControlledTokens();\n        for (const token of controlledTokens) {\n          await token.document.toggleCombatant();\n        }\n      }\n    };\n    actionsData.push(toggleCombatAction);\n\n    // Toggle Visibility\n    if (game.user.isGM) {\n      const toggleVisibilityId = \"toggleVisibility\";\n      const toggleVisibilityname = tokens.every(token => token.document?.hidden)\n        ? game.i18n.localize(\"tokenActionHud.makeVisible\")\n        : game.i18n.localize(\"tokenActionHud.makeInvisible\");\n      const toggleVisibilityAction = {\n        id: toggleVisibilityId,\n        name: toggleVisibilityname,\n        onClick: async () => {\n          const controlledTokens = Utils.getControlledTokens();\n          for (const token of controlledTokens) {\n            const isHidden = token.document.hidden;\n            await token.document.update({ hidden: !isHidden });\n          }\n        }\n      };\n      actionsData.push(toggleVisibilityAction);\n    }\n\n    const groupData = { id: \"token\", type: GROUP_TYPE.SYSTEM };\n\n    // Add actions to HUD\n    this.actionHandler.addActions(actionsData, groupData);\n  }\n}\n","import { ACTION_TYPE, COMPENDIUM_PACK_TYPES } from \"../../core/constants.mjs\";\nimport { Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for building the HUD's compendium actions.\n */\nexport class CompendiumActionHandler {\n  actionHandler;\n\n  compendiumActions;\n\n  packIds;\n\n  constructor(actionHandler) {\n    this.actionHandler = actionHandler;\n    this.compendiumActions = new Map();\n    this.packIds = [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build compendium actions\n   */\n  async buildActions() {\n    if (this.compendiumActions.size === 0) {\n      this.packIds = game.packs\n        .filter(\n          pack =>\n            COMPENDIUM_PACK_TYPES.includes(pack.documentName)\n              && (foundry.utils.isNewerVersion(game.version, \"10\") ? pack.visible : !pack.private || game.user.isGM)\n        )\n        .map(pack => pack.metadata.id);\n\n      if (this.packIds.length === 0) return;\n\n      await Promise.all(this.packIds.map(packId => this.#setActions(packId)));\n    }\n\n    for (const pack of this.compendiumActions.values()) {\n      this.actionHandler.addActions(pack.actionsData, pack.groupData);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set compendium actions into the compendiumActions map\n   * @param {string} packId The pack id\n   */\n  async #setActions(packId) {\n    const pack = game.packs.get(packId);\n    const entries = pack ? pack.index.size > 0 ? pack.index : await pack.getIndex() : null;\n    if (!entries) return;\n    const actionType = this.#getCompendiumActionType(pack?.documentName);\n    if (!actionType) return;\n    const actionsData = entries.map(entry => ({\n      id: entry._id,\n      name: entry.name,\n      listName: `${game.i18n.localize(ACTION_TYPE[actionType])}: ${entry.name}`,\n      img: Utils.getImage(entry),\n      function: this.#getOnClick(actionType, pack, entry._id)\n    }));\n    const groupData = { id: this.#getGroupId(packId), type: \"core\" };\n    this.compendiumActions.set(packId, { actionsData, groupData });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get compendium action type based on document name\n   * @param {string} documentName The pack document name\n   * @returns {string}            The compendium action type\n   */\n  #getCompendiumActionType(documentName) {\n    switch (documentName) {\n      case \"Macro\":\n        return \"compendiumMacro\";\n      default:\n        return \"compendiumEntry\";\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get on click function\n   * @param {string} actionType The action type\n   * @param {object} pack       The compendium pack\n   * @param {string} documentId The document ID\n   * @returns {Function}        The function\n   */\n  #getOnClick(actionType, pack, documentId) {\n    switch (actionType) {\n      case \"compendiumMacro\":\n        return this.#getOnClickFunction(pack, documentId);\n      default:\n        return this.#getOnClickEntry(pack, documentId);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get on click function for compendium journal entry\n   * @param {object} pack       The pack\n   * @param {string} documentId The document ID\n   * @returns {Function}        The function\n   */\n  #getOnClickEntry(pack, documentId) {\n    return async () => {\n      const journalEntry = await pack.getDocument(documentId);\n      journalEntry.sheet.render(true); };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get on click function for compendium macro\n   * @param {object} pack       The pack\n   * @param {string} documentId The document ID\n   * @returns {Function}        The function\n   */\n  #getOnClickFunction(pack, documentId) {\n    return async () => {\n      await pack.getDocument(documentId).then(macro => macro.execute());\n    };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the group ID from the pack ID\n   * @param {string} packId The pack id\n   * @returns {string}      The group id\n   */\n  #getGroupId(packId) {\n    return packId.replace(\".\", \"-\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the compendium is linked\n   * @public\n   * @param {string} packId The pack id\n   * @returns {boolean}     Whether the compendium is linked\n   */\n  isLinkedCompendium(packId) {\n    return (this.packIds.length)\n      ? this.packIds?.includes(packId)\n      : false;\n  }\n}\n","import { ACTION_TYPE } from \"../../core/constants.mjs\";\nimport { Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for building the HUD's macro actions.\n */\nexport class MacroActionHandler {\n  constructor(actionHandler) {\n    this.actionHandler = actionHandler;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build macro actions\n   * @override\n   */\n  async buildActions() {\n    if (!this.macroActions) {\n      this.macroActions = {\n        actionsData: await this.#getActions(),\n        groupData: { id: \"macros\", type: \"core\" }\n      };\n    }\n\n    this.actionHandler.addActions(this.macroActions.actionsData, this.macroActions.groupData);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actions\n   * @private\n   * @returns {object} The actions\n   */\n  async #getActions() {\n    const actionType = \"macro\";\n    const macros = game.macros.filter(macro => this.#hasPermission(macro));\n\n    return macros.map(macro => {\n      return {\n        id: macro.id,\n        name: macro.name,\n        listName: this.#getListName(actionType, macro.name),\n        img: Utils.getImage(macro),\n        onClick: () => {\n          game.macros.get(macro.id).execute();\n        }\n      };\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Check if the user has permission for the macro\n   * @private\n   * @param {object} macro The macro\n   * @returns {boolean}    Whether the user has permission\n   */\n  #hasPermission(macro) {\n    const { ownership } = macro;\n    return ownership[game.userId] ? ownership[game.userId] > 0 : ownership.default > 0;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get list name\n   * @param {string} actionType The action type\n   * @param {string} name       The action name\n   * @returns {string}          The list name\n   */\n  #getListName(actionType, name) {\n    const actionTypeName = `${game.i18n.localize(ACTION_TYPE[actionType])}: ` ?? \"\";\n    return `${actionTypeName}${name}`;\n  }\n}\n","import { DELIMITER } from \"../../core/constants.mjs\";\nimport { GenericActionHandler } from \"./generic-action-handler.mjs\";\nimport { CompendiumActionHandler } from \"./compendium-action-handler.mjs\";\nimport { MacroActionHandler } from \"./macro-action-handler.mjs\";\nimport { getTooltip } from \"../tooltip-handler.mjs\";\nimport { Logger, Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for the HUD actions.\n */\nexport class ActionHandler {\n  constructor() {\n    this.hudManager = {};\n    this.groupHandler = {};\n    this.genericActionHandler = new GenericActionHandler(this);\n    this.compendiumActionHandler = new CompendiumActionHandler(this);\n    this.macroActionHandler = new MacroActionHandler(this);\n    this.actions = [];\n    this.availableActions = new Map();\n    this.delimiter = DELIMITER;\n    this.actionHandlerExtenders = [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Soft reset variables\n   */\n  softReset() {\n    this.genericActionHandler = new GenericActionHandler(this);\n    this.actions = [];\n    this.availableActions = new Map();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare actions\n   * @param {object} groups The HUD groups\n   */\n  prepareActions(groups) {\n    for (const group of Object.values(groups)) {\n      if (group.actions?.length) {\n        this.actions.push(...group.actions);\n        for (const action of group.actions) {\n          action.selected = false;\n        }\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build actions\n   */\n  async buildActionsCore() {\n    await Promise.all([\n      this.#buildSystemActionsCore(),\n      this.#buildGenericActionsCore(),\n      this.#buildCompendiumActionsCore(),\n      this.#buildMacroActionsCore()\n    ]);\n    await this.#buildExtendedActionsCore();\n    this.#updateNonPresetActions();\n    this.#setCharacterLimit();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build system-specific actions\n   * @private\n   */\n  async #buildSystemActionsCore() {\n    Logger.debug(\"Building system actions...\", { actor: this.actor, token: this.token });\n    const groupIds = this.groupHandler.getGroupIds();\n    await this.buildSystemActions(groupIds);\n    Logger.debug(\"System actions built\", { hud: this.hud, actor: this.actor, token: this.token });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Placeholder function for the system module\n   * @override\n   * @param {Array} groupIds The group IDs\n   */\n  async buildSystemActions(groupIds) {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build compendium-specific actions\n   * @private\n   */\n  async #buildCompendiumActionsCore() {\n    Logger.debug(\"Building compendium actions...\");\n    await this.compendiumActionHandler.buildActions();\n    Logger.debug(\"Compendium actions built\", { hud: this.hud });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build generic actions\n   * @private\n   */\n  #buildGenericActionsCore() {\n    Logger.debug(\"Building generic actions...\", { actor: this.actor, token: this.token });\n    this.genericActionHandler.buildActions();\n    Logger.debug(\"Generic actions built\", { hud: this.hud, actor: this.actor, token: this.token });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build macro-specific actions\n   * @private\n   */\n  async #buildMacroActionsCore() {\n    Logger.debug(\"Building macro actions...\");\n    await this.macroActionHandler.buildActions();\n    Logger.debug(\"Macro actions built\", { hud: this.hud });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build extended actions\n   * @private\n   */\n  async #buildExtendedActionsCore() {\n    await Promise.all(this.actionHandlerExtenders.map(\n      async extender => await extender.extendActionHandler()\n    ));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update non-preset actions\n   * @private\n   */\n  #updateNonPresetActions() {\n    const nonPresetActions = this.actions.filter(action => !action?.isPreset);\n\n    for (const nonPresetAction of nonPresetActions) {\n      const availableAction = this.availableActions.get(nonPresetAction.id);\n\n      if (availableAction) {\n        const systemSelected = availableAction.systemSelected ?? nonPresetAction.systemSelected;\n        const userSelected = nonPresetAction.userSelected ?? availableAction.userSelected;\n        Object.assign(nonPresetAction, this.#createAction({ ...availableAction, systemSelected, userSelected }));\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set character limit for action names based on the 'Character per Word' setting\n   * @private\n   */\n  #setCharacterLimit() {\n    const groups = this.groupHandler.getGroups({ level: 1 });\n\n    for (const group of groups) {\n      const groupCharacterCount = group?.settings?.characterCount;\n\n      const subgroups = this.groupHandler.getGroups({ nestId: group.nestId });\n\n      for (const subgroup of subgroups) {\n        const actions = subgroup.actions;\n        if (!actions?.length) continue;\n\n        const subgroupCharacterCount = subgroup?.settings?.characterCount;\n        const characterCount = (subgroupCharacterCount >= 0)\n          ? groupCharacterCount\n          : subgroupCharacterCount;\n\n        // Exit if character limit is not defined\n        if ((!characterCount && characterCount !== 0) || characterCount < 0) continue;\n\n        for (const action of actions) {\n          if (action.name.length <= characterCount) continue;\n          if (characterCount === 0) {\n            action.name = \"\";\n            continue;\n          }\n          // Set each word to the character limit\n          action.name = action.name\n            .split(\" \")\n            .map(word => word.slice(0, characterCount))\n            .join(\" \");\n        }\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actions by ID\n   * @public\n   * @param {object} actionData The action data\n   * @returns {Array}           The actions\n   */\n  getActions(actionData) {\n    return this.actions.filter(action => action.id === actionData.id);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Create action\n   * @private\n   * @param {object} actionData The action data\n   * @returns {object}          The action\n   */\n  #createAction(actionData) {\n    const fullName = actionData.fullName ?? actionData.name;\n    const tooltip = getTooltip(actionData.tooltip, fullName);\n\n    const infoProps = info => {\n      if (!info) return {};\n      return {\n        ...(info.class && { class: info.class }),\n        ...(info.icon && { icon: info.icon }),\n        ...(info.text && { text: info.text }),\n        ...(info.title && { title: info.title })\n      };\n    };\n\n    return {\n      id: actionData.id,\n      name: actionData.name,\n      fullName,\n      listName: actionData.listName || actionData.name,\n      ...(actionData.onClick && { onClick: actionData.onClick }),\n      ...(actionData.onHover && { onClick: actionData.onHover }),\n      ...(actionData.encodedValue && { encodedValue: actionData.encodedValue }),\n      ...(actionData.cssClass && { cssClass: actionData.cssClass }),\n      icons: actionData.icons || {},\n      ...(actionData.icon1 && { icon1: actionData.icon1 }),\n      ...(actionData.icon2 && { icon2: actionData.icon2 }),\n      ...(actionData.icon3 && { icon3: actionData.icon3 }),\n      ...(actionData.img && { img: actionData.img }),\n      info1: infoProps(actionData.info1),\n      info2: infoProps(actionData.info2),\n      info3: infoProps(actionData.info3),\n      system: actionData.system || {},\n      isAction: true,\n      ...(actionData.isItem && { isItem: actionData.isItem }),\n      ...(actionData.isPreset && { isPreset: actionData.isPreset }),\n      userSelected: actionData.userSelected ?? true,\n      systemSelected: actionData.systemSelected ?? true,\n      selected: actionData.systemSelected\n        ? actionData.userSelected ?? actionData.systemSelected ?? true\n        : false,\n      tooltip,\n      ...(actionData.useRawHtmlName && { useRawHtmlName: actionData.useRawHtmlName })\n    };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add actions to the HUD\n   * @public\n   * @param {object} actionsData The actions data\n   * @param {object} groupData   The group data\n   */\n  addActions(actionsData, groupData) {\n    if (!actionsData.length) return;\n\n    // Create actions\n    const actions = new Map(actionsData.map(actionData => [actionData.id, this.#createAction(actionData)]));\n    this.#addToAvailableActions(actions);\n\n    if (!groupData?.id) return;\n\n    if (!groupData?.type) { groupData.type = \"system\"; }\n\n    const groups = this.groupHandler.getGroups(groupData);\n\n    if (!groups) return;\n\n    for (const group of groups) {\n      // Get existing actions\n      const existingActions = new Map(group.actions.map(action => [action.id, action]));\n\n      const reorderedActions = [];\n\n      // Loop the previously saved actions in the group\n      existingActions.forEach((existingAction, existingActionId) => {\n        const action = actions.get(existingActionId);\n        if (action) {\n          const systemSelected = action.systemSelected ?? existingAction.systemSelected;\n          const userSelected = existingAction.userSelected ?? action.userSelected;\n          const selected = (!systemSelected)\n            ? false\n            : userSelected ?? systemSelected ?? true;\n          Object.assign(existingAction, { ...action, isPreset: true, selected, systemSelected, userSelected });\n        } else if (!existingAction.selected && existingAction.isPreset) {\n          const systemSelected = false;\n          Object.assign(existingAction, this.#createAction({ ...existingAction, systemSelected }));\n        }\n      });\n\n      // Loop the generated actions and add any not previously saved\n      actions.forEach((action, actionId) => {\n        const existingAction = existingActions.get(actionId);\n        if (!existingAction) reorderedActions.push(this.#createAction({ ...action, isPreset: true }));\n      });\n\n      // Sort actions alphabetically\n      if (\n        groupData?.settings?.sort\n        || (typeof groupData?.settings?.sort === \"undefined\" && Utils.getSetting(\"sortActions\"))\n      ) {\n        reorderedActions.sort((a, b) => a.name.localeCompare(b.name));\n      }\n\n      // Add actions to group\n      group.actions.push(...reorderedActions);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update actions\n   * @public\n   * @param {Array} actionsData The actions data\n   * @param {object} groupData  The group data\n   */\n  updateActions(actionsData, groupData) {\n    const group = this.groupHandler.getGroup(groupData);\n    const actions = group.actions;\n\n    const reorderedActions = [];\n\n    // Set 'selected' to true for selected actions\n    // Reorder actions based on order in dialog\n    for (const actionData of actionsData) {\n      if (actionData.id.includes(\"itemMacro\")) continue;\n      const existingAction = group.actions.find(action => action.id === actionData.id);\n      if (existingAction) {\n        const actionClone = { ...existingAction, userSelected: true };\n        reorderedActions.push(actionClone);\n      } else {\n        const availableAction = this.availableActions.get(actionData.id);\n        if (availableAction) {\n          const actionClone = { ...availableAction, userSelected: true };\n          reorderedActions.push(actionClone);\n        }\n      }\n    }\n    // Set 'selected' to false for unselected actions\n    for (const action of actions) {\n      if (!action.id || action?.id.includes(\"itemMacro\")) continue;\n\n      const actionData = actionsData.find(actionData => actionData.id === action.id);\n      if (!actionData && action.isPreset) {\n        const actionClone = { ...action, userSelected: false };\n        reorderedActions.push(actionClone);\n      }\n    }\n\n    // Sort actions alphabetically\n    if (groupData?.settings?.sort\n      || (typeof groupData?.settings?.sort === \"undefined\" && Utils.getSetting(\"sortActions\"))) {\n      reorderedActions.sort((a, b) => a.name.localeCompare(b.name));\n    }\n\n    // Replace group actions\n    group.actions = reorderedActions;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add to available actions\n   * @private\n   * @param {Array} actions The actions\n   */\n  #addToAvailableActions(actions) {\n    actions.forEach((action, actionId) => {\n      if (!this.availableActions.has(actionId)) this.availableActions.set(actionId, action);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get available actions as Tagify entries\n   * @public\n   * @returns {Array} The available actions as Tagify entries\n   */\n  getAvailableActionsAsTags() {\n    return [...this.availableActions.values()]\n      .map(action => this.#toTagify(action))\n      .sort((a, b) => a.value.localeCompare(b.value));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get selected actions as Tagify entries\n   * @public\n   * @param {object} groupData The group data\n   * @returns {Array}          The selected actions as Tagify entries\n   */\n  getSelectedActionsAsTags(groupData) {\n    const group = this.groupHandler.getGroup(groupData);\n    if (!group) return [];\n    return group.actions\n      .filter(action => action.selected === true)\n      .map(action => this.#toTagify(action));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add action handler extender\n   * @public\n   * @param {object} actionHandlerExtender The action handler extender\n   */\n  addActionHandlerExtender(actionHandlerExtender) {\n    Logger.debug(\"Adding action handler extender...\", { actionHandlerExtender });\n    actionHandlerExtender.hudManager = this.hudManager;\n    actionHandlerExtender.groupHandler = this.groupHandler;\n    actionHandlerExtender.actionHandler = this;\n    this.actionHandlerExtenders.push(actionHandlerExtender);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Convert an action into a Tagify entry\n   * @private\n   * @param {object} actionData The action data\n   * @returns {object}          The Tagify entry\n   */\n  #toTagify(actionData) {\n    const { id, name, listName } = actionData;\n    return { id, name, type: \"action\", value: listName ?? name };\n  }\n\n  /* -------------------------------------------- */\n  /* Shortcuts to the HudManager properties       */\n  /* -------------------------------------------- */\n\n  /**\n   * Get character name\n   * @returns {string} The character name\n   */\n  get characterName() {\n    return this.hudManager?.characterName;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actor\n   * @returns {object} The actor\n   */\n  get actor() {\n    return this.hudManager?.actor;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set actor\n   */\n  set actor(actor) {\n    this.hudManager.actor = actor;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actors\n   * @returns {Array} The actors\n   */\n  get actors() {\n    return this.hudManager?.actors;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set actors\n   * @param {Array} actors The actors\n   */\n  set actors(actors) {\n    this.hudManager.actors = actors;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get token\n   * @returns {object} The token\n   */\n  get token() {\n    return this.hudManager?.token;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set token\n   */\n  set token(token) {\n    this.hudManager.token = token;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get tokens\n   * @returns {Array} The tokens\n   */\n  get tokens() {\n    return this.hudManager?.tokens;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set tokens\n   * @param {Array} tokens The tokens\n   */\n  set tokens(tokens) {\n    this.hudManager.tokens = tokens;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the right mouse button was clicked\n   * @returns {boolean} Whether the right mouse button was clicked\n   */\n  get isRightClick() {\n    return this.hudManager?.isRightClick;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the ALT key was pressed\n   * @returns {boolean} Whether the ALT key was pressed\n   */\n  get isAlt() {\n    return this.hudManager?.isAlt;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the CTRL key was pressed\n   * @returns {boolean} Whether the CTRL key was pressed\n   */\n  get isCtrl() {\n    return this.hudManager?.isCtrl;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the SHIFT key was pressed\n   * @returns {boolean} Whether the SHIFT key was pressed\n   */\n  get isShift() {\n    return this.hudManager?.isShift;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the element was hovered\n   * @returns {boolean} Whether the element was hovered\n   */\n  get isHover() {\n    return this.hudManager?.isHover;\n  }\n}\n","import { ActionHandler } from \"./action-handler.mjs\";\n\n/**\n * An extension of the base ActionHandler which extends the HUD via core or system modules.\n */\nexport class ActionHandlerExtender extends ActionHandler {\n  constructor() {\n    super();\n  }\n\n  /**\n   * Extend action handler\n   * @override\n   */\n  extendActionHandler() {}\n}\n","import { DELIMITER } from \"../../core/constants.mjs\";\nimport { Logger, Utils } from \"../../core/utils.mjs\";\n\n/**\n * Resolves core actions triggered from the HUD\n */\nexport class RollHandler {\n  constructor() {\n    this.hudManager = null;\n    this.delimiter = DELIMITER;\n    this.preRollHandlers = [];\n    this.rollHandlerExtenders = [];\n  }\n\n  /**\n   * Throw error\n   * @public\n   * @param {*} err The error\n   */\n  throwInvalidValueErr(err) {\n    throw new Error(\n      `Error handling button click: ${err}`\n    );\n  }\n\n  /**\n   * Handle action events\n   * @public\n   * @param {object} event The event\n   * @param {object} action The action\n   */\n  async handleActionClickCore(event, action) {\n    try {\n      Logger.debug(\"Handling action click event\", { event });\n\n      // Update variables with current action context\n      this.action = action;\n\n      // If the action has an onClick function, call it and trigger a HUD update\n      if (typeof action?.onClick === \"function\") {\n        action.onClick();\n        Hooks.callAll(\"forceUpdateTokenActionHud\");\n        return;\n      }\n\n      // Get the value of the associated button\n      const buttonValue = this.#getButtonValue(event);\n\n      // Check pre-handlers\n      let handled = false;\n      for (const handler of this.preRollHandlers) {\n        if (handled) break;\n        handler.action = this.action;\n        handled = handler.prehandleActionEvent(event, buttonValue, this.actionHandler);\n      }\n\n      // If the action was not handled by the pre-handlers, call the default method\n      if (!handled) {\n        this.handleActionClick(event, buttonValue);\n      }\n    } catch(error) {\n      Logger.error(\"Error handling action click event\", { error, event, action });\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Overide for the TAH system module\n   * @override\n   * @param {object} event       The event\n   * @param {string} buttonValue The button value\n   */\n  handleActionClick(event, buttonValue) {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle action hover events\n   * @param {object} event  The event\n   * @param {object} action The action\n   */\n  async handleActionHoverCore(event, action) {\n    Logger.debug(\"Handling action hover event\", { event });\n\n    // Update variables with current action context\n    this.action = action;\n\n    // If the action has an onHover function, call it\n    if (typeof action?.onHover === \"function\") {\n      action.onHover();\n      return;\n    }\n\n    // Get the value of the associated button\n    const buttonValue = this.#getButtonValue(event);\n\n    this.handleActionHover(event, buttonValue);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Overide for the TAH system module\n   * @override\n   * @param {object} event       The event\n   * @param {string} buttonValue The button value\n   */\n  handleActionHover(event, buttonValue) {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle group click events\n   * @param {object} event The event\n   * @param {group} group  The nest ID\n   */\n  async handleGroupClickCore(event, group) {\n    Logger.debug(`Handling click event for group [${group.name}]`, { event });\n\n    this.handleGroupClick(event, group);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Overide for the TAH system module\n   * @override\n   * @param {object} event The event\n   * @param {object} group The group\n   */\n  handleGroupClick(event, group) {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add a pre-roll handler\n   * @public\n   * @param {object} handler The roll handler\n   */\n  addPreRollHandler(handler) {\n    Logger.debug(`Adding pre-roll handler ${handler.constructor.name}`);\n    this.preRollHandlers.push(handler);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get button value\n   * @private\n   * @param {object} event  The event\n   * @returns {string}      The button value\n   */\n  #getButtonValue(event) {\n    if (!event) return null;\n    const buttonElement = event.target.querySelector(\".tah-action-button\") ?? event.target.closest(\".tah-action-button\");\n    return buttonElement?.value || null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Renders the item sheet\n   * @public\n   * @param {object} actor  The actor\n   * @param {string} itemId The item id\n   * @returns {boolean}     Whether the item was rendered\n   */\n  renderItem(actor, itemId) {\n    // If actor is not specified, use the RollHandler's actor\n    if (!actor) {\n      actor = this.actor;\n    }\n\n    // Get the item\n    const item = Utils.getItem(actor, itemId);\n\n    // If the item is not found, return false\n    if (!item) return false;\n\n    // Render the item and return true\n    item.sheet.render(true);\n    return true;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the item sheet should be rendered\n   * @public\n   * @returns {boolean}\n   */\n  isRenderItem() {\n    return (this.isRightClick && !(this.isAlt || this.isCtrl || this.isShift));\n  }\n\n  /* -------------------------------------------- */\n  /* Shortcuts to the HudManager properties       */\n  /* -------------------------------------------- */\n\n  /**\n   * Get actor\n   * @returns {object} The actor\n   */\n  get actor() {\n    return this.hudManager?.actor;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actors\n   * @returns {Array} The actors\n   */\n  get actors() {\n    return this.hudManager?.actors;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get token\n   * @returns {object} The token\n   */\n  get token() {\n    return this.hudManager?.token;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get tokens\n   * @returns {Array} The tokens\n   */\n  get tokens() {\n    return this.hudManager?.tokens;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the right mouse button was clicked\n   * @returns {boolean} Whether the right mouse button was clicked\n   */\n  get isRightClick() {\n    return this.hudManager.isRightClick;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the ALT key was pressed\n   * @returns {boolean} Whether the ALT key was pressed\n   */\n  get isAlt() {\n    return this.hudManager.isAlt;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the CTRL key was pressed\n   * @returns {boolean} Whether the CTRL key was pressed\n   */\n  get isCtrl() {\n    return this.hudManager.isCtrl;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the SHIFT key was pressed\n   * @returns {boolean} Whether the SHIFT key was pressed\n   */\n  get isShift() {\n    return this.hudManager.isShift;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the element was hovered over\n   * @returns {boolean} Whether the element was hovered over\n   */\n  get isHover() {\n    return this.hudManager?.isHover;\n  }\n}\n","import { RollHandler } from \"./roll-handler.mjs\";\n\n/*\n * Used for adding support for actions not part of the core functions.\n * Returns true from prehandleActionEvent() if it can perform an action and stops\n * further actions being performed.\n */\nexport class PreRollHandler extends RollHandler {\n  /**\n   * Pre-handle action event\n   * @param {object} event        The event\n   * @param {string} buttonValue  The button value\n   * @param {class} actionHandler The ActionHandler instance\n   * @returns {boolean}\n   */\n  prehandleActionEvent(event, buttonValue, actionHandler) {\n    return false;\n  }\n}\n","import { RollHandler } from \"./roll-handler.mjs\";\n\n/**\n * An extension of the base RollHandler which extends the actions that can be handled\n */\nexport class RollHandlerExtender extends RollHandler {\n  /**\n   * Pre-handle action event\n   * @param {object} event        The event\n   * @param {string} buttonValue  The button value\n   * @param {class} actionHandler The ActionHandler instance\n   * @returns {boolean}\n   */\n  prehandleActionEvent(event, buttonValue, actionHandler) {\n    return false;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle action click\n   * @override\n   * @param {object} event        The click event\n   * @param {string} buttonValue  The button value\n   * @param {class} actionHandler The ActionHandler instance\n   * @returns {boolean}\n   */\n  handleActionClick(event, buttonValue, actionHandler) {\n    return false;\n  }\n}\n","import { CUSTOM_STYLE, MODULE, TEMPLATE } from \"../core/constants.mjs\";\nimport { Utils } from \"../core/utils.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class CustomStyleForm extends HandlebarsApplicationMixin(ApplicationV2) {\n  constructor(...args) {\n    super(args);\n  }\n\n  /* -------------------------------------------- */\n\n  static DEFAULT_OPTIONS = {\n    actions: {\n      reset: CustomStyleForm.reset\n    },\n    classes: [`${MODULE.ID}-app`, \"sheet\"],\n    id: \"token-action-hud-core-settings\",\n    form: {\n      closeOnSubmit: true,\n      handler: CustomStyleForm.submit\n    },\n    position: {\n      width: 600,\n      height: 680\n    },\n    tag: \"form\",\n    window: {\n      minimizable: true,\n      resizable: true,\n      title: \"tokenActionHud.settings.customStyle.form.title\"\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  static PARTS = {\n    form: {\n      template: TEMPLATE.customStyleForm\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  async _prepareContext() {\n    this.context = {\n      backgroundColor: Utils.getSetting(\"backgroundColor\", CUSTOM_STYLE.backgroundColor.default),\n      buttonHeight: Utils.getSetting(\"buttonHeight\", CUSTOM_STYLE.buttonHeight.default),\n      buttonBackgroundColor: Utils.getSetting(\"buttonBackgroundColor\", CUSTOM_STYLE.buttonBackgroundColor.default),\n      buttonHoverBackgroundColor: Utils.getSetting(\"buttonHoverBackgroundColor\", CUSTOM_STYLE.buttonHoverBackgroundColor.default),\n      buttonToggleActiveBackgroundColor: Utils.getSetting(\"buttonToggleActiveBackgroundColor\", CUSTOM_STYLE.buttonToggleActiveBackgroundColor.default),\n      buttonToggleHoverBackgroundColor: Utils.getSetting(\"buttonToggleHoverBackgroundColor\", CUSTOM_STYLE.buttonToggleHoverBackgroundColor.default),\n      buttonTextColor: Utils.getSetting(\"buttonTextColor\", CUSTOM_STYLE.buttonTextColor.default),\n      buttonHoverTextColor: Utils.getSetting(\"buttonHoverTextColor\", CUSTOM_STYLE.buttonHoverTextColor.default),\n      buttonToggleActiveTextColor: Utils.getSetting(\"buttonToggleActiveTextColor\", CUSTOM_STYLE.buttonToggleActiveTextColor.default),\n      buttonToggleHoverTextColor: Utils.getSetting(\"buttonToggleHoverTextColor\", CUSTOM_STYLE.buttonToggleHoverTextColor.default),\n      buttonBorderPrimaryColor: Utils.getSetting(\"buttonBorderPrimaryColor\", CUSTOM_STYLE.buttonBorderPrimaryColor.default),\n      buttonBorderSecondaryColor: Utils.getSetting(\"buttonBorderSecondaryColor\", CUSTOM_STYLE.buttonBorderSecondaryColor.default),\n      buttonHoverBorderPrimaryColor: Utils.getSetting(\"buttonHoverBorderPrimaryColor\", CUSTOM_STYLE.buttonHoverBorderPrimaryColor.default),\n      buttonHoverBorderSecondaryColor: Utils.getSetting(\"buttonHoverBorderSecondaryColor\", CUSTOM_STYLE.buttonHoverBorderSecondaryColor.default),\n      buttonToggleActiveBorderPrimaryColor: Utils.getSetting(\"buttonToggleActiveBorderPrimaryColor\", CUSTOM_STYLE.buttonToggleActiveBorderPrimaryColor.default),\n      buttonToggleActiveBorderSecondaryColor: Utils.getSetting(\"buttonToggleActiveBorderSecondaryColor\", CUSTOM_STYLE.buttonToggleActiveBorderSecondaryColor.default),\n      buttonToggleHoverBorderPrimaryColor: Utils.getSetting(\"buttonToggleHoverBorderPrimaryColor\", CUSTOM_STYLE.buttonToggleHoverBorderPrimaryColor.default),\n      buttonToggleHoverBorderSecondaryColor: Utils.getSetting(\"buttonToggleHoverBorderSecondaryColor\", CUSTOM_STYLE.buttonToggleHoverBorderSecondaryColor.default),\n      textPrimaryColor: Utils.getSetting(\"textPrimaryColor\", CUSTOM_STYLE.textPrimaryColor.default),\n      textSecondaryColor: Utils.getSetting(\"textSecondaryColor\", CUSTOM_STYLE.textSecondaryColor.default),\n      textTertiaryColor: Utils.getSetting(\"textTertiaryColor\", CUSTOM_STYLE.textTertiaryColor.default),\n      textHoverPrimaryColor: Utils.getSetting(\"textHoverPrimaryColor\", CUSTOM_STYLE.textHoverPrimaryColor.default),\n      textHoverSecondaryColor: Utils.getSetting(\"textHoverSecondaryColor\", CUSTOM_STYLE.textHoverSecondaryColor.default),\n      textHoverTertiaryColor: Utils.getSetting(\"textHoverTertiaryColor\", CUSTOM_STYLE.textHoverTertiaryColor.default)\n    };\n    return this.context;\n  }\n\n  /* -------------------------------------------- */\n\n  _onRender(context, options) {\n    super._onRender(context, options);\n    if (typeof ColorPicker !== \"undefined\") { ColorPicker.install(); }\n  }\n\n  /* -------------------------------------------- */\n\n  static async reset() {\n    for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n      Utils.setSetting(key, value.default);\n      document.querySelector(\":root\").style.setProperty(value.cssProperty, value.default);\n    }\n    this.render(true);\n  }\n\n  /* -------------------------------------------- */\n\n  static async submit(event, form, formData) {\n    const isCustom = Utils.getSetting(\"style\") === \"custom\";\n    for (const [key, value] of Object.entries(formData.object)) {\n      const customStyle = CUSTOM_STYLE[key];\n      if (value !== this.context[key]) {\n        Utils.setSetting(key, value);\n        if (isCustom) {\n          document.querySelector(\":root\").style.setProperty(customStyle.cssProperty, value);\n        }\n      }\n    }\n  }\n}\n","import { Logger, Utils } from \"../core/utils.mjs\";\n\n/**\n * Reset layout confirmation dialog\n * @public\n */\nexport async function resetLayoutDialog() {\n  await foundry.applications.api.DialogV2.confirm({\n    window: {\n      title: game.i18n.localize(\"tokenActionHud.dialog.resetLayout.title\")\n    },\n    content: `<p>${game.i18n.localize(\"tokenActionHud.dialog.resetLayout.content\")}</p>`,\n    modal: true,\n    yes: {\n      label: game.i18n.localize(\"tokenActionHud.dialog.button.yes\"),\n      callback: async () => resetLayout()\n    },\n    no: {\n      label: game.i18n.localize(\"tokenActionHud.dialog.button.no\")\n    }\n  });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Reset user layout\n */\nasync function resetLayout() {\n  if (!game?.tokenActionHud) return;\n\n  const customLayoutElement = document.querySelector(\"#token-action-hud-core-settings input[name=customLayout]\");\n  if (customLayoutElement) {\n    await game.tokenActionHud.updateCachedSettings(\"customLayout\", customLayoutElement?.value ?? \"\");\n    await Utils.setSetting(\"customLayout\", customLayoutElement?.value ?? \"\");\n  }\n\n  const userCustomLayoutElement = document.querySelector(\"#token-action-hud-core-settings input[name=userCustomLayout]\");\n  if (userCustomLayoutElement) {\n    await game.tokenActionHud.updateCachedSettings(\"userCustomLayout\", userCustomLayoutElement?.value ?? \"\");\n    await Utils.setUserFlag(\"userCustomLayout\", userCustomLayoutElement?.value ?? \"\");\n  }\n\n  await game.tokenActionHud.resetLayout();\n  Logger.info(\"Layout reset\", true);\n}\n","import { Logger, Utils } from \"../core/utils.mjs\";\n\n/**\n * Reset all layouts confirmation dialog\n * @public\n */\nexport async function resetAllLayoutsDialog() {\n  await foundry.applications.api.DialogV2.confirm({\n    window: {\n      title: game.i18n.localize(\"tokenActionHud.dialog.resetAllLayouts.title\")\n    },\n    content: `<p>${game.i18n.localize(\"tokenActionHud.dialog.resetAllLayouts.content\")}</p>`,\n    modal: true,\n    yes: {\n      label: game.i18n.localize(\"tokenActionHud.dialog.button.yes\"),\n      callback: async () => resetAllLayouts()\n    },\n    no: {\n      label: game.i18n.localize(\"tokenActionHud.dialog.button.no\")\n    }\n  });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Reset HUD layouts for everyone\n * @public\n */\nasync function resetAllLayouts() {\n  if (!game.tokenActionHud) return;\n\n  const customLayoutElement = document.querySelector(\"#token-action-hud-core-settings input[name=customLayout]\");\n  if (customLayoutElement) {\n    await Utils.setSetting(\"customLayout\", customLayoutElement?.value ?? \"\");\n  }\n\n  const userCustomLayoutElement = document.querySelector(\"#token-action-hud-core-settings input[name=userCustomLayout]\");\n  if (userCustomLayoutElement) {\n    await Utils.setUserFlag(\"userCustomLayout\", userCustomLayoutElement?.value ?? \"\");\n  }\n\n  await game.tokenActionHud.socket.executeForEveryone(\"reset\");\n  Logger.info(\"All layouts reset\", true);\n}\n","import { MODULE, LAYOUT_SETTING, TEMPLATE } from \"../core/constants.mjs\";\nimport { resetLayoutDialog } from \"../dialogs/reset-layout.mjs\";\nimport { resetAllLayoutsDialog } from \"../dialogs/reset-all-layouts.mjs\";\nimport { Utils } from \"../core/utils.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class TahSettingsForm extends HandlebarsApplicationMixin(ApplicationV2) {\n  constructor(...args) {\n    super(args);\n\n    this.settings = {};\n  }\n\n  /* -------------------------------------------- */\n\n  static DEFAULT_OPTIONS = {\n    actions: {\n      exportLayout: TahSettingsForm.exportLayout,\n      resetLayout: resetLayoutDialog,\n      resetAllLayouts: resetAllLayoutsDialog,\n      reset: TahSettingsForm.reset\n    },\n    classes: [`${MODULE.ID}-app`, \"sheet\"],\n    id: \"token-action-hud-core-settings\",\n    form: {\n      closeOnSubmit: true,\n      handler: TahSettingsForm.submit\n    },\n    position: {\n      width: 600,\n      height: 800\n    },\n    tag: \"form\",\n    window: {\n      minimizable: true,\n      resizable: true\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  static PARTS = {\n    form: {\n      template: TEMPLATE.settings\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  async _prepareContext() {\n    const settings = [];\n    const context = { settings };\n\n    for (const [key, setting] of Object.entries(this.settings)) {\n      const { scope, hint, icon, label, name, type, inputType, range, choices, action } = setting;\n\n      if (scope === \"world\" && !game.user.isGM) continue;\n\n      const value = (setting?.scope)\n        ? (scope === \"user\")\n          ? await Utils.getUserFlag(key)\n          : await Utils.getSetting(key)\n        : \"\";\n      const settingType = type instanceof Function ? type.name : \"String\";\n      const isButton = inputType === \"button\";\n      const isCheckbox = inputType === \"checkbox\";\n      const isFilePicker = inputType === \"filePicker\";\n      const filePickerType = (inputType === \"filePicker\") ? settingType ?? \"any\" : \"\";\n      const isNumber = inputType === \"number\";\n      const isRange = (inputType === \"range\") && range;\n      const isSelect = choices !== undefined;\n      settings.push({\n        id: key,\n        hint: game.i18n.localize(hint),\n        icon,\n        label: game.i18n.localize(label),\n        name: game.i18n.localize(name),\n        value,\n        type,\n        isButton,\n        action,\n        isCheckbox,\n        isFilePicker,\n        filePickerType,\n        isNumber,\n        isRange,\n        isSelect\n      });\n    }\n    return context;\n  }\n\n  /* -------------------------------------------- */\n\n  static exportLayout() {\n    if (!game.tokenActionHud) return;\n    game.tokenActionHud.hudManager.layoutHandler.exportLayout();\n  }\n\n  static async submit(event, form, formData) {\n    for (const [key, value] of Object.entries(formData.object)) {\n      switch (this.settings[key].scope) {\n        case \"client\":\n        case \"world\":\n          await Utils.setSetting(key, value); break;\n        case \"user\":\n          await Utils.setUserFlag(key, value); break;\n      }\n\n      await game.tokenActionHud.updateCachedSettings(key, value);\n    }\n\n    game.tokenActionHud.update();\n  }\n}\n\n/* -------------------------------------------- */\n\nexport class TahSettingsFormLayout extends TahSettingsForm {\n  constructor() {\n    super();\n    this.settings = LAYOUT_SETTING;\n  }\n\n  /* -------------------------------------------- */\n\n  static DEFAULT_OPTIONS = {\n    window: {\n      title: \"tokenActionHud.settings.layout.form.title\"\n    }\n  };\n}\n","import { CustomStyleForm } from \"../applications/custom-style-form.mjs\";\nimport { TahSettingsFormLayout } from \"../applications/settings-form.mjs\";\nimport { CUSTOM_STYLE, MODULE } from \"./constants.mjs\";\nimport { Logger, Utils } from \"./utils.mjs\";\n\n/**\n * When a module setting is changed, update the HUD settings\n * @param {string} key The setting key\n * @param {*} value    The setting value\n */\nfunction onChangeFunction(key, value) {\n  if (game.tokenActionHud) game.tokenActionHud.updateCachedSettings(key, value);\n}\n\n/* -------------------------------------------- */\n\n// Register key bindings\nHooks.on(\"init\", async () => {\n  game.keybindings.register(MODULE.ID, \"enableDisableHud\", {\n    name: game.i18n.localize(\"tokenActionHud.enableDisableHud\"),\n    editable: [],\n    onDown: () => { if (game.tokenActionHud) game.tokenActionHud.toggleHudEnable(); }\n  });\n\n  game.keybindings.register(MODULE.ID, \"collapseExpandHud\", {\n    name: game.i18n.localize(\"tokenActionHud.collapseExpandHud\"),\n    editable: [],\n    onDown: () => { if (game.tokenActionHud) game.tokenActionHud.toggleHudCollapse(); }\n  });\n});\n\n/* -------------------------------------------- */\n\n/**\n * Register module settings\n * @param {class} systemManager The system manager\n * @param {Array} rollHandlers  The available roll handlers\n * @param {object} styles       The styles\n */\nexport const registerSettingsCore = function(systemManager, rollHandlers, styles) {\n  game.settings.registerMenu(MODULE.ID, \"customStyle\", {\n    hint: game.i18n.localize(\"tokenActionHud.settings.customStyle.hint\"),\n    label: game.i18n.localize(\"tokenActionHud.settings.customStyle.label\"),\n    name: game.i18n.localize(\"tokenActionHud.settings.customStyle.name\"),\n    icon: \"fas fa-palette\",\n    type: CustomStyleForm,\n    restricted: false,\n    scope: \"client\"\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.registerMenu(MODULE.ID, \"layout\", {\n    hint: game.i18n.localize(\"tokenActionHud.settings.layout.hint\"),\n    label: game.i18n.localize(\"tokenActionHud.settings.layout.label\"),\n    name: game.i18n.localize(\"tokenActionHud.settings.layout.name\"),\n    icon: \"fas fa-table-layout\",\n    type: TahSettingsFormLayout,\n    restricted: false,\n    scope: \"client\"\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"startup\", {\n    name: \"One-Time Startup Prompt\",\n    scope: \"world\",\n    config: false,\n    type: Boolean,\n    default: false\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"migrationVersion\", {\n    name: \"Migration Version\",\n    scope: \"world\",\n    config: false,\n    type: String,\n    default: \"0.0\"\n  });\n\n  /* -------------------------------------------- */\n\n  const styleChoices = Object.fromEntries(Object.entries(styles).map(([key, value]) => [key, value.name]));\n\n  game.settings.register(MODULE.ID, \"style\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.style.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.style.hint\"),\n    scope: \"client\",\n    config: true,\n    type: String,\n    default: \"foundryVTT\",\n    choices: styleChoices,\n    onChange: value => {\n      Utils.switchCSS(value);\n      onChangeFunction(\"style\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"customLayout\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.customLayout.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.customLayout.hint\"),\n    scope: \"world\",\n    config: false,\n    type: String\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"userCustomLayout\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.userCustomLayout.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.userCustomLayout.hint\"),\n    scope: \"client\",\n    config: false,\n    type: String\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"direction\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.direction.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.direction.hint\"),\n    scope: \"client\",\n    config: true,\n    type: String,\n    default: \"auto\",\n    choices: {\n      auto: game.i18n.localize(\"tokenActionHud.settings.direction.choice.auto\"),\n      up: game.i18n.localize(\"tokenActionHud.settings.direction.choice.up\"),\n      down: game.i18n.localize(\"tokenActionHud.settings.direction.choice.down\")\n    },\n    onChange: value => {\n      onChangeFunction(\"direction\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"grid\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.grid.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.grid.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"grid\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"scale\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.scale.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.scale.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Number,\n    range: {\n      min: 0.5,\n      max: 2,\n      step: 0.05\n    },\n    default: 1,\n    onChange: value => {\n      onChangeFunction(\"scale\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"drag\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.drag.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.drag.hint\"),\n    scope: \"client\",\n    config: true,\n    type: String,\n    default: \"whenUnlocked\",\n    choices: {\n      always: game.i18n.localize(\"tokenActionHud.settings.drag.choices.always\"),\n      whenUnlocked: game.i18n.localize(\"tokenActionHud.settings.drag.choices.whenUnlocked\"),\n      never: game.i18n.localize(\"tokenActionHud.settings.drag.choices.never\")\n    },\n    onChange: value => {\n      onChangeFunction(\"drag\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"enable\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.enable.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.enable.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"enable\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"rollHandler\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.rollHandler.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.rollHandler.hint\"),\n    scope: \"world\",\n    config: true,\n    type: String,\n    choices: rollHandlers,\n    default: \"core\",\n    onChange: value => {\n      onChangeFunction(\"rollHandler\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"allow\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.allow.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.allow.hint\"),\n    scope: \"world\",\n    config: true,\n    type: String,\n    choices: {\n      4: game.i18n.localize(\"tokenActionHud.settings.allow.choice.4\"),\n      3: game.i18n.localize(\"tokenActionHud.settings.allow.choice.3\"),\n      2: game.i18n.localize(\"tokenActionHud.settings.allow.choice.2\"),\n      1: game.i18n.localize(\"tokenActionHud.settings.allow.choice.1\")\n    },\n    default: 1,\n    requiresReload: true\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"enableCustomization\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.enableCustomization.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.enableCustomization.hint\"),\n    scope: \"world\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"enableCustomization\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"alwaysShowHud\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.alwaysShowHud.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.alwaysShowHud.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"alwaysShowHud\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"displayCharacterName\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.displayCharacterName.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.displayCharacterName.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"displayCharacterName\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"sortActions\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.sortActions.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.sortActions.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"sortActions\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"displayIcons\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.displayIcons.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.displayIcons.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"displayIcons\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"tooltips\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.tooltips.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.tooltips.hint\"),\n    scope: \"client\",\n    config: true,\n    type: String,\n    default: \"full\",\n    choices: {\n      full: game.i18n.localize(\"tokenActionHud.settings.tooltips.choices.full\"),\n      nameOnly: game.i18n.localize(\"tokenActionHud.settings.tooltips.choices.nameOnly\"),\n      none: game.i18n.localize(\"tokenActionHud.settings.tooltips.choices.none\")\n    },\n    onChange: value => {\n      onChangeFunction(\"tooltips\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"tooltipDelay\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.tooltipDelay.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.tooltipDelay.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Number,\n    default: 1500,\n    onChange: value => {\n      setTooltipDelay(value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  const tooltipDelay = Utils.getSetting(\"tooltipDelay\") || 1500;\n  setTooltipDelay(tooltipDelay);\n\n  /**\n   * Set the tooltip delay\n   * @param {number} ms Delay amount in milliseconds\n   */\n  function setTooltipDelay(ms) {\n    const root = document.querySelector(\":root\");\n    root.style.setProperty(\"--tah-tooltip-delay\", `${ms}ms`);\n  }\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"clickOpenCategory\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.clickOpenCategory.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.clickOpenCategory.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"clickOpenCategory\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  if (Utils.isModuleActive(\"itemacro\") && !Utils.isModuleActive(\"midi-qol\")) {\n    game.settings.register(MODULE.ID, \"itemMacro\", {\n      name: game.i18n.localize(\"tokenActionHud.settings.itemMacro.name\"),\n      hint: game.i18n.localize(\"tokenActionHud.settings.itemMacro.hint\"),\n      scope: \"client\",\n      config: true,\n      type: String,\n      choices: {\n        both: game.i18n.localize(\"tokenActionHud.settings.itemMacro.choices.both\"),\n        itemMacro: game.i18n.localize(\"tokenActionHud.settings.itemMacro.choices.itemMacro\"),\n        original: game.i18n.localize(\"tokenActionHud.settings.itemMacro.choices.original\")\n      },\n      default: \"both\",\n      onChange: value => {\n        onChangeFunction(\"itemMacro\", value);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"activeCssAsText\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.activeCssAsText.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.activeCssAsText.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"activeCssAsText\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"debug\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.debug.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.debug.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"debug\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  registerCustomStyleSettings();\n\n  systemManager.registerSettings(onChangeFunction);\n\n  Logger.debug(\"Available roll handlers\", { rollHandlers });\n};\n\n/* -------------------------------------------- */\n\n/**\n * Register color settings\n */\nfunction registerCustomStyleSettings() {\n  for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n    game.settings.register(MODULE.ID, key, {\n      scope: \"client\",\n      config: false,\n      type: value.type,\n      default: value.default\n    });\n  }\n}\n","import { ActionHandlerExtender } from \"./action-handler-extender.mjs\";\nimport { DELIMITER, ITEM_MACRO_ICON } from \"../../core/constants.mjs\";\nimport { Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for building actions related to the Item Macro module.\n */\nexport class ItemMacroActionHandlerExtender extends ActionHandlerExtender {\n  constructor() {\n    super();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Extend the action list\n   * @override\n   */\n  extendActionHandler() {\n    if (!this.actor) return;\n\n    const items = this.actor.items.filter(item => item.flags?.itemacro?.macro?.command);\n    if (!items?.length) return;\n\n    const itemMacroSetting = Utils.getSetting(\"itemMacro\");\n    if (itemMacroSetting === \"original\") return;\n\n    const replaceExisting = itemMacroSetting === \"itemMacro\";\n\n    Object.values(this.groupHandler.groups).forEach(group => {\n      this.#addGroupActions(items, group, replaceExisting);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add group actions\n   * @private\n   * @param {Array} items     The items\n   * @param {object} group    The group\n   * @param {boolean} replace Whether to replace the action or not\n   */\n  #addGroupActions(items, group, replace) {\n    // Exit if no actions exist\n    if (!group?.actions?.length) return;\n\n    const actions = [];\n    for (const existingAction of group.actions) {\n      const item = items.find(item => item.id === existingAction.id);\n      if (!item) continue;\n\n      const existingItemMacroAction = group.actions.find(action => action.id === `itemMacro+${existingAction.id}`);\n      const actionToReplace = existingItemMacroAction ?? existingAction;\n\n      if (existingItemMacroAction) replace = true;\n\n      const macroAction = this.#createItemMacroAction(item, existingAction, actionToReplace, replace);\n\n      if (!replace) {\n        actions.push(macroAction);\n      }\n\n      if (!this.actionHandler.availableActions.has(macroAction.id)) {\n        this.actionHandler.availableActions.set(macroAction.id, macroAction);\n      }\n    }\n\n    this.#addActions(actions, group);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Create item macro action\n   * @private\n   * @param {object} item            The item\n   * @param {object} existingAction  The existing action\n   * @param {object} actionToReplace The action to replace\n   * @param {boolean} replace        Whether to replace the action or not\n   * @returns {object}               The item macro action\n   */\n  #createItemMacroAction(item, existingAction, actionToReplace, replace) {\n    const action = (replace) ? actionToReplace : Utils.deepClone(existingAction);\n    action.encodedValue = `itemMacro${existingAction.encodedValue?.substr(existingAction.encodedValue.indexOf(DELIMITER))}`;\n    action.id = `itemMacro+${existingAction.id}`;\n    action.fullName = existingAction.fullName;\n    action.listName = `Item Macro: ${existingAction.fullName}`;\n    action.name = existingAction.name;\n    action.img = existingAction.img;\n    action.itemMacroIcon = `<i class=\"${ITEM_MACRO_ICON.ICON}\" data-tooltip=\"${ITEM_MACRO_ICON.TOOLTIP}\"></i>`;\n    action.selected = existingAction.userSelected ?? existingAction.systemSelected;\n\n    action.onClick = () => {\n      try {\n        item.executeMacro();\n      } catch(err) {\n        Logger.debug(\"ItemMacro Error\", err);\n        return false;\n      }\n    };\n\n    return action;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add actions to the group\n   * @private\n   * @param {object} actions The actions\n   * @param {object} group   The group\n   */\n  #addActions(actions, group) {\n    actions.forEach(macroAction => {\n      const index = group.actions.findIndex(action => action.id === macroAction.id) + 1;\n      group.actions.splice(index, 0, macroAction);\n    });\n  }\n}\n","import { registerSettingsCore } from \"../core/settings.mjs\";\nimport { ItemMacroActionHandlerExtender } from \"../handlers/action-handlers/item-macro-extender.mjs\";\nimport { RollHandler } from \"../handlers/roll-handlers/roll-handler.mjs\";\nimport { MODULE, CSS_STYLE } from \"../core/constants.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\n\nexport class SystemManager {\n  constructor() {\n    this.coreModuleId = MODULE.ID;\n    this.defaults = [];\n    this.styles = null;\n  }\n\n  /* -------------------------------------------- */\n  /*  Methods for system modules to override      */\n  /* -------------------------------------------- */\n\n  getActionHandler() {}\n\n  getRollHandler(rollHandlerId) {\n    return false;\n  }\n\n  getAvailableRollHandlers() {}\n\n  registerSettings(onChangeFunction) {}\n\n  async registerDefaults() {}\n\n  async registerStyles() {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Initialise the system manager\n   */\n  async init() {\n    await this.#registerDefaultsCore();\n    this.#registerStylesCore();\n    this.#registerSettingsCore();\n  }\n\n\n  /* -------------------------------------------- */\n\n  /**\n   * Register defaults\n   * @private\n   * @returns {Array} The defaults\n   */\n  async #registerDefaultsCore() {\n    const defaults = await this.registerDefaults() ?? [];\n\n    Hooks.callAll(\"tokenActionHudCoreRegisterDefaults\", defaults);\n\n    if (defaults) {\n      this.defaults = defaults;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Register styles\n   * @private\n   */\n  async #registerStylesCore() {\n    const systemStyles = this.registerStyles() ?? {};\n    this.styles = foundry.utils.mergeObject(CSS_STYLE, systemStyles);\n\n    Hooks.callAll(\"tokenActionHudCoreRegisterStyles\", this.styles);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Register module settings\n   * @private\n   */\n  #registerSettingsCore() {\n    const rollHandlers = this.getAvailableRollHandlers();\n    registerSettingsCore(this, rollHandlers, this.styles);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Initialise the action handler\n   * @public\n   * @param {class} hudManager The HudManager instance\n   * @returns {class}          The ActionHandler instance\n   */\n  getActionHandlerCore(hudManager) {\n    const actionHandler = this.getActionHandler();\n    actionHandler.systemManager = this;\n\n    const { dataHandler, groupHandler } = hudManager;\n    actionHandler.hudManager = hudManager;\n    actionHandler.dataHandler = dataHandler;\n    actionHandler.groupHandler = groupHandler;\n    actionHandler.addGroup = groupHandler.addGroup.bind(groupHandler);\n    actionHandler.addGroupInfo = groupHandler.addGroupInfo.bind(groupHandler);\n    this.#addActionHandlerExtenders(groupHandler, actionHandler);\n\n    Hooks.callAll(\"tokenActionHudCoreAddActionHandler\", actionHandler);\n\n    return actionHandler;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add action handler extensions\n   * @public\n   * @param {class} groupHandler The GroupHandler instance\n   * @param {class} actionHandler The ActionHandler instance\n   */\n  #addActionHandlerExtenders(groupHandler, actionHandler) {\n    if (Utils.isModuleActive(\"itemacro\") && !Utils.isModuleActive(\"midi-qol\")) {\n      actionHandler.addActionHandlerExtender(new ItemMacroActionHandlerExtender(groupHandler, actionHandler));\n    }\n\n    Hooks.callAll(\"tokenActionHudCoreAddActionHandlerExtenders\", actionHandler);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the roll handler\n   * @public\n   * @param {class} hudManager The HudManager instance\n   * @returns {class}          The RollHandler instance\n   */\n  getRollHandlerCore(hudManager) {\n    let rollHandlerId = Utils.getSetting(\"rollHandler\");\n\n    if (!(rollHandlerId === \"core\" || Utils.isModuleActive(rollHandlerId))) {\n      Logger.error(rollHandlerId, game.i18n.localize(\"tokenActionHud.handlerNotFound\"));\n      rollHandlerId = \"core\";\n      Utils.setSetting(\"rollHandler\", rollHandlerId);\n    }\n\n    // If no system RollHandler is returned, use core RollHandler\n    const rollHandler = this.getRollHandler(rollHandlerId) ?? new RollHandler();\n    rollHandler.hudManager = hudManager;\n\n    this.#addRollHandlerExtenders(rollHandler);\n\n    Hooks.callAll(\"tokenActionHudCoreAddRollHandler\", rollHandler);\n\n    return rollHandler;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add roll handler extensions\n   * @public\n   * @param {class} rollHandler The roll handler\n   */\n  #addRollHandlerExtenders(rollHandler) {\n    Hooks.callAll(\"tokenActionHudCoreAddRollHandlerExtenders\", rollHandler);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add handler\n   * @param {Array} choices The choices\n   * @param {string} id     The module id\n   */\n  static addHandler(choices, id) {\n    if (Utils.isModuleActive(id)) {\n      const title = Utils.getModuleTitle(id);\n      foundry.utils.mergeObject(choices, { [id]: title });\n    }\n  }\n}\n","import { MODULE, TEMPLATE } from \"./core/constants.mjs\";\nimport { DataHandler } from \"./handlers/data-handler.mjs\";\nimport { MigrationManager } from \"./managers/migration-manager.mjs\";\nimport { TokenActionHud } from \"./applications/token-action-hud.mjs\";\nimport { Logger, Utils } from \"./core/utils.mjs\";\nimport { registerSocket, getSocket, isSocketlibActive } from \"./core/sockets.mjs\";\nimport { registerApi } from \"./core/api.mjs\";\n\nlet systemManager;\n\n/**\n * Register hooks\n */\nHooks.once(\"socketlib.ready\", registerSocket);\nHooks.on(\"ready\", registerApi);\nHooks.on(\"tokenActionHudSystemReady\", registerCoreModule);\nHooks.on(\"tokenActionHudCoreReady\", registerHud);\nHooks.on(\"renderHotbar\", (_, html) => addContextMenuListener(html, \"li.macro\"));\nHooks.on(\"renderSceneNavigation\", (_, html) => addContextMenuListener(html, \"li.scene.nav-item\"));\n\n/* -------------------------------------------- */\n\n/**\n * Register the core module\n * @param {object} systemModule The system module\n */\nasync function registerCoreModule(systemModule) {\n  // Exit if core module version is not compatible with the system module\n  if (!Utils.isSystemModuleCompatible(systemModule.api?.requiredCoreModuleVersion)) return;\n\n  // Exit if socketlit module is not installed or enabled\n  if (!isSocketlibActive()) return;\n\n  // Create new SystemManager and register core and system module settings\n  systemManager = new systemModule.api.SystemManager(MODULE.ID);\n  await systemManager.init();\n\n  // Set stylesheet to 'style' core module setting\n  Utils.switchCSS(Utils.getSetting(\"style\"));\n\n  // Register Handlebar helpers\n  Utils.registerHandlebars();\n\n  // Load templates\n  loadTemplates(Object.values(TEMPLATE));\n\n  Hooks.callAll(\"tokenActionHudCoreReady\");\n}\n\n/* -------------------------------------------- */\n\n/**\n * Register the TokenActionHud application\n */\nasync function registerHud() {\n  // Get socket\n  const socket = getSocket();\n\n  // Initialise DataHandler\n  const dataHandler = new DataHandler(socket);\n  await dataHandler.init();\n\n  // Initialise MigrationManager\n  const migrationManager = new MigrationManager(dataHandler, socket);\n  await migrationManager.init();\n\n  checkColorPicker();\n  registerHudHooks();\n\n  game.tokenActionHud = new TokenActionHud(systemManager, dataHandler, socket);\n  await game.tokenActionHud.init();\n\n  Hooks.callAll(\"tokenActionHudReady\");\n\n  game.tokenActionHud.update({ type: \"hook\", name: \"tokenActionHudCoreReady\" });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Notify GM if the Color Picker is not active\n */\nfunction checkColorPicker() {\n  if (game.user.isGM && !game.modules.get(\"color-picker\")?.active && Utils.getSetting(\"startup\") === false) {\n    Logger.info(\"To enable color pickers, install the 'Color Picker' module.\", true);\n    Utils.setSetting(\"startup\", true);\n  }\n}\n\n/* -------------------------------------------- */\n\n/**\n * Register HUD-related hooks\n */\nfunction registerHudHooks() {\n  Hooks.on(\"renderTokenActionHud\", () => game.tokenActionHud.postRender());\n  const hooks = [\n    \"deleteActor\", \"updateActor\", \"createActiveEffect\", \"deleteActiveEffect\",\n    \"createCombat\", \"deleteCombat\", \"updateCombat\", \"updateCombatant\",\n    \"deleteCompendium\", \"updateCompendium\", \"createItem\", \"deleteItem\",\n    \"updateItem\", \"deleteMacro\", \"updateMacro\", \"controlToken\", \"deleteToken\",\n    \"updateToken\", \"closeSettingsConfig\", \"forceUpdateTokenActionHud\"\n  ];\n\n  hooks.forEach(hook => Hooks.on(hook, (...args) => handleHookEvent({ ...args }, hook)));\n}\n\n/* -------------------------------------------- */\n\n/**\n * Handle hook events\n * @param {object} hookData The hook data\n * @param {string} hookName The hook name\n */\nfunction handleHookEvent(hookData, hookName) {\n  if (!validateHookData(hookData, hookName)) return;\n  game.tokenActionHud.update({ type: \"hook\", name: hookName, data: hookData });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Validate hook data\n * @param {object} hookData The hook data\n * @param {string} hookName The hook name\n * @returns {boolean}\n */\nfunction validateHookData(hookData, hookName) {\n  switch (hookName) {\n    case \"deleteActor\":\n    case \"updateActor\":\n      return game.tokenActionHud.isValidActorOrItemUpdate(hookData[0], hookData[1]);\n    case \"createActiveEffect\":\n    case \"deleteActiveEffect\":\n      return game.tokenActionHud.isControlledActor(hookData[0]?.parent);\n    case \"createCombatant\":\n    case \"updateCombatant\":\n      return game.tokenActionHud.isControlledActor(hookData[0]?.actor);\n    case \"deleteCompendium\":\n    case \"updateCompendium\":\n      return validateCompendium(hookData.source?.metadata?.id);\n    case \"createItem\":\n    case \"deleteItem\":\n    case \"updateItem\":\n      return game.tokenActionHud.isValidActorOrItemUpdate(hookData[0]?.actor);\n    case \"deleteMacro\":\n    case \"updateMacro\":\n      game.tokenActionHud.actionHandler.macroActionHandler.macroActions = null;\n      return true;\n    case \"updateToken\":\n      return Object.hasOwn(hookData[1], \"hidden\") && game.tokenActionHud.isValidTokenChange(hookData[0], hookData[1]);\n    default:\n      return true;\n  }\n}\n\n/* -------------------------------------------- */\n\n/**\n * Validate compendium hook\n * @param {string} id The compendium ID\n * @returns {boolean} Whether the compendium hook is valid\n */\nfunction validateCompendium(id) {\n  const compendiumHandler = game.tokenActionHud.actionHandler.compendiumActionHandler;\n  if (!compendiumHandler.isLinkedCompendium(id)) return false;\n  compendiumHandler.compendiumActions = new Map();\n  return true;\n}\n\n/* -------------------------------------------- */\n\n/**\n * Add context menu listeners\n * @param {object} html     The HTML\n * @param {string} selector The selector for the HTML element\n */\nfunction addContextMenuListener(html, selector) {\n  const element = html[0].querySelector(selector);\n  if (element) element.addEventListener(\"contextmenu\", sendHudToBottom);\n}\n\n/* -------------------------------------------- */\n\n/**\n * Send HUD to bottom\n */\nfunction sendHudToBottom() {\n  if (game.tokenActionHud?.element) {\n    game.tokenActionHud.element.style.zIndex = 0;\n  }\n}\n","import { MODULE } from \"./constants.mjs\";\nimport { ActionHandler } from \"../handlers/action-handlers/action-handler.mjs\";\nimport { ActionHandlerExtender } from \"../handlers/action-handlers/action-handler-extender.mjs\";\nimport { DataHandler } from \"../handlers/data-handler.mjs\";\nimport { PreRollHandler } from \"../handlers/roll-handlers/pre-roll-handler.mjs\";\nimport { RollHandler } from \"../handlers/roll-handlers/roll-handler.mjs\";\nimport { RollHandlerExtender } from \"../handlers/roll-handlers/roll-handler-extender.mjs\";\nimport { SystemManager } from \"../managers/system-manager.mjs\";\nimport { Logger, Timer, Utils } from \"./utils.mjs\";\n\n/**\n * Register the API\n */\nexport function registerApi() {\n  const module = game.modules.get(MODULE.ID);\n  module.api = {\n    ActionHandlerExtender,\n    ActionHandler,\n    DataHandler,\n    Logger,\n    PreRollHandler,\n    RollHandler,\n    RollHandlerExtender,\n    SystemManager,\n    Timer,\n    Utils\n  };\n\n  Hooks.callAll(\"tokenActionHudCoreApiReady\", module);\n}\n"],"names":["MODULE","ID","NAME","TEMPLATE_DIR","TEMPLATE","action","customStyleForm","group","hud","listSubgroup","settings","tabSubgroup","tagifyAppHud","tagifyAppGroup","tagifyAppSubgroup","ACTION_TYPE","compendiumEntry","compendiumMacro","compendiumPlaylist","macro","COMPENDIUM_PACK_TYPES","CSS_STYLE","foundryVTT","class","file","moduleId","name","primaryColor","secondaryColor","tertiaryColor","foundryVttLight","compact","pathfinder","highContrast","custom","dockedLeft","isDocked","dockedCenterRight","collapseIcon","expandIcon","dockedRight","CUSTOM_STYLE","backgroundColor","cssProperty","type","String","default","buttonHeight","Number","buttonBackgroundColor","buttonBorderPrimaryColor","buttonBorderSecondaryColor","buttonTextColor","buttonHoverBorderPrimaryColor","buttonHoverBorderSecondaryColor","buttonHoverBackgroundColor","buttonHoverTextColor","buttonToggleActiveBackgroundColor","buttonToggleActiveBorderPrimaryColor","buttonToggleActiveBorderSecondaryColor","buttonToggleActiveTextColor","buttonToggleHoverBackgroundColor","buttonToggleHoverBorderPrimaryColor","buttonToggleHoverBorderSecondaryColor","buttonToggleHoverTextColor","textPrimaryColor","textSecondaryColor","textTertiaryColor","textHoverPrimaryColor","textHoverSecondaryColor","textHoverTertiaryColor","GROUP_TYPE","HUD","ITEM_MACRO_ICON","LAYOUT_SETTING","customLayout","hint","inputType","filePickerType","dtype","scope","userCustomLayout","exportLayout","label","icon","resetLayout","resetAllLayouts","SETTING","activeCssAsText","classes","variable","allow","alwaysShowHud","clickOpenCategory","customStyle","debug","direction","displayCharacterName","displayIcons","drag","enable","enableCustomization","grid","itemMacro","migrationVersion","reset","renderItemOnRightClick","rollHandler","scale","sortActions","startup","style","tooltips","Logger$1","Logger","info","message","notify","ui","notifications","console","log","error","data","game","tokenActionHud","debugSetting","Utils","getSetting","dataClone","deepClone","Timer","constructor","milliseconds","this","timer","start","abort","Promise","resolve","setTimeout","clearTimeout","checkAllow","userRole","allowSetting","capitalize","value","replace","text","charAt","toUpperCase","substring","toLowerCase","original","options","foundry","utils","getActor","actorId","tokenId","token","canvas","tokens","placeables","find","id","actor","actors","get","getClosestGroupElement","event","target","closest","getControlledActors","controlled","map","getStatusEffect","statusId","effects","effect","statuses","every","status","getImage","entity","defaultImages","push","result","displayIconsSetting","img","includes","getItem","itemId","items","getToken","getControlledTokens","getFirstControlledToken","controlledToken","character","user","key","defaultValue","setSetting","set","getActorFlag","getFlag","setActorFlag","setFlag","unsetActorFlag","unsetFlag","getUserFlag","setUserFlag","unsetUserFlag","i18n","toTranslate","localize","isGmActive","users","some","isGM","active","isModuleActive","module","modules","getModuleTitle","title","getModuleVersion","version","humanizeBinding","binding","keybindings","modifiers","reduce","parts","part","KeyboardManager","MODIFIER_CODES","unshift","getKeycodeDisplayString","join","median","numbers","mid","Math","floor","length","nums","sort","a","b","getUpperQuartileAverage","sortedNumbers","slice","endIndex","sum","count","i","ceil","getModifier","num","sortItems","Map","entries","localeCompare","sortItemsByName","switchCSS","Object","href","stylesheet","values","document","styleSheets","ss","disabled","setting","querySelector","setProperty","tahElement","classList","remove","add","registerHandlebars","Handlebars","registerHelper","string","tokenActionHudCoreTrue","args","reducer","Array","from","pop","first","shift","reduceOp","arguments","block","activeCssAsTextSetting","fn","inverse","getModuleVersionParts","moduleVersion","trigger","moduleVersionParts","split","major","minor","patch","isSystemModuleCompatible","requiredCoreModuleVersion","requiredCoreModuleVersionParts","coreModuleVersionParts","getNestedGroups","groups","order","groupId","groupType","isArray","foundGroups","level","nestId","assign","keys","getGroupByNestId","async","findGroup","groupStyle","foundGroup","deleteGroupByNestId","findAndDeleteGroup","index","splice","deleteGroupsById","DataHandler","socket","init","createDirectories","all","private","isPrivate","fileMap","getFilePathsAsGm","isPersistentStorage","isNewerVersion","ForgeVTT","DATA_FOLDER","moduleDirectory","directoriesToCreate","world","directory","FilePicker","browse","catch","createDirectory","path","getFileParts","filename","folder","hasPermission","files","getFilePaths","executeAsGM","getFilePathsWithSocket","dataHandler","actorFiles","userFiles","canSaveData","saveDataAsGm","saveData","saveDataWithSocket","fileName","encodeURI","File","JSON","stringify","response","upload","has","canGetData","getDataAsGm","getData","getDataWithSocket","foundFile","endsWith","ms","Date","now","fetch","ok","json","getDataMigrate","folderPath","foundFilePath","then","MigrationManager","isSuccess","unsetOldFlags","migrateFiles","filter","objects","children","scene","scenes","err","CharacterHandler","hudManager","groupHandler","actionHandler","previousActorId","setCharacter","isCharacter","isMultipleTokens","isSameActor","resetCharacter","controlledTokens","handleMultipleTokens","handleSingleToken","characterName","isValidCharacter","t","testUserPermission","LayoutHandler","systemManager","defaultLayout","setDefaultLayout","setCustomLayout","softReset","hardReset","defaults","layout","userId","saveDataToFile","getTooltip","tooltip","content","GroupHandler","layoutHandler","defaultGroups","actorGroups","userGroups","setDefaultGroups","setSavedActorGroups","setSavedUserGroups","defaultGroup","getUserGroups","savedUserData","prepareGroups","userGroup","createGroup","parentNestId","parentGroup","tabs","lists","getActorGroups","actorGroup","existingGroup","actions","getGroup","getGroups","selected","startsWith","getGroupIds","getGroupSettings","groupData","keepData","groupDataClone","defaultSettings","showTitle","groupSettings","subtitleClass","groupSystem","system","commonProps","cssClass","info1","info2","info3","listName","isSelected","defaultSelected","updateGroups","groupsData","parentGroupData","childGroupData","existingGroups","existingParentGroup","saveGroupSettings","saveGroups","saveActor","saveUser","saveActorGroups","saveUserGroups","getReducedGroupData","keepActions","isPreset","userSelected","getSelectedGroupsAsTags","toTagify","getAvailableGroupAsTags","getDerivedGroupsAsTags","getSystemGroupsAsTags","getCompendiumGroupsAsTags","getMacroGroupsAsTags","derivedGroups","packs","pack","documentName","visible","metadata","addGroup","update","parentGroups","updateGroup","updateExistingGroups","removeGroup","addGroupInfo","groupInfo","forEach","setHasActions","hasActions","HudManager","getActionHandlerCore","getRollHandlerCore","characterHandler","isHudEnabled","buildHud","softResetHud","hardResetHud","previousActor","isGmInactiveUserNotified","prepareHud","buildActionsCore","prepareActions","handleHudEvent","eventType","getAction","registerKeyPresses","setIsHover","handleGroupClickCore","handleActionClickCore","handleActionHoverCore","setIsRightClick","setIsAlt","setIsCtrl","setIsShift","button","originalEvent","isRightClick","isModiferActive","keyboard","isModifierActive","MODIFIER_KEYS","ALT","altKey","emulateKeypress","force","downKeys","isAlt","CONTROL","ctrlKey","isCtrl","SHIFT","shiftKey","isShift","isHover","groupElement","dataset","actionButtonElement","actionId","availableActions","role","e","amd","exports","s","r","window","MutationObserver","WebKitMutationObserver","nodeType","observe","childList","subtree","addEventListener","parentElm","uid","selector","callbacks","setup","bind","bindEvents","prototype","namespace","childNodes","parentNode","removeChild","matches","draggable","gap","getItemsGap","firstElementChild","throttle","call","getDraggableElm","dragstart","saveInitialStyles","source","getInitialState","getBoundingClientRect","elm","idx","getNodeIndex","size","width","height","dataTransfer","effectAllowed","dragStart","afterDragStart","mode","dragover","preventDefault","stopPropagation","hoverDirection","dropEffect","getTargetDirection","directionAwareDragEnter","dragenter","isValidElm","bounding","cleanupLastTarget","abs","toggle","dragend","dragoverTimeout","cleanup","nextElementSibling","insertBefore","dragEnd","isTargetLastChild","lastElementChild","pageY","top","pageX","left","previousSibling","test","setAttribute","getAttribute","removeAttribute","getComputedStyle","parseInt","listeners","destroy","DragSort","n","Symbol","iterator","toString","TypeError","isEnabled","TAGIFY_DEBUG","apply","concat","warn","trim","o","indexOf","DOMParser","parseFromString","body","l","d","c","u","hasOwnProperty","hasInstance","g","next","done","h","p","return","normalize","navigator","userAgent","f","crypto","getRandomValues","Uint8Array","m","contains","classNames","tag","v","tagSelector","getSelection","getRangeAt","createTextNode","deleteContents","insertNode","w","__tagifyTagData","tagElm","y","rangeCount","setStartAfter","collapse","removeAllRanges","addRange","T","before","O","delimiters","pattern","tagTextProp","maxTags","addTagOnBlur","addTagOn","onChangeAfterBlur","duplicates","whitelist","blacklist","enforceWhitelist","userInput","focusable","keepInvalidTags","createInvalidTags","mixTagsAllowedAfter","mixTagsInterpolator","backspace","skipInvalid","pasteAsTags","editTags","clicks","keepInvalid","transformTag","a11y","focusableTags","mixMode","insertAfterTag","autoComplete","enabled","rightKey","tabKey","selectMode","input","focus","tagNoAnimation","tagInvalid","tagNotAllowed","scopeLoading","hasMaxTags","hasNoTags","empty","inputInvalid","dropdown","dropdownWrapper","dropdownHeader","dropdownFooter","dropdownItem","dropdownItemActive","dropdownItemHidden","dropdownItemSelected","dropdownInital","tagText","tagX","tagLoading","tagEditing","tagFlash","tagHide","classname","maxItems","searchKeys","fuzzySearch","caseSensitive","accentedSearch","includeSelectedTags","escapeHTML","highlightFirst","closeOnSelect","clearOnSelect","position","appendTarget","hooks","beforeRemoveTag","beforePaste","suggestionClick","beforeKeyDown","x","defineProperty","enumerable","configurable","writable","D","getOwnPropertySymbols","getOwnPropertyDescriptor","I","getOwnPropertyDescriptors","defineProperties","S","E","N","_dropdown","refs","DOM","__tagify","_","A","C","events","onKeyDown","onMouseOver","onMouseLeave","onClick","onScroll","state","hasFocus","composing","dropdownItemActiveSelector","getSuggestionDataByNode","tagify","getAllSuggestionsRefs","getNextOrPrevOption","dropdownItemSelector","highlightOption","hide","ArrowLeft","editing","getMappedValue","autocomplete","tagData","suggestionElm","selectOption","addTags","inputText","raw","charCodeAt","removeTags","editTag","scrollTop","scrollHeight","clientHeight","percentage","round","refilter","query","suggestedListItems","filterListItems","fill","findIndex","ddItemElm","ddItemData","suggest","offsetTop","normalizeTags","onEditTagDone","__isValid","toggleFocusClass","fillHeaderFooter","once","selectAll","suggestions","exact","isTagDuplicate","sortby","mapValueTo","createListHTML","templates","mappedValue","parseTemplate","getHeaderRef","getFooterRef","M","querySelectorAll","show","dropdownItemNoMatch","isLoading","readonly","dropdownHide__bindEventsTimeout","setStateSelection","render","removeEventListener","selection","flaggedTags","baseOffset","getAppendTarget","cloneNode","cssText","appendChild","dropdownContent","innerHTML","replaceChild","RTL","pageYOffset","fullscreenElement","webkitFullscreenElement","documentElement","max","clientWidth","innerWidth","startContainer","startOffset","createRange","setStart","setEnd","right","bottom","offsetLeft","placeAbove","pageXOffset","k","L","exceed","duplicate","notAllowed","j","wrapper","className","required","placeholder","getAttributes","P","V","R","H","B","K","U","customBinding","customEventsList","on","mainEvents","main","bindGlobal","isJQueryPlugin","jQuery","originalInput","removeAllTags","keydown","onKeydown","click","onClickScope","dblclick","onDoubleClickScope","paste","onPaste","drop","onDrop","compositionstart","onCompositionStart","compositionend","onCompositionEnd","inputMutationObserver","onInputDOMChange","disconnect","bindOriginaInputListener","clearInterval","originalInputValueObserverInterval","setInterval","observeOriginalInputValue","global","isIE","cb","onWindowKeyDown","onFocusBlur","onClickAnywhere","useCapture","unbindGlobal","textContent","relatedTarget","addNew","postUpdate","triggerChangeEvent","loading","getTagElms","activeElement","hasAttribute","anchorOffset","anchorNode","createElement","innerText","nodeValue","fromCharCode","previousElementSibling","Element","nodeName","min","nextSibling","blur","inputSuggestion","onInput","onMixTagsInput","inputElm","validateTag","toggleScopeValidation","isValid","search","createDocumentFragment","createTagElem","setRangeAtStartEnd","lastChild","withoutChangeEvent","cloneRange","focusNode","endOffset","match","lastIndexOf","prefix","matchedPatternCount","onInputIE","tagifyValue","loadOriginalValues","fixFirefoxLastTagNoCaret","W","clipboardData","pastedText","injectAtCaret","tagsElems","onEditTagInput","__tagId","editTagChangeDetected","originalIsValid","newValue","onEditTagPaste","onEditTagClick","onEditTagFocus","onEditTagBlur","__originalData","onEditTagkeydown","__originalHTML","editable","addedNodes","outerHTML","replaceWith","removedNodes","q","z","X","J","G","$","Proxy","removeAllCustomListeners","F","off","cloneData","triggerHandler","cloneEvent","HTMLElement","CustomEvent","detail","dispatchEvent","isFirefox","documentMode","getPersistedData","localStorage","parse","setPersistedData","setItem","Event","clearPersistedData","removeItem","applySettings","build","getCSSVars","autofocus","placeCaretAfterNode","getSetTagData","helpers","sameStr","removeCollectionProp","omit","isObject","parseHTML","extend","concatWithoutDups","getUID","isNodeTag","dataProps","setContentEditable","generateClassSelectors","RegExp","_delimiters","TEXTS","texts","getCustomAttributes","range","CSSVars","tagHideTransition","unit","getPropertyValue","integrated","originalInput_tabIndex","tabIndex","inputSelector","blockChangeEvent","parseMixTags","tagName","insertAdjacentHTML","lastOriginalValueReported","toggleClass","setPlaceholder","bubbles","simulated","_valueTracker","setValue","random","getTagTextNode","tagTextSelector","setTagTextNode","getLastTag","skipValidation","editTagToggleValidity","removeTagsFromValue","previousData","replaceTag","reCheckInvalidTags","getInvalidTagAttrs","updateValueByDOMTags","appendMixTags","validate","substr","replaceTextWithNode","getTagIdx","getTagIndexByValue","getTagElmByValue","flashTag","isTagBlacklisted","isTagWhitelisted","getWhitelistItem","setReadonly","contentEditable","setDisabled","Error","splitText","prepareNewTagNode","__preInvalidData","aggregatedInvalidInput","postProcessNewTagNode","selectTag","appendTag","addEmptyTag","addMixTags","prefixedTextToTag","createNodeIterator","NodeFilter","SHOW_TEXT","nextNode","node","__removed","parseFloat","clientTop","removeTagsFromDOM","setOriginalInputValue","debouncedUpdateTimeout","getInputValue","getCleanValue","getMixedTagsAsString","originalInputValueFormat","removeTag","ApplicationV2","HandlebarsApplicationMixin","applications","api","TagifyApp","super","dragSort","submit","categoryId","subcategoryId","static","resetActions","unselectAllTags","form","closeOnSubmit","handler","minimizable","resizable","_prepareContext","open","dialogType","tags","dialogData","dialogSubmit","prepareHook","dialog","TagifyAppHud","TagifyAppGroup","TagifyAppSubgroup","Hooks","app","html","tagInput","Infinity","onDragEnd","available","Tagify","tagifyInput","dropdownLabelElement","DialogV2","confirm","modal","yes","callback","resetActorData","no","_onKeyDown","close","defaultChoice","buttons","formData","slugify","replacement","strict","object","template","TagifyAppHelper","openEditHudApp","topLabel","choices","callAll","openEditGroupApp","choice","characterCount","customWidth","image","openEditSubgroupApp","getAvailableActionsAsTags","availableGroups","selectedActions","getSelectedActionsAsTags","selectedGroups","_style","updateActions","GroupResizer","minCols","isCustomWidth","spacing","resizeGroup","setVariables","subgroupsElement","setWidth","setHeight","resetVariables","setSubgroupsElement","resetGroupsElements","setSubgroupElementArr","actionsElements","availableHeight","availableWidth","gridWidth","subgroupElementArr","subgroupsElementPadding","subgroupsElementRect","groupsElements","resetCSS","maxHeight","overflowY","getGridWidth","display","gridTemplateColumns","actionWidths","actionWidthsForMedian","actionsElement","actionElements","actionElement","actionRect","actionWidth","actionButtonText","actionButtonTextRect","actionButtonTextWidth","upperQuartileAverage","availableactionButtonTextWidth","resizeGrid","groupCustomWidth","assignCSS","squaredCols","sqrt","availableGroupWidth","availableCols","resize","sqrtActions","currentRow","maxRowWidth","rowWidth","maxWidth","getAvailableWidth","windowWidth","screenDimensions","contentLeft","uiRightClientWidth","subgroupsElementComputed","paddingLeft","paddingRight","hasGrid","subgroupElement","requestAnimationFrame","getAvailableHeight","windowHeight","innerHeight","contentBottom","contentTop","siblingsHeight","sibling","siblings","uiTopBottomOffsetHeight","offsetHeight","element","elements","TokenActionHud","groupResizer","openGroups","Set","updatePendingTimer","updateTimer","closeTimer","renderTimer","clickGroup","clickSubgroup","clickAction","collapseHud","expandHud","lockHud","unlockHud","editHud","background","frame","zIndex","styleData","styles","context","cacheSettings","updateCachedSettings","updateSettingsPending","setPosition","_onRender","cacheElements","setInitialHudState","addHoverEvents","actionArr","tabSubgroupArr","editHudButton","listSubgroupsArr","subgroupsContainerArr","subgroupArr","listSubgroupTitleArr","groupButtonArr","collapseExpandContainer","collapseHudButton","expandHudButton","unlockButton","lockButton","isCollapsed","isUnlocked","toggleGroup","passive","dragEvent","handleActionHover","postRender","rendering","applyDirection","reopenGroups","toggleHudEnable","format","toggleHudCollapse","isCollapsing","toggleHudLock","isUnlocking","toggleElements","hideIfEmpty","bringToFront","currentTarget","handleGroupClick","collapseExpandSubgroup","isOpen","shouldOpen","toggleOtherGroups","delete","groupToIgnore","isParentToIgnore","groupsElement","imageElement","toggleGroupVisibility","parsedLevel","isDraggable","clientX","changedTouches","clientY","pos1","pos2","pos3","pos4","originalElementTop","originalElementLeft","newElementTop","newElementLeft","mouseMoveEvent","topPos","mouseUpEvent","onmousemove","ontouchmove","onmouseup","ontouchend","hudPosition","setDockedPosition","setUndockedPosition","interfaceElement","styleSetting","rightUiElement","leftUiElement","setPositionFromFlag","defaultLeftPos","defaultTopPos","check","leftPos","obj","bool","resetPosition","copy","fromUserId","toUserIds","copyUserData","fromGroup","resetLayoutWithSocket","resetUserAndActorData","resetAllActorData","resetUserData","resetAllUserData","handleUpdate","performUpdate","isUpdatePending","waitForUpdateCompletion","maxWaitTime","isUpdating","windows","appId","abortUpdate","closeHud","animate","isValidTokenChange","flags","isRelevantToken","isControlledActor","isValidActorOrItemUpdate","getSocket","GenericActionHandler","buildActions","buildUtilities","buildSingleTokenUtilities","buildMultipleTokenUtilities","actionsData","toggleCombatAction","inCombat","toggleCombatant","toggleVisibilityAction","hidden","isHidden","addActions","CompendiumActionHandler","compendiumActions","packIds","packId","setActions","getIndex","actionType","getCompendiumActionType","entry","_id","function","getOnClick","getGroupId","documentId","getOnClickFunction","getOnClickEntry","getDocument","sheet","execute","isLinkedCompendium","MacroActionHandler","macroActions","getActions","macros","getListName","ownership","ActionHandler","genericActionHandler","compendiumActionHandler","macroActionHandler","delimiter","actionHandlerExtenders","buildSystemActionsCore","buildGenericActionsCore","buildCompendiumActionsCore","buildMacroActionsCore","buildExtendedActionsCore","updateNonPresetActions","setCharacterLimit","groupIds","buildSystemActions","extender","extendActionHandler","nonPresetActions","nonPresetAction","availableAction","systemSelected","createAction","groupCharacterCount","subgroups","subgroup","subgroupCharacterCount","word","actionData","fullName","infoProps","onHover","encodedValue","icons","icon1","icon2","icon3","isAction","isItem","useRawHtmlName","addToAvailableActions","existingActions","reorderedActions","existingAction","existingActionId","actionClone","addActionHandlerExtender","actionHandlerExtender","ActionHandlerExtender","RollHandler","preRollHandlers","rollHandlerExtenders","throwInvalidValueErr","buttonValue","getButtonValue","handled","prehandleActionEvent","handleActionClick","addPreRollHandler","buttonElement","renderItem","item","isRenderItem","PreRollHandler","RollHandlerExtender","CustomStyleForm","ColorPicker","install","isCustom","resetLayoutDialog","customLayoutElement","userCustomLayoutElement","resetAllLayoutsDialog","executeForEveryone","TahSettingsForm","settingType","Function","isButton","isCheckbox","isFilePicker","isNumber","isRange","isSelect","undefined","TahSettingsFormLayout","onChangeFunction","register","onDown","registerSettingsCore","rollHandlers","registerMenu","restricted","config","Boolean","styleChoices","fromEntries","onChange","auto","up","down","step","always","whenUnlocked","never","requiresReload","full","nameOnly","none","setTooltipDelay","both","registerCustomStyleSettings","registerSettings","ItemMacroActionHandlerExtender","itemacro","command","itemMacroSetting","replaceExisting","addGroupActions","existingItemMacroAction","actionToReplace","macroAction","createItemMacroAction","itemMacroIcon","executeMacro","SystemManager","coreModuleId","getActionHandler","getRollHandler","rollHandlerId","getAvailableRollHandlers","registerDefaults","registerStyles","registerDefaultsCore","registerStylesCore","systemStyles","mergeObject","addActionHandlerExtenders","addRollHandlerExtenders","addHandler","addContextMenuListener","sendHudToBottom","registerSocket","socketlib","registerModule","registerApi","registerCoreModule","systemModule","isSocketlibActive","loadTemplates","registerHud","migrationManager","checkColorPicker","registerHudHooks","hook","handleHookEvent","hookData","hookName","validateHookData","parent","validateCompendium","compendiumHandler","hasOwn"],"mappings":"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","x_google_ignoreList":[9,10]}